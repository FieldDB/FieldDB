//     Underscore.js 1.3.3
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

/*!
 * jQuery JavaScript Library v1.7.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Wed Mar 21 12:46:34 2012 -0700
 */

/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */

/* ===================================================
 * bootstrap-transition.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =========================================================
 * bootstrap-modal.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ============================================================
 * bootstrap-dropdown.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =============================================================
 * bootstrap-scrollspy.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#scrollspy
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================== */

/* ========================================================
 * bootstrap-tab.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */

/* ===========================================================
 * bootstrap-tooltip.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ===========================================================
 * bootstrap-popover.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */

/* ==========================================================
 * bootstrap-alert.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ============================================================
 * bootstrap-button.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =============================================================
 * bootstrap-collapse.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ==========================================================
 * bootstrap-carousel.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#carousel
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =============================================================
 * bootstrap-typeahead.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#typeahead
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*
 * JavaScript Pretty Date Copyright (c) 2011 John Resig (ejohn.org) Licensed
 * under the MIT and GPL licenses.
 */

/*
CryptoJS v3.0.1
code.google.com/p/crypto-js
(c) 2009-2012 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/

/*
Copyright 2011 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Author: Eric Bidelman (ericbidelman@chromium.org)
*/

/*!
Math.uuid.js (v1.4)
http://www.broofa.com
mailto:robert@broofa.com

Copyright (c) 2010 Robert Kieffer
Dual licensed under the MIT and GPL licenses.
*/

/**
*
*  MD5 (Message-Digest Algorithm)
*
*  For original source see http://www.webtoolkit.info/
*  Download: 15.02.2009 from http://www.webtoolkit.info/javascript-md5.html
*
*  Licensed under CC-BY 2.0 License
*  (http://creativecommons.org/licenses/by/2.0/uk/)
*
**/

// parseUri 1.2.2
// (c) Steven Levithan <stevenlevithan.com>
// MIT License

// Autosize 1.11 - jQuery plugin for textareas
// (c) 2012 Jack Moore - jacklmoore.com
// license: www.opensource.org/licenses/mit-license.php

/*
 Copyright 2011 Abdulla Abdurakhmanov
 Original sources are available at https://code.google.com/p/x2js/

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */

function Sound(e) {
    var t = this, n = null, r = null, i = e || !1;
    window.AudioContext = window.AudioContext || window.webkitAudioContext, window.AudioContext && (n = new window.AudioContext), this.load = function(e, r, i) {
        var s = new XMLHttpRequest;
        s.open("GET", e, !0), s.responseType = "arraybuffer", s.onload = function() {
            n && n.decodeAudioData(this.response, function(e) {
                t.sample = e, i && i();
            }, function(e) {
                console.log(e);
            });
        }, s.send();
    }, this.play = function() {
        n && (r = n.createBufferSource(), r.buffer = t.sample, r.looping = i, r.connect(n.destination), r.noteOn(0));
    }, this.stop = function() {
        r && (r.noteOff(0), r.disconnect(0));
    };
}

function X2JS() {
    function n(e) {
        var t = e.localName;
        t == null && (t = e.baseName);
        if (t == null || t == "") t = e.nodeName;
        return t;
    }
    function r(e) {
        
return e.prefix;
    }
    function i(e) {
        if (e.nodeType == t.DOCUMENT_NODE) {
            var s = new Object, o = e.firstChild, u = n(o);
            return s[u] = i(o), s;
        }
        if (e.nodeType == t.ELEMENT_NODE) {
            var s = new Object;
            s.__cnt = 0;
            var a = e.childNodes;
            for (var f = 0; f < a.length; f++) {
                var o = a.item(f), u = n(o);
                s.__cnt++;
                if (s[u] == null) s[u] = i(o), s[u + "_asArray"] = new Array(1), s[u + "_asArray"][0] = s[u]; else {
                    if (s[u] != null && !(s[u] instanceof Array)) {
                        var l = s[u];
                        s[u] = new Array, s[u][0] = l, s[u + "_asArray"] = s[u];
                    }
                    var c = 0;
                    while (s[u][c] != null) c++;
                    s[u][c] = i(o);
                }
            }
            for (var h = 0; h < e.attributes.length; h++) {
                var p = 
e.attributes.item(h);
                s.__cnt++, s["_" + p.name] = p.value;
            }
            var d = r(e);
            d != null && d != "" && (s.__cnt++, s.__prefix = d), s.__cnt == 1 && s["#text"] != null && (s = s["#text"]), s["#text"] != null && (s.__text = s["#text"], delete s["#text"], delete s["#text_asArray"]), s["#cdata-section"] != null && (s.__cdata = s["#cdata-section"], delete s["#cdata-section"], delete s["#cdata-section_asArray"]);
            if (s.__text != null || s.__cdata != null) s.toString = function() {
                return (this.__text != null ? this.__text : "") + (this.__cdata != null ? this.__cdata : "");
            };
            return s;
        }
        if (e.nodeType == t.TEXT_NODE || e.nodeType == t.CDATA_SECTION_NODE) return e.nodeValue;
    }
    function s(e, t, n, r) {
        var i = "<" + (e.__prefix != null ? e.__prefix + ":" : "") + t;
        if (n != null) for (var s = 0; s < n.length; s++) {
            var o = n[s], u = e[o];
            
i += " " + o.substr(1) + "='" + u + "'";
        }
        return r ? i += "/>" : i += ">", i;
    }
    function o(e, t) {
        return "</" + (e.__prefix != null ? e.__prefix + ":" : "") + t + ">";
    }
    function u(e, t) {
        return e.indexOf(t, e.length - t.length) !== -1;
    }
    function a(e) {
        var t = "";
        return e.__text != null ? t += e.__text : t += e, t;
    }
    function f(e) {
        var t = "", n = 0;
        for (var r in e) {
            if (u(r.toString(), "_asArray") || r.toString().indexOf("_") == 0 || e[r] instanceof Function) continue;
            n++;
        }
        for (var r in e) {
            if (u(r.toString(), "_asArray") || r.toString().indexOf("_") == 0 || e[r] instanceof Function) continue;
            var i = e[r], l = [];
            for (var c in i) c.toString().indexOf("__") == -1 && c.toString().indexOf("_") == 0 && l.push(c);
            if (i != null && i instanceof Object && n > 0) if (i instanceof Array) {
                
var h = !0;
                i.length > 0 ? h = i[0] instanceof Object : t += s(i, r, l, !0);
                for (var p = 0; p < i.length; p++) h ? t += f(i[p]) : (t += s(i, r, l, !1), t += a(i[p]), t += o(i, r));
            } else t += s(i, r, l, !1), t += f(i), i.__cdata != null && (t += "<![CDATA[" + i.__cdata + "]]>"), i.__text != null && (t += i.__text), t += o(i, r); else {
                t += s(i, r, l, !1), i.__cdata != null && (t += "<![CDATA[" + i.__cdata + "]]>");
                if (i.__text != null || !(i instanceof Object)) t += a(i);
                t += o(i, r);
            }
        }
        return t;
    }
    var e = "1.0.6", t = {
        ELEMENT_NODE: 1,
        TEXT_NODE: 3,
        CDATA_SECTION_NODE: 4,
        DOCUMENT_NODE: 9
    };
    this.parseXmlString = function(e) {
        var t;
        if (window.DOMParser) {
            var n = new DOMParser;
            t = n.parseFromString(e, "text/xml");
        } else e.indexOf("<?") == 0 && (e = e.substr(e.indexOf
("?>") + 2)), t = new ActiveXObject("Microsoft.XMLDOM"), t.async = "false", t.loadXML(e);
        return t;
    }, this.xml2json = function(e) {
        return i(e);
    }, this.xml_str2json = function(e) {
        var t = this.parseXmlString(e);
        return this.xml2json(t);
    }, this.json2xml_str = function(e) {
        return f(e);
    }, this.json2xml = function(e) {
        var t = this.json2xml_str(e);
        return this.parseXmlString(t);
    };
}

(function() {
    function C(e, t, n) {
        if (e === t) return e !== 0 || 1 / e == 1 / t;
        if (e == null || t == null) return e === t;
        e._chain && (e = e._wrapped), t._chain && (t = t._wrapped);
        if (e.isEqual && S.isFunction(e.isEqual)) return e.isEqual(t);
        if (t.isEqual && S.isFunction(t.isEqual)) return t.isEqual(e);
        var r = a.call(e);
        if (r != a.call(t)) return !1;
        switch (r) {
          case "[object String]":
            return e == String(t);
          case "[object Number]"
:
            return e != +e ? t != +t : e == 0 ? 1 / e == 1 / t : e == +t;
          case "[object Date]":
          case "[object Boolean]":
            return +e == +t;
          case "[object RegExp]":
            return e.source == t.source && e.global == t.global && e.multiline == t.multiline && e.ignoreCase == t.ignoreCase;
        }
        if (typeof e != "object" || typeof t != "object") return !1;
        var i = n.length;
        while (i--) if (n[i] == e) return !0;
        n.push(e);
        var s = 0, o = !0;
        if (r == "[object Array]") {
            s = e.length, o = s == t.length;
            if (o) while (s--) if (!(o = s in e == s in t && C(e[s], t[s], n))) break;
        } else {
            if ("constructor" in e != "constructor" in t || e.constructor != t.constructor) return !1;
            for (var u in e) if (S.has(e, u)) {
                s++;
                if (!(o = S.has(t, u) && C(e[u], t[u], n))) break;
            }
            if (o) {
                
for (u in t) if (S.has(t, u) && !(s--)) break;
                o = !s;
            }
        }
        return n.pop(), o;
    }
    var e = this, t = e._, n = {}, r = Array.prototype, i = Object.prototype, s = Function.prototype, o = r.slice, u = r.unshift, a = i.toString, f = i.hasOwnProperty, l = r.forEach, c = r.map, h = r.reduce, p = r.reduceRight, d = r.filter, v = r.every, m = r.some, g = r.indexOf, y = r.lastIndexOf, b = Array.isArray, w = Object.keys, E = s.bind, S = function(e) {
        return new P(e);
    };
    typeof exports != "undefined" ? (typeof module != "undefined" && module.exports && (exports = module.exports = S), exports._ = S) : e._ = S, S.VERSION = "1.3.3";
    var x = S.each = S.forEach = function(e, t, r) {
        if (e == null) return;
        if (l && e.forEach === l) e.forEach(t, r); else if (e.length === +e.length) {
            for (var i = 0, s = e.length; i < s; i++) if (i in e && t.call(r, e[i], i, e) === n) return;
        } else for (var o in e) if (
S.has(e, o) && t.call(r, e[o], o, e) === n) return;
    };
    S.map = S.collect = function(e, t, n) {
        var r = [];
        return e == null ? r : c && e.map === c ? e.map(t, n) : (x(e, function(e, i, s) {
            r[r.length] = t.call(n, e, i, s);
        }), e.length === +e.length && (r.length = e.length), r);
    }, S.reduce = S.foldl = S.inject = function(e, t, n, r) {
        var i = arguments.length > 2;
        e == null && (e = []);
        if (h && e.reduce === h) return r && (t = S.bind(t, r)), i ? e.reduce(t, n) : e.reduce(t);
        x(e, function(e, s, o) {
            i ? n = t.call(r, n, e, s, o) : (n = e, i = !0);
        });
        if (!i) throw new TypeError("Reduce of empty array with no initial value");
        return n;
    }, S.reduceRight = S.foldr = function(e, t, n, r) {
        var i = arguments.length > 2;
        e == null && (e = []);
        if (p && e.reduceRight === p) return r && (t = S.bind(t, r)), i ? e.reduceRight(t, n) : e.reduceRight(t);
        
var s = S.toArray(e).reverse();
        return r && !i && (t = S.bind(t, r)), i ? S.reduce(s, t, n, r) : S.reduce(s, t);
    }, S.find = S.detect = function(e, t, n) {
        var r;
        return T(e, function(e, i, s) {
            if (t.call(n, e, i, s)) return r = e, !0;
        }), r;
    }, S.filter = S.select = function(e, t, n) {
        var r = [];
        return e == null ? r : d && e.filter === d ? e.filter(t, n) : (x(e, function(e, i, s) {
            t.call(n, e, i, s) && (r[r.length] = e);
        }), r);
    }, S.reject = function(e, t, n) {
        var r = [];
        return e == null ? r : (x(e, function(e, i, s) {
            t.call(n, e, i, s) || (r[r.length] = e);
        }), r);
    }, S.every = S.all = function(e, t, r) {
        var i = !0;
        return e == null ? i : v && e.every === v ? e.every(t, r) : (x(e, function(e, s, o) {
            if (!(i = i && t.call(r, e, s, o))) return n;
        }), !!i);
    };
    var T = S.some = S.any = function(e, t, r) {
        
t || (t = S.identity);
        var i = !1;
        return e == null ? i : m && e.some === m ? e.some(t, r) : (x(e, function(e, s, o) {
            if (i || (i = t.call(r, e, s, o))) return n;
        }), !!i);
    };
    S.include = S.contains = function(e, t) {
        var n = !1;
        return e == null ? n : g && e.indexOf === g ? e.indexOf(t) != -1 : (n = T(e, function(e) {
            return e === t;
        }), n);
    }, S.invoke = function(e, t) {
        var n = o.call(arguments, 2);
        return S.map(e, function(e) {
            return (S.isFunction(t) ? t || e : e[t]).apply(e, n);
        });
    }, S.pluck = function(e, t) {
        return S.map(e, function(e) {
            return e[t];
        });
    }, S.max = function(e, t, n) {
        if (!t && S.isArray(e) && e[0] === +e[0]) return Math.max.apply(Math, e);
        if (!t && S.isEmpty(e)) return -Infinity;
        var r = {
            computed: -Infinity
        };
        return x(e, function(e, i, s) {
            
var o = t ? t.call(n, e, i, s) : e;
            o >= r.computed && (r = {
                value: e,
                computed: o
            });
        }), r.value;
    }, S.min = function(e, t, n) {
        if (!t && S.isArray(e) && e[0] === +e[0]) return Math.min.apply(Math, e);
        if (!t && S.isEmpty(e)) return Infinity;
        var r = {
            computed: Infinity
        };
        return x(e, function(e, i, s) {
            var o = t ? t.call(n, e, i, s) : e;
            o < r.computed && (r = {
                value: e,
                computed: o
            });
        }), r.value;
    }, S.shuffle = function(e) {
        var t = [], n;
        return x(e, function(e, r, i) {
            n = Math.floor(Math.random() * (r + 1)), t[r] = t[n], t[n] = e;
        }), t;
    }, S.sortBy = function(e, t, n) {
        var r = S.isFunction(t) ? t : function(e) {
            return e[t];
        };
        return S.pluck(S.map(e, function(e, t, i) {
            return {
                
value: e,
                criteria: r.call(n, e, t, i)
            };
        }).sort(function(e, t) {
            var n = e.criteria, r = t.criteria;
            return n === void 0 ? 1 : r === void 0 ? -1 : n < r ? -1 : n > r ? 1 : 0;
        }), "value");
    }, S.groupBy = function(e, t) {
        var n = {}, r = S.isFunction(t) ? t : function(e) {
            return e[t];
        };
        return x(e, function(e, t) {
            var i = r(e, t);
            (n[i] || (n[i] = [])).push(e);
        }), n;
    }, S.sortedIndex = function(e, t, n) {
        n || (n = S.identity);
        var r = 0, i = e.length;
        while (r < i) {
            var s = r + i >> 1;
            n(e[s]) < n(t) ? r = s + 1 : i = s;
        }
        return r;
    }, S.toArray = function(e) {
        return e ? S.isArray(e) ? o.call(e) : S.isArguments(e) ? o.call(e) : e.toArray && S.isFunction(e.toArray) ? e.toArray() : S.values(e) : [];
    }, S.size = function(e) {
        return S.isArray(e) ? e.length 
: S.keys(e).length;
    }, S.first = S.head = S.take = function(e, t, n) {
        return t != null && !n ? o.call(e, 0, t) : e[0];
    }, S.initial = function(e, t, n) {
        return o.call(e, 0, e.length - (t == null || n ? 1 : t));
    }, S.last = function(e, t, n) {
        return t != null && !n ? o.call(e, Math.max(e.length - t, 0)) : e[e.length - 1];
    }, S.rest = S.tail = function(e, t, n) {
        return o.call(e, t == null || n ? 1 : t);
    }, S.compact = function(e) {
        return S.filter(e, function(e) {
            return !!e;
        });
    }, S.flatten = function(e, t) {
        return S.reduce(e, function(e, n) {
            return S.isArray(n) ? e.concat(t ? n : S.flatten(n)) : (e[e.length] = n, e);
        }, []);
    }, S.without = function(e) {
        return S.difference(e, o.call(arguments, 1));
    }, S.uniq = S.unique = function(e, t, n) {
        var r = n ? S.map(e, n) : e, i = [];
        return e.length < 3 && (t = !0), S.reduce(r, function(n, r, s) 
{
            if (t ? S.last(n) !== r || !n.length : !S.include(n, r)) n.push(r), i.push(e[s]);
            return n;
        }, []), i;
    }, S.union = function() {
        return S.uniq(S.flatten(arguments, !0));
    }, S.intersection = S.intersect = function(e) {
        var t = o.call(arguments, 1);
        return S.filter(S.uniq(e), function(e) {
            return S.every(t, function(t) {
                return S.indexOf(t, e) >= 0;
            });
        });
    }, S.difference = function(e) {
        var t = S.flatten(o.call(arguments, 1), !0);
        return S.filter(e, function(e) {
            return !S.include(t, e);
        });
    }, S.zip = function() {
        var e = o.call(arguments), t = S.max(S.pluck(e, "length")), n = new Array(t);
        for (var r = 0; r < t; r++) n[r] = S.pluck(e, "" + r);
        return n;
    }, S.indexOf = function(e, t, n) {
        if (e == null) return -1;
        var r, i;
        if (n) return r = S.sortedIndex(e, t), e[r] === t ? r : -1
;
        if (g && e.indexOf === g) return e.indexOf(t);
        for (r = 0, i = e.length; r < i; r++) if (r in e && e[r] === t) return r;
        return -1;
    }, S.lastIndexOf = function(e, t) {
        if (e == null) return -1;
        if (y && e.lastIndexOf === y) return e.lastIndexOf(t);
        var n = e.length;
        while (n--) if (n in e && e[n] === t) return n;
        return -1;
    }, S.range = function(e, t, n) {
        arguments.length <= 1 && (t = e || 0, e = 0), n = arguments[2] || 1;
        var r = Math.max(Math.ceil((t - e) / n), 0), i = 0, s = new Array(r);
        while (i < r) s[i++] = e, e += n;
        return s;
    };
    var N = function() {};
    S.bind = function(t, n) {
        var r, i;
        if (t.bind === E && E) return E.apply(t, o.call(arguments, 1));
        if (!S.isFunction(t)) throw new TypeError;
        return i = o.call(arguments, 2), r = function() {
            if (this instanceof r) {
                N.prototype = t.prototype;
                
var e = new N, s = t.apply(e, i.concat(o.call(arguments)));
                return Object(s) === s ? s : e;
            }
            return t.apply(n, i.concat(o.call(arguments)));
        };
    }, S.bindAll = function(e) {
        var t = o.call(arguments, 1);
        return t.length == 0 && (t = S.functions(e)), x(t, function(t) {
            e[t] = S.bind(e[t], e);
        }), e;
    }, S.memoize = function(e, t) {
        var n = {};
        return t || (t = S.identity), function() {
            var r = t.apply(this, arguments);
            return S.has(n, r) ? n[r] : n[r] = e.apply(this, arguments);
        };
    }, S.delay = function(e, t) {
        var n = o.call(arguments, 2);
        return setTimeout(function() {
            return e.apply(null, n);
        }, t);
    }, S.defer = function(e) {
        return S.delay.apply(S, [ e, 1 ].concat(o.call(arguments, 1)));
    }, S.throttle = function(e, t) {
        var n, r, i, s, o, u, a = S.debounce(function() {
            o = 
s = !1;
        }, t);
        return function() {
            n = this, r = arguments;
            var f = function() {
                i = null, o && e.apply(n, r), a();
            };
            return i || (i = setTimeout(f, t)), s ? o = !0 : u = e.apply(n, r), a(), s = !0, u;
        };
    }, S.debounce = function(e, t, n) {
        var r;
        return function() {
            var i = this, s = arguments, o = function() {
                r = null, n || e.apply(i, s);
            };
            n && !r && e.apply(i, s), clearTimeout(r), r = setTimeout(o, t);
        };
    }, S.once = function(e) {
        var t = !1, n;
        return function() {
            return t ? n : (t = !0, n = e.apply(this, arguments));
        };
    }, S.wrap = function(e, t) {
        return function() {
            var n = [ e ].concat(o.call(arguments, 0));
            return t.apply(this, n);
        };
    }, S.compose = function() {
        var e = arguments;
        return function() {
            
var t = arguments;
            for (var n = e.length - 1; n >= 0; n--) t = [ e[n].apply(this, t) ];
            return t[0];
        };
    }, S.after = function(e, t) {
        return e <= 0 ? t() : function() {
            if (--e < 1) return t.apply(this, arguments);
        };
    }, S.keys = w || function(e) {
        if (e !== Object(e)) throw new TypeError("Invalid object");
        var t = [];
        for (var n in e) S.has(e, n) && (t[t.length] = n);
        return t;
    }, S.values = function(e) {
        return S.map(e, S.identity);
    }, S.functions = S.methods = function(e) {
        var t = [];
        for (var n in e) S.isFunction(e[n]) && t.push(n);
        return t.sort();
    }, S.extend = function(e) {
        return x(o.call(arguments, 1), function(t) {
            for (var n in t) e[n] = t[n];
        }), e;
    }, S.pick = function(e) {
        var t = {};
        return x(S.flatten(o.call(arguments, 1)), function(n) {
            n in e && (t[n] = e[n]);
        
}), t;
    }, S.defaults = function(e) {
        return x(o.call(arguments, 1), function(t) {
            for (var n in t) e[n] == null && (e[n] = t[n]);
        }), e;
    }, S.clone = function(e) {
        return S.isObject(e) ? S.isArray(e) ? e.slice() : S.extend({}, e) : e;
    }, S.tap = function(e, t) {
        return t(e), e;
    }, S.isEqual = function(e, t) {
        return C(e, t, []);
    }, S.isEmpty = function(e) {
        if (e == null) return !0;
        if (S.isArray(e) || S.isString(e)) return e.length === 0;
        for (var t in e) if (S.has(e, t)) return !1;
        return !0;
    }, S.isElement = function(e) {
        return !!e && e.nodeType == 1;
    }, S.isArray = b || function(e) {
        return a.call(e) == "[object Array]";
    }, S.isObject = function(e) {
        return e === Object(e);
    }, S.isArguments = function(e) {
        return a.call(e) == "[object Arguments]";
    }, S.isArguments(arguments) || (S.isArguments = function(e) {
        return !!e && !!
S.has(e, "callee");
    }), S.isFunction = function(e) {
        return a.call(e) == "[object Function]";
    }, S.isString = function(e) {
        return a.call(e) == "[object String]";
    }, S.isNumber = function(e) {
        return a.call(e) == "[object Number]";
    }, S.isFinite = function(e) {
        return S.isNumber(e) && isFinite(e);
    }, S.isNaN = function(e) {
        return e !== e;
    }, S.isBoolean = function(e) {
        return e === !0 || e === !1 || a.call(e) == "[object Boolean]";
    }, S.isDate = function(e) {
        return a.call(e) == "[object Date]";
    }, S.isRegExp = function(e) {
        return a.call(e) == "[object RegExp]";
    }, S.isNull = function(e) {
        return e === null;
    }, S.isUndefined = function(e) {
        return e === void 0;
    }, S.has = function(e, t) {
        return f.call(e, t);
    }, S.noConflict = function() {
        return e._ = t, this;
    }, S.identity = function(e) {
        return e;
    }, S.times = function(e, t, 
n) {
        for (var r = 0; r < e; r++) t.call(n, r);
    }, S.escape = function(e) {
        return ("" + e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;");
    }, S.result = function(e, t) {
        if (e == null) return null;
        var n = e[t];
        return S.isFunction(n) ? n.call(e) : n;
    }, S.mixin = function(e) {
        x(S.functions(e), function(t) {
            B(t, S[t] = e[t]);
        });
    };
    var k = 0;
    S.uniqueId = function(e) {
        var t = k++;
        return e ? e + t : t;
    }, S.templateSettings = {
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: /<%=([\s\S]+?)%>/g,
        escape: /<%-([\s\S]+?)%>/g
    };
    var L = /.^/, A = {
        "\\": "\\",
        "'": "'",
        r: "\r",
        n: "\n",
        t: "	",
        u2028: "\u2028",
        u2029: "\u2029"
    };
    for (var O in A) A[A[O]] = O;
    var M = /\\|'|\r|\n|\t|\u2028|\u2029/g
, _ = /\\(\\|'|r|n|t|u2028|u2029)/g, D = function(e) {
        return e.replace(_, function(e, t) {
            return A[t];
        });
    };
    S.template = function(e, t, n) {
        n = S.defaults(n || {}, S.templateSettings);
        var r = "__p+='" + e.replace(M, function(e) {
            return "\\" + A[e];
        }).replace(n.escape || L, function(e, t) {
            return "'+\n_.escape(" + D(t) + ")+\n'";
        }).replace(n.interpolate || L, function(e, t) {
            return "'+\n(" + D(t) + ")+\n'";
        }).replace(n.evaluate || L, function(e, t) {
            return "';\n" + D(t) + "\n;__p+='";
        }) + "';\n";
        n.variable || (r = "with(obj||{}){\n" + r + "}\n"), r = "var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n" + r + "return __p;\n";
        var i = new Function(n.variable || "obj", "_", r);
        if (t) return i(t, S);
        var s = function(e) {
            return i.call(this, e, S);
        };
        return s
.source = "function(" + (n.variable || "obj") + "){\n" + r + "}", s;
    }, S.chain = function(e) {
        return S(e).chain();
    };
    var P = function(e) {
        this._wrapped = e;
    };
    S.prototype = P.prototype;
    var H = function(e, t) {
        return t ? S(e).chain() : e;
    }, B = function(e, t) {
        P.prototype[e] = function() {
            var e = o.call(arguments);
            return u.call(e, this._wrapped), H(t.apply(S, e), this._chain);
        };
    };
    S.mixin(S), x([ "pop", "push", "reverse", "shift", "sort", "splice", "unshift" ], function(e) {
        var t = r[e];
        P.prototype[e] = function() {
            var n = this._wrapped;
            t.apply(n, arguments);
            var r = n.length;
            return (e == "shift" || e == "splice") && r === 0 && delete n[0], H(n, this._chain);
        };
    }), x([ "concat", "join", "slice" ], function(e) {
        var t = r[e];
        P.prototype[e] = function() {
            return H(t.apply
(this._wrapped, arguments), this._chain);
        };
    }), P.prototype.chain = function() {
        return this._chain = !0, this;
    }, P.prototype.value = function() {
        return this._wrapped;
    };
}).call(this), fielddb.define("underscore", function(e) {
    return function() {
        var t, n;
        return t || e._;
    };
}(this)), function(e, t) {
    function u(e) {
        var t = o[e] = {}, n, r;
        e = e.split(/\s+/);
        for (n = 0, r = e.length; n < r; n++) t[e[n]] = !0;
        return t;
    }
    function c(e, n, r) {
        if (r === t && e.nodeType === 1) {
            var i = "data-" + n.replace(l, "-$1").toLowerCase();
            r = e.getAttribute(i);
            if (typeof r == "string") {
                try {
                    r = r === "true" ? !0 : r === "false" ? !1 : r === "null" ? null : s.isNumeric(r) ? +r : f.test(r) ? s.parseJSON(r) : r;
                } catch (o) {}
                s.data(e, n, r);
            } else r = t;
        
}
        return r;
    }
    function h(e) {
        for (var t in e) {
            if (t === "data" && s.isEmptyObject(e[t])) continue;
            if (t !== "toJSON") return !1;
        }
        return !0;
    }
    function p(e, t, n) {
        var r = t + "defer", i = t + "queue", o = t + "mark", u = s._data(e, r);
        u && (n === "queue" || !s._data(e, i)) && (n === "mark" || !s._data(e, o)) && setTimeout(function() {
            !s._data(e, i) && !s._data(e, o) && (s.removeData(e, r, !0), u.fire());
        }, 0);
    }
    function H() {
        return !1;
    }
    function B() {
        return !0;
    }
    function W(e) {
        return !e || !e.parentNode || e.parentNode.nodeType === 11;
    }
    function X(e, t, n) {
        t = t || 0;
        if (s.isFunction(t)) return s.grep(e, function(e, r) {
            var i = !!t.call(e, r, e);
            return i === n;
        });
        if (t.nodeType) return s.grep(e, function(e, r) {
            return e === t === n;
        
});
        if (typeof t == "string") {
            var r = s.grep(e, function(e) {
                return e.nodeType === 1;
            });
            if (q.test(t)) return s.filter(t, r, !n);
            t = s.filter(t, r);
        }
        return s.grep(e, function(e, r) {
            return s.inArray(e, t) >= 0 === n;
        });
    }
    function V(e) {
        var t = $.split("|"), n = e.createDocumentFragment();
        if (n.createElement) while (t.length) n.createElement(t.pop());
        return n;
    }
    function at(e, t) {
        return s.nodeName(e, "table") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e;
    }
    function ft(e, t) {
        if (t.nodeType !== 1 || !s.hasData(e)) return;
        var n, r, i, o = s._data(e), u = s._data(t, o), a = o.events;
        if (a) {
            delete u.handle, u.events = {};
            for (n in a) for (r = 0, i = a[n].length; r < i; r++) s.event.add(t, n, a[n][r]);
        
}
        u.data && (u.data = s.extend({}, u.data));
    }
    function lt(e, t) {
        var n;
        if (t.nodeType !== 1) return;
        t.clearAttributes && t.clearAttributes(), t.mergeAttributes && t.mergeAttributes(e), n = t.nodeName.toLowerCase(), n === "object" ? t.outerHTML = e.outerHTML : n !== "input" || e.type !== "checkbox" && e.type !== "radio" ? n === "option" ? t.selected = e.defaultSelected : n === "input" || n === "textarea" ? t.defaultValue = e.defaultValue : n === "script" && t.text !== e.text && (t.text = e.text) : (e.checked && (t.defaultChecked = t.checked = e.checked), t.value !== e.value && (t.value = e.value)), t.removeAttribute(s.expando), t.removeAttribute("_submit_attached"), t.removeAttribute("_change_attached");
    }
    function ct(e) {
        return typeof e.getElementsByTagName != "undefined" ? e.getElementsByTagName("*") : typeof e.querySelectorAll != "undefined" ? e.querySelectorAll("*") : [];
    }
    function ht(e) {
        if (e.type === "checkbox" || 
e.type === "radio") e.defaultChecked = e.checked;
    }
    function pt(e) {
        var t = (e.nodeName || "").toLowerCase();
        t === "input" ? ht(e) : t !== "script" && typeof e.getElementsByTagName != "undefined" && s.grep(e.getElementsByTagName("input"), ht);
    }
    function dt(e) {
        var t = n.createElement("div");
        return ut.appendChild(t), t.innerHTML = e.outerHTML, t.firstChild;
    }
    function kt(e, t, n) {
        var r = t === "width" ? e.offsetWidth : e.offsetHeight, i = t === "width" ? 1 : 0, o = 4;
        if (r > 0) {
            if (n !== "border") for (; i < o; i += 2) n || (r -= parseFloat(s.css(e, "padding" + xt[i])) || 0), n === "margin" ? r += parseFloat(s.css(e, n + xt[i])) || 0 : r -= parseFloat(s.css(e, "border" + xt[i] + "Width")) || 0;
            return r + "px";
        }
        r = Tt(e, t);
        if (r < 0 || r == null) r = e.style[t];
        if (bt.test(r)) return r;
        r = parseFloat(r) || 0;
        if (n) for (; i < o; 
i += 2) r += parseFloat(s.css(e, "padding" + xt[i])) || 0, n !== "padding" && (r += parseFloat(s.css(e, "border" + xt[i] + "Width")) || 0), n === "margin" && (r += parseFloat(s.css(e, n + xt[i])) || 0);
        return r + "px";
    }
    function Qt(e) {
        return function(t, n) {
            typeof t != "string" && (n = t, t = "*");
            if (s.isFunction(n)) {
                var r = t.toLowerCase().split(qt), i = 0, o = r.length, u, a, f;
                for (; i < o; i++) u = r[i], f = /^\+/.test(u), f && (u = u.substr(1) || "*"), a = e[u] = e[u] || [], a[f ? "unshift" : "push"](n);
            }
        };
    }
    function Gt(e, n, r, i, s, o) {
        s = s || n.dataTypes[0], o = o || {}, o[s] = !0;
        var u = e[s], a = 0, f = u ? u.length : 0, l = e === Wt, c;
        for (; a < f && (l || !c); a++) c = u[a](n, r, i), typeof c == "string" && (!l || o[c] ? c = t : (n.dataTypes.unshift(c), c = Gt(e, n, r, i, c, o)));
        return (l || !c) && !o["*"] && (c = Gt
(e, n, r, i, "*", o)), c;
    }
    function Yt(e, n) {
        var r, i, o = s.ajaxSettings.flatOptions || {};
        for (r in n) n[r] !== t && ((o[r] ? e : i || (i = {}))[r] = n[r]);
        i && s.extend(!0, e, i);
    }
    function Zt(e, t, n, r) {
        if (s.isArray(t)) s.each(t, function(t, i) {
            n || At.test(e) ? r(e, i) : Zt(e + "[" + (typeof i == "object" ? t : "") + "]", i, n, r);
        }); else if (!n && s.type(t) === "object") for (var i in t) Zt(e + "[" + i + "]", t[i], n, r); else r(e, t);
    }
    function en(e, n, r) {
        var i = e.contents, s = e.dataTypes, o = e.responseFields, u, a, f, l;
        for (a in o) a in r && (n[o[a]] = r[a]);
        while (s[0] === "*") s.shift(), u === t && (u = e.mimeType || n.getResponseHeader("content-type"));
        if (u) for (a in i) if (i[a] && i[a].test(u)) {
            s.unshift(a);
            break;
        }
        if (s[0] in r) f = s[0]; else {
            for (a in r) {
                if (!s[0] || 
e.converters[a + " " + s[0]]) {
                    f = a;
                    break;
                }
                l || (l = a);
            }
            f = f || l;
        }
        if (f) return f !== s[0] && s.unshift(f), r[f];
    }
    function tn(e, n) {
        e.dataFilter && (n = e.dataFilter(n, e.dataType));
        var r = e.dataTypes, i = {}, o, u, a = r.length, f, l = r[0], c, h, p, d, v;
        for (o = 1; o < a; o++) {
            if (o === 1) for (u in e.converters) typeof u == "string" && (i[u.toLowerCase()] = e.converters[u]);
            c = l, l = r[o];
            if (l === "*") l = c; else if (c !== "*" && c !== l) {
                h = c + " " + l, p = i[h] || i["* " + l];
                if (!p) {
                    v = t;
                    for (d in i) {
                        f = d.split(" ");
                        if (f[0] === c || f[0] === "*") {
                            v = i[f[1] + " " + l];
                            if (v) {
                                
d = i[d], d === !0 ? p = v : v === !0 && (p = d);
                                break;
                            }
                        }
                    }
                }
                !p && !v && s.error("No conversion from " + h.replace(" ", " to ")), p !== !0 && (n = p ? p(n) : v(d(n)));
            }
        }
        return n;
    }
    function an() {
        try {
            return new e.XMLHttpRequest;
        } catch (t) {}
    }
    function fn() {
        try {
            return new e.ActiveXObject("Microsoft.XMLHTTP");
        } catch (t) {}
    }
    function yn() {
        return setTimeout(bn, 0), gn = s.now();
    }
    function bn() {
        gn = t;
    }
    function wn(e, t) {
        var n = {};
        return s.each(mn.concat.apply([], mn.slice(0, t)), function() {
            n[this] = e;
        }), n;
    }
    function En(e) {
        if (!ln[e]) {
            var t = n.body, r = s("<" + e + ">").appendTo(t), i = r.css("display");
            
r.remove();
            if (i === "none" || i === "") {
                cn || (cn = n.createElement("iframe"), cn.frameBorder = cn.width = cn.height = 0), t.appendChild(cn);
                if (!hn || !cn.createElement) hn = (cn.contentWindow || cn.contentDocument).document, hn.write((s.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), hn.close();
                r = hn.createElement(e), hn.body.appendChild(r), i = s.css(r, "display"), t.removeChild(cn);
            }
            ln[e] = i;
        }
        return ln[e];
    }
    function Nn(e) {
        return s.isWindow(e) ? e : e.nodeType === 9 ? e.defaultView || e.parentWindow : !1;
    }
    var n = e.document, r = e.navigator, i = e.location, s = function() {
        function H() {
            if (i.isReady) return;
            try {
                n.documentElement.doScroll("left");
            } catch (e) {
                setTimeout(H, 1);
                return;
            }
            i.ready();
        }
        
var i = function(e, t) {
            return new i.fn.init(e, t, u);
        }, s = e.jQuery, o = e.$, u, a = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, f = /\S/, l = /^\s+/, c = /\s+$/, h = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, p = /^[\],:{}\s]*$/, d = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, v = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, m = /(?:^|:|,)(?:\s*\[)+/g, g = /(webkit)[ \/]([\w.]+)/, y = /(opera)(?:.*version)?[ \/]([\w.]+)/, b = /(msie) ([\w.]+)/, w = /(mozilla)(?:.*? rv:([\w.]+))?/, E = /-([a-z]|[0-9])/ig, S = /^-ms-/, x = function(e, t) {
            return (t + "").toUpperCase();
        }, T = r.userAgent, N, C, k, L = Object.prototype.toString, A = Object.prototype.hasOwnProperty, O = Array.prototype.push, M = Array.prototype.slice, _ = String.prototype.trim, D = Array.prototype.indexOf, P = {};
        return i.fn = i.prototype = {
            constructor: i,
            init: function(e, r, s) {
                var o, u, f, l;
                if (!e) return this
;
                if (e.nodeType) return this.context = this[0] = e, this.length = 1, this;
                if (e === "body" && !r && n.body) return this.context = n, this[0] = n.body, this.selector = e, this.length = 1, this;
                if (typeof e == "string") {
                    e.charAt(0) === "<" && e.charAt(e.length - 1) === ">" && e.length >= 3 ? o = [ null, e, null ] : o = a.exec(e);
                    if (o && (o[1] || !r)) {
                        if (o[1]) return r = r instanceof i ? r[0] : r, l = r ? r.ownerDocument || r : n, f = h.exec(e), f ? i.isPlainObject(r) ? (e = [ n.createElement(f[1]) ], i.fn.attr.call(e, r, !0)) : e = [ l.createElement(f[1]) ] : (f = i.buildFragment([ o[1] ], [ l ]), e = (f.cacheable ? i.clone(f.fragment) : f.fragment).childNodes), i.merge(this, e);
                        u = n.getElementById(o[2]);
                        if (u && u.parentNode) {
                            if (u.id !== o[2]) return s.find(e);
                            
this.length = 1, this[0] = u;
                        }
                        return this.context = n, this.selector = e, this;
                    }
                    return !r || r.jquery ? (r || s).find(e) : this.constructor(r).find(e);
                }
                return i.isFunction(e) ? s.ready(e) : (e.selector !== t && (this.selector = e.selector, this.context = e.context), i.makeArray(e, this));
            },
            selector: "",
            jquery: "1.7.2",
            length: 0,
            size: function() {
                return this.length;
            },
            toArray: function() {
                return M.call(this, 0);
            },
            get: function(e) {
                return e == null ? this.toArray() : e < 0 ? this[this.length + e] : this[e];
            },
            pushStack: function(e, t, n) {
                var r = this.constructor();
                return i.isArray(e) ? O.apply(r, e) : i.merge(r, e), r.prevObject = this, r.context = 
this.context, t === "find" ? r.selector = this.selector + (this.selector ? " " : "") + n : t && (r.selector = this.selector + "." + t + "(" + n + ")"), r;
            },
            each: function(e, t) {
                return i.each(this, e, t);
            },
            ready: function(e) {
                return i.bindReady(), C.add(e), this;
            },
            eq: function(e) {
                return e = +e, e === -1 ? this.slice(e) : this.slice(e, e + 1);
            },
            first: function() {
                return this.eq(0);
            },
            last: function() {
                return this.eq(-1);
            },
            slice: function() {
                return this.pushStack(M.apply(this, arguments), "slice", M.call(arguments).join(","));
            },
            map: function(e) {
                return this.pushStack(i.map(this, function(t, n) {
                    return e.call(t, n, t);
                }));
            },
            end: function(
) {
                return this.prevObject || this.constructor(null);
            },
            push: O,
            sort: [].sort,
            splice: [].splice
        }, i.fn.init.prototype = i.fn, i.extend = i.fn.extend = function() {
            var e, n, r, s, o, u, a = arguments[0] || {}, f = 1, l = arguments.length, c = !1;
            typeof a == "boolean" && (c = a, a = arguments[1] || {}, f = 2), typeof a != "object" && !i.isFunction(a) && (a = {}), l === f && (a = this, --f);
            for (; f < l; f++) if ((e = arguments[f]) != null) for (n in e) {
                r = a[n], s = e[n];
                if (a === s) continue;
                c && s && (i.isPlainObject(s) || (o = i.isArray(s))) ? (o ? (o = !1, u = r && i.isArray(r) ? r : []) : u = r && i.isPlainObject(r) ? r : {}, a[n] = i.extend(c, u, s)) : s !== t && (a[n] = s);
            }
            return a;
        }, i.extend({
            noConflict: function(t) {
                return e.$ === i && (e.$ = o), t && 
e.jQuery === i && (e.jQuery = s), i;
            },
            isReady: !1,
            readyWait: 1,
            holdReady: function(e) {
                e ? i.readyWait++ : i.ready(!0);
            },
            ready: function(e) {
                if (e === !0 && !--i.readyWait || e !== !0 && !i.isReady) {
                    if (!n.body) return setTimeout(i.ready, 1);
                    i.isReady = !0;
                    if (e !== !0 && --i.readyWait > 0) return;
                    C.fireWith(n, [ i ]), i.fn.trigger && i(n).trigger("ready").off("ready");
                }
            },
            bindReady: function() {
                if (C) return;
                C = i.Callbacks("once memory");
                if (n.readyState === "complete") return setTimeout(i.ready, 1);
                if (n.addEventListener) n.addEventListener("DOMContentLoaded", k, !1), e.addEventListener("load", i.ready, !1); else if (n.attachEvent) {
                    n.attachEvent("onreadystatechange"
, k), e.attachEvent("onload", i.ready);
                    var t = !1;
                    try {
                        t = e.frameElement == null;
                    } catch (r) {}
                    n.documentElement.doScroll && t && H();
                }
            },
            isFunction: function(e) {
                return i.type(e) === "function";
            },
            isArray: Array.isArray || function(e) {
                return i.type(e) === "array";
            },
            isWindow: function(e) {
                return e != null && e == e.window;
            },
            isNumeric: function(e) {
                return !isNaN(parseFloat(e)) && isFinite(e);
            },
            type: function(e) {
                return e == null ? String(e) : P[L.call(e)] || "object";
            },
            isPlainObject: function(e) {
                if (!e || i.type(e) !== "object" || e.nodeType || i.isWindow(e)) return !1;
                try {
                    
if (e.constructor && !A.call(e, "constructor") && !A.call(e.constructor.prototype, "isPrototypeOf")) return !1;
                } catch (n) {
                    return !1;
                }
                var r;
                for (r in e) ;
                return r === t || A.call(e, r);
            },
            isEmptyObject: function(e) {
                for (var t in e) return !1;
                return !0;
            },
            error: function(e) {
                throw new Error(e);
            },
            parseJSON: function(t) {
                if (typeof t != "string" || !t) return null;
                t = i.trim(t);
                if (e.JSON && e.JSON.parse) return e.JSON.parse(t);
                if (p.test(t.replace(d, "@").replace(v, "]").replace(m, ""))) return (new Function("return " + t))();
                i.error("Invalid JSON: " + t);
            },
            parseXML: function(n) {
                if (typeof n != "string" || !n) return null;
                
var r, s;
                try {
                    e.DOMParser ? (s = new DOMParser, r = s.parseFromString(n, "text/xml")) : (r = new ActiveXObject("Microsoft.XMLDOM"), r.async = "false", r.loadXML(n));
                } catch (o) {
                    r = t;
                }
                return (!r || !r.documentElement || r.getElementsByTagName("parsererror").length) && i.error("Invalid XML: " + n), r;
            },
            noop: function() {},
            globalEval: function(t) {
                t && f.test(t) && (e.execScript || function(t) {
                    e.eval.call(e, t);
                })(t);
            },
            camelCase: function(e) {
                return e.replace(S, "ms-").replace(E, x);
            },
            nodeName: function(e, t) {
                return e.nodeName && e.nodeName.toUpperCase() === t.toUpperCase();
            },
            each: function(e, n, r) {
                var s, o = 0, u = e.length, a = u === t || i.isFunction(e);
                
if (r) {
                    if (a) {
                        for (s in e) if (n.apply(e[s], r) === !1) break;
                    } else for (; o < u; ) if (n.apply(e[o++], r) === !1) break;
                } else if (a) {
                    for (s in e) if (n.call(e[s], s, e[s]) === !1) break;
                } else for (; o < u; ) if (n.call(e[o], o, e[o++]) === !1) break;
                return e;
            },
            trim: _ ? function(e) {
                return e == null ? "" : _.call(e);
            } : function(e) {
                return e == null ? "" : e.toString().replace(l, "").replace(c, "");
            },
            makeArray: function(e, t) {
                var n = t || [];
                if (e != null) {
                    var r = i.type(e);
                    e.length == null || r === "string" || r === "function" || r === "regexp" || i.isWindow(e) ? O.call(n, e) : i.merge(n, e);
                }
                return n;
            },
            inArray
: function(e, t, n) {
                var r;
                if (t) {
                    if (D) return D.call(t, e, n);
                    r = t.length, n = n ? n < 0 ? Math.max(0, r + n) : n : 0;
                    for (; n < r; n++) if (n in t && t[n] === e) return n;
                }
                return -1;
            },
            merge: function(e, n) {
                var r = e.length, i = 0;
                if (typeof n.length == "number") for (var s = n.length; i < s; i++) e[r++] = n[i]; else while (n[i] !== t) e[r++] = n[i++];
                return e.length = r, e;
            },
            grep: function(e, t, n) {
                var r = [], i;
                n = !!n;
                for (var s = 0, o = e.length; s < o; s++) i = !!t(e[s], s), n !== i && r.push(e[s]);
                return r;
            },
            map: function(e, n, r) {
                var s, o, u = [], a = 0, f = e.length, l = e instanceof i || f !== t && typeof f == "number" && (f > 0 && 
e[0] && e[f - 1] || f === 0 || i.isArray(e));
                if (l) for (; a < f; a++) s = n(e[a], a, r), s != null && (u[u.length] = s); else for (o in e) s = n(e[o], o, r), s != null && (u[u.length] = s);
                return u.concat.apply([], u);
            },
            guid: 1,
            proxy: function(e, n) {
                if (typeof n == "string") {
                    var r = e[n];
                    n = e, e = r;
                }
                if (!i.isFunction(e)) return t;
                var s = M.call(arguments, 2), o = function() {
                    return e.apply(n, s.concat(M.call(arguments)));
                };
                return o.guid = e.guid = e.guid || o.guid || i.guid++, o;
            },
            access: function(e, n, r, s, o, u, a) {
                var f, l = r == null, c = 0, h = e.length;
                if (r && typeof r == "object") {
                    for (c in r) i.access(e, n, c, r[c], 1, u, s);
                    o = 1;
                
} else if (s !== t) {
                    f = a === t && i.isFunction(s), l && (f ? (f = n, n = function(e, t, n) {
                        return f.call(i(e), n);
                    }) : (n.call(e, s), n = null));
                    if (n) for (; c < h; c++) n(e[c], r, f ? s.call(e[c], c, n(e[c], r)) : s, a);
                    o = 1;
                }
                return o ? e : l ? n.call(e) : h ? n(e[0], r) : u;
            },
            now: function() {
                return (new Date).getTime();
            },
            uaMatch: function(e) {
                e = e.toLowerCase();
                var t = g.exec(e) || y.exec(e) || b.exec(e) || e.indexOf("compatible") < 0 && w.exec(e) || [];
                return {
                    browser: t[1] || "",
                    version: t[2] || "0"
                };
            },
            sub: function() {
                function e(t, n) {
                    return new e.fn.init(t, n);
                }
                
i.extend(!0, e, this), e.superclass = this, e.fn = e.prototype = this(), e.fn.constructor = e, e.sub = this.sub, e.fn.init = function(r, s) {
                    return s && s instanceof i && !(s instanceof e) && (s = e(s)), i.fn.init.call(this, r, s, t);
                }, e.fn.init.prototype = e.fn;
                var t = e(n);
                return e;
            },
            browser: {}
        }), i.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(e, t) {
            P["[object " + t + "]"] = t.toLowerCase();
        }), N = i.uaMatch(T), N.browser && (i.browser[N.browser] = !0, i.browser.version = N.version), i.browser.webkit && (i.browser.safari = !0), f.test("\u00a0") && (l = /^[\s\xA0]+/, c = /[\s\xA0]+$/), u = i(n), n.addEventListener ? k = function() {
            n.removeEventListener("DOMContentLoaded", k, !1), i.ready();
        } : n.attachEvent && (k = function() {
            n.readyState === "complete" && (n.detachEvent("onreadystatechange"
, k), i.ready());
        }), i;
    }(), o = {};
    s.Callbacks = function(e) {
        e = e ? o[e] || u(e) : {};
        var n = [], r = [], i, a, f, l, c, h, p = function(t) {
            var r, i, o, u, a;
            for (r = 0, i = t.length; r < i; r++) o = t[r], u = s.type(o), u === "array" ? p(o) : u === "function" && (!e.unique || !v.has(o)) && n.push(o);
        }, d = function(t, s) {
            s = s || [], i = !e.memory || [ t, s ], a = !0, f = !0, h = l || 0, l = 0, c = n.length;
            for (; n && h < c; h++) if (n[h].apply(t, s) === !1 && e.stopOnFalse) {
                i = !0;
                break;
            }
            f = !1, n && (e.once ? i === !0 ? v.disable() : n = [] : r && r.length && (i = r.shift(), v.fireWith(i[0], i[1])));
        }, v = {
            add: function() {
                if (n) {
                    var e = n.length;
                    p(arguments), f ? c = n.length : i && i !== !0 && (l = e, d(i[0], i[1]));
                }
                
return this;
            },
            remove: function() {
                if (n) {
                    var t = arguments, r = 0, i = t.length;
                    for (; r < i; r++) for (var s = 0; s < n.length; s++) if (t[r] === n[s]) {
                        f && s <= c && (c--, s <= h && h--), n.splice(s--, 1);
                        if (e.unique) break;
                    }
                }
                return this;
            },
            has: function(e) {
                if (n) {
                    var t = 0, r = n.length;
                    for (; t < r; t++) if (e === n[t]) return !0;
                }
                return !1;
            },
            empty: function() {
                return n = [], this;
            },
            disable: function() {
                return n = r = i = t, this;
            },
            disabled: function() {
                return !n;
            },
            lock: function() {
                return r = t, (!i || i === !0
) && v.disable(), this;
            },
            locked: function() {
                return !r;
            },
            fireWith: function(t, n) {
                return r && (f ? e.once || r.push([ t, n ]) : (!e.once || !i) && d(t, n)), this;
            },
            fire: function() {
                return v.fireWith(this, arguments), this;
            },
            fired: function() {
                return !!a;
            }
        };
        return v;
    };
    var a = [].slice;
    s.extend({
        Deferred: function(e) {
            var t = s.Callbacks("once memory"), n = s.Callbacks("once memory"), r = s.Callbacks("memory"), i = "pending", o = {
                resolve: t,
                reject: n,
                notify: r
            }, u = {
                done: t.add,
                fail: n.add,
                progress: r.add,
                state: function() {
                    return i;
                },
                isResolved: t.fired,
                
isRejected: n.fired,
                then: function(e, t, n) {
                    return a.done(e).fail(t).progress(n), this;
                },
                always: function() {
                    return a.done.apply(a, arguments).fail.apply(a, arguments), this;
                },
                pipe: function(e, t, n) {
                    return s.Deferred(function(r) {
                        s.each({
                            done: [ e, "resolve" ],
                            fail: [ t, "reject" ],
                            progress: [ n, "notify" ]
                        }, function(e, t) {
                            var n = t[0], i = t[1], o;
                            s.isFunction(n) ? a[e](function() {
                                o = n.apply(this, arguments), o && s.isFunction(o.promise) ? o.promise().then(r.resolve, r.reject, r.notify) : r[i + "With"](this === a ? r : this, [ o ]);
                            }) : a[e](r[i]);
                        });
                    
}).promise();
                },
                promise: function(e) {
                    if (e == null) e = u; else for (var t in u) e[t] = u[t];
                    return e;
                }
            }, a = u.promise({}), f;
            for (f in o) a[f] = o[f].fire, a[f + "With"] = o[f].fireWith;
            return a.done(function() {
                i = "resolved";
            }, n.disable, r.lock).fail(function() {
                i = "rejected";
            }, t.disable, r.lock), e && e.call(a, a), a;
        },
        when: function(e) {
            function c(e) {
                return function(n) {
                    t[e] = arguments.length > 1 ? a.call(arguments, 0) : n, --o || f.resolveWith(f, t);
                };
            }
            function h(e) {
                return function(t) {
                    i[e] = arguments.length > 1 ? a.call(arguments, 0) : t, f.notifyWith(l, i);
                };
            }
            var t = a.call(arguments, 0), n = 0
, r = t.length, i = new Array(r), o = r, u = r, f = r <= 1 && e && s.isFunction(e.promise) ? e : s.Deferred(), l = f.promise();
            if (r > 1) {
                for (; n < r; n++) t[n] && t[n].promise && s.isFunction(t[n].promise) ? t[n].promise().then(c(n), f.reject, h(n)) : --o;
                o || f.resolveWith(f, t);
            } else f !== e && f.resolveWith(f, r ? [ e ] : []);
            return l;
        }
    }), s.support = function() {
        var t, r, i, o, u, a, f, l, c, h, p, d, v = n.createElement("div"), m = n.documentElement;
        v.setAttribute("className", "t"), v.innerHTML = "   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>", r = v.getElementsByTagName("*"), i = v.getElementsByTagName("a")[0];
        if (!r || !r.length || !i) return {};
        o = n.createElement("select"), u = o.appendChild(n.createElement("option")), a = v.getElementsByTagName("input")[0], t = {
            leadingWhitespace
: v.firstChild.nodeType === 3,
            tbody: !v.getElementsByTagName("tbody").length,
            htmlSerialize: !!v.getElementsByTagName("link").length,
            style: /top/.test(i.getAttribute("style")),
            hrefNormalized: i.getAttribute("href") === "/a",
            opacity: /^0.55/.test(i.style.opacity),
            cssFloat: !!i.style.cssFloat,
            checkOn: a.value === "on",
            optSelected: u.selected,
            getSetAttribute: v.className !== "t",
            enctype: !!n.createElement("form").enctype,
            html5Clone: n.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>",
            submitBubbles: !0,
            changeBubbles: !0,
            focusinBubbles: !1,
            deleteExpando: !0,
            noCloneEvent: !0,
            inlineBlockNeedsLayout: !1,
            shrinkWrapBlocks: !1,
            reliableMarginRight: !0,
            pixelMargin: !0
        }, s.boxModel = t.boxModel = n.compatMode === "CSS1Compat"
, a.checked = !0, t.noCloneChecked = a.cloneNode(!0).checked, o.disabled = !0, t.optDisabled = !u.disabled;
        try {
            delete v.test;
        } catch (g) {
            t.deleteExpando = !1;
        }
        !v.addEventListener && v.attachEvent && v.fireEvent && (v.attachEvent("onclick", function() {
            t.noCloneEvent = !1;
        }), v.cloneNode(!0).fireEvent("onclick")), a = n.createElement("input"), a.value = "t", a.setAttribute("type", "radio"), t.radioValue = a.value === "t", a.setAttribute("checked", "checked"), a.setAttribute("name", "t"), v.appendChild(a), f = n.createDocumentFragment(), f.appendChild(v.lastChild), t.checkClone = f.cloneNode(!0).cloneNode(!0).lastChild.checked, t.appendChecked = a.checked, f.removeChild(a), f.appendChild(v);
        if (v.attachEvent) for (p in {
            submit: 1,
            change: 1,
            focusin: 1
        }) h = "on" + p, d = h in v, d || (v.setAttribute(h, "return;"), d = typeof v[h] == "function"), t[p + "Bubbles"
] = d;
        return f.removeChild(v), f = o = u = v = a = null, s(function() {
            var r, i, o, u, a, f, c, h, p, m, g, y, b, w = n.getElementsByTagName("body")[0];
            if (!w) return;
            h = 1, b = "padding:0;margin:0;border:", g = "position:absolute;top:0;left:0;width:1px;height:1px;", y = b + "0;visibility:hidden;", p = "style='" + g + b + "5px solid #000;", m = "<div " + p + "display:block;'><div style='" + b + "0;display:block;overflow:hidden;'></div></div>" + "<table " + p + "' cellpadding='0' cellspacing='0'>" + "<tr><td></td></tr></table>", r = n.createElement("div"), r.style.cssText = y + "width:0;height:0;position:static;top:0;margin-top:" + h + "px", w.insertBefore(r, w.firstChild), v = n.createElement("div"), r.appendChild(v), v.innerHTML = "<table><tr><td style='" + b + "0;display:none'></td><td>t</td></tr></table>", l = v.getElementsByTagName("td"), d = l[0].offsetHeight === 0, l[0].style.display = "", l[1].style.display = "none", t.reliableHiddenOffsets = 
d && l[0].offsetHeight === 0, e.getComputedStyle && (v.innerHTML = "", c = n.createElement("div"), c.style.width = "0", c.style.marginRight = "0", v.style.width = "2px", v.appendChild(c), t.reliableMarginRight = (parseInt((e.getComputedStyle(c, null) || {
                marginRight: 0
            }).marginRight, 10) || 0) === 0), typeof v.style.zoom != "undefined" && (v.innerHTML = "", v.style.width = v.style.padding = "1px", v.style.border = 0, v.style.overflow = "hidden", v.style.display = "inline", v.style.zoom = 1, t.inlineBlockNeedsLayout = v.offsetWidth === 3, v.style.display = "block", v.style.overflow = "visible", v.innerHTML = "<div style='width:5px;'></div>", t.shrinkWrapBlocks = v.offsetWidth !== 3), v.style.cssText = g + y, v.innerHTML = m, i = v.firstChild, o = i.firstChild, a = i.nextSibling.firstChild.firstChild, f = {
                doesNotAddBorder: o.offsetTop !== 5,
                doesAddBorderForTableAndCells: a.offsetTop === 5
            }, o.style.position = "fixed"
, o.style.top = "20px", f.fixedPosition = o.offsetTop === 20 || o.offsetTop === 15, o.style.position = o.style.top = "", i.style.overflow = "hidden", i.style.position = "relative", f.subtractsBorderForOverflowNotVisible = o.offsetTop === -5, f.doesNotIncludeMarginInBodyOffset = w.offsetTop !== h, e.getComputedStyle && (v.style.marginTop = "1%", t.pixelMargin = (e.getComputedStyle(v, null) || {
                marginTop: 0
            }).marginTop !== "1%"), typeof r.style.zoom != "undefined" && (r.style.zoom = 1), w.removeChild(r), c = v = r = null, s.extend(t, f);
        }), t;
    }();
    var f = /^(?:\{.*\}|\[.*\])$/, l = /([A-Z])/g;
    s.extend({
        cache: {},
        uuid: 0,
        expando: "jQuery" + (s.fn.jquery + Math.random()).replace(/\D/g, ""),
        noData: {
            embed: !0,
            object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
            applet: !0
        },
        hasData: function(e) {
            return e = e.nodeType ? s.cache[e[s.expando
]] : e[s.expando], !!e && !h(e);
        },
        data: function(e, n, r, i) {
            if (!s.acceptData(e)) return;
            var o, u, a, f = s.expando, l = typeof n == "string", c = e.nodeType, h = c ? s.cache : e, p = c ? e[f] : e[f] && f, d = n === "events";
            if ((!p || !h[p] || !d && !i && !h[p].data) && l && r === t) return;
            p || (c ? e[f] = p = ++s.uuid : p = f), h[p] || (h[p] = {}, c || (h[p].toJSON = s.noop));
            if (typeof n == "object" || typeof n == "function") i ? h[p] = s.extend(h[p], n) : h[p].data = s.extend(h[p].data, n);
            return o = u = h[p], i || (u.data || (u.data = {}), u = u.data), r !== t && (u[s.camelCase(n)] = r), d && !u[n] ? o.events : (l ? (a = u[n], a == null && (a = u[s.camelCase(n)])) : a = u, a);
        },
        removeData: function(e, t, n) {
            if (!s.acceptData(e)) return;
            var r, i, o, u = s.expando, a = e.nodeType, f = a ? s.cache : e, l = a ? e[u] : u;
            if (!f[l]) 
return;
            if (t) {
                r = n ? f[l] : f[l].data;
                if (r) {
                    s.isArray(t) || (t in r ? t = [ t ] : (t = s.camelCase(t), t in r ? t = [ t ] : t = t.split(" ")));
                    for (i = 0, o = t.length; i < o; i++) delete r[t[i]];
                    if (!(n ? h : s.isEmptyObject)(r)) return;
                }
            }
            if (!n) {
                delete f[l].data;
                if (!h(f[l])) return;
            }
            s.support.deleteExpando || !f.setInterval ? delete f[l] : f[l] = null, a && (s.support.deleteExpando ? delete e[u] : e.removeAttribute ? e.removeAttribute(u) : e[u] = null);
        },
        _data: function(e, t, n) {
            return s.data(e, t, n, !0);
        },
        acceptData: function(e) {
            if (e.nodeName) {
                var t = s.noData[e.nodeName.toLowerCase()];
                if (t) return t !== !0 && e.getAttribute("classid") === t;
            }
            
return !0;
        }
    }), s.fn.extend({
        data: function(e, n) {
            var r, i, o, u, a, f = this[0], l = 0, h = null;
            if (e === t) {
                if (this.length) {
                    h = s.data(f);
                    if (f.nodeType === 1 && !s._data(f, "parsedAttrs")) {
                        o = f.attributes;
                        for (a = o.length; l < a; l++) u = o[l].name, u.indexOf("data-") === 0 && (u = s.camelCase(u.substring(5)), c(f, u, h[u]));
                        s._data(f, "parsedAttrs", !0);
                    }
                }
                return h;
            }
            return typeof e == "object" ? this.each(function() {
                s.data(this, e);
            }) : (r = e.split(".", 2), r[1] = r[1] ? "." + r[1] : "", i = r[1] + "!", s.access(this, function(n) {
                if (n === t) return h = this.triggerHandler("getData" + i, [ r[0] ]), h === t && f && (h = s.data(f, e), h = c(f, e, h)), h === t && r[1] ? this
.data(r[0]) : h;
                r[1] = n, this.each(function() {
                    var t = s(this);
                    t.triggerHandler("setData" + i, r), s.data(this, e, n), t.triggerHandler("changeData" + i, r);
                });
            }, null, n, arguments.length > 1, null, !1));
        },
        removeData: function(e) {
            return this.each(function() {
                s.removeData(this, e);
            });
        }
    }), s.extend({
        _mark: function(e, t) {
            e && (t = (t || "fx") + "mark", s._data(e, t, (s._data(e, t) || 0) + 1));
        },
        _unmark: function(e, t, n) {
            e !== !0 && (n = t, t = e, e = !1);
            if (t) {
                n = n || "fx";
                var r = n + "mark", i = e ? 0 : (s._data(t, r) || 1) - 1;
                i ? s._data(t, r, i) : (s.removeData(t, r, !0), p(t, n, "mark"));
            }
        },
        queue: function(e, t, n) {
            var r;
            if (e) return t = (t || "fx"
) + "queue", r = s._data(e, t), n && (!r || s.isArray(n) ? r = s._data(e, t, s.makeArray(n)) : r.push(n)), r || [];
        },
        dequeue: function(e, t) {
            t = t || "fx";
            var n = s.queue(e, t), r = n.shift(), i = {};
            r === "inprogress" && (r = n.shift()), r && (t === "fx" && n.unshift("inprogress"), s._data(e, t + ".run", i), r.call(e, function() {
                s.dequeue(e, t);
            }, i)), n.length || (s.removeData(e, t + "queue " + t + ".run", !0), p(e, t, "queue"));
        }
    }), s.fn.extend({
        queue: function(e, n) {
            var r = 2;
            return typeof e != "string" && (n = e, e = "fx", r--), arguments.length < r ? s.queue(this[0], e) : n === t ? this : this.each(function() {
                var t = s.queue(this, e, n);
                e === "fx" && t[0] !== "inprogress" && s.dequeue(this, e);
            });
        },
        dequeue: function(e) {
            return this.each(function() {
                s
.dequeue(this, e);
            });
        },
        delay: function(e, t) {
            return e = s.fx ? s.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function(t, n) {
                var r = setTimeout(t, e);
                n.stop = function() {
                    clearTimeout(r);
                };
            });
        },
        clearQueue: function(e) {
            return this.queue(e || "fx", []);
        },
        promise: function(e, n) {
            function h() {
                --u || r.resolveWith(i, [ i ]);
            }
            typeof e != "string" && (n = e, e = t), e = e || "fx";
            var r = s.Deferred(), i = this, o = i.length, u = 1, a = e + "defer", f = e + "queue", l = e + "mark", c;
            while (o--) if (c = s.data(i[o], a, t, !0) || (s.data(i[o], f, t, !0) || s.data(i[o], l, t, !0)) && s.data(i[o], a, s.Callbacks("once memory"), !0)) u++, c.add(h);
            return h(), r.promise(n);
        }
    });
    var d = /[\n\t\r]/g, v = /\s+/
, m = /\r/g, g = /^(?:button|input)$/i, y = /^(?:button|input|object|select|textarea)$/i, b = /^a(?:rea)?$/i, w = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, E = s.support.getSetAttribute, S, x, T;
    s.fn.extend({
        attr: function(e, t) {
            return s.access(this, s.attr, e, t, arguments.length > 1);
        },
        removeAttr: function(e) {
            return this.each(function() {
                s.removeAttr(this, e);
            });
        },
        prop: function(e, t) {
            return s.access(this, s.prop, e, t, arguments.length > 1);
        },
        removeProp: function(e) {
            return e = s.propFix[e] || e, this.each(function() {
                try {
                    this[e] = t, delete this[e];
                } catch (n) {}
            });
        },
        addClass: function(e) {
            var t, n, r, i, o, u, a;
            if (s.isFunction(e)) return this
.each(function(t) {
                s(this).addClass(e.call(this, t, this.className));
            });
            if (e && typeof e == "string") {
                t = e.split(v);
                for (n = 0, r = this.length; n < r; n++) {
                    i = this[n];
                    if (i.nodeType === 1) if (!i.className && t.length === 1) i.className = e; else {
                        o = " " + i.className + " ";
                        for (u = 0, a = t.length; u < a; u++) ~o.indexOf(" " + t[u] + " ") || (o += t[u] + " ");
                        i.className = s.trim(o);
                    }
                }
            }
            return this;
        },
        removeClass: function(e) {
            var n, r, i, o, u, a, f;
            if (s.isFunction(e)) return this.each(function(t) {
                s(this).removeClass(e.call(this, t, this.className));
            });
            if (e && typeof e == "string" || e === t) {
                n = (e || "").split(v);
                
for (r = 0, i = this.length; r < i; r++) {
                    o = this[r];
                    if (o.nodeType === 1 && o.className) if (e) {
                        u = (" " + o.className + " ").replace(d, " ");
                        for (a = 0, f = n.length; a < f; a++) u = u.replace(" " + n[a] + " ", " ");
                        o.className = s.trim(u);
                    } else o.className = "";
                }
            }
            return this;
        },
        toggleClass: function(e, t) {
            var n = typeof e, r = typeof t == "boolean";
            return s.isFunction(e) ? this.each(function(n) {
                s(this).toggleClass(e.call(this, n, this.className, t), t);
            }) : this.each(function() {
                if (n === "string") {
                    var i, o = 0, u = s(this), a = t, f = e.split(v);
                    while (i = f[o++]) a = r ? a : !u.hasClass(i), u[a ? "addClass" : "removeClass"](i);
                } else if (n === "undefined" || 
n === "boolean") this.className && s._data(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : s._data(this, "__className__") || "";
            });
        },
        hasClass: function(e) {
            var t = " " + e + " ", n = 0, r = this.length;
            for (; n < r; n++) if (this[n].nodeType === 1 && (" " + this[n].className + " ").replace(d, " ").indexOf(t) > -1) return !0;
            return !1;
        },
        val: function(e) {
            var n, r, i, o = this[0];
            if (!arguments.length) {
                if (o) return n = s.valHooks[o.type] || s.valHooks[o.nodeName.toLowerCase()], n && "get" in n && (r = n.get(o, "value")) !== t ? r : (r = o.value, typeof r == "string" ? r.replace(m, "") : r == null ? "" : r);
                return;
            }
            return i = s.isFunction(e), this.each(function(r) {
                var o = s(this), u;
                if (this.nodeType !== 1) return;
                i ? u = e
.call(this, r, o.val()) : u = e, u == null ? u = "" : typeof u == "number" ? u += "" : s.isArray(u) && (u = s.map(u, function(e) {
                    return e == null ? "" : e + "";
                })), n = s.valHooks[this.type] || s.valHooks[this.nodeName.toLowerCase()];
                if (!n || !("set" in n) || n.set(this, u, "value") === t) this.value = u;
            });
        }
    }), s.extend({
        valHooks: {
            option: {
                get: function(e) {
                    var t = e.attributes.value;
                    return !t || t.specified ? e.value : e.text;
                }
            },
            select: {
                get: function(e) {
                    var t, n, r, i, o = e.selectedIndex, u = [], a = e.options, f = e.type === "select-one";
                    if (o < 0) return null;
                    n = f ? o : 0, r = f ? o + 1 : a.length;
                    for (; n < r; n++) {
                        i = a[n];
                        
if (i.selected && (s.support.optDisabled ? !i.disabled : i.getAttribute("disabled") === null) && (!i.parentNode.disabled || !s.nodeName(i.parentNode, "optgroup"))) {
                            t = s(i).val();
                            if (f) return t;
                            u.push(t);
                        }
                    }
                    return f && !u.length && a.length ? s(a[o]).val() : u;
                },
                set: function(e, t) {
                    var n = s.makeArray(t);
                    return s(e).find("option").each(function() {
                        this.selected = s.inArray(s(this).val(), n) >= 0;
                    }), n.length || (e.selectedIndex = -1), n;
                }
            }
        },
        attrFn: {
            val: !0,
            css: !0,
            html: !0,
            text: !0,
            data: !0,
            width: !0,
            height: !0,
            offset: !0
        },
        attr: function(e, n, r, 
i) {
            var o, u, a, f = e.nodeType;
            if (!e || f === 3 || f === 8 || f === 2) return;
            if (i && n in s.attrFn) return s(e)[n](r);
            if (typeof e.getAttribute == "undefined") return s.prop(e, n, r);
            a = f !== 1 || !s.isXMLDoc(e), a && (n = n.toLowerCase(), u = s.attrHooks[n] || (w.test(n) ? x : S));
            if (r !== t) {
                if (r === null) {
                    s.removeAttr(e, n);
                    return;
                }
                return u && "set" in u && a && (o = u.set(e, r, n)) !== t ? o : (e.setAttribute(n, "" + r), r);
            }
            return u && "get" in u && a && (o = u.get(e, n)) !== null ? o : (o = e.getAttribute(n), o === null ? t : o);
        },
        removeAttr: function(e, t) {
            var n, r, i, o, u, a = 0;
            if (t && e.nodeType === 1) {
                r = t.toLowerCase().split(v), o = r.length;
                for (; a < o; a++) i = r[a], i && (n = s.propFix[i
] || i, u = w.test(i), u || s.attr(e, i, ""), e.removeAttribute(E ? i : n), u && n in e && (e[n] = !1));
            }
        },
        attrHooks: {
            type: {
                set: function(e, t) {
                    if (g.test(e.nodeName) && e.parentNode) s.error("type property can't be changed"); else if (!s.support.radioValue && t === "radio" && s.nodeName(e, "input")) {
                        var n = e.value;
                        return e.setAttribute("type", t), n && (e.value = n), t;
                    }
                }
            },
            value: {
                get: function(e, t) {
                    return S && s.nodeName(e, "button") ? S.get(e, t) : t in e ? e.value : null;
                },
                set: function(e, t, n) {
                    if (S && s.nodeName(e, "button")) return S.set(e, t, n);
                    e.value = t;
                }
            }
        },
        propFix: {
            tabindex: "tabIndex",
            readonly
: "readOnly",
            "for": "htmlFor",
            "class": "className",
            maxlength: "maxLength",
            cellspacing: "cellSpacing",
            cellpadding: "cellPadding",
            rowspan: "rowSpan",
            colspan: "colSpan",
            usemap: "useMap",
            frameborder: "frameBorder",
            contenteditable: "contentEditable"
        },
        prop: function(e, n, r) {
            var i, o, u, a = e.nodeType;
            if (!e || a === 3 || a === 8 || a === 2) return;
            return u = a !== 1 || !s.isXMLDoc(e), u && (n = s.propFix[n] || n, o = s.propHooks[n]), r !== t ? o && "set" in o && (i = o.set(e, r, n)) !== t ? i : e[n] = r : o && "get" in o && (i = o.get(e, n)) !== null ? i : e[n];
        },
        propHooks: {
            tabIndex: {
                get: function(e) {
                    var n = e.getAttributeNode("tabindex");
                    return n && n.specified ? parseInt(n.value, 10) : y.test(e.nodeName) || b.test
(e.nodeName) && e.href ? 0 : t;
                }
            }
        }
    }), s.attrHooks.tabindex = s.propHooks.tabIndex, x = {
        get: function(e, n) {
            var r, i = s.prop(e, n);
            return i === !0 || typeof i != "boolean" && (r = e.getAttributeNode(n)) && r.nodeValue !== !1 ? n.toLowerCase() : t;
        },
        set: function(e, t, n) {
            var r;
            return t === !1 ? s.removeAttr(e, n) : (r = s.propFix[n] || n, r in e && (e[r] = !0), e.setAttribute(n, n.toLowerCase())), n;
        }
    }, E || (T = {
        name: !0,
        id: !0,
        coords: !0
    }, S = s.valHooks.button = {
        get: function(e, n) {
            var r;
            return r = e.getAttributeNode(n), r && (T[n] ? r.nodeValue !== "" : r.specified) ? r.nodeValue : t;
        },
        set: function(e, t, r) {
            var i = e.getAttributeNode(r);
            return i || (i = n.createAttribute(r), e.setAttributeNode(i)), i.nodeValue = t + "";
        }
    
}, s.attrHooks.tabindex.set = S.set, s.each([ "width", "height" ], function(e, t) {
        s.attrHooks[t] = s.extend(s.attrHooks[t], {
            set: function(e, n) {
                if (n === "") return e.setAttribute(t, "auto"), n;
            }
        });
    }), s.attrHooks.contenteditable = {
        get: S.get,
        set: function(e, t, n) {
            t === "" && (t = "false"), S.set(e, t, n);
        }
    }), s.support.hrefNormalized || s.each([ "href", "src", "width", "height" ], function(e, n) {
        s.attrHooks[n] = s.extend(s.attrHooks[n], {
            get: function(e) {
                var r = e.getAttribute(n, 2);
                return r === null ? t : r;
            }
        });
    }), s.support.style || (s.attrHooks.style = {
        get: function(e) {
            return e.style.cssText.toLowerCase() || t;
        },
        set: function(e, t) {
            return e.style.cssText = "" + t;
        }
    }), s.support.optSelected || (s.propHooks.selected = 
s.extend(s.propHooks.selected, {
        get: function(e) {
            var t = e.parentNode;
            return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null;
        }
    })), s.support.enctype || (s.propFix.enctype = "encoding"), s.support.checkOn || s.each([ "radio", "checkbox" ], function() {
        s.valHooks[this] = {
            get: function(e) {
                return e.getAttribute("value") === null ? "on" : e.value;
            }
        };
    }), s.each([ "radio", "checkbox" ], function() {
        s.valHooks[this] = s.extend(s.valHooks[this], {
            set: function(e, t) {
                if (s.isArray(t)) return e.checked = s.inArray(s(e).val(), t) >= 0;
            }
        });
    });
    var N = /^(?:textarea|input|select)$/i, C = /^([^\.]*)?(?:\.(.+))?$/, k = /(?:^|\s)hover(\.\S+)?\b/, L = /^key/, A = /^(?:mouse|contextmenu)|click/, O = /^(?:focusinfocus|focusoutblur)$/, M = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, _ = function(e) 
{
        var t = M.exec(e);
        return t && (t[1] = (t[1] || "").toLowerCase(), t[3] = t[3] && new RegExp("(?:^|\\s)" + t[3] + "(?:\\s|$)")), t;
    }, D = function(e, t) {
        var n = e.attributes || {};
        return (!t[1] || e.nodeName.toLowerCase() === t[1]) && (!t[2] || (n.id || {}).value === t[2]) && (!t[3] || t[3].test((n["class"] || {}).value));
    }, P = function(e) {
        return s.event.special.hover ? e : e.replace(k, "mouseenter$1 mouseleave$1");
    };
    s.event = {
        add: function(e, n, r, i, o) {
            var u, a, f, l, c, h, p, d, v, m, g, y;
            if (e.nodeType === 3 || e.nodeType === 8 || !n || !r || !(u = s._data(e))) return;
            r.handler && (v = r, r = v.handler, o = v.selector), r.guid || (r.guid = s.guid++), f = u.events, f || (u.events = f = {}), a = u.handle, a || (u.handle = a = function(e) {
                return typeof s == "undefined" || !!e && s.event.triggered === e.type ? t : s.event.dispatch.apply(a.elem, arguments
);
            }, a.elem = e), n = s.trim(P(n)).split(" ");
            for (l = 0; l < n.length; l++) {
                c = C.exec(n[l]) || [], h = c[1], p = (c[2] || "").split(".").sort(), y = s.event.special[h] || {}, h = (o ? y.delegateType : y.bindType) || h, y = s.event.special[h] || {}, d = s.extend({
                    type: h,
                    origType: c[1],
                    data: i,
                    handler: r,
                    guid: r.guid,
                    selector: o,
                    quick: o && _(o),
                    namespace: p.join(".")
                }, v), g = f[h];
                if (!g) {
                    g = f[h] = [], g.delegateCount = 0;
                    if (!y.setup || y.setup.call(e, i, p, a) === !1) e.addEventListener ? e.addEventListener(h, a, !1) : e.attachEvent && e.attachEvent("on" + h, a);
                }
                y.add && (y.add.call(e, d), d.handler.guid || (d.handler.guid = r.guid)), o ? g.splice(g.delegateCount++
, 0, d) : g.push(d), s.event.global[h] = !0;
            }
            e = null;
        },
        global: {},
        remove: function(e, t, n, r, i) {
            var o = s.hasData(e) && s._data(e), u, a, f, l, c, h, p, d, v, m, g, y;
            if (!o || !(d = o.events)) return;
            t = s.trim(P(t || "")).split(" ");
            for (u = 0; u < t.length; u++) {
                a = C.exec(t[u]) || [], f = l = a[1], c = a[2];
                if (!f) {
                    for (f in d) s.event.remove(e, f + t[u], n, r, !0);
                    continue;
                }
                v = s.event.special[f] || {}, f = (r ? v.delegateType : v.bindType) || f, g = d[f] || [], h = g.length, c = c ? new RegExp("(^|\\.)" + c.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null;
                for (p = 0; p < g.length; p++) y = g[p], (i || l === y.origType) && (!n || n.guid === y.guid) && (!c || c.test(y.namespace)) && (!r || r === y.selector || r === "**" && y.selector) && 
(g.splice(p--, 1), y.selector && g.delegateCount--, v.remove && v.remove.call(e, y));
                g.length === 0 && h !== g.length && ((!v.teardown || v.teardown.call(e, c) === !1) && s.removeEvent(e, f, o.handle), delete d[f]);
            }
            s.isEmptyObject(d) && (m = o.handle, m && (m.elem = null), s.removeData(e, [ "events", "handle" ], !0));
        },
        customEvent: {
            getData: !0,
            setData: !0,
            changeData: !0
        },
        trigger: function(n, r, i, o) {
            if (!i || i.nodeType !== 3 && i.nodeType !== 8) {
                var u = n.type || n, a = [], f, l, c, h, p, d, v, m, g, y;
                if (O.test(u + s.event.triggered)) return;
                u.indexOf("!") >= 0 && (u = u.slice(0, -1), l = !0), u.indexOf(".") >= 0 && (a = u.split("."), u = a.shift(), a.sort());
                if ((!i || s.event.customEvent[u]) && !s.event.global[u]) return;
                n = typeof n == "object" ? n[s.expando] ? n 
: new s.Event(u, n) : new s.Event(u), n.type = u, n.isTrigger = !0, n.exclusive = l, n.namespace = a.join("."), n.namespace_re = n.namespace ? new RegExp("(^|\\.)" + a.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, d = u.indexOf(":") < 0 ? "on" + u : "";
                if (!i) {
                    f = s.cache;
                    for (c in f) f[c].events && f[c].events[u] && s.event.trigger(n, r, f[c].handle.elem, !0);
                    return;
                }
                n.result = t, n.target || (n.target = i), r = r != null ? s.makeArray(r) : [], r.unshift(n), v = s.event.special[u] || {};
                if (v.trigger && v.trigger.apply(i, r) === !1) return;
                g = [ [ i, v.bindType || u ] ];
                if (!o && !v.noBubble && !s.isWindow(i)) {
                    y = v.delegateType || u, h = O.test(y + u) ? i : i.parentNode, p = null;
                    for (; h; h = h.parentNode) g.push([ h, y ]), p = h;
                    p && p === i.ownerDocument && g
.push([ p.defaultView || p.parentWindow || e, y ]);
                }
                for (c = 0; c < g.length && !n.isPropagationStopped(); c++) h = g[c][0], n.type = g[c][1], m = (s._data(h, "events") || {})[n.type] && s._data(h, "handle"), m && m.apply(h, r), m = d && h[d], m && s.acceptData(h) && m.apply(h, r) === !1 && n.preventDefault();
                return n.type = u, !o && !n.isDefaultPrevented() && (!v._default || v._default.apply(i.ownerDocument, r) === !1) && (u !== "click" || !s.nodeName(i, "a")) && s.acceptData(i) && d && i[u] && (u !== "focus" && u !== "blur" || n.target.offsetWidth !== 0) && !s.isWindow(i) && (p = i[d], p && (i[d] = null), s.event.triggered = u, i[u](), s.event.triggered = t, p && (i[d] = p)), n.result;
            }
            return;
        },
        dispatch: function(n) {
            n = s.event.fix(n || e.event);
            var r = (s._data(this, "events") || {})[n.type] || [], i = r.delegateCount, o = [].slice.call(arguments, 0), u = !n.exclusive && !
n.namespace, a = s.event.special[n.type] || {}, f = [], l, c, h, p, d, v, m, g, y, b, w;
            o[0] = n, n.delegateTarget = this;
            if (a.preDispatch && a.preDispatch.call(this, n) === !1) return;
            if (i && (!n.button || n.type !== "click")) {
                p = s(this), p.context = this.ownerDocument || this;
                for (h = n.target; h != this; h = h.parentNode || this) if (h.disabled !== !0) {
                    v = {}, g = [], p[0] = h;
                    for (l = 0; l < i; l++) y = r[l], b = y.selector, v[b] === t && (v[b] = y.quick ? D(h, y.quick) : p.is(b)), v[b] && g.push(y);
                    g.length && f.push({
                        elem: h,
                        matches: g
                    });
                }
            }
            r.length > i && f.push({
                elem: this,
                matches: r.slice(i)
            });
            for (l = 0; l < f.length && !n.isPropagationStopped(); l++) {
                
m = f[l], n.currentTarget = m.elem;
                for (c = 0; c < m.matches.length && !n.isImmediatePropagationStopped(); c++) {
                    y = m.matches[c];
                    if (u || !n.namespace && !y.namespace || n.namespace_re && n.namespace_re.test(y.namespace)) n.data = y.data, n.handleObj = y, d = ((s.event.special[y.origType] || {}).handle || y.handler).apply(m.elem, o), d !== t && (n.result = d, d === !1 && (n.preventDefault(), n.stopPropagation()));
                }
            }
            return a.postDispatch && a.postDispatch.call(this, n), n.result;
        },
        props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(e, t) {
                return e.which == null && (e.which = t.charCode != null ? t
.charCode : t.keyCode), e;
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function(e, r) {
                var i, s, o, u = r.button, a = r.fromElement;
                return e.pageX == null && r.clientX != null && (i = e.target.ownerDocument || n, s = i.documentElement, o = i.body, e.pageX = r.clientX + (s && s.scrollLeft || o && o.scrollLeft || 0) - (s && s.clientLeft || o && o.clientLeft || 0), e.pageY = r.clientY + (s && s.scrollTop || o && o.scrollTop || 0) - (s && s.clientTop || o && o.clientTop || 0)), !e.relatedTarget && a && (e.relatedTarget = a === e.target ? r.toElement : a), !e.which && u !== t && (e.which = u & 1 ? 1 : u & 2 ? 3 : u & 4 ? 2 : 0), e;
            }
        },
        fix: function(e) {
            if (e[s.expando]) return e;
            var r, i, o = e, u = s.event.fixHooks[e.type] || {}, a = u.props ? this.props
.concat(u.props) : this.props;
            e = s.Event(o);
            for (r = a.length; r; ) i = a[--r], e[i] = o[i];
            return e.target || (e.target = o.srcElement || n), e.target.nodeType === 3 && (e.target = e.target.parentNode), e.metaKey === t && (e.metaKey = e.ctrlKey), u.filter ? u.filter(e, o) : e;
        },
        special: {
            ready: {
                setup: s.bindReady
            },
            load: {
                noBubble: !0
            },
            focus: {
                delegateType: "focusin"
            },
            blur: {
                delegateType: "focusout"
            },
            beforeunload: {
                setup: function(e, t, n) {
                    s.isWindow(this) && (this.onbeforeunload = n);
                },
                teardown: function(e, t) {
                    this.onbeforeunload === t && (this.onbeforeunload = null);
                }
            }
        },
        simulate: function(e, t, n, r) {
            
var i = s.extend(new s.Event, n, {
                type: e,
                isSimulated: !0,
                originalEvent: {}
            });
            r ? s.event.trigger(i, null, t) : s.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault();
        }
    }, s.event.handle = s.event.dispatch, s.removeEvent = n.removeEventListener ? function(e, t, n) {
        e.removeEventListener && e.removeEventListener(t, n, !1);
    } : function(e, t, n) {
        e.detachEvent && e.detachEvent("on" + t, n);
    }, s.Event = function(e, t) {
        if (!(this instanceof s.Event)) return new s.Event(e, t);
        e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || e.returnValue === !1 || e.getPreventDefault && e.getPreventDefault() ? B : H) : this.type = e, t && s.extend(this, t), this.timeStamp = e && e.timeStamp || s.now(), this[s.expando] = !0;
    }, s.Event.prototype = {
        preventDefault: function() {
            
this.isDefaultPrevented = B;
            var e = this.originalEvent;
            if (!e) return;
            e.preventDefault ? e.preventDefault() : e.returnValue = !1;
        },
        stopPropagation: function() {
            this.isPropagationStopped = B;
            var e = this.originalEvent;
            if (!e) return;
            e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0;
        },
        stopImmediatePropagation: function() {
            this.isImmediatePropagationStopped = B, this.stopPropagation();
        },
        isDefaultPrevented: H,
        isPropagationStopped: H,
        isImmediatePropagationStopped: H
    }, s.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout"
    }, function(e, t) {
        s.event.special[e] = {
            delegateType: t,
            bindType: t,
            handle: function(e) {
                var n = this, r = e.relatedTarget, i = e.handleObj, o = i.selector, u;
                if (!r || r !== n && !
s.contains(n, r)) e.type = i.origType, u = i.handler.apply(this, arguments), e.type = t;
                return u;
            }
        };
    }), s.support.submitBubbles || (s.event.special.submit = {
        setup: function() {
            if (s.nodeName(this, "form")) return !1;
            s.event.add(this, "click._submit keypress._submit", function(e) {
                var n = e.target, r = s.nodeName(n, "input") || s.nodeName(n, "button") ? n.form : t;
                r && !r._submit_attached && (s.event.add(r, "submit._submit", function(e) {
                    e._submit_bubble = !0;
                }), r._submit_attached = !0);
            });
        },
        postDispatch: function(e) {
            e._submit_bubble && (delete e._submit_bubble, this.parentNode && !e.isTrigger && s.event.simulate("submit", this.parentNode, e, !0));
        },
        teardown: function() {
            if (s.nodeName(this, "form")) return !1;
            s.event.remove(this, "._submit");
        
}
    }), s.support.changeBubbles || (s.event.special.change = {
        setup: function() {
            if (N.test(this.nodeName)) {
                if (this.type === "checkbox" || this.type === "radio") s.event.add(this, "propertychange._change", function(e) {
                    e.originalEvent.propertyName === "checked" && (this._just_changed = !0);
                }), s.event.add(this, "click._change", function(e) {
                    this._just_changed && !e.isTrigger && (this._just_changed = !1, s.event.simulate("change", this, e, !0));
                });
                return !1;
            }
            s.event.add(this, "beforeactivate._change", function(e) {
                var t = e.target;
                N.test(t.nodeName) && !t._change_attached && (s.event.add(t, "change._change", function(e) {
                    this.parentNode && !e.isSimulated && !e.isTrigger && s.event.simulate("change", this.parentNode, e, !0);
                }), t._change_attached = !0);
            
});
        },
        handle: function(e) {
            var t = e.target;
            if (this !== t || e.isSimulated || e.isTrigger || t.type !== "radio" && t.type !== "checkbox") return e.handleObj.handler.apply(this, arguments);
        },
        teardown: function() {
            return s.event.remove(this, "._change"), N.test(this.nodeName);
        }
    }), s.support.focusinBubbles || s.each({
        focus: "focusin",
        blur: "focusout"
    }, function(e, t) {
        var r = 0, i = function(e) {
            s.event.simulate(t, e.target, s.event.fix(e), !0);
        };
        s.event.special[t] = {
            setup: function() {
                r++ === 0 && n.addEventListener(e, i, !0);
            },
            teardown: function() {
                --r === 0 && n.removeEventListener(e, i, !0);
            }
        };
    }), s.fn.extend({
        on: function(e, n, r, i, o) {
            var u, a;
            if (typeof e == "object") {
                typeof n != "string" && 
(r = r || n, n = t);
                for (a in e) this.on(a, n, r, e[a], o);
                return this;
            }
            r == null && i == null ? (i = n, r = n = t) : i == null && (typeof n == "string" ? (i = r, r = t) : (i = r, r = n, n = t));
            if (i === !1) i = H; else if (!i) return this;
            return o === 1 && (u = i, i = function(e) {
                return s().off(e), u.apply(this, arguments);
            }, i.guid = u.guid || (u.guid = s.guid++)), this.each(function() {
                s.event.add(this, e, i, r, n);
            });
        },
        one: function(e, t, n, r) {
            return this.on(e, t, n, r, 1);
        },
        off: function(e, n, r) {
            if (e && e.preventDefault && e.handleObj) {
                var i = e.handleObj;
                return s(e.delegateTarget).off(i.namespace ? i.origType + "." + i.namespace : i.origType, i.selector, i.handler), this;
            }
            if (typeof e == "object") {
                
for (var o in e) this.off(o, n, e[o]);
                return this;
            }
            if (n === !1 || typeof n == "function") r = n, n = t;
            return r === !1 && (r = H), this.each(function() {
                s.event.remove(this, e, r, n);
            });
        },
        bind: function(e, t, n) {
            return this.on(e, null, t, n);
        },
        unbind: function(e, t) {
            return this.off(e, null, t);
        },
        live: function(e, t, n) {
            return s(this.context).on(e, this.selector, t, n), this;
        },
        die: function(e, t) {
            return s(this.context).off(e, this.selector || "**", t), this;
        },
        delegate: function(e, t, n, r) {
            return this.on(t, e, n, r);
        },
        undelegate: function(e, t, n) {
            return arguments.length == 1 ? this.off(e, "**") : this.off(t, e, n);
        },
        trigger: function(e, t) {
            return this.each(function() {
                
s.event.trigger(e, t, this);
            });
        },
        triggerHandler: function(e, t) {
            if (this[0]) return s.event.trigger(e, t, this[0], !0);
        },
        toggle: function(e) {
            var t = arguments, n = e.guid || s.guid++, r = 0, i = function(n) {
                var i = (s._data(this, "lastToggle" + e.guid) || 0) % r;
                return s._data(this, "lastToggle" + e.guid, i + 1), n.preventDefault(), t[i].apply(this, arguments) || !1;
            };
            i.guid = n;
            while (r < t.length) t[r++].guid = n;
            return this.click(i);
        },
        hover: function(e, t) {
            return this.mouseenter(e).mouseleave(t || e);
        }
    }), s.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, t) {
        s.fn[t] = function(e, n) {
            
return n == null && (n = e, e = null), arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t);
        }, s.attrFn && (s.attrFn[t] = !0), L.test(t) && (s.event.fixHooks[t] = s.event.keyHooks), A.test(t) && (s.event.fixHooks[t] = s.event.mouseHooks);
    }), function() {
        function S(e, t, n, i, s, o) {
            for (var u = 0, a = i.length; u < a; u++) {
                var f = i[u];
                if (f) {
                    var l = !1;
                    f = f[e];
                    while (f) {
                        if (f[r] === n) {
                            l = i[f.sizset];
                            break;
                        }
                        f.nodeType === 1 && !o && (f[r] = n, f.sizset = u);
                        if (f.nodeName.toLowerCase() === t) {
                            l = f;
                            break;
                        }
                        f = f[e];
                    }
                    i[u] = l;
                
}
            }
        }
        function x(e, t, n, i, s, o) {
            for (var u = 0, a = i.length; u < a; u++) {
                var f = i[u];
                if (f) {
                    var l = !1;
                    f = f[e];
                    while (f) {
                        if (f[r] === n) {
                            l = i[f.sizset];
                            break;
                        }
                        if (f.nodeType === 1) {
                            o || (f[r] = n, f.sizset = u);
                            if (typeof t != "string") {
                                if (f === t) {
                                    l = !0;
                                    break;
                                }
                            } else if (h.filter(t, [ f ]).length > 0) {
                                l = f;
                                break;
                            }
                        }
                        f = f[e];
                    
}
                    i[u] = l;
                }
            }
        }
        var e = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, r = "sizcache" + (Math.random() + "").replace(".", ""), i = 0, o = Object.prototype.toString, u = !1, a = !0, f = /\\/g, l = /\r\n/g, c = /\W/;
        [ 0, 0 ].sort(function() {
            return a = !1, 0;
        });
        var h = function(t, r, i, s) {
            i = i || [], r = r || n;
            var u = r;
            if (r.nodeType !== 1 && r.nodeType !== 9) return [];
            if (!t || typeof t != "string") return i;
            var a, f, l, c, p, m, g, b, w = !0, E = h.isXML(r), S = [], x = t;
            do {
                e.exec(""), a = e.exec(x);
                if (a) {
                    x = a[3], S.push(a[1]);
                    if (a[2]) {
                        c = a[3];
                        break;
                    }
                
}
            } while (a);
            if (S.length > 1 && v.exec(t)) if (S.length === 2 && d.relative[S[0]]) f = T(S[0] + S[1], r, s); else {
                f = d.relative[S[0]] ? [ r ] : h(S.shift(), r);
                while (S.length) t = S.shift(), d.relative[t] && (t += S.shift()), f = T(t, f, s);
            } else {
                !s && S.length > 1 && r.nodeType === 9 && !E && d.match.ID.test(S[0]) && !d.match.ID.test(S[S.length - 1]) && (p = h.find(S.shift(), r, E), r = p.expr ? h.filter(p.expr, p.set)[0] : p.set[0]);
                if (r) {
                    p = s ? {
                        expr: S.pop(),
                        set: y(s)
                    } : h.find(S.pop(), S.length !== 1 || S[0] !== "~" && S[0] !== "+" || !r.parentNode ? r : r.parentNode, E), f = p.expr ? h.filter(p.expr, p.set) : p.set, S.length > 0 ? l = y(f) : w = !1;
                    while (S.length) m = S.pop(), g = m, d.relative[m] ? g = S.pop() : m = "", g == null && (g = r), d.relative[m
](l, g, E);
                } else l = S = [];
            }
            l || (l = f), l || h.error(m || t);
            if (o.call(l) === "[object Array]") if (!w) i.push.apply(i, l); else if (r && r.nodeType === 1) for (b = 0; l[b] != null; b++) l[b] && (l[b] === !0 || l[b].nodeType === 1 && h.contains(r, l[b])) && i.push(f[b]); else for (b = 0; l[b] != null; b++) l[b] && l[b].nodeType === 1 && i.push(f[b]); else y(l, i);
            return c && (h(c, u, i, s), h.uniqueSort(i)), i;
        };
        h.uniqueSort = function(e) {
            if (w) {
                u = a, e.sort(w);
                if (u) for (var t = 1; t < e.length; t++) e[t] === e[t - 1] && e.splice(t--, 1);
            }
            return e;
        }, h.matches = function(e, t) {
            return h(e, null, null, t);
        }, h.matchesSelector = function(e, t) {
            return h(t, null, null, [ e ]).length > 0;
        }, h.find = function(e, t, n) {
            var r, i, s, o, u, a;
            if (!e) 
return [];
            for (i = 0, s = d.order.length; i < s; i++) {
                u = d.order[i];
                if (o = d.leftMatch[u].exec(e)) {
                    a = o[1], o.splice(1, 1);
                    if (a.substr(a.length - 1) !== "\\") {
                        o[1] = (o[1] || "").replace(f, ""), r = d.find[u](o, t, n);
                        if (r != null) {
                            e = e.replace(d.match[u], "");
                            break;
                        }
                    }
                }
            }
            return r || (r = typeof t.getElementsByTagName != "undefined" ? t.getElementsByTagName("*") : []), {
                set: r,
                expr: e
            };
        }, h.filter = function(e, n, r, i) {
            var s, o, u, a, f, l, c, p, v, m = e, g = [], y = n, b = n && n[0] && h.isXML(n[0]);
            while (e && n.length) {
                for (u in d.filter) if ((s = d.leftMatch[u].exec(e)) != null && s[2]) {
                    
l = d.filter[u], c = s[1], o = !1, s.splice(1, 1);
                    if (c.substr(c.length - 1) === "\\") continue;
                    y === g && (g = []);
                    if (d.preFilter[u]) {
                        s = d.preFilter[u](s, y, r, g, i, b);
                        if (!s) o = a = !0; else if (s === !0) continue;
                    }
                    if (s) for (p = 0; (f = y[p]) != null; p++) f && (a = l(f, s, p, y), v = i ^ a, r && a != null ? v ? o = !0 : y[p] = !1 : v && (g.push(f), o = !0));
                    if (a !== t) {
                        r || (y = g), e = e.replace(d.match[u], "");
                        if (!o) return [];
                        break;
                    }
                }
                if (e === m) {
                    if (o != null) break;
                    h.error(e);
                }
                m = e;
            }
            return y;
        }, h.error = function(e) {
            throw new Error("Syntax error, unrecognized expression: " + 
e);
        };
        var p = h.getText = function(e) {
            var t, n, r = e.nodeType, i = "";
            if (r) {
                if (r === 1 || r === 9 || r === 11) {
                    if (typeof e.textContent == "string") return e.textContent;
                    if (typeof e.innerText == "string") return e.innerText.replace(l, "");
                    for (e = e.firstChild; e; e = e.nextSibling) i += p(e);
                } else if (r === 3 || r === 4) return e.nodeValue;
            } else for (t = 0; n = e[t]; t++) n.nodeType !== 8 && (i += p(n));
            return i;
        }, d = h.selectors = {
            order: [ "ID", "NAME", "TAG" ],
            match: {
                ID: /#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,
                CLASS: /\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,
                NAME: /\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,
                ATTR: /\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/
,
                TAG: /^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,
                CHILD: /:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,
                POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,
                PSEUDO: /:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/
            },
            leftMatch: {},
            attrMap: {
                "class": "className",
                "for": "htmlFor"
            },
            attrHandle: {
                href: function(e) {
                    return e.getAttribute("href");
                },
                type: function(e) {
                    return e.getAttribute("type");
                }
            },
            relative: {
                "+": function(e, t) {
                    var n = typeof t == "string", r = n && !c.test(t), i = n && !r;
                    r && (t = t.toLowerCase());
                    for (var s = 0
, o = e.length, u; s < o; s++) if (u = e[s]) {
                        while ((u = u.previousSibling) && u.nodeType !== 1) ;
                        e[s] = i || u && u.nodeName.toLowerCase() === t ? u || !1 : u === t;
                    }
                    i && h.filter(t, e, !0);
                },
                ">": function(e, t) {
                    var n, r = typeof t == "string", i = 0, s = e.length;
                    if (r && !c.test(t)) {
                        t = t.toLowerCase();
                        for (; i < s; i++) {
                            n = e[i];
                            if (n) {
                                var o = n.parentNode;
                                e[i] = o.nodeName.toLowerCase() === t ? o : !1;
                            }
                        }
                    } else {
                        for (; i < s; i++) n = e[i], n && (e[i] = r ? n.parentNode : n.parentNode === t);
                        r && h.filter(t, e, !0);
                    
}
                },
                "": function(e, t, n) {
                    var r, s = i++, o = x;
                    typeof t == "string" && !c.test(t) && (t = t.toLowerCase(), r = t, o = S), o("parentNode", t, s, e, r, n);
                },
                "~": function(e, t, n) {
                    var r, s = i++, o = x;
                    typeof t == "string" && !c.test(t) && (t = t.toLowerCase(), r = t, o = S), o("previousSibling", t, s, e, r, n);
                }
            },
            find: {
                ID: function(e, t, n) {
                    if (typeof t.getElementById != "undefined" && !n) {
                        var r = t.getElementById(e[1]);
                        return r && r.parentNode ? [ r ] : [];
                    }
                },
                NAME: function(e, t) {
                    if (typeof t.getElementsByName != "undefined") {
                        var n = [], r = t.getElementsByName(e[1]);
                        for (var i = 0
, s = r.length; i < s; i++) r[i].getAttribute("name") === e[1] && n.push(r[i]);
                        return n.length === 0 ? null : n;
                    }
                },
                TAG: function(e, t) {
                    if (typeof t.getElementsByTagName != "undefined") return t.getElementsByTagName(e[1]);
                }
            },
            preFilter: {
                CLASS: function(e, t, n, r, i, s) {
                    e = " " + e[1].replace(f, "") + " ";
                    if (s) return e;
                    for (var o = 0, u; (u = t[o]) != null; o++) u && (i ^ (u.className && (" " + u.className + " ").replace(/[\t\n\r]/g, " ").indexOf(e) >= 0) ? n || r.push(u) : n && (t[o] = !1));
                    return !1;
                },
                ID: function(e) {
                    return e[1].replace(f, "");
                },
                TAG: function(e, t) {
                    return e[1].replace(f, "").toLowerCase();
                },
                
CHILD: function(e) {
                    if (e[1] === "nth") {
                        e[2] || h.error(e[0]), e[2] = e[2].replace(/^\+|\s*/g, "");
                        var t = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2] === "even" && "2n" || e[2] === "odd" && "2n+1" || !/\D/.test(e[2]) && "0n+" + e[2] || e[2]);
                        e[2] = t[1] + (t[2] || 1) - 0, e[3] = t[3] - 0;
                    } else e[2] && h.error(e[0]);
                    return e[0] = i++, e;
                },
                ATTR: function(e, t, n, r, i, s) {
                    var o = e[1] = e[1].replace(f, "");
                    return !s && d.attrMap[o] && (e[1] = d.attrMap[o]), e[4] = (e[4] || e[5] || "").replace(f, ""), e[2] === "~=" && (e[4] = " " + e[4] + " "), e;
                },
                PSEUDO: function(t, n, r, i, s) {
                    if (t[1] === "not") {
                        if (!((e.exec(t[3]) || "").length > 1 || /^\w/.test(t[3]))) {
                            var o = h.filter
(t[3], n, r, !0 ^ s);
                            return r || i.push.apply(i, o), !1;
                        }
                        t[3] = h(t[3], null, null, n);
                    } else if (d.match.POS.test(t[0]) || d.match.CHILD.test(t[0])) return !0;
                    return t;
                },
                POS: function(e) {
                    return e.unshift(!0), e;
                }
            },
            filters: {
                enabled: function(e) {
                    return e.disabled === !1 && e.type !== "hidden";
                },
                disabled: function(e) {
                    return e.disabled === !0;
                },
                checked: function(e) {
                    return e.checked === !0;
                },
                selected: function(e) {
                    return e.parentNode && e.parentNode.selectedIndex, e.selected === !0;
                },
                parent: function(e) {
                    return !!e.firstChild
;
                },
                empty: function(e) {
                    return !e.firstChild;
                },
                has: function(e, t, n) {
                    return !!h(n[3], e).length;
                },
                header: function(e) {
                    return /h\d/i.test(e.nodeName);
                },
                text: function(e) {
                    var t = e.getAttribute("type"), n = e.type;
                    return e.nodeName.toLowerCase() === "input" && "text" === n && (t === n || t === null);
                },
                radio: function(e) {
                    return e.nodeName.toLowerCase() === "input" && "radio" === e.type;
                },
                checkbox: function(e) {
                    return e.nodeName.toLowerCase() === "input" && "checkbox" === e.type;
                },
                file: function(e) {
                    return e.nodeName.toLowerCase() === "input" && "file" === e.type;
                },
                
password: function(e) {
                    return e.nodeName.toLowerCase() === "input" && "password" === e.type;
                },
                submit: function(e) {
                    var t = e.nodeName.toLowerCase();
                    return (t === "input" || t === "button") && "submit" === e.type;
                },
                image: function(e) {
                    return e.nodeName.toLowerCase() === "input" && "image" === e.type;
                },
                reset: function(e) {
                    var t = e.nodeName.toLowerCase();
                    return (t === "input" || t === "button") && "reset" === e.type;
                },
                button: function(e) {
                    var t = e.nodeName.toLowerCase();
                    return t === "input" && "button" === e.type || t === "button";
                },
                input: function(e) {
                    return /input|select|textarea|button/i.test(e.nodeName);
                },
                
focus: function(e) {
                    return e === e.ownerDocument.activeElement;
                }
            },
            setFilters: {
                first: function(e, t) {
                    return t === 0;
                },
                last: function(e, t, n, r) {
                    return t === r.length - 1;
                },
                even: function(e, t) {
                    return t % 2 === 0;
                },
                odd: function(e, t) {
                    return t % 2 === 1;
                },
                lt: function(e, t, n) {
                    return t < n[3] - 0;
                },
                gt: function(e, t, n) {
                    return t > n[3] - 0;
                },
                nth: function(e, t, n) {
                    return n[3] - 0 === t;
                },
                eq: function(e, t, n) {
                    return n[3] - 0 === t;
                }
            },
            filter: {
                
PSEUDO: function(e, t, n, r) {
                    var i = t[1], s = d.filters[i];
                    if (s) return s(e, n, t, r);
                    if (i === "contains") return (e.textContent || e.innerText || p([ e ]) || "").indexOf(t[3]) >= 0;
                    if (i === "not") {
                        var o = t[3];
                        for (var u = 0, a = o.length; u < a; u++) if (o[u] === e) return !1;
                        return !0;
                    }
                    h.error(i);
                },
                CHILD: function(e, t) {
                    var n, i, s, o, u, a, f, l = t[1], c = e;
                    switch (l) {
                      case "only":
                      case "first":
                        while (c = c.previousSibling) if (c.nodeType === 1) return !1;
                        if (l === "first") return !0;
                        c = e;
                      case "last":
                        while (c = c.nextSibling) if (c.nodeType === 1
) return !1;
                        return !0;
                      case "nth":
                        n = t[2], i = t[3];
                        if (n === 1 && i === 0) return !0;
                        s = t[0], o = e.parentNode;
                        if (o && (o[r] !== s || !e.nodeIndex)) {
                            a = 0;
                            for (c = o.firstChild; c; c = c.nextSibling) c.nodeType === 1 && (c.nodeIndex = ++a);
                            o[r] = s;
                        }
                        return f = e.nodeIndex - i, n === 0 ? f === 0 : f % n === 0 && f / n >= 0;
                    }
                },
                ID: function(e, t) {
                    return e.nodeType === 1 && e.getAttribute("id") === t;
                },
                TAG: function(e, t) {
                    return t === "*" && e.nodeType === 1 || !!e.nodeName && e.nodeName.toLowerCase() === t;
                },
                CLASS: function(e, t) {
                    
return (" " + (e.className || e.getAttribute("class")) + " ").indexOf(t) > -1;
                },
                ATTR: function(e, t) {
                    var n = t[1], r = h.attr ? h.attr(e, n) : d.attrHandle[n] ? d.attrHandle[n](e) : e[n] != null ? e[n] : e.getAttribute(n), i = r + "", s = t[2], o = t[4];
                    return r == null ? s === "!=" : !s && h.attr ? r != null : s === "=" ? i === o : s === "*=" ? i.indexOf(o) >= 0 : s === "~=" ? (" " + i + " ").indexOf(o) >= 0 : o ? s === "!=" ? i !== o : s === "^=" ? i.indexOf(o) === 0 : s === "$=" ? i.substr(i.length - o.length) === o : s === "|=" ? i === o || i.substr(0, o.length + 1) === o + "-" : !1 : i && r !== !1;
                },
                POS: function(e, t, n, r) {
                    var i = t[2], s = d.setFilters[i];
                    if (s) return s(e, n, t, r);
                }
            }
        }, v = d.match.POS, m = function(e, t) {
            return "\\" + (t - 0 + 1);
        };
        for (var g in 
d.match) d.match[g] = new RegExp(d.match[g].source + /(?![^\[]*\])(?![^\(]*\))/.source), d.leftMatch[g] = new RegExp(/(^(?:.|\r|\n)*?)/.source + d.match[g].source.replace(/\\(\d+)/g, m));
        d.match.globalPOS = v;
        var y = function(e, t) {
            return e = Array.prototype.slice.call(e, 0), t ? (t.push.apply(t, e), t) : e;
        };
        try {
            Array.prototype.slice.call(n.documentElement.childNodes, 0)[0].nodeType;
        } catch (b) {
            y = function(e, t) {
                var n = 0, r = t || [];
                if (o.call(e) === "[object Array]") Array.prototype.push.apply(r, e); else if (typeof e.length == "number") for (var i = e.length; n < i; n++) r.push(e[n]); else for (; e[n]; n++) r.push(e[n]);
                return r;
            };
        }
        var w, E;
        n.documentElement.compareDocumentPosition ? w = function(e, t) {
            return e === t ? (u = !0, 0) : !e.compareDocumentPosition || !t.compareDocumentPosition ? 
e.compareDocumentPosition ? -1 : 1 : e.compareDocumentPosition(t) & 4 ? -1 : 1;
        } : (w = function(e, t) {
            if (e === t) return u = !0, 0;
            if (e.sourceIndex && t.sourceIndex) return e.sourceIndex - t.sourceIndex;
            var n, r, i = [], s = [], o = e.parentNode, a = t.parentNode, f = o;
            if (o === a) return E(e, t);
            if (!o) return -1;
            if (!a) return 1;
            while (f) i.unshift(f), f = f.parentNode;
            f = a;
            while (f) s.unshift(f), f = f.parentNode;
            n = i.length, r = s.length;
            for (var l = 0; l < n && l < r; l++) if (i[l] !== s[l]) return E(i[l], s[l]);
            return l === n ? E(e, s[l], -1) : E(i[l], t, 1);
        }, E = function(e, t, n) {
            if (e === t) return n;
            var r = e.nextSibling;
            while (r) {
                if (r === t) return -1;
                r = r.nextSibling;
            }
            return 1;
        }), function(
) {
            var e = n.createElement("div"), r = "script" + (new Date).getTime(), i = n.documentElement;
            e.innerHTML = "<a name='" + r + "'/>", i.insertBefore(e, i.firstChild), n.getElementById(r) && (d.find.ID = function(e, n, r) {
                if (typeof n.getElementById != "undefined" && !r) {
                    var i = n.getElementById(e[1]);
                    return i ? i.id === e[1] || typeof i.getAttributeNode != "undefined" && i.getAttributeNode("id").nodeValue === e[1] ? [ i ] : t : [];
                }
            }, d.filter.ID = function(e, t) {
                var n = typeof e.getAttributeNode != "undefined" && e.getAttributeNode("id");
                return e.nodeType === 1 && n && n.nodeValue === t;
            }), i.removeChild(e), i = e = null;
        }(), function() {
            var e = n.createElement("div");
            e.appendChild(n.createComment("")), e.getElementsByTagName("*").length > 0 && (d.find.TAG = function(e, t) {
                
var n = t.getElementsByTagName(e[1]);
                if (e[1] === "*") {
                    var r = [];
                    for (var i = 0; n[i]; i++) n[i].nodeType === 1 && r.push(n[i]);
                    n = r;
                }
                return n;
            }), e.innerHTML = "<a href='#'></a>", e.firstChild && typeof e.firstChild.getAttribute != "undefined" && e.firstChild.getAttribute("href") !== "#" && (d.attrHandle.href = function(e) {
                return e.getAttribute("href", 2);
            }), e = null;
        }(), n.querySelectorAll && function() {
            var e = h, t = n.createElement("div"), r = "__sizzle__";
            t.innerHTML = "<p class='TEST'></p>";
            if (t.querySelectorAll && t.querySelectorAll(".TEST").length === 0) return;
            h = function(t, i, s, o) {
                i = i || n;
                if (!o && !h.isXML(i)) {
                    var u = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);
                    if (u && (
i.nodeType === 1 || i.nodeType === 9)) {
                        if (u[1]) return y(i.getElementsByTagName(t), s);
                        if (u[2] && d.find.CLASS && i.getElementsByClassName) return y(i.getElementsByClassName(u[2]), s);
                    }
                    if (i.nodeType === 9) {
                        if (t === "body" && i.body) return y([ i.body ], s);
                        if (u && u[3]) {
                            var a = i.getElementById(u[3]);
                            if (!a || !a.parentNode) return y([], s);
                            if (a.id === u[3]) return y([ a ], s);
                        }
                        try {
                            return y(i.querySelectorAll(t), s);
                        } catch (f) {}
                    } else if (i.nodeType === 1 && i.nodeName.toLowerCase() !== "object") {
                        var l = i, c = i.getAttribute("id"), p = c || r, v = i.parentNode, m = /^\s*[+~]/.test(t);
                        
c ? p = p.replace(/'/g, "\\$&") : i.setAttribute("id", p), m && v && (i = i.parentNode);
                        try {
                            if (!m || v) return y(i.querySelectorAll("[id='" + p + "'] " + t), s);
                        } catch (g) {} finally {
                            c || l.removeAttribute("id");
                        }
                    }
                }
                return e(t, i, s, o);
            };
            for (var i in e) h[i] = e[i];
            t = null;
        }(), function() {
            var e = n.documentElement, t = e.matchesSelector || e.mozMatchesSelector || e.webkitMatchesSelector || e.msMatchesSelector;
            if (t) {
                var r = !t.call(n.createElement("div"), "div"), i = !1;
                try {
                    t.call(n.documentElement, "[test!='']:sizzle");
                } catch (s) {
                    i = !0;
                }
                h.matchesSelector = function(e, n) {
                    
n = n.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']");
                    if (!h.isXML(e)) try {
                        if (i || !d.match.PSEUDO.test(n) && !/!=/.test(n)) {
                            var s = t.call(e, n);
                            if (s || !r || e.document && e.document.nodeType !== 11) return s;
                        }
                    } catch (o) {}
                    return h(n, null, null, [ e ]).length > 0;
                };
            }
        }(), function() {
            var e = n.createElement("div");
            e.innerHTML = "<div class='test e'></div><div class='test'></div>";
            if (!e.getElementsByClassName || e.getElementsByClassName("e").length === 0) return;
            e.lastChild.className = "e";
            if (e.getElementsByClassName("e").length === 1) return;
            d.order.splice(1, 0, "CLASS"), d.find.CLASS = function(e, t, n) {
                if (typeof t.getElementsByClassName != "undefined" && !n) return t.getElementsByClassName
(e[1]);
            }, e = null;
        }(), n.documentElement.contains ? h.contains = function(e, t) {
            return e !== t && (e.contains ? e.contains(t) : !0);
        } : n.documentElement.compareDocumentPosition ? h.contains = function(e, t) {
            return !!(e.compareDocumentPosition(t) & 16);
        } : h.contains = function() {
            return !1;
        }, h.isXML = function(e) {
            var t = (e ? e.ownerDocument || e : 0).documentElement;
            return t ? t.nodeName !== "HTML" : !1;
        };
        var T = function(e, t, n) {
            var r, i = [], s = "", o = t.nodeType ? [ t ] : t;
            while (r = d.match.PSEUDO.exec(e)) s += r[0], e = e.replace(d.match.PSEUDO, "");
            e = d.relative[e] ? e + "*" : e;
            for (var u = 0, a = o.length; u < a; u++) h(e, o[u], i, n);
            return h.filter(s, i);
        };
        h.attr = s.attr, h.selectors.attrMap = {}, s.find = h, s.expr = h.selectors, s.expr[":"] = s.expr.
filters, s.unique = h.uniqueSort, s.text = h.getText, s.isXMLDoc = h.isXML, s.contains = h.contains;
    }();
    var j = /Until$/, F = /^(?:parents|prevUntil|prevAll)/, I = /,/, q = /^.[^:#\[\.,]*$/, R = Array.prototype.slice, U = s.expr.match.globalPOS, z = {
        children: !0,
        contents: !0,
        next: !0,
        prev: !0
    };
    s.fn.extend({
        find: function(e) {
            var t = this, n, r;
            if (typeof e != "string") return s(e).filter(function() {
                for (n = 0, r = t.length; n < r; n++) if (s.contains(t[n], this)) return !0;
            });
            var i = this.pushStack("", "find", e), o, u, a;
            for (n = 0, r = this.length; n < r; n++) {
                o = i.length, s.find(e, this[n], i);
                if (n > 0) for (u = o; u < i.length; u++) for (a = 0; a < o; a++) if (i[a] === i[u]) {
                    i.splice(u--, 1);
                    break;
                }
            }
            return i;
        
},
        has: function(e) {
            var t = s(e);
            return this.filter(function() {
                for (var e = 0, n = t.length; e < n; e++) if (s.contains(this, t[e])) return !0;
            });
        },
        not: function(e) {
            return this.pushStack(X(this, e, !1), "not", e);
        },
        filter: function(e) {
            return this.pushStack(X(this, e, !0), "filter", e);
        },
        is: function(e) {
            return !!e && (typeof e == "string" ? U.test(e) ? s(e, this.context).index(this[0]) >= 0 : s.filter(e, this).length > 0 : this.filter(e).length > 0);
        },
        closest: function(e, t) {
            var n = [], r, i, o = this[0];
            if (s.isArray(e)) {
                var u = 1;
                while (o && o.ownerDocument && o !== t) {
                    for (r = 0; r < e.length; r++) s(o).is(e[r]) && n.push({
                        selector: e[r],
                        elem: o,
                        level: 
u
                    });
                    o = o.parentNode, u++;
                }
                return n;
            }
            var a = U.test(e) || typeof e != "string" ? s(e, t || this.context) : 0;
            for (r = 0, i = this.length; r < i; r++) {
                o = this[r];
                while (o) {
                    if (a ? a.index(o) > -1 : s.find.matchesSelector(o, e)) {
                        n.push(o);
                        break;
                    }
                    o = o.parentNode;
                    if (!o || !o.ownerDocument || o === t || o.nodeType === 11) break;
                }
            }
            return n = n.length > 1 ? s.unique(n) : n, this.pushStack(n, "closest", e);
        },
        index: function(e) {
            return e ? typeof e == "string" ? s.inArray(this[0], s(e)) : s.inArray(e.jquery ? e[0] : e, this) : this[0] && this[0].parentNode ? this.prevAll().length : -1;
        },
        add: function(e, t) {
            var n = typeof 
e == "string" ? s(e, t) : s.makeArray(e && e.nodeType ? [ e ] : e), r = s.merge(this.get(), n);
            return this.pushStack(W(n[0]) || W(r[0]) ? r : s.unique(r));
        },
        andSelf: function() {
            return this.add(this.prevObject);
        }
    }), s.each({
        parent: function(e) {
            var t = e.parentNode;
            return t && t.nodeType !== 11 ? t : null;
        },
        parents: function(e) {
            return s.dir(e, "parentNode");
        },
        parentsUntil: function(e, t, n) {
            return s.dir(e, "parentNode", n);
        },
        next: function(e) {
            return s.nth(e, 2, "nextSibling");
        },
        prev: function(e) {
            return s.nth(e, 2, "previousSibling");
        },
        nextAll: function(e) {
            return s.dir(e, "nextSibling");
        },
        prevAll: function(e) {
            return s.dir(e, "previousSibling");
        },
        nextUntil: function(e, t, n) {
            return s
.dir(e, "nextSibling", n);
        },
        prevUntil: function(e, t, n) {
            return s.dir(e, "previousSibling", n);
        },
        siblings: function(e) {
            return s.sibling((e.parentNode || {}).firstChild, e);
        },
        children: function(e) {
            return s.sibling(e.firstChild);
        },
        contents: function(e) {
            return s.nodeName(e, "iframe") ? e.contentDocument || e.contentWindow.document : s.makeArray(e.childNodes);
        }
    }, function(e, t) {
        s.fn[e] = function(n, r) {
            var i = s.map(this, t, n);
            return j.test(e) || (r = n), r && typeof r == "string" && (i = s.filter(r, i)), i = this.length > 1 && !z[e] ? s.unique(i) : i, (this.length > 1 || I.test(r)) && F.test(e) && (i = i.reverse()), this.pushStack(i, e, R.call(arguments).join(","));
        };
    }), s.extend({
        filter: function(e, t, n) {
            return n && (e = ":not(" + e + ")"), t.length === 1 ? s.find.matchesSelector
(t[0], e) ? [ t[0] ] : [] : s.find.matches(e, t);
        },
        dir: function(e, n, r) {
            var i = [], o = e[n];
            while (o && o.nodeType !== 9 && (r === t || o.nodeType !== 1 || !s(o).is(r))) o.nodeType === 1 && i.push(o), o = o[n];
            return i;
        },
        nth: function(e, t, n, r) {
            t = t || 1;
            var i = 0;
            for (; e; e = e[n]) if (e.nodeType === 1 && ++i === t) break;
            return e;
        },
        sibling: function(e, t) {
            var n = [];
            for (; e; e = e.nextSibling) e.nodeType === 1 && e !== t && n.push(e);
            return n;
        }
    });
    var $ = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", J = / jQuery\d+="(?:\d+|null)"/g, K = /^\s+/, Q = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig, G = /<([\w:]+)/, Y = /<tbody/i, Z = /<|&#?\w+;/
, et = /<(?:script|style)/i, tt = /<(?:script|object|embed|option|style)/i, nt = new RegExp("<(?:" + $ + ")[\\s/>]", "i"), rt = /checked\s*(?:[^=]|=\s*.checked.)/i, it = /\/(java|ecma)script/i, st = /^\s*<!(?:\[CDATA\[|\-\-)/, ot = {
        option: [ 1, "<select multiple='multiple'>", "</select>" ],
        legend: [ 1, "<fieldset>", "</fieldset>" ],
        thead: [ 1, "<table>", "</table>" ],
        tr: [ 2, "<table><tbody>", "</tbody></table>" ],
        td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],
        col: [ 2, "<table><tbody></tbody><colgroup>", "</colgroup></table>" ],
        area: [ 1, "<map>", "</map>" ],
        _default: [ 0, "", "" ]
    }, ut = V(n);
    ot.optgroup = ot.option, ot.tbody = ot.tfoot = ot.colgroup = ot.caption = ot.thead, ot.th = ot.td, s.support.htmlSerialize || (ot._default = [ 1, "div<div>", "</div>" ]), s.fn.extend({
        text: function(e) {
            return s.access(this, function(e) {
                return e === t ? s.text(this) 
: this.empty().append((this[0] && this[0].ownerDocument || n).createTextNode(e));
            }, null, e, arguments.length);
        },
        wrapAll: function(e) {
            if (s.isFunction(e)) return this.each(function(t) {
                s(this).wrapAll(e.call(this, t));
            });
            if (this[0]) {
                var t = s(e, this[0].ownerDocument).eq(0).clone(!0);
                this[0].parentNode && t.insertBefore(this[0]), t.map(function() {
                    var e = this;
                    while (e.firstChild && e.firstChild.nodeType === 1) e = e.firstChild;
                    return e;
                }).append(this);
            }
            return this;
        },
        wrapInner: function(e) {
            return s.isFunction(e) ? this.each(function(t) {
                s(this).wrapInner(e.call(this, t));
            }) : this.each(function() {
                var t = s(this), n = t.contents();
                n.length ? n.wrapAll(e) : t.append(e
);
            });
        },
        wrap: function(e) {
            var t = s.isFunction(e);
            return this.each(function(n) {
                s(this).wrapAll(t ? e.call(this, n) : e);
            });
        },
        unwrap: function() {
            return this.parent().each(function() {
                s.nodeName(this, "body") || s(this).replaceWith(this.childNodes);
            }).end();
        },
        append: function() {
            return this.domManip(arguments, !0, function(e) {
                this.nodeType === 1 && this.appendChild(e);
            });
        },
        prepend: function() {
            return this.domManip(arguments, !0, function(e) {
                this.nodeType === 1 && this.insertBefore(e, this.firstChild);
            });
        },
        before: function() {
            if (this[0] && this[0].parentNode) return this.domManip(arguments, !1, function(e) {
                this.parentNode.insertBefore(e, this);
            });
            
if (arguments.length) {
                var e = s.clean(arguments);
                return e.push.apply(e, this.toArray()), this.pushStack(e, "before", arguments);
            }
        },
        after: function() {
            if (this[0] && this[0].parentNode) return this.domManip(arguments, !1, function(e) {
                this.parentNode.insertBefore(e, this.nextSibling);
            });
            if (arguments.length) {
                var e = this.pushStack(this, "after", arguments);
                return e.push.apply(e, s.clean(arguments)), e;
            }
        },
        remove: function(e, t) {
            for (var n = 0, r; (r = this[n]) != null; n++) if (!e || s.filter(e, [ r ]).length) !t && r.nodeType === 1 && (s.cleanData(r.getElementsByTagName("*")), s.cleanData([ r ])), r.parentNode && r.parentNode.removeChild(r);
            return this;
        },
        empty: function() {
            for (var e = 0, t; (t = this[e]) != null; e++) {
                t.nodeType === 1 && 
s.cleanData(t.getElementsByTagName("*"));
                while (t.firstChild) t.removeChild(t.firstChild);
            }
            return this;
        },
        clone: function(e, t) {
            return e = e == null ? !1 : e, t = t == null ? e : t, this.map(function() {
                return s.clone(this, e, t);
            });
        },
        html: function(e) {
            return s.access(this, function(e) {
                var n = this[0] || {}, r = 0, i = this.length;
                if (e === t) return n.nodeType === 1 ? n.innerHTML.replace(J, "") : null;
                if (typeof e == "string" && !et.test(e) && (s.support.leadingWhitespace || !K.test(e)) && !ot[(G.exec(e) || [ "", "" ])[1].toLowerCase()]) {
                    e = e.replace(Q, "<$1></$2>");
                    try {
                        for (; r < i; r++) n = this[r] || {}, n.nodeType === 1 && (s.cleanData(n.getElementsByTagName("*")), n.innerHTML = e);
                        n = 0;
                    
} catch (o) {}
                }
                n && this.empty().append(e);
            }, null, e, arguments.length);
        },
        replaceWith: function(e) {
            return this[0] && this[0].parentNode ? s.isFunction(e) ? this.each(function(t) {
                var n = s(this), r = n.html();
                n.replaceWith(e.call(this, t, r));
            }) : (typeof e != "string" && (e = s(e).detach()), this.each(function() {
                var t = this.nextSibling, n = this.parentNode;
                s(this).remove(), t ? s(t).before(e) : s(n).append(e);
            })) : this.length ? this.pushStack(s(s.isFunction(e) ? e() : e), "replaceWith", e) : this;
        },
        detach: function(e) {
            return this.remove(e, !0);
        },
        domManip: function(e, n, r) {
            var i, o, u, a, f = e[0], l = [];
            if (!s.support.checkClone && arguments.length === 3 && typeof f == "string" && rt.test(f)) return this.each(function() {
                
s(this).domManip(e, n, r, !0);
            });
            if (s.isFunction(f)) return this.each(function(i) {
                var o = s(this);
                e[0] = f.call(this, i, n ? o.html() : t), o.domManip(e, n, r);
            });
            if (this[0]) {
                a = f && f.parentNode, s.support.parentNode && a && a.nodeType === 11 && a.childNodes.length === this.length ? i = {
                    fragment: a
                } : i = s.buildFragment(e, this, l), u = i.fragment, u.childNodes.length === 1 ? o = u = u.firstChild : o = u.firstChild;
                if (o) {
                    n = n && s.nodeName(o, "tr");
                    for (var c = 0, h = this.length, p = h - 1; c < h; c++) r.call(n ? at(this[c], o) : this[c], i.cacheable || h > 1 && c < p ? s.clone(u, !0, !0) : u);
                }
                l.length && s.each(l, function(e, t) {
                    t.src ? s.ajax({
                        type: "GET",
                        global: !1,
                        
url: t.src,
                        async: !1,
                        dataType: "script"
                    }) : s.globalEval((t.text || t.textContent || t.innerHTML || "").replace(st, "/*$0*/")), t.parentNode && t.parentNode.removeChild(t);
                });
            }
            return this;
        }
    }), s.buildFragment = function(e, t, r) {
        var i, o, u, a, f = e[0];
        return t && t[0] && (a = t[0].ownerDocument || t[0]), a.createDocumentFragment || (a = n), e.length === 1 && typeof f == "string" && f.length < 512 && a === n && f.charAt(0) === "<" && !tt.test(f) && (s.support.checkClone || !rt.test(f)) && (s.support.html5Clone || !nt.test(f)) && (o = !0, u = s.fragments[f], u && u !== 1 && (i = u)), i || (i = a.createDocumentFragment(), s.clean(e, a, i, r)), o && (s.fragments[f] = u ? i : 1), {
            fragment: i,
            cacheable: o
        };
    }, s.fragments = {}, s.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore
: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(e, t) {
        s.fn[e] = function(n) {
            var r = [], i = s(n), o = this.length === 1 && this[0].parentNode;
            if (o && o.nodeType === 11 && o.childNodes.length === 1 && i.length === 1) return i[t](this[0]), this;
            for (var u = 0, a = i.length; u < a; u++) {
                var f = (u > 0 ? this.clone(!0) : this).get();
                s(i[u])[t](f), r = r.concat(f);
            }
            return this.pushStack(r, e, i.selector);
        };
    }), s.extend({
        clone: function(e, t, n) {
            var r, i, o, u = s.support.html5Clone || s.isXMLDoc(e) || !nt.test("<" + e.nodeName + ">") ? e.cloneNode(!0) : dt(e);
            if ((!s.support.noCloneEvent || !s.support.noCloneChecked) && (e.nodeType === 1 || e.nodeType === 11) && !s.isXMLDoc(e)) {
                lt(e, u), r = ct(e), i = ct(u);
                for (o = 0; r[o]; ++o) i[o] && lt(r[o], i[o]);
            
}
            if (t) {
                ft(e, u);
                if (n) {
                    r = ct(e), i = ct(u);
                    for (o = 0; r[o]; ++o) ft(r[o], i[o]);
                }
            }
            return r = i = null, u;
        },
        clean: function(e, t, r, i) {
            var o, u, a, f = [];
            t = t || n, typeof t.createElement == "undefined" && (t = t.ownerDocument || t[0] && t[0].ownerDocument || n);
            for (var l = 0, c; (c = e[l]) != null; l++) {
                typeof c == "number" && (c += "");
                if (!c) continue;
                if (typeof c == "string") if (!Z.test(c)) c = t.createTextNode(c); else {
                    c = c.replace(Q, "<$1></$2>");
                    var h = (G.exec(c) || [ "", "" ])[1].toLowerCase(), p = ot[h] || ot._default, d = p[0], v = t.createElement("div"), m = ut.childNodes, g;
                    t === n ? ut.appendChild(v) : V(t).appendChild(v), v.innerHTML = p[1] + c + p[2];
                    
while (d--) v = v.lastChild;
                    if (!s.support.tbody) {
                        var y = Y.test(c), b = h === "table" && !y ? v.firstChild && v.firstChild.childNodes : p[1] === "<table>" && !y ? v.childNodes : [];
                        for (a = b.length - 1; a >= 0; --a) s.nodeName(b[a], "tbody") && !b[a].childNodes.length && b[a].parentNode.removeChild(b[a]);
                    }
                    !s.support.leadingWhitespace && K.test(c) && v.insertBefore(t.createTextNode(K.exec(c)[0]), v.firstChild), c = v.childNodes, v && (v.parentNode.removeChild(v), m.length > 0 && (g = m[m.length - 1], g && g.parentNode && g.parentNode.removeChild(g)));
                }
                var w;
                if (!s.support.appendChecked) if (c[0] && typeof (w = c.length) == "number") for (a = 0; a < w; a++) pt(c[a]); else pt(c);
                c.nodeType ? f.push(c) : f = s.merge(f, c);
            }
            if (r) {
                o = function(e) {
                    
return !e.type || it.test(e.type);
                };
                for (l = 0; f[l]; l++) {
                    u = f[l];
                    if (i && s.nodeName(u, "script") && (!u.type || it.test(u.type))) i.push(u.parentNode ? u.parentNode.removeChild(u) : u); else {
                        if (u.nodeType === 1) {
                            var E = s.grep(u.getElementsByTagName("script"), o);
                            f.splice.apply(f, [ l + 1, 0 ].concat(E));
                        }
                        r.appendChild(u);
                    }
                }
            }
            return f;
        },
        cleanData: function(e) {
            var t, n, r = s.cache, i = s.event.special, o = s.support.deleteExpando;
            for (var u = 0, a; (a = e[u]) != null; u++) {
                if (a.nodeName && s.noData[a.nodeName.toLowerCase()]) continue;
                n = a[s.expando];
                if (n) {
                    t = r[n];
                    if (t && 
t.events) {
                        for (var f in t.events) i[f] ? s.event.remove(a, f) : s.removeEvent(a, f, t.handle);
                        t.handle && (t.handle.elem = null);
                    }
                    o ? delete a[s.expando] : a.removeAttribute && a.removeAttribute(s.expando), delete r[n];
                }
            }
        }
    });
    var vt = /alpha\([^)]*\)/i, mt = /opacity=([^)]*)/, gt = /([A-Z]|^ms)/g, yt = /^[\-+]?(?:\d*\.)?\d+$/i, bt = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, wt = /^([\-+])=([\-+.\de]+)/, Et = /^margin/, St = {
        position: "absolute",
        visibility: "hidden",
        display: "block"
    }, xt = [ "Top", "Right", "Bottom", "Left" ], Tt, Nt, Ct;
    s.fn.css = function(e, n) {
        return s.access(this, function(e, n, r) {
            return r !== t ? s.style(e, n, r) : s.css(e, n);
        }, e, n, arguments.length > 1);
    }, s.extend({
        cssHooks: {
            opacity: {
                get: function(e, t) {
                    
if (t) {
                        var n = Tt(e, "opacity");
                        return n === "" ? "1" : n;
                    }
                    return e.style.opacity;
                }
            }
        },
        cssNumber: {
            fillOpacity: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {
            "float": s.support.cssFloat ? "cssFloat" : "styleFloat"
        },
        style: function(e, n, r, i) {
            if (!e || e.nodeType === 3 || e.nodeType === 8 || !e.style) return;
            var o, u, a = s.camelCase(n), f = e.style, l = s.cssHooks[a];
            n = s.cssProps[a] || a;
            if (r === t) return l && "get" in l && (o = l.get(e, !1, i)) !== t ? o : f[n];
            u = typeof r, u === "string" && (o = wt.exec(r)) && (r = +(o[1] + 1) * +o[2] + parseFloat(s.css(e, n)), u = "number"
);
            if (r == null || u === "number" && isNaN(r)) return;
            u === "number" && !s.cssNumber[a] && (r += "px");
            if (!l || !("set" in l) || (r = l.set(e, r)) !== t) try {
                f[n] = r;
            } catch (c) {}
        },
        css: function(e, n, r) {
            var i, o;
            n = s.camelCase(n), o = s.cssHooks[n], n = s.cssProps[n] || n, n === "cssFloat" && (n = "float");
            if (o && "get" in o && (i = o.get(e, !0, r)) !== t) return i;
            if (Tt) return Tt(e, n);
        },
        swap: function(e, t, n) {
            var r = {}, i, s;
            for (s in t) r[s] = e.style[s], e.style[s] = t[s];
            i = n.call(e);
            for (s in t) e.style[s] = r[s];
            return i;
        }
    }), s.curCSS = s.css, n.defaultView && n.defaultView.getComputedStyle && (Nt = function(e, t) {
        var n, r, i, o, u = e.style;
        return t = t.replace(gt, "-$1").toLowerCase(), (r = e.ownerDocument.defaultView
) && (i = r.getComputedStyle(e, null)) && (n = i.getPropertyValue(t), n === "" && !s.contains(e.ownerDocument.documentElement, e) && (n = s.style(e, t))), !s.support.pixelMargin && i && Et.test(t) && bt.test(n) && (o = u.width, u.width = n, n = i.width, u.width = o), n;
    }), n.documentElement.currentStyle && (Ct = function(e, t) {
        var n, r, i, s = e.currentStyle && e.currentStyle[t], o = e.style;
        return s == null && o && (i = o[t]) && (s = i), bt.test(s) && (n = o.left, r = e.runtimeStyle && e.runtimeStyle.left, r && (e.runtimeStyle.left = e.currentStyle.left), o.left = t === "fontSize" ? "1em" : s, s = o.pixelLeft + "px", o.left = n, r && (e.runtimeStyle.left = r)), s === "" ? "auto" : s;
    }), Tt = Nt || Ct, s.each([ "height", "width" ], function(e, t) {
        s.cssHooks[t] = {
            get: function(e, n, r) {
                if (n) return e.offsetWidth !== 0 ? kt(e, t, r) : s.swap(e, St, function() {
                    return kt(e, t, r);
                }
);
            },
            set: function(e, t) {
                return yt.test(t) ? t + "px" : t;
            }
        };
    }), s.support.opacity || (s.cssHooks.opacity = {
        get: function(e, t) {
            return mt.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : t ? "1" : "";
        },
        set: function(e, t) {
            var n = e.style, r = e.currentStyle, i = s.isNumeric(t) ? "alpha(opacity=" + t * 100 + ")" : "", o = r && r.filter || n.filter || "";
            n.zoom = 1;
            if (t >= 1 && s.trim(o.replace(vt, "")) === "") {
                n.removeAttribute("filter");
                if (r && !r.filter) return;
            }
            n.filter = vt.test(o) ? o.replace(vt, i) : o + " " + i;
        }
    }), s(function() {
        s.support.reliableMarginRight || (s.cssHooks.marginRight = {
            get: function(e, t) {
                return s.swap(e, {
                    display: "inline-block"
                
}, function() {
                    return t ? Tt(e, "margin-right") : e.style.marginRight;
                });
            }
        });
    }), s.expr && s.expr.filters && (s.expr.filters.hidden = function(e) {
        var t = e.offsetWidth, n = e.offsetHeight;
        return t === 0 && n === 0 || !s.support.reliableHiddenOffsets && (e.style && e.style.display || s.css(e, "display")) === "none";
    }, s.expr.filters.visible = function(e) {
        return !s.expr.filters.hidden(e);
    }), s.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(e, t) {
        s.cssHooks[e + t] = {
            expand: function(n) {
                var r, i = typeof n == "string" ? n.split(" ") : [ n ], s = {};
                for (r = 0; r < 4; r++) s[e + xt[r] + t] = i[r] || i[r - 2] || i[0];
                return s;
            }
        };
    });
    var Lt = /%20/g, At = /\[\]$/, Ot = /\r?\n/g, Mt = /#.*$/, _t = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, Dt = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i
, Pt = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, Ht = /^(?:GET|HEAD)$/, Bt = /^\/\//, jt = /\?/, Ft = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, It = /^(?:select|textarea)/i, qt = /\s+/, Rt = /([?&])_=[^&]*/, Ut = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, zt = s.fn.load, Wt = {}, Xt = {}, Vt, $t, Jt = [ "*/" ] + [ "*" ];
    try {
        Vt = i.href;
    } catch (Kt) {
        Vt = n.createElement("a"), Vt.href = "", Vt = Vt.href;
    }
    $t = Ut.exec(Vt.toLowerCase()) || [], s.fn.extend({
        load: function(e, n, r) {
            if (typeof e != "string" && zt) return zt.apply(this, arguments);
            if (!this.length) return this;
            var i = e.indexOf(" ");
            if (i >= 0) {
                var o = e.slice(i, e.length);
                e = e.slice(0, i);
            }
            var u = "GET";
            n && (s.isFunction(n) ? (r = n, n = t) : typeof n == "object" && (n = s.param(n, s.ajaxSettings.traditional), u = "POST"
));
            var a = this;
            return s.ajax({
                url: e,
                type: u,
                dataType: "html",
                data: n,
                complete: function(e, t, n) {
                    n = e.responseText, e.isResolved() && (e.done(function(e) {
                        n = e;
                    }), a.html(o ? s("<div>").append(n.replace(Ft, "")).find(o) : n)), r && a.each(r, [ n, t, e ]);
                }
            }), this;
        },
        serialize: function() {
            return s.param(this.serializeArray());
        },
        serializeArray: function() {
            return this.map(function() {
                return this.elements ? s.makeArray(this.elements) : this;
            }).filter(function() {
                return this.name && !this.disabled && (this.checked || It.test(this.nodeName) || Dt.test(this.type));
            }).map(function(e, t) {
                var n = s(this).val();
                return n == null ? null 
: s.isArray(n) ? s.map(n, function(e, n) {
                    return {
                        name: t.name,
                        value: e.replace(Ot, "\r\n")
                    };
                }) : {
                    name: t.name,
                    value: n.replace(Ot, "\r\n")
                };
            }).get();
        }
    }), s.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(e, t) {
        s.fn[t] = function(e) {
            return this.on(t, e);
        };
    }), s.each([ "get", "post" ], function(e, n) {
        s[n] = function(e, r, i, o) {
            return s.isFunction(r) && (o = o || i, i = r, r = t), s.ajax({
                type: n,
                url: e,
                data: r,
                success: i,
                dataType: o
            });
        };
    }), s.extend({
        getScript: function(e, n) {
            return s.get(e, t, n, "script");
        },
        getJSON: function(e, t, n) {
            
return s.get(e, t, n, "json");
        },
        ajaxSetup: function(e, t) {
            return t ? Yt(e, s.ajaxSettings) : (t = e, e = s.ajaxSettings), Yt(e, t), e;
        },
        ajaxSettings: {
            url: Vt,
            isLocal: Pt.test($t[1]),
            global: !0,
            type: "GET",
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            processData: !0,
            async: !0,
            accepts: {
                xml: "application/xml, text/xml",
                html: "text/html",
                text: "text/plain",
                json: "application/json, text/javascript",
                "*": Jt
            },
            contents: {
                xml: /xml/,
                html: /html/,
                json: /json/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText"
            },
            converters: {
                "* text": e.String,
                "text html"
: !0,
                "text json": s.parseJSON,
                "text xml": s.parseXML
            },
            flatOptions: {
                context: !0,
                url: !0
            }
        },
        ajaxPrefilter: Qt(Wt),
        ajaxTransport: Qt(Xt),
        ajax: function(e, n) {
            function S(e, n, c, h) {
                if (y === 2) return;
                y = 2, m && clearTimeout(m), v = t, p = h || "", E.readyState = e > 0 ? 4 : 0;
                var d, g, w, S = n, x = c ? en(r, E, c) : t, T, N;
                if (e >= 200 && e < 300 || e === 304) {
                    if (r.ifModified) {
                        if (T = E.getResponseHeader("Last-Modified")) s.lastModified[l] = T;
                        if (N = E.getResponseHeader("Etag")) s.etag[l] = N;
                    }
                    if (e === 304) S = "notmodified", d = !0; else try {
                        g = tn(r, x), S = "success", d = !0;
                    } catch (C) {
                        
S = "parsererror", w = C;
                    }
                } else {
                    w = S;
                    if (!S || e) S = "error", e < 0 && (e = 0);
                }
                E.status = e, E.statusText = "" + (n || S), d ? u.resolveWith(i, [ g, S, E ]) : u.rejectWith(i, [ E, S, w ]), E.statusCode(f), f = t, b && o.trigger("ajax" + (d ? "Success" : "Error"), [ E, r, d ? g : w ]), a.fireWith(i, [ E, S ]), b && (o.trigger("ajaxComplete", [ E, r ]), --s.active || s.event.trigger("ajaxStop"));
            }
            typeof e == "object" && (n = e, e = t), n = n || {};
            var r = s.ajaxSetup({}, n), i = r.context || r, o = i !== r && (i.nodeType || i instanceof s) ? s(i) : s.event, u = s.Deferred(), a = s.Callbacks("once memory"), f = r.statusCode || {}, l, c = {}, h = {}, p, d, v, m, g, y = 0, b, w, E = {
                readyState: 0,
                setRequestHeader: function(e, t) {
                    if (!y) {
                        var n = e.toLowerCase
();
                        e = h[n] = h[n] || e, c[e] = t;
                    }
                    return this;
                },
                getAllResponseHeaders: function() {
                    return y === 2 ? p : null;
                },
                getResponseHeader: function(e) {
                    var n;
                    if (y === 2) {
                        if (!d) {
                            d = {};
                            while (n = _t.exec(p)) d[n[1].toLowerCase()] = n[2];
                        }
                        n = d[e.toLowerCase()];
                    }
                    return n === t ? null : n;
                },
                overrideMimeType: function(e) {
                    return y || (r.mimeType = e), this;
                },
                abort: function(e) {
                    return e = e || "abort", v && v.abort(e), S(0, e), this;
                }
            };
            u.promise(E), E.success = E.done, E.error = 
E.fail, E.complete = a.add, E.statusCode = function(e) {
                if (e) {
                    var t;
                    if (y < 2) for (t in e) f[t] = [ f[t], e[t] ]; else t = e[E.status], E.then(t, t);
                }
                return this;
            }, r.url = ((e || r.url) + "").replace(Mt, "").replace(Bt, $t[1] + "//"), r.dataTypes = s.trim(r.dataType || "*").toLowerCase().split(qt), r.crossDomain == null && (g = Ut.exec(r.url.toLowerCase()), r.crossDomain = !(!g || g[1] == $t[1] && g[2] == $t[2] && (g[3] || (g[1] === "http:" ? 80 : 443)) == ($t[3] || ($t[1] === "http:" ? 80 : 443)))), r.data && r.processData && typeof r.data != "string" && (r.data = s.param(r.data, r.traditional)), Gt(Wt, r, n, E);
            if (y === 2) return !1;
            b = r.global, r.type = r.type.toUpperCase(), r.hasContent = !Ht.test(r.type), b && s.active++ === 0 && s.event.trigger("ajaxStart");
            if (!r.hasContent) {
                r.data && (r.url += (jt.test(r.url) ? "&" 
: "?") + r.data, delete r.data), l = r.url;
                if (r.cache === !1) {
                    var x = s.now(), T = r.url.replace(Rt, "$1_=" + x);
                    r.url = T + (T === r.url ? (jt.test(r.url) ? "&" : "?") + "_=" + x : "");
                }
            }
            (r.data && r.hasContent && r.contentType !== !1 || n.contentType) && E.setRequestHeader("Content-Type", r.contentType), r.ifModified && (l = l || r.url, s.lastModified[l] && E.setRequestHeader("If-Modified-Since", s.lastModified[l]), s.etag[l] && E.setRequestHeader("If-None-Match", s.etag[l])), E.setRequestHeader("Accept", r.dataTypes[0] && r.accepts[r.dataTypes[0]] ? r.accepts[r.dataTypes[0]] + (r.dataTypes[0] !== "*" ? ", " + Jt + "; q=0.01" : "") : r.accepts["*"]);
            for (w in r.headers) E.setRequestHeader(w, r.headers[w]);
            if (!r.beforeSend || r.beforeSend.call(i, E, r) !== !1 && y !== 2) {
                for (w in {
                    success: 1,
                    error
: 1,
                    complete: 1
                }) E[w](r[w]);
                v = Gt(Xt, r, n, E);
                if (!v) S(-1, "No Transport"); else {
                    E.readyState = 1, b && o.trigger("ajaxSend", [ E, r ]), r.async && r.timeout > 0 && (m = setTimeout(function() {
                        E.abort("timeout");
                    }, r.timeout));
                    try {
                        y = 1, v.send(c, S);
                    } catch (N) {
                        if (!(y < 2)) throw N;
                        S(-1, N);
                    }
                }
                return E;
            }
            return E.abort(), !1;
        },
        param: function(e, n) {
            var r = [], i = function(e, t) {
                t = s.isFunction(t) ? t() : t, r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t);
            };
            n === t && (n = s.ajaxSettings.traditional);
            if (s.isArray(e) || e.jquery && !s.isPlainObject
(e)) s.each(e, function() {
                i(this.name, this.value);
            }); else for (var o in e) Zt(o, e[o], n, i);
            return r.join("&").replace(Lt, "+");
        }
    }), s.extend({
        active: 0,
        lastModified: {},
        etag: {}
    });
    var nn = s.now(), rn = /(\=)\?(&|$)|\?\?/i;
    s.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            return s.expando + "_" + nn++;
        }
    }), s.ajaxPrefilter("json jsonp", function(t, n, r) {
        var i = typeof t.data == "string" && /^application\/x\-www\-form\-urlencoded/.test(t.contentType);
        if (t.dataTypes[0] === "jsonp" || t.jsonp !== !1 && (rn.test(t.url) || i && rn.test(t.data))) {
            var o, u = t.jsonpCallback = s.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, a = e[u], f = t.url, l = t.data, c = "$1" + u + "$2";
            return t.jsonp !== !1 && (f = f.replace(rn, c), t.url === f && (i && (l = l.replace(rn, c)), t.data === 
l && (f += (/\?/.test(f) ? "&" : "?") + t.jsonp + "=" + u))), t.url = f, t.data = l, e[u] = function(e) {
                o = [ e ];
            }, r.always(function() {
                e[u] = a, o && s.isFunction(a) && e[u](o[0]);
            }), t.converters["script json"] = function() {
                return o || s.error(u + " was not called"), o[0];
            }, t.dataTypes[0] = "json", "script";
        }
    }), s.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /javascript|ecmascript/
        },
        converters: {
            "text script": function(e) {
                return s.globalEval(e), e;
            }
        }
    }), s.ajaxPrefilter("script", function(e) {
        e.cache === t && (e.cache = !1), e.crossDomain && (e.type = "GET", e.global = !1);
    }), s.ajaxTransport("script", function(e) {
        if (e.crossDomain) {
            
var r, i = n.head || n.getElementsByTagName("head")[0] || n.documentElement;
            return {
                send: function(s, o) {
                    r = n.createElement("script"), r.async = "async", e.scriptCharset && (r.charset = e.scriptCharset), r.src = e.url, r.onload = r.onreadystatechange = function(e, n) {
                        if (n || !r.readyState || /loaded|complete/.test(r.readyState)) r.onload = r.onreadystatechange = null, i && r.parentNode && i.removeChild(r), r = t, n || o(200, "success");
                    }, i.insertBefore(r, i.firstChild);
                },
                abort: function() {
                    r && r.onload(0, 1);
                }
            };
        }
    });
    var sn = e.ActiveXObject ? function() {
        for (var e in un) un[e](0, 1);
    } : !1, on = 0, un;
    s.ajaxSettings.xhr = e.ActiveXObject ? function() {
        return !this.isLocal && an() || fn();
    } : an, function(e) {
        s.extend(s.support, {
            
ajax: !!e,
            cors: !!e && "withCredentials" in e
        });
    }(s.ajaxSettings.xhr()), s.support.ajax && s.ajaxTransport(function(n) {
        if (!n.crossDomain || s.support.cors) {
            var r;
            return {
                send: function(i, o) {
                    var u = n.xhr(), a, f;
                    n.username ? u.open(n.type, n.url, n.async, n.username, n.password) : u.open(n.type, n.url, n.async);
                    if (n.xhrFields) for (f in n.xhrFields) u[f] = n.xhrFields[f];
                    n.mimeType && u.overrideMimeType && u.overrideMimeType(n.mimeType), !n.crossDomain && !i["X-Requested-With"] && (i["X-Requested-With"] = "XMLHttpRequest");
                    try {
                        for (f in i) u.setRequestHeader(f, i[f]);
                    } catch (l) {}
                    u.send(n.hasContent && n.data || null), r = function(e, i) {
                        var f, l, c, h, p;
                        try {
                            
if (r && (i || u.readyState === 4)) {
                                r = t, a && (u.onreadystatechange = s.noop, sn && delete un[a]);
                                if (i) u.readyState !== 4 && u.abort(); else {
                                    f = u.status, c = u.getAllResponseHeaders(), h = {}, p = u.responseXML, p && p.documentElement && (h.xml = p);
                                    try {
                                        h.text = u.responseText;
                                    } catch (e) {}
                                    try {
                                        l = u.statusText;
                                    } catch (d) {
                                        l = "";
                                    }
                                    !f && n.isLocal && !n.crossDomain ? f = h.text ? 200 : 404 : f === 1223 && (f = 204);
                                }
                            }
                        } catch (v) {
                            
i || o(-1, v);
                        }
                        h && o(f, l, h, c);
                    }, !n.async || u.readyState === 4 ? r() : (a = ++on, sn && (un || (un = {}, s(e).unload(sn)), un[a] = r), u.onreadystatechange = r);
                },
                abort: function() {
                    r && r(0, 1);
                }
            };
        }
    });
    var ln = {}, cn, hn, pn = /^(?:toggle|show|hide)$/, dn = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, vn, mn = [ [ "height", "marginTop", "marginBottom", "paddingTop", "paddingBottom" ], [ "width", "marginLeft", "marginRight", "paddingLeft", "paddingRight" ], [ "opacity" ] ], gn;
    s.fn.extend({
        show: function(e, t, n) {
            var r, i;
            if (e || e === 0) return this.animate(wn("show", 3), e, t, n);
            for (var o = 0, u = this.length; o < u; o++) r = this[o], r.style && (i = r.style.display, !s._data(r, "olddisplay") && i === "none" && (i = r.style.display = ""), (i === "" && s.css(r, "display"
) === "none" || !s.contains(r.ownerDocument.documentElement, r)) && s._data(r, "olddisplay", En(r.nodeName)));
            for (o = 0; o < u; o++) {
                r = this[o];
                if (r.style) {
                    i = r.style.display;
                    if (i === "" || i === "none") r.style.display = s._data(r, "olddisplay") || "";
                }
            }
            return this;
        },
        hide: function(e, t, n) {
            if (e || e === 0) return this.animate(wn("hide", 3), e, t, n);
            var r, i, o = 0, u = this.length;
            for (; o < u; o++) r = this[o], r.style && (i = s.css(r, "display"), i !== "none" && !s._data(r, "olddisplay") && s._data(r, "olddisplay", i));
            for (o = 0; o < u; o++) this[o].style && (this[o].style.display = "none");
            return this;
        },
        _toggle: s.fn.toggle,
        toggle: function(e, t, n) {
            var r = typeof e == "boolean";
            return s.isFunction(e) && s.
isFunction(t) ? this._toggle.apply(this, arguments) : e == null || r ? this.each(function() {
                var t = r ? e : s(this).is(":hidden");
                s(this)[t ? "show" : "hide"]();
            }) : this.animate(wn("toggle", 3), e, t, n), this;
        },
        fadeTo: function(e, t, n, r) {
            return this.filter(":hidden").css("opacity", 0).show().end().animate({
                opacity: t
            }, e, n, r);
        },
        animate: function(e, t, n, r) {
            function o() {
                i.queue === !1 && s._mark(this);
                var t = s.extend({}, i), n = this.nodeType === 1, r = n && s(this).is(":hidden"), o, u, a, f, l, c, h, p, d, v, m;
                t.animatedProperties = {};
                for (a in e) {
                    o = s.camelCase(a), a !== o && (e[o] = e[a], delete e[a]);
                    if ((l = s.cssHooks[o]) && "expand" in l) {
                        c = l.expand(e[o]), delete e[o];
                        
for (a in c) a in e || (e[a] = c[a]);
                    }
                }
                for (o in e) {
                    u = e[o], s.isArray(u) ? (t.animatedProperties[o] = u[1], u = e[o] = u[0]) : t.animatedProperties[o] = t.specialEasing && t.specialEasing[o] || t.easing || "swing";
                    if (u === "hide" && r || u === "show" && !r) return t.complete.call(this);
                    n && (o === "height" || o === "width") && (t.overflow = [ this.style.overflow, this.style.overflowX, this.style.overflowY ], s.css(this, "display") === "inline" && s.css(this, "float") === "none" && (!s.support.inlineBlockNeedsLayout || En(this.nodeName) === "inline" ? this.style.display = "inline-block" : this.style.zoom = 1));
                }
                t.overflow != null && (this.style.overflow = "hidden");
                for (a in e) f = new s.fx(this, t, a), u = e[a], pn.test(u) ? (m = s._data(this, "toggle" + a) || (u === "toggle" ? r ? "show" : "hide" : 0), m ? (s._data(
this, "toggle" + a, m === "show" ? "hide" : "show"), f[m]()) : f[u]()) : (h = dn.exec(u), p = f.cur(), h ? (d = parseFloat(h[2]), v = h[3] || (s.cssNumber[a] ? "" : "px"), v !== "px" && (s.style(this, a, (d || 1) + v), p = (d || 1) / f.cur() * p, s.style(this, a, p + v)), h[1] && (d = (h[1] === "-=" ? -1 : 1) * d + p), f.custom(p, d, v)) : f.custom(p, u, ""));
                return !0;
            }
            var i = s.speed(t, n, r);
            return s.isEmptyObject(e) ? this.each(i.complete, [ !1 ]) : (e = s.extend({}, e), i.queue === !1 ? this.each(o) : this.queue(i.queue, o));
        },
        stop: function(e, n, r) {
            return typeof e != "string" && (r = n, n = e, e = t), n && e !== !1 && this.queue(e || "fx", []), this.each(function() {
                function u(e, t, n) {
                    var i = t[n];
                    s.removeData(e, n, !0), i.stop(r);
                }
                var t, n = !1, i = s.timers, o = s._data(this);
                r || 
s._unmark(!0, this);
                if (e == null) for (t in o) o[t] && o[t].stop && t.indexOf(".run") === t.length - 4 && u(this, o, t); else o[t = e + ".run"] && o[t].stop && u(this, o, t);
                for (t = i.length; t--; ) i[t].elem === this && (e == null || i[t].queue === e) && (r ? i[t](!0) : i[t].saveState(), n = !0, i.splice(t, 1));
                (!r || !n) && s.dequeue(this, e);
            });
        }
    }), s.each({
        slideDown: wn("show", 1),
        slideUp: wn("hide", 1),
        slideToggle: wn("toggle", 1),
        fadeIn: {
            opacity: "show"
        },
        fadeOut: {
            opacity: "hide"
        },
        fadeToggle: {
            opacity: "toggle"
        }
    }, function(e, t) {
        s.fn[e] = function(e, n, r) {
            return this.animate(t, e, n, r);
        };
    }), s.extend({
        speed: function(e, t, n) {
            var r = e && typeof e == "object" ? s.extend({}, e) : {
                complete: n || !n && 
t || s.isFunction(e) && e,
                duration: e,
                easing: n && t || t && !s.isFunction(t) && t
            };
            r.duration = s.fx.off ? 0 : typeof r.duration == "number" ? r.duration : r.duration in s.fx.speeds ? s.fx.speeds[r.duration] : s.fx.speeds._default;
            if (r.queue == null || r.queue === !0) r.queue = "fx";
            return r.old = r.complete, r.complete = function(e) {
                s.isFunction(r.old) && r.old.call(this), r.queue ? s.dequeue(this, r.queue) : e !== !1 && s._unmark(this);
            }, r;
        },
        easing: {
            linear: function(e) {
                return e;
            },
            swing: function(e) {
                return -Math.cos(e * Math.PI) / 2 + .5;
            }
        },
        timers: [],
        fx: function(e, t, n) {
            this.options = t, this.elem = e, this.prop = n, t.orig = t.orig || {};
        }
    }), s.fx.prototype = {
        update: function() {
            this
.options.step && this.options.step.call(this.elem, this.now, this), (s.fx.step[this.prop] || s.fx.step._default)(this);
        },
        cur: function() {
            if (this.elem[this.prop] == null || !!this.elem.style && this.elem.style[this.prop] != null) {
                var e, t = s.css(this.elem, this.prop);
                return isNaN(e = parseFloat(t)) ? !t || t === "auto" ? 0 : t : e;
            }
            return this.elem[this.prop];
        },
        custom: function(e, n, r) {
            function u(e) {
                return i.step(e);
            }
            var i = this, o = s.fx;
            this.startTime = gn || yn(), this.end = n, this.now = this.start = e, this.pos = this.state = 0, this.unit = r || this.unit || (s.cssNumber[this.prop] ? "" : "px"), u.queue = this.options.queue, u.elem = this.elem, u.saveState = function() {
                s._data(i.elem, "fxshow" + i.prop) === t && (i.options.hide ? s._data(i.elem, "fxshow" + i.prop, i.start) : i.options
.show && s._data(i.elem, "fxshow" + i.prop, i.end));
            }, u() && s.timers.push(u) && !vn && (vn = setInterval(o.tick, o.interval));
        },
        show: function() {
            var e = s._data(this.elem, "fxshow" + this.prop);
            this.options.orig[this.prop] = e || s.style(this.elem, this.prop), this.options.show = !0, e !== t ? this.custom(this.cur(), e) : this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()), s(this.elem).show();
        },
        hide: function() {
            this.options.orig[this.prop] = s._data(this.elem, "fxshow" + this.prop) || s.style(this.elem, this.prop), this.options.hide = !0, this.custom(this.cur(), 0);
        },
        step: function(e) {
            var t, n, r, i = gn || yn(), o = !0, u = this.elem, a = this.options;
            if (e || i >= a.duration + this.startTime) {
                this.now = this.end, this.pos = this.state = 1, this.update(), a.animatedProperties[this.prop] = !0;
                
for (t in a.animatedProperties) a.animatedProperties[t] !== !0 && (o = !1);
                if (o) {
                    a.overflow != null && !s.support.shrinkWrapBlocks && s.each([ "", "X", "Y" ], function(e, t) {
                        u.style["overflow" + t] = a.overflow[e];
                    }), a.hide && s(u).hide();
                    if (a.hide || a.show) for (t in a.animatedProperties) s.style(u, t, a.orig[t]), s.removeData(u, "fxshow" + t, !0), s.removeData(u, "toggle" + t, !0);
                    r = a.complete, r && (a.complete = !1, r.call(u));
                }
                return !1;
            }
            return a.duration == Infinity ? this.now = i : (n = i - this.startTime, this.state = n / a.duration, this.pos = s.easing[a.animatedProperties[this.prop]](this.state, n, 0, 1, a.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update(), !0;
        }
    }, s.extend(s.fx, {
        tick: function() {
            var e, t = s.timers, 
n = 0;
            for (; n < t.length; n++) e = t[n], !e() && t[n] === e && t.splice(n--, 1);
            t.length || s.fx.stop();
        },
        interval: 13,
        stop: function() {
            clearInterval(vn), vn = null;
        },
        speeds: {
            slow: 600,
            fast: 200,
            _default: 400
        },
        step: {
            opacity: function(e) {
                s.style(e.elem, "opacity", e.now);
            },
            _default: function(e) {
                e.elem.style && e.elem.style[e.prop] != null ? e.elem.style[e.prop] = e.now + e.unit : e.elem[e.prop] = e.now;
            }
        }
    }), s.each(mn.concat.apply([], mn), function(e, t) {
        t.indexOf("margin") && (s.fx.step[t] = function(e) {
            s.style(e.elem, t, Math.max(0, e.now) + e.unit);
        });
    }), s.expr && s.expr.filters && (s.expr.filters.animated = function(e) {
        return s.grep(s.timers, function(t) {
            return e === t.elem;
        
}).length;
    });
    var Sn, xn = /^t(?:able|d|h)$/i, Tn = /^(?:body|html)$/i;
    "getBoundingClientRect" in n.documentElement ? Sn = function(e, t, n, r) {
        try {
            r = e.getBoundingClientRect();
        } catch (i) {}
        if (!r || !s.contains(n, e)) return r ? {
            top: r.top,
            left: r.left
        } : {
            top: 0,
            left: 0
        };
        var o = t.body, u = Nn(t), a = n.clientTop || o.clientTop || 0, f = n.clientLeft || o.clientLeft || 0, l = u.pageYOffset || s.support.boxModel && n.scrollTop || o.scrollTop, c = u.pageXOffset || s.support.boxModel && n.scrollLeft || o.scrollLeft, h = r.top + l - a, p = r.left + c - f;
        return {
            top: h,
            left: p
        };
    } : Sn = function(e, t, n) {
        var r, i = e.offsetParent, o = e, u = t.body, a = t.defaultView, f = a ? a.getComputedStyle(e, null) : e.currentStyle, l = e.offsetTop, c = e.offsetLeft;
        while ((e = e.parentNode) && e !== 
u && e !== n) {
            if (s.support.fixedPosition && f.position === "fixed") break;
            r = a ? a.getComputedStyle(e, null) : e.currentStyle, l -= e.scrollTop, c -= e.scrollLeft, e === i && (l += e.offsetTop, c += e.offsetLeft, s.support.doesNotAddBorder && (!s.support.doesAddBorderForTableAndCells || !xn.test(e.nodeName)) && (l += parseFloat(r.borderTopWidth) || 0, c += parseFloat(r.borderLeftWidth) || 0), o = i, i = e.offsetParent), s.support.subtractsBorderForOverflowNotVisible && r.overflow !== "visible" && (l += parseFloat(r.borderTopWidth) || 0, c += parseFloat(r.borderLeftWidth) || 0), f = r;
        }
        if (f.position === "relative" || f.position === "static") l += u.offsetTop, c += u.offsetLeft;
        return s.support.fixedPosition && f.position === "fixed" && (l += Math.max(n.scrollTop, u.scrollTop), c += Math.max(n.scrollLeft, u.scrollLeft)), {
            top: l,
            left: c
        };
    }, s.fn.offset = function(e) {
        if (arguments.length
) return e === t ? this : this.each(function(t) {
            s.offset.setOffset(this, e, t);
        });
        var n = this[0], r = n && n.ownerDocument;
        return r ? n === r.body ? s.offset.bodyOffset(n) : Sn(n, r, r.documentElement) : null;
    }, s.offset = {
        bodyOffset: function(e) {
            var t = e.offsetTop, n = e.offsetLeft;
            return s.support.doesNotIncludeMarginInBodyOffset && (t += parseFloat(s.css(e, "marginTop")) || 0, n += parseFloat(s.css(e, "marginLeft")) || 0), {
                top: t,
                left: n
            };
        },
        setOffset: function(e, t, n) {
            var r = s.css(e, "position");
            r === "static" && (e.style.position = "relative");
            var i = s(e), o = i.offset(), u = s.css(e, "top"), a = s.css(e, "left"), f = (r === "absolute" || r === "fixed") && s.inArray("auto", [ u, a ]) > -1, l = {}, c = {}, h, p;
            f ? (c = i.position(), h = c.top, p = c.left) : (h = parseFloat(u) || 0
, p = parseFloat(a) || 0), s.isFunction(t) && (t = t.call(e, n, o)), t.top != null && (l.top = t.top - o.top + h), t.left != null && (l.left = t.left - o.left + p), "using" in t ? t.using.call(e, l) : i.css(l);
        }
    }, s.fn.extend({
        position: function() {
            if (!this[0]) return null;
            var e = this[0], t = this.offsetParent(), n = this.offset(), r = Tn.test(t[0].nodeName) ? {
                top: 0,
                left: 0
            } : t.offset();
            return n.top -= parseFloat(s.css(e, "marginTop")) || 0, n.left -= parseFloat(s.css(e, "marginLeft")) || 0, r.top += parseFloat(s.css(t[0], "borderTopWidth")) || 0, r.left += parseFloat(s.css(t[0], "borderLeftWidth")) || 0, {
                top: n.top - r.top,
                left: n.left - r.left
            };
        },
        offsetParent: function() {
            return this.map(function() {
                var e = this.offsetParent || n.body;
                while (e && !Tn.test(e.nodeName
) && s.css(e, "position") === "static") e = e.offsetParent;
                return e;
            });
        }
    }), s.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(e, n) {
        var r = /Y/.test(n);
        s.fn[e] = function(i) {
            return s.access(this, function(e, i, o) {
                var u = Nn(e);
                if (o === t) return u ? n in u ? u[n] : s.support.boxModel && u.document.documentElement[i] || u.document.body[i] : e[i];
                u ? u.scrollTo(r ? s(u).scrollLeft() : o, r ? o : s(u).scrollTop()) : e[i] = o;
            }, e, i, arguments.length, null);
        };
    }), s.each({
        Height: "height",
        Width: "width"
    }, function(e, n) {
        var r = "client" + e, i = "scroll" + e, o = "offset" + e;
        s.fn["inner" + e] = function() {
            var e = this[0];
            return e ? e.style ? parseFloat(s.css(e, n, "padding")) : this[n]() : null;
        }, s.fn["outer" + e] = 
function(e) {
            var t = this[0];
            return t ? t.style ? parseFloat(s.css(t, n, e ? "margin" : "border")) : this[n]() : null;
        }, s.fn[n] = function(e) {
            return s.access(this, function(e, n, u) {
                var a, f, l, c;
                if (s.isWindow(e)) return a = e.document, f = a.documentElement[r], s.support.boxModel && f || a.body && a.body[r] || f;
                if (e.nodeType === 9) return a = e.documentElement, a[r] >= a[i] ? a[r] : Math.max(e.body[i], a[i], e.body[o], a[o]);
                if (u === t) return l = s.css(e, n), c = parseFloat(l), s.isNumeric(c) ? c : l;
                s(e).css(n, u);
            }, n, e, arguments.length, null);
        };
    }), e.jQuery = e.$ = s, typeof fielddb.define == "function" && fielddb.define.amd && fielddb.define.amd.jQuery && fielddb.define("jquery", [], function() {
        return s;
    });
}(window), !function(e) {
    e(function() {
        e.support.transition = function() {
            
var e = function() {
                var e = document.createElement("bootstrap"), t = {
                    WebkitTransition: "webkitTransitionEnd",
                    MozTransition: "transitionend",
                    OTransition: "oTransitionEnd",
                    msTransition: "MSTransitionEnd",
                    transition: "transitionend"
                }, n;
                for (n in t) if (e.style[n] !== undefined) return t[n];
            }();
            return e && {
                end: e
            };
        }();
    });
}(window.jQuery), !function(e) {
    function n() {
        var t = this, n = setTimeout(function() {
            t.$element.off(e.support.transition.end), r.call(t);
        }, 500);
        this.$element.one(e.support.transition.end, function() {
            clearTimeout(n), r.call(t);
        });
    }
    function r(e) {
        this.$element.hide().trigger("hidden"), i.call(this);
    }
    function i(t) {
        var n = this, r = this.$element
.hasClass("fade") ? "fade" : "";
        if (this.isShown && this.options.backdrop) {
            var i = e.support.transition && r;
            this.$backdrop = e('<div class="modal-backdrop ' + r + '" />').appendTo(document.body), this.options.backdrop != "static" && this.$backdrop.click(e.proxy(this.hide, this)), i && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), i ? this.$backdrop.one(e.support.transition.end, t) : t();
        } else !this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), e.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(e.support.transition.end, e.proxy(s, this)) : s.call(this)) : t && t();
    }
    function s() {
        this.$backdrop.remove(), this.$backdrop = null;
    }
    function o() {
        var t = this;
        this.isShown && this.options.keyboard ? e(document).on("keyup.dismiss.modal", function(e) {
            e.which == 27 && t.hide();
        }) : this.isShown || e(document).off("keyup.dismiss.modal"
);
    }
    var t = function(t, n) {
        this.options = n, this.$element = e(t).delegate('[data-dismiss="modal"]', "click.dismiss.modal", e.proxy(this.hide, this));
    };
    t.prototype = {
        constructor: t,
        toggle: function() {
            return this[this.isShown ? "hide" : "show"]();
        },
        show: function() {
            var t = this, n = e.Event("show");
            this.$element.trigger(n);
            if (this.isShown || n.isDefaultPrevented()) return;
            e("body").addClass("modal-open"), this.isShown = !0, o.call(this), i.call(this, function() {
                var n = e.support.transition && t.$element.hasClass("fade");
                t.$element.parent().length || t.$element.appendTo(document.body), t.$element.show(), n && t.$element[0].offsetWidth, t.$element.addClass("in"), n ? t.$element.one(e.support.transition.end, function() {
                    t.$element.trigger("shown");
                }) : t.$element.trigger("shown");
            
});
        },
        hide: function(t) {
            t && t.preventDefault();
            var i = this;
            t = e.Event("hide"), this.$element.trigger(t);
            if (!this.isShown || t.isDefaultPrevented()) return;
            this.isShown = !1, e("body").removeClass("modal-open"), o.call(this), this.$element.removeClass("in"), e.support.transition && this.$element.hasClass("fade") ? n.call(this) : r.call(this);
        }
    }, e.fn.modal = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("modal"), s = e.extend({}, e.fn.modal.defaults, r.data(), typeof n == "object" && n);
            i || r.data("modal", i = new t(this, s)), typeof n == "string" ? i[n]() : s.show && i.show();
        });
    }, e.fn.modal.defaults = {
        backdrop: !0,
        keyboard: !0,
        show: !0
    }, e.fn.modal.Constructor = t, e(function() {
        e("body").on("click.modal.data-api", '[data-toggle="modal"]', function(t) {
            var n = 
e(this), r, i = e(n.attr("data-target") || (r = n.attr("href")) && r.replace(/.*(?=#[^\s]+$)/, "")), s = i.data("modal") ? "toggle" : e.extend({}, i.data(), n.data());
            t.preventDefault(), i.modal(s);
        });
    });
}(window.jQuery), !function(e) {
    function r() {
        e(t).parent().removeClass("open");
    }
    var t = '[data-toggle="dropdown"]', n = function(t) {
        var n = e(t).on("click.dropdown.data-api", this.toggle);
        e("html").on("click.dropdown.data-api", function() {
            n.parent().removeClass("open");
        });
    };
    n.prototype = {
        constructor: n,
        toggle: function(t) {
            var n = e(this), i, s, o;
            if (n.is(".disabled, :disabled")) return;
            return s = n.attr("data-target"), s || (s = n.attr("href"), s = s && s.replace(/.*(?=#[^\s]*$)/, "")), i = e(s), i.length || (i = n.parent()), o = i.hasClass("open"), r(), o || i.toggleClass("open"), !1;
        }
    }, e.fn.dropdown = function(
t) {
        return this.each(function() {
            var r = e(this), i = r.data("dropdown");
            i || r.data("dropdown", i = new n(this)), typeof t == "string" && i[t].call(r);
        });
    }, e.fn.dropdown.Constructor = n, e(function() {
        e("html").on("click.dropdown.data-api", r), e("body").on("click.dropdown", ".dropdown form", function(e) {
            e.stopPropagation();
        }).on("click.dropdown.data-api", t, n.prototype.toggle);
    });
}(window.jQuery), !function(e) {
    function t(t, n) {
        var r = e.proxy(this.process, this), i = e(t).is("body") ? e(window) : e(t), s;
        this.options = e.extend({}, e.fn.scrollspy.defaults, n), this.$scrollElement = i.on("scroll.scroll.data-api", r), this.selector = (this.options.target || (s = e(t).attr("href")) && s.replace(/.*(?=#[^\s]+$)/, "") || "") + " .nav li > a", this.$body = e("body"), this.refresh(), this.process();
    }
    t.prototype = {
        constructor: t,
        refresh: function() {
            
var t = this, n;
            this.offsets = e([]), this.targets = e([]), n = this.$body.find(this.selector).map(function() {
                var t = e(this), n = t.data("target") || t.attr("href"), r = /^#\w/.test(n) && e(n);
                return r && n.length && [ [ r.position().top, n ] ] || null;
            }).sort(function(e, t) {
                return e[0] - t[0];
            }).each(function() {
                t.offsets.push(this[0]), t.targets.push(this[1]);
            });
        },
        process: function() {
            var e = this.$scrollElement.scrollTop() + this.options.offset, t = this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight, n = t - this.$scrollElement.height(), r = this.offsets, i = this.targets, s = this.activeTarget, o;
            if (e >= n) return s != (o = i.last()[0]) && this.activate(o);
            for (o = r.length; o--; ) s != i[o] && e >= r[o] && (!r[o + 1] || e <= r[o + 1]) && this.activate(i[o]);
        },
        activate: function(
t) {
            var n, r;
            this.activeTarget = t, e(this.selector).parent(".active").removeClass("active"), r = this.selector + '[data-target="' + t + '"],' + this.selector + '[href="' + t + '"]', n = e(r).parent("li").addClass("active"), n.parent(".dropdown-menu") && (n = n.closest("li.dropdown").addClass("active")), n.trigger("activate");
        }
    }, e.fn.scrollspy = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("scrollspy"), s = typeof n == "object" && n;
            i || r.data("scrollspy", i = new t(this, s)), typeof n == "string" && i[n]();
        });
    }, e.fn.scrollspy.Constructor = t, e.fn.scrollspy.defaults = {
        offset: 10
    }, e(function() {
        e('[data-spy="scroll"]').each(function() {
            var t = e(this);
            t.scrollspy(t.data());
        });
    });
}(window.jQuery), !function(e) {
    var t = function(t) {
        this.element = e(t);
    };
    t.prototype = {
        constructor
: t,
        show: function() {
            var t = this.element, n = t.closest("ul:not(.dropdown-menu)"), r = t.attr("data-target"), i, s, o;
            r || (r = t.attr("href"), r = r && r.replace(/.*(?=#[^\s]*$)/, ""));
            if (t.parent("li").hasClass("active")) return;
            i = n.find(".active a").last()[0], o = e.Event("show", {
                relatedTarget: i
            }), t.trigger(o);
            if (o.isDefaultPrevented()) return;
            s = e(r), this.activate(t.parent("li"), n), this.activate(s, s.parent(), function() {
                t.trigger({
                    type: "shown",
                    relatedTarget: i
                });
            });
        },
        activate: function(t, n, r) {
            function o() {
                i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"), t.addClass("active"), s ? (t[0].offsetWidth, t.addClass("in")) : t.removeClass("fade"), t.parent(".dropdown-menu") && t.closest("li.dropdown"
).addClass("active"), r && r();
            }
            var i = n.find("> .active"), s = r && e.support.transition && i.hasClass("fade");
            s ? i.one(e.support.transition.end, o) : o(), i.removeClass("in");
        }
    }, e.fn.tab = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("tab");
            i || r.data("tab", i = new t(this)), typeof n == "string" && i[n]();
        });
    }, e.fn.tab.Constructor = t, e(function() {
        e("body").on("click.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', function(t) {
            t.preventDefault(), e(this).tab("show");
        });
    });
}(window.jQuery), !function(e) {
    var t = function(e, t) {
        this.init("tooltip", e, t);
    };
    t.prototype = {
        constructor: t,
        init: function(t, n, r) {
            var i, s;
            this.type = t, this.$element = e(n), this.options = this.getOptions(r), this.enabled = !0, this.options.trigger != "manual" && 
(i = this.options.trigger == "hover" ? "mouseenter" : "focus", s = this.options.trigger == "hover" ? "mouseleave" : "blur", this.$element.on(i, this.options.selector, e.proxy(this.enter, this)), this.$element.on(s, this.options.selector, e.proxy(this.leave, this))), this.options.selector ? this._options = e.extend({}, this.options, {
                trigger: "manual",
                selector: ""
            }) : this.fixTitle();
        },
        getOptions: function(t) {
            return t = e.extend({}, e.fn[this.type].defaults, t, this.$element.data()), t.delay && typeof t.delay == "number" && (t.delay = {
                show: t.delay,
                hide: t.delay
            }), t;
        },
        enter: function(t) {
            var n = e(t.currentTarget)[this.type](this._options).data(this.type);
            if (!n.options.delay || !n.options.delay.show) return n.show();
            clearTimeout(this.timeout), n.hoverState = "in", this.timeout = setTimeout(function() {
                
n.hoverState == "in" && n.show();
            }, n.options.delay.show);
        },
        leave: function(t) {
            var n = e(t.currentTarget)[this.type](this._options).data(this.type);
            this.timeout && clearTimeout(this.timeout);
            if (!n.options.delay || !n.options.delay.hide) return n.hide();
            n.hoverState = "out", this.timeout = setTimeout(function() {
                n.hoverState == "out" && n.hide();
            }, n.options.delay.hide);
        },
        show: function() {
            var e, t, n, r, i, s, o;
            if (this.hasContent() && this.enabled) {
                e = this.tip(), this.setContent(), this.options.animation && e.addClass("fade"), s = typeof this.options.placement == "function" ? this.options.placement.call(this, e[0], this.$element[0]) : this.options.placement, t = /in/.test(s), e.remove().css({
                    top: 0,
                    left: 0,
                    display: "block"
                }).appendTo
(t ? this.$element : document.body), n = this.getPosition(t), r = e[0].offsetWidth, i = e[0].offsetHeight;
                switch (t ? s.split(" ")[1] : s) {
                  case "bottom":
                    o = {
                        top: n.top + n.height,
                        left: n.left + n.width / 2 - r / 2
                    };
                    break;
                  case "top":
                    o = {
                        top: n.top - i,
                        left: n.left + n.width / 2 - r / 2
                    };
                    break;
                  case "left":
                    o = {
                        top: n.top + n.height / 2 - i / 2,
                        left: n.left - r
                    };
                    break;
                  case "right":
                    o = {
                        top: n.top + n.height / 2 - i / 2,
                        left: n.left + n.width
                    };
                }
                
e.css(o).addClass(s).addClass("in");
            }
        },
        isHTML: function(e) {
            return typeof e != "string" || e.charAt(0) === "<" && e.charAt(e.length - 1) === ">" && e.length >= 3 || /^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e);
        },
        setContent: function() {
            var e = this.tip(), t = this.getTitle();
            e.find(".tooltip-inner")[this.isHTML(t) ? "html" : "text"](t), e.removeClass("fade in top bottom left right");
        },
        hide: function() {
            function r() {
                var t = setTimeout(function() {
                    n.off(e.support.transition.end).remove();
                }, 500);
                n.one(e.support.transition.end, function() {
                    clearTimeout(t), n.remove();
                });
            }
            var t = this, n = this.tip();
            n.removeClass("in"), e.support.transition && this.$tip.hasClass("fade") ? r() : n.remove();
        },
        fixTitle: function() {
            
var e = this.$element;
            (e.attr("title") || typeof e.attr("data-original-title") != "string") && e.attr("data-original-title", e.attr("title") || "").removeAttr("title");
        },
        hasContent: function() {
            return this.getTitle();
        },
        getPosition: function(t) {
            return e.extend({}, t ? {
                top: 0,
                left: 0
            } : this.$element.offset(), {
                width: this.$element[0].offsetWidth,
                height: this.$element[0].offsetHeight
            });
        },
        getTitle: function() {
            var e, t = this.$element, n = this.options;
            return e = t.attr("data-original-title") || (typeof n.title == "function" ? n.title.call(t[0]) : n.title), e;
        },
        tip: function() {
            return this.$tip = this.$tip || e(this.options.template);
        },
        validate: function() {
            this.$element[0].parentNode || (this.hide(), this.$element = 
null, this.options = null);
        },
        enable: function() {
            this.enabled = !0;
        },
        disable: function() {
            this.enabled = !1;
        },
        toggleEnabled: function() {
            this.enabled = !this.enabled;
        },
        toggle: function() {
            this[this.tip().hasClass("in") ? "hide" : "show"]();
        }
    }, e.fn.tooltip = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("tooltip"), s = typeof n == "object" && n;
            i || r.data("tooltip", i = new t(this, s)), typeof n == "string" && i[n]();
        });
    }, e.fn.tooltip.Constructor = t, e.fn.tooltip.defaults = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover",
        title: "",
        delay: 0
    };
}(window.jQuery), !function(e) {
    var t = function(
e, t) {
        this.init("popover", e, t);
    };
    t.prototype = e.extend({}, e.fn.tooltip.Constructor.prototype, {
        constructor: t,
        setContent: function() {
            var e = this.tip(), t = this.getTitle(), n = this.getContent();
            e.find(".popover-title")[this.isHTML(t) ? "html" : "text"](t), e.find(".popover-content > *")[this.isHTML(n) ? "html" : "text"](n), e.removeClass("fade top bottom left right in");
        },
        hasContent: function() {
            return this.getTitle() || this.getContent();
        },
        getContent: function() {
            var e, t = this.$element, n = this.options;
            return e = t.attr("data-content") || (typeof n.content == "function" ? n.content.call(t[0]) : n.content), e;
        },
        tip: function() {
            return this.$tip || (this.$tip = e(this.options.template)), this.$tip;
        }
    }), e.fn.popover = function(n) {
        return this.each(function() {
            var r = e(this), 
i = r.data("popover"), s = typeof n == "object" && n;
            i || r.data("popover", i = new t(this, s)), typeof n == "string" && i[n]();
        });
    }, e.fn.popover.Constructor = t, e.fn.popover.defaults = e.extend({}, e.fn.tooltip.defaults, {
        placement: "right",
        content: "",
        template: '<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'
    });
}(window.jQuery), !function(e) {
    var t = '[data-dismiss="alert"]', n = function(n) {
        e(n).on("click", t, this.close);
    };
    n.prototype.close = function(t) {
        function s() {
            i.trigger("closed").remove();
        }
        var n = e(this), r = n.attr("data-target"), i;
        r || (r = n.attr("href"), r = r && r.replace(/.*(?=#[^\s]*$)/, "")), i = e(r), t && t.preventDefault(), i.length || (i = n.hasClass("alert") ? n : n.parent()), i.trigger(t = e.Event("close"));
        
if (t.isDefaultPrevented()) return;
        i.removeClass("in"), e.support.transition && i.hasClass("fade") ? i.on(e.support.transition.end, s) : s();
    }, e.fn.alert = function(t) {
        return this.each(function() {
            var r = e(this), i = r.data("alert");
            i || r.data("alert", i = new n(this)), typeof t == "string" && i[t].call(r);
        });
    }, e.fn.alert.Constructor = n, e(function() {
        e("body").on("click.alert.data-api", t, n.prototype.close);
    });
}(window.jQuery), !function(e) {
    var t = function(t, n) {
        this.$element = e(t), this.options = e.extend({}, e.fn.button.defaults, n);
    };
    t.prototype.setState = function(e) {
        var t = "disabled", n = this.$element, r = n.data(), i = n.is("input") ? "val" : "html";
        e += "Text", r.resetText || n.data("resetText", n[i]()), n[i](r[e] || this.options[e]), setTimeout(function() {
            e == "loadingText" ? n.addClass(t).attr(t, t) : n.removeClass(t).removeAttr(t)
;
        }, 0);
    }, t.prototype.toggle = function() {
        var e = this.$element.parent('[data-toggle="buttons-radio"]');
        e && e.find(".active").removeClass("active"), this.$element.toggleClass("active");
    }, e.fn.button = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("button"), s = typeof n == "object" && n;
            i || r.data("button", i = new t(this, s)), n == "toggle" ? i.toggle() : n && i.setState(n);
        });
    }, e.fn.button.defaults = {
        loadingText: "loading..."
    }, e.fn.button.Constructor = t, e(function() {
        e("body").on("click.button.data-api", "[data-toggle^=button]", function(t) {
            var n = e(t.target);
            n.hasClass("btn") || (n = n.closest(".btn")), n.button("toggle");
        });
    });
}(window.jQuery), !function(e) {
    var t = function(t, n) {
        this.$element = e(t), this.options = e.extend({}, e.fn.collapse.defaults, n), this.options.parent && (this.
$parent = e(this.options.parent)), this.options.toggle && this.toggle();
    };
    t.prototype = {
        constructor: t,
        dimension: function() {
            var e = this.$element.hasClass("width");
            return e ? "width" : "height";
        },
        show: function() {
            var t, n, r, i;
            if (this.transitioning) return;
            t = this.dimension(), n = e.camelCase([ "scroll", t ].join("-")), r = this.$parent && this.$parent.find("> .accordion-group > .in");
            if (r && r.length) {
                i = r.data("collapse");
                if (i && i.transitioning) return;
                r.collapse("hide"), i || r.data("collapse", null);
            }
            this.$element[t](0), this.transition("addClass", e.Event("show"), "shown"), this.$element[t](this.$element[0][n]);
        },
        hide: function() {
            var t;
            if (this.transitioning) return;
            t = this.dimension(), this.reset(this.$element[t](
)), this.transition("removeClass", e.Event("hide"), "hidden"), this.$element[t](0);
        },
        reset: function(e) {
            var t = this.dimension();
            return this.$element.removeClass("collapse")[t](e || "auto")[0].offsetWidth, this.$element[e !== null ? "addClass" : "removeClass"]("collapse"), this;
        },
        transition: function(t, n, r) {
            var i = this, s = function() {
                n.type == "show" && i.reset(), i.transitioning = 0, i.$element.trigger(r);
            };
            this.$element.trigger(n);
            if (n.isDefaultPrevented()) return;
            this.transitioning = 1, this.$element[t]("in"), e.support.transition && this.$element.hasClass("collapse") ? this.$element.one(e.support.transition.end, s) : s();
        },
        toggle: function() {
            this[this.$element.hasClass("in") ? "hide" : "show"]();
        }
    }, e.fn.collapse = function(n) {
        return this.each(function() {
            var r = e(
this), i = r.data("collapse"), s = typeof n == "object" && n;
            i || r.data("collapse", i = new t(this, s)), typeof n == "string" && i[n]();
        });
    }, e.fn.collapse.defaults = {
        toggle: !0
    }, e.fn.collapse.Constructor = t, e(function() {
        e("body").on("click.collapse.data-api", "[data-toggle=collapse]", function(t) {
            var n = e(this), r, i = n.attr("data-target") || t.preventDefault() || (r = n.attr("href")) && r.replace(/.*(?=#[^\s]+$)/, ""), s = e(i).data("collapse") ? "toggle" : n.data();
            e(i).collapse(s);
        });
    });
}(window.jQuery), !function(e) {
    var t = function(t, n) {
        this.$element = e(t), this.options = n, this.options.slide && this.slide(this.options.slide), this.options.pause == "hover" && this.$element.on("mouseenter", e.proxy(this.pause, this)).on("mouseleave", e.proxy(this.cycle, this));
    };
    t.prototype = {
        cycle: function(t) {
            return t || (this.paused = !1), this.
options.interval && !this.paused && (this.interval = setInterval(e.proxy(this.next, this), this.options.interval)), this;
        },
        to: function(t) {
            var n = this.$element.find(".active"), r = n.parent().children(), i = r.index(n), s = this;
            if (t > r.length - 1 || t < 0) return;
            return this.sliding ? this.$element.one("slid", function() {
                s.to(t);
            }) : i == t ? this.pause().cycle() : this.slide(t > i ? "next" : "prev", e(r[t]));
        },
        pause: function(e) {
            return e || (this.paused = !0), clearInterval(this.interval), this.interval = null, this;
        },
        next: function() {
            if (this.sliding) return;
            return this.slide("next");
        },
        prev: function() {
            if (this.sliding) return;
            return this.slide("prev");
        },
        slide: function(t, n) {
            var r = this.$element.find(".active"), i = n || r[t](), s = this.interval
, o = t == "next" ? "left" : "right", u = t == "next" ? "first" : "last", a = this, f = e.Event("slide");
            this.sliding = !0, s && this.pause(), i = i.length ? i : this.$element.find(".item")[u]();
            if (i.hasClass("active")) return;
            if (e.support.transition && this.$element.hasClass("slide")) {
                this.$element.trigger(f);
                if (f.isDefaultPrevented()) return;
                i.addClass(t), i[0].offsetWidth, r.addClass(o), i.addClass(o), this.$element.one(e.support.transition.end, function() {
                    i.removeClass([ t, o ].join(" ")).addClass("active"), r.removeClass([ "active", o ].join(" ")), a.sliding = !1, setTimeout(function() {
                        a.$element.trigger("slid");
                    }, 0);
                });
            } else {
                this.$element.trigger(f);
                if (f.isDefaultPrevented()) return;
                r.removeClass("active"), i.addClass("active"), this.sliding = !1
, this.$element.trigger("slid");
            }
            return s && this.cycle(), this;
        }
    }, e.fn.carousel = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("carousel"), s = e.extend({}, e.fn.carousel.defaults, typeof n == "object" && n);
            i || r.data("carousel", i = new t(this, s)), typeof n == "number" ? i.to(n) : typeof n == "string" || (n = s.slide) ? i[n]() : s.interval && i.cycle();
        });
    }, e.fn.carousel.defaults = {
        interval: 5e3,
        pause: "hover"
    }, e.fn.carousel.Constructor = t, e(function() {
        e("body").on("click.carousel.data-api", "[data-slide]", function(t) {
            var n = e(this), r, i = e(n.attr("data-target") || (r = n.attr("href")) && r.replace(/.*(?=#[^\s]+$)/, "")), s = !i.data("modal") && e.extend({}, i.data(), n.data());
            i.carousel(s), t.preventDefault();
        });
    });
}(window.jQuery), !function(e) {
    var t = function(t, n) {
        
this.$element = e(t), this.options = e.extend({}, e.fn.typeahead.defaults, n), this.matcher = this.options.matcher || this.matcher, this.sorter = this.options.sorter || this.sorter, this.highlighter = this.options.highlighter || this.highlighter, this.updater = this.options.updater || this.updater, this.$menu = e(this.options.menu).appendTo("body"), this.source = this.options.source, this.shown = !1, this.listen();
    };
    t.prototype = {
        constructor: t,
        select: function() {
            var e = this.$menu.find(".active").attr("data-value");
            return this.$element.val(this.updater(e)).change(), this.hide();
        },
        updater: function(e) {
            return e;
        },
        show: function() {
            var t = e.extend({}, this.$element.offset(), {
                height: this.$element[0].offsetHeight
            });
            return this.$menu.css({
                top: t.top + t.height,
                left: t.left
            }), this.$menu
.show(), this.shown = !0, this;
        },
        hide: function() {
            return this.$menu.hide(), this.shown = !1, this;
        },
        lookup: function(t) {
            var n = this, r, i;
            return this.query = this.$element.val(), this.query ? (r = e.grep(this.source, function(e) {
                return n.matcher(e);
            }), r = this.sorter(r), r.length ? this.render(r.slice(0, this.options.items)).show() : this.shown ? this.hide() : this) : this.shown ? this.hide() : this;
        },
        matcher: function(e) {
            return ~e.toLowerCase().indexOf(this.query.toLowerCase());
        },
        sorter: function(e) {
            var t = [], n = [], r = [], i;
            while (i = e.shift()) i.toLowerCase().indexOf(this.query.toLowerCase()) ? ~i.indexOf(this.query) ? n.push(i) : r.push(i) : t.push(i);
            return t.concat(n, r);
        },
        highlighter: function(e) {
            var t = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g
, "\\$&");
            return e.replace(new RegExp("(" + t + ")", "ig"), function(e, t) {
                return "<strong>" + t + "</strong>";
            });
        },
        render: function(t) {
            var n = this;
            return t = e(t).map(function(t, r) {
                return t = e(n.options.item).attr("data-value", r), t.find("a").html(n.highlighter(r)), t[0];
            }), t.first().addClass("active"), this.$menu.html(t), this;
        },
        next: function(t) {
            var n = this.$menu.find(".active").removeClass("active"), r = n.next();
            r.length || (r = e(this.$menu.find("li")[0])), r.addClass("active");
        },
        prev: function(e) {
            var t = this.$menu.find(".active").removeClass("active"), n = t.prev();
            n.length || (n = this.$menu.find("li").last()), n.addClass("active");
        },
        listen: function() {
            this.$element.on("blur", e.proxy(this.blur, this)).on("keypress", e.proxy(this.keypress
, this)).on("keyup", e.proxy(this.keyup, this)), (e.browser.webkit || e.browser.msie) && this.$element.on("keydown", e.proxy(this.keypress, this)), this.$menu.on("click", e.proxy(this.click, this)).on("mouseenter", "li", e.proxy(this.mouseenter, this));
        },
        keyup: function(e) {
            switch (e.keyCode) {
              case 40:
              case 38:
                break;
              case 9:
              case 13:
                if (!this.shown) return;
                this.select();
                break;
              case 27:
                if (!this.shown) return;
                this.hide();
                break;
              default:
                this.lookup();
            }
            e.stopPropagation(), e.preventDefault();
        },
        keypress: function(e) {
            if (!this.shown) return;
            switch (e.keyCode) {
              case 9:
              case 13:
              case 27:
                e.preventDefault();
                
break;
              case 38:
                if (e.type != "keydown") break;
                e.preventDefault(), this.prev();
                break;
              case 40:
                if (e.type != "keydown") break;
                e.preventDefault(), this.next();
            }
            e.stopPropagation();
        },
        blur: function(e) {
            var t = this;
            setTimeout(function() {
                t.hide();
            }, 150);
        },
        click: function(e) {
            e.stopPropagation(), e.preventDefault(), this.select();
        },
        mouseenter: function(t) {
            this.$menu.find(".active").removeClass("active"), e(t.currentTarget).addClass("active");
        }
    }, e.fn.typeahead = function(n) {
        return this.each(function() {
            var r = e(this), i = r.data("typeahead"), s = typeof n == "object" && n;
            i || r.data("typeahead", i = new t(this, s)), typeof n == "string" && i[n]();
        });
    }, e.
fn.typeahead.defaults = {
        source: [],
        items: 8,
        menu: '<ul class="typeahead dropdown-menu"></ul>',
        item: '<li><a href="#"></a></li>'
    }, e.fn.typeahead.Constructor = t, e(function() {
        e("body").on("focus.typeahead.data-api", '[data-provide="typeahead"]', function(t) {
            var n = e(this);
            if (n.data("typeahead")) return;
            t.preventDefault(), n.typeahead(n.data());
        });
    });
}(window.jQuery), fielddb.define("bootstrap", [ "jquery" ], function(e) {
    return function() {
        var t, n;
        return t || e.bootstrap;
    };
}(this));

var Handlebars = {};

Handlebars.VERSION = "1.0.beta.6", Handlebars.helpers = {}, Handlebars.partials = {}, Handlebars.registerHelper = function(e, t, n) {
    n && (t.not = n), this.helpers[e] = t;
}, Handlebars.registerPartial = function(e, t) {
    this.partials[e] = t;
}, Handlebars.registerHelper("helperMissing", function(e) {
    if (arguments.length === 2) return undefined
;
    throw new Error("Could not find property '" + e + "'");
});

var toString = Object.prototype.toString, functionType = "[object Function]";

Handlebars.registerHelper("blockHelperMissing", function(e, t) {
    var n = t.inverse || function() {}, r = t.fn, i = "", s = toString.call(e);
    s === functionType && (e = e.call(this));
    if (e === !0) return r(this);
    if (e === !1 || e == null) return n(this);
    if (s === "[object Array]") {
        if (e.length > 0) for (var o = 0, u = e.length; o < u; o++) i += r(e[o]); else i = n(this);
        return i;
    }
    return r(e);
}), Handlebars.registerHelper("each", function(e, t) {
    var n = t.fn, r = t.inverse, i = "";
    if (e && e.length > 0) for (var s = 0, o = e.length; s < o; s++) i += n(e[s]); else i = r(this);
    return i;
}), Handlebars.registerHelper("if", function(e, t) {
    var n = toString.call(e);
    return n === functionType && (e = e.call(this)), !e || Handlebars.Utils.isEmpty(e) ? t.inverse(this) : t.fn(this
);
}), Handlebars.registerHelper("unless", function(e, t) {
    var n = t.fn, r = t.inverse;
    return t.fn = r, t.inverse = n, Handlebars.helpers["if"].call(this, e, t);
}), Handlebars.registerHelper("with", function(e, t) {
    return t.fn(e);
}), Handlebars.registerHelper("log", function(e) {
    Handlebars.log(e);
}), Handlebars.Exception = function(e) {
    var t = Error.prototype.constructor.apply(this, arguments);
    for (var n in t) t.hasOwnProperty(n) && (this[n] = t[n]);
    this.message = t.message;
}, Handlebars.Exception.prototype = new Error, Handlebars.SafeString = function(e) {
    this.string = e;
}, Handlebars.SafeString.prototype.toString = function() {
    return this.string.toString();
}, function() {
    var e = {
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#x27;",
        "`": "&#x60;"
    }, t = /&(?!\w+;)|[<>"'`]/g, n = /[&<>"'`]/, r = function(t) {
        return e[t] || "&amp;";
    };
    Handlebars.Utils = {
        escapeExpression
: function(e) {
            return e instanceof Handlebars.SafeString ? e.toString() : e == null || e === !1 ? "" : n.test(e) ? e.replace(t, r) : e;
        },
        isEmpty: function(e) {
            return typeof e == "undefined" ? !0 : e === null ? !0 : e === !1 ? !0 : Object.prototype.toString.call(e) === "[object Array]" && e.length === 0 ? !0 : !1;
        }
    };
}(), Handlebars.VM = {
    template: function(e) {
        var t = {
            escapeExpression: Handlebars.Utils.escapeExpression,
            invokePartial: Handlebars.VM.invokePartial,
            programs: [],
            program: function(e, t, n) {
                var r = this.programs[e];
                return n ? Handlebars.VM.program(t, n) : r ? r : (r = this.programs[e] = Handlebars.VM.program(t), r);
            },
            programWithDepth: Handlebars.VM.programWithDepth,
            noop: Handlebars.VM.noop
        };
        return function(n, r) {
            return r = r || {}, e.call(t, Handlebars
, n, r.helpers, r.partials, r.data);
        };
    },
    programWithDepth: function(e, t, n) {
        var r = Array.prototype.slice.call(arguments, 2);
        return function(n, i) {
            return i = i || {}, e.apply(this, [ n, i.data || t ].concat(r));
        };
    },
    program: function(e, t) {
        return function(n, r) {
            return r = r || {}, e(n, r.data || t);
        };
    },
    noop: function() {
        return "";
    },
    invokePartial: function(e, t, n, r, i, s) {
        options = {
            helpers: r,
            partials: i,
            data: s
        };
        if (e === undefined) throw new Handlebars.Exception("The partial " + t + " could not be found");
        if (e instanceof Function) return e(n, options);
        if (!Handlebars.compile) throw new Handlebars.Exception("The partial " + t + " could not be compiled when running in runtime-only mode");
        return i[t] = Handlebars.compile(e), i[t](n, options);
    }
}, Handlebars.
template = Handlebars.VM.template, fielddb.define("handlebars", [ "bootstrap", "jquery" ], function(e) {
    return function() {
        var t, n;
        return t || e.Handlebars;
    };
}(this)), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.activity = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<span class="activity-feed-user-link"></span>\n<span class="timestamp pull-right"><i class="icon-time"></i>', u = n.timestamp, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.timestamp, o = typeof o === a ? o() : o), s += f(o) + '</span>\n<i class="activity_verb_icon ', u = n.verbicon, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.verbicon, o = typeof o === a ? o() : o), s += f(o) + '"></i><span class="activity_verb">', u = n.verb, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.verb, o = typeof 
o === a ? o() : o), s += f(o) + '</span>\n<i class="activity_direct_object_icon ', u = n.directobjecticon, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.directobjecticon, o = typeof o === a ? o() : o), s += f(o) + '"></i><span class="activity_direct_object">', u = n.directobject, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.directobject, o = typeof o === a ? o() : o), s += f(o) + ' </span>\n<span class="activity_indirect_object"> ', u = n.indirectobject, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.indirectobject, o = typeof o === a ? o() : o), s += f(o) + " </span>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.activity_feed = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="pull-right">\n  <a  href="#" class = "locale_Refresh_Activities" rel="tooltip"  >\n      <i class="icons icon-refresh"></i></a>\n  <a  href="#" class = "locale_Hide_Activities" rel="tooltip"  >\n      <i class="icons icon-minus-sign"></i></a>\n</div>\n<h3 class="locale_Activity_Feed"></h3>\n<ul class = "activities-updating-collection unstyled"></ul>\n<div class="pagination-control"></div>\n'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.activity_feed_minimized = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="pull-right">\n<a  href="#"  class = "locale_Show_Activities" rel="tooltip" >\n       <i class="icons icon-plus-sign"></i></a>  \n</div>\n<h3 class = "locale_Activity_Feed"></h3>\n';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.app = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<!-- Black Navigation Bar Across the Top -->\n<div class="navbar navbar-fixed-top navbar-inner width100">\n	<div class="btn-group pull-right">\n		<ul class="nav">\n			<li>\n			 <a href="#" class = "locale_Show_Dashboard" rel="tooltip" title="Show dashboard with data entry form">\n			     <i class="icons icon-home icon-white"></i></a>\n			</li>\n		  <li>\n			  <div class="btn-group">\n				  <button class="btn dropdown-toggle btn-inverse" data-toggle="dropdown">\n            <span class = "locale_Need_save"></span>   \n            <progress class="unsaved-changes" max="100" value="30">\n            </progress>\n            <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu unsaved-changes-status" id="unsaved-changes-status">\n            <li class="not-a locale_Recent_Changes"></li>\n          </ul>\n			    <a href="#" class = "locale_Save_on_this_Computer pull-right" rel="tooltip">\n					  <i class="icons icon-save save-dashboard icon-white"></i></a>\n        </div>\n		  </li>\n		  \n      <li>\n		    <div class="btn-group">\n				  <button class="btn dropdown-toggle btn-inverse" data-toggle="dropdown">\n	          <span class = "locale_Need_sync"></span>  \n	          <progress class="unsynced-changes" max="100" value="80">\n	          </progress>\n	          <span class="caret"></span>\n	        </button>\n	        <ul class="dropdown-menu unsynced-changes-status" id="unsynced-changes-status">\n	          <li class="not-a locale_Differences_with_the_central_server"></li>\n	        </ul>\n				  <a href="#" class = "locale_Sync_and_Share pull-right" rel="tooltip">\n						<i class="icons icon-sitemap  sync-everything icon-white"></i></a>\n        </div>\n		  </li>\n			<li>\n				<div class="btn-group">\n			  <a href="#" class = "locale_View_Public_Profile_Tooltip pull-left" rel="tooltip">\n			   <span id="user-quickview">\n			     <i class="icons icon-user icon-white"></i>\n			   </span>\n			   </a>\n					<button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown"> \n						 <span class="caret"></span>  \n					</button>\n					<ul class="dropdown-menu" id="authentication-embedded"></ul>\n				</div>\n			</li>\n		</ul>\n	</div>\n	<div>\n		<!-- This is a div for the top nav bar area -->\n		<span id="search-top" class="search"></span> \n	</div>\n</div>\n<!-- The rest of the page -->\n<div class="container-fluid main">\n  <div id="dashboard-view" class="row-fluid">\n    <!-- Elements on Lefthand side -->\n    <div class="span3">\n      <div id="corpus-quickview" class="well sidebar-nav"></div>\n      <div id="session-quickview" class="well sidebar-nav"></div>\n      <div id="search-data-list-quickview" class="  span12">\n        <div id="search-data-list-quickview-header" class=" sidebar-nav"></div>\n        <div class=" sidebar-nav ">\n          <ul class="unstyled zebra   search-data-list-paginated-view "></ul>\n          <div class="pagination-control"></div>\n        </div>\n      </div >\n      <div id="data-list-quickview" class="well span12">\n        <div id="data-list-quickview-header" class=" sidebar-nav"></div>\n        <div class=" sidebar-nav container span12">\n          <ul class="unstyled zebra   current-data-list-paginated-view "></ul>\n          <div class="pagination-control "></div>\n        </div>\n      </div>\n    </div>\n    <!--Elements in the middle (things that get hidden)  -->\n    <div class="span6">\n      <div id="toast-user-area">\n        <div class="alert alert-info alert-block">\n          <a class="close" data-dismiss="alert" href="#">\u00d7</a> \n          <strong class="alert-heading ">Quick Start Instructions:</strong>\n          <span class="locale_Instructions_to_show_on_dashboard"></span> \n          <span class="locale_to_beta_testers"></span>\n        </div>\n      </div>\n      <div id="datums-embedded" class="middle well"></div>\n      <div id="data-list-embedded" class="well">\n        <div id="data-list-embedded-header" class="middle "></div>\n        <div>\n          <ul class="unstyled zebra current-data-list-paginated-view"></ul>\n          <div class="pagination-control"></div>\n        </div>\n      </div>\n      <div id="session-embedded" class="middle well"></div>\n      <div id="corpus-embedded" class="middle well"></div>\n      <div id="search-embedded" class="middle well"></div>\n    </div>\n    <!--/span-->\n    <!-- right hand side -->\n    <div class="span3">\n      <div id="insert-unicode" class="well"></div>\n      <div id="activity-feed-user" class="well"></div>\n			<div id="activity-feed-corpus-team" class="well"></div>\n		</div>\n    <!--/span-->\n  </div>\n  <!--/row-->\n\n  <!-- FullScreen Views -->\n  <div id="user-fullscreen" class="well "></div>\n  <div id="public-user-page" class="well "></div>\n  <div id="corpus-fullscreen" class="well "></div>\n  <div id="session-fullscreen" class="well "></div>\n  <div id="search-fullscreen" class="well "></div>\n  <div id="data-list-fullscreen" class="well row">\n    <div id="data-list-fullscreen-header"></div>\n    <div class=" container span12 ">\n      <ul class="unstyled zebra current-data-list-paginated-view"></ul>\n      <div class="pagination-control"></div>\n    </div>\n  </div>\n  <div id="datum-container-fullscreen" class="well "></div>\n  <div id="import-fullscreen" class=""></div>\n</div>\n\n<!-- Modals are windows which pop over the active app to take focus -->\n<div id="hotkey-settings-modal" class="modal hide"></div>\n<div id="user-modal" class="modal hide"></div>\n<div id="user-preferences-modal" class="modal hide"></div>\n<div id="export-modal" class="modal hide"></div>\n<div id="new-session-modal" class="modal hide"></div>\n<div id="new-corpus-modal" class="modal hide"></div>\n<div id="quick-authenticate-modal" data-backdrop="static" data-keyboard="static" class="modal hide">\n	<div class="modal-header">\n	  <h4 class = "locale_We_need_to_make_sure_its_you"></h4>\n	</div>\n	<div class="modal-body">\n	<label class = "locale_Password"></label>\n	    <input type="password" id="quick-authenticate-password"/>\n	</div>\n	<div class="modal-footer">\n	  <button class="btn btn-success locale_Yep_its_me" id="quick-authentication-okay-btn"></button>\n	</div>\n</div>\n'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.audio_video_edit_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, "<!-- this is done in the code see AudioVideoEditView -->";
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.audio_video_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<audio preload="" controls="" \n	class="datum-audio-player">\n	<source\n		src="', u = n.URL, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.URL, o = typeof o === a ? o() : o), s += f(o) + '"\n		type="', u = n.audioType, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.audioType, o = typeof o === a ? o() : o), s += f(o) + '">\n</audio>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars
.templates = Handlebars.templates || {};
    t.authentication_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<li class="not-a">\n  <div>\n  <img class="gravatar-large" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '"/><br/>\n   ', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '\n  </div>\n  <div id="login_form">\n    <div class=" alert alert-error hide "></div>\n	  <label class = "locale_Username"></label> \n	  <input type="text" id="username" name="username" value="lingllama" /> \n		<label class = "locale_Password "></label>\n		<input type="password" id="password" size="100px" name="password"\n		value="phoneme" />\n		<input type="text" id="authUrl" size="100px" name="authUrl"\n    value="" />\n	</div>\n</li>\n<li class="not-a">\n  <button id="logout" class="btn btn-inverse logout locale_Log_Out"></button>\n  <button id="login" class="btn btn-inverse login locale_Log_In"></button>\n</li>\n<li class="divider"></li>\n\n<li><a data-toggle="modal" href="#user-modal"><i class=" icon-user"></i> <span class = "locale_Private_Profile"></span> </a></li>\n<li><a data-toggle="modal" href="#user-preferences-modal"><i class=" icon-cog"></i> <span class = "locale_User_Settings"></span> </a></li>\n<li><a data-toggle="modal" href="#hotkey-settings-modal"><i class=" icon-hdd"></i> <span class = "locale_Keyboard_Shortcuts"></span></a></li>\n<li><a class="corpus-settings"><i class=" icon-cogs"></i> <span class = "locale_Corpus_Settings"></span></a></li>\n<li class="divider"></li>\n<li class="power-users-link"><a data-toggle="modal" href="#terminal-modal"><i class=" icon-magic"></i> <span class = "locale_Terminal_Power_Users"></span> </a></li>\n<li><a href="http://fieldlinguist.com" target="_blank"><i class=" icon-film"></i> Help Videos and User Guide</a></li>\n<li><a href="https://docs.google.com/spreadsheet/viewform?formkey=dGFyREp4WmhBRURYNzFkcWZMTnpkV2c6MQ" target="_blank"><i class=" icon-beaker"></i> Bug Report/Contact Us</a></li>\n<li><a href="https://github.com/OpenSourceFieldlinguistics/FieldDB/issues/milestones?state=closed" target="_blank"><i class=" icon-github"></i> FieldDB v<span class="fielddb-version"></span></a></li>'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.comment_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="alert alert-info">\n\n<span> <img class="gravatar-small" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '"/></span>\n\n<span>', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '</span>\n<i class="icons icon-comment"></i>\n\n<div class= "pull-right">  ', u = n.timestamp, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.timestamp, o = typeof o === a ? o() : o), s += f(o) + '</div>\n\n<textarea class="comment-new-text">', u = n.text, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.text, o = typeof 
o === a ? o() : o), s += f(o) + "</textarea>\n\n</div>\n\n\n  \n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.comment_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="alert alert-info">\n\n<span> <img class="gravatar-small" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '"/></span>\n\n<span> ', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '   </span>\n<i class="icons icon-comment"></i>\n\n<div class= "pull-right">  ', u = n.timestamp, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.timestamp, o = typeof o === a ? o() : o), s += f(o) + '</div>\n\n<div class="comment-text">', u = n.text, u ? o = u.call
(t, {
            hash: {}
        }) : (o = t.text, o = typeof o === a ? o() : o), s += f(o) + "</div>\n\n</div>\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- Corpus icons - Different for all Corpus Handlebars -->\n<div class="pull-right">\n   <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n    <i class="icons icon-book"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n    <i class="icons icon-resize-small"></i></a>\n</div>\n<div class="btn-toolbar ">\n  <!-- Corpus Menu - Identical for all Corpus Handlebars -->\n  <div class="btn-toolbar">\n    <div class="btn-group">\n      <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_New_menu"></span>  <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li class="new-datum"><a href="#" class = "locale_New_Datum"></a></li>\n        <li class="new-data-list"><a href="#" class = "locale_New_Data_List"></a></li>\n        <li class="new-session"><a href="#" class = "locale_New_Session"></a></li>\n        <li class="new-corpus"><a href="#" class = "locale_New_Corpus"></a></li>\n      </ul>\n    </div>\n    <div class="btn-group">\n      <button class="btn btn-info dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_Data_menu"></span> <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li><a href="#import" class = "locale_Import_Data"></a></li>\n        <li><a href="#corpus/'
, u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '/export" class = "locale_Export_Data"></a></li>\n      </ul>\n    </div>\n	  <!-- /Corpus Menu - Identical for all Corpus Handlebars -->\n	  <!-- Corpus Save and Toggle to Readonly - Edit View Only-->\n	  <div class="btn-group">\n	    <button class="btn btn-success save-corpus">\n	     <span class="locale_Save"></span></button>\n	  </div>\n  </div>\n</div>\n\n	\n\n<label class = "locale_Title"></label> <i class="icon-cloud"></i> \n<input class="corpus-title-input" value="', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + '" type="text"/><small>', u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '</small>\n\n<label class = locale_Description></label>\n<textarea class="corpus-description-input">'
, u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + "</textarea>\n\n<small>Shareable URL: http://www.fieldlinguist.com/", u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '</small>\n        \n<div class="accordion" id="accordion-edit-embedded">\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-edit-embedded" href="#collapseSessionsEE">\n        <i class="icon-comments-alt"></i> <strong class="locale_Sessions_associated"></strong>\n         </a>\n    </div>\n    <div class="accordion-body collapse" id="collapseSessionsEE">\n      <div class="accordion-inner">\n        <span class="locale_elicitation_sessions_explaination"></span>\n        <ul class = "sessions-updating-collection unstyled">\n                <!-- Updating Sessions Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  \n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-edit-embedded" href="#collapseDatalistsEE">\n          <i class="icon-pushpin"></i> <strong class="locale_Datalists_associated"></strong>\n      </a>\n    </div>\n    <div class="accordion-body collapse" id="collapseDatalistsEE" >\n      <div class="accordion-inner">\n				<span class="locale_datalists_explaination"></span>\n         <ul class = "datalists-updating-collection unstyled">\n                <!-- Updating DataLists Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  \n  <div class="accordion-group">\n    <div class="accordion-heading">\n			<a class="accordion-toggle" data-toggle="collapse"\n				data-parent="accordion-edit-embedded" href="#collapsePermissionsEE">\n				<i class="icon-group"></i> <strong class="locale_Permissions_associated"></strong>\n			</a>\n		</div>\n    <div class="accordion-body collapse" id="collapsePermissionsEE">\n      <div class="accordion-inner container span12">\n				<span class="locale_permissions_explaination"></span>\n				<label class = "locale_Public_or_Private"></label>\n				<input type="text" value="'
, u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '" class=" public-or-private" data-provide="typeahead" data-items="4" \n				        data-source="[&quot;Public&quot;,&quot;Private&quot;]"/>\n				<a href = "http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '" target="_blank"><i class=" icon-link"></i></a>\n				<small>Shareable URL: http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '</small>\n				 \n        <ul class = "permissions-updating-collection unstyled">\n                      <!-- Updating Permissions Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-edit-embedded" href="#collapseDatumFieldSettingsEE">\n           <i class="icon-list"></i> <strong class="locale_Datum_field_settings"></strong>\n        </a>\n    </div>\n    <div class="accordion-body collapse" id="collapseDatumFieldSettingsEE">\n      <div class="accordion-inner">\n				<span class="locale_datum_fields_explaination"></span>\n        <ul class="datum_field_settings unstyled"></ul>\n        <div class="breadcrumb">\n          <span class="pull-right"> \n            <span class="locale_Encrypt_if_confidential"></span>\n            <input type="checkbox" class="add_shouldBeEncrypted"'
, u = n.shouldBeEncrypted, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.shouldBeEncrypted, o = typeof o === a ? o() : o), s += f(o) + '></input>\n          </span> \n          <input type="text" class="span3 choose_add_field"  data-provide="typeahead" data-items="4" data-source="[&quot;Phonemic Transcription&quot;,&quot;Phonetic Transcription&quot;,&quot;Semantic Denotation&quot;,&quot;Semantic Context&quot;,&quot;Spanish&quot;,&quot;Notes&quot;]">\n          <label class="locale_Help_Text"></label>\n          <textarea class="add_help locale_Help_Text_Placeholder"></textarea>\n          <a href="#" class="locale_Add_New_Datum_Field_Tooltip btn btn-primary add-datum-field locale_Add" rel="tooltip">\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-edit-embedded" href="#collapseDatumStateSettingsEE">\n        <i class="icon-flag"></i>  <strong class="locale_Datum_state_settings"></strong>\n      </a>\n    </div>\n    <div class="accordion-body collapse" id="collapseDatumStateSettingsEE">\n			<span class="locale_datum_states_explaination"></span>\n        <ul class="datum_state_settings unstyled"></ul>\n        <input class="add_input locale_Add_Placeholder" value="" type="text"></input>\n        <select class="add_color_chooser">\n          <option value="success" class = "locale_Green"></option>\n          <option value="warning" class = "locale_Orange"></option>\n          <option value="important" class = "locale_Red"></option>\n          <option value="info" class = "locale_Teal"></option>\n          <option value="inverse" class = "locale_Black"></option>\n          <option value="" class = "locale_Default"></option>\n        </select>\n        <a href="#" class = "locale_Add_New_Datum_State_Tooltip btn btn-primary add-datum-state locale_Add" rel="tooltip">\n        </a>\n    </div>\n  </div>      \n</div>\n\n<!-- Corpus comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-corpus" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_edit_new_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n  <h1> <span class = "locale_New_Corpus"></span> <small class="new-corpus-pouchname">', u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '</small></h1>\n  <p class = "locale_New_Corpus_Instructions"></p>\n  <p class="alert alert-danger">\n    <strong class="locale_Warning"></strong> \n    <span class = "locale_New_Corpus_Warning"></span>\n  </p>\n</div>\n\n<div class="modal-body">\n	<label class = "locale_Title"></label>  <i class="icon-cloud"></i> \n	<textarea class="corpus-title-input">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? 
o() : o), s += f(o) + '</textarea>\n	<label class = "locale_Description">Description:</label>\n	<textarea class="corpus-description-input">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n  <label class = "locale_Public_or_Private"></label>\n  <input type="text" value="', u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '"  class=" public-or-private" data-provide="typeahead" data-items="4" \n        data-source="[&quot;Public&quot;,&quot;Private&quot;]"/>\n</div>\n\n<div class="modal-footer">\n  <a href="#" class="btn locale_Cancel" data-dismiss="modal"></a>\n  <button class="btn btn-success pull-right save-corpus locale_Save" value="Save"></button>  \n</div>\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_read_embedded = 
e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- Corpus icons - Different for all Corpus Handlebars -->\n<div class="pull-right">\n  <a href="#" class = "locale_Edit_corpus" rel="tooltip">\n    <i class="icons icon-edit"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n    <i class="icons icon-resize-small"></i></a>\n</div>\n<div class="btn-toolbar ">\n  <!-- Corpus Menu - Identical for all Corpus Handlebars -->\n  <div class="btn-toolbar">\n    <div class="btn-group">\n      <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_New_menu"></span>  <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li class="new-datum"><a href="#" class = "locale_New_Datum"></a></li>\n        <li class="new-data-list"><a href="#" class = "locale_New_Data_List"></a></li>\n        <li class="new-session"><a href="#" class = "locale_New_Session"></a></li>\n        <li class="new-corpus"><a href="#" class = "locale_New_Corpus"></a></li>\n      </ul>\n    </div>\n    <div class="btn-group">\n      <button class="btn btn-info dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_Data_menu"></span> <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li><a href="#import" class = "locale_Import_Data"></a></li>\n        <li><a href="#corpus/'
, u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '/export" class = "locale_Export_Data"></a></li>\n      </ul>\n    </div>\n    <!-- /Corpus Menu - Identical for all Corpus Handlebars -->\n  </div>\n</div>\n\n<h2><i class="icon-cloud"></i> ', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + " <small>", u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '</small></h2>\n<a href = "http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '" target = "_blank"><i class=" icon-link"></i></a>\n<small>Shareable URL: http://www.fieldlinguist.com/'
, u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<div class="description">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</div>\n\n<div class="accordion" id="accordion-read-embedded">\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapseSessionsRE">\n        <i class="icon-comments-alt"></i> <strong class="locale_Sessions_associated"></strong>\n         </a>\n    </div>\n    <div id="collapseSessionsRE" class="accordion-body collapse">\n      <div class="accordion-inner">\n				<span class="locale_elicitation_sessions_explaination"></span>\n				<ul class = "sessions-updating-collection unstyled">\n                <!-- Updating Sessions Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapseDatalistsRE">\n          <i class="icon-pushpin"></i> <strong class="locale_Datalists_associated"></strong>\n        </a>\n    </div>\n    <div id="collapseDatalistsRE" class="accordion-body collapse">\n      <div class="accordion-inner">\n				<span class="locale_datalists_explaination"></span>\n        <ul class = "datalists-updating-collection unstyled">\n                <!-- Updating DataLists Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapsePermissionsRE">\n        <i class="icon-group"></i> <strong class="locale_Permissions_associated"></strong>\n        </a>\n    </div>\n    <div id="collapsePermissionsRE" class="accordion-body collapse">\n      <div class="accordion-inner ">\n				<span class="locale_permissions_explaination"></span>\n        <ul class = "permissions-updating-collection unstyled">\n                      <!-- Updating Permissions Collection -->\n        </ul>\n      </div>\n    </div>\n  </div>\n  \n  <div class="accordion-group">\n    <div class="accordion-heading">\n        <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapseDatumFieldSettingsRE">\n          <i class="icon-list"></i>  <strong class="locale_Datum_field_settings"></strong>\n        </a>\n    </div>\n    <div id="collapseDatumFieldSettingsRE" class="accordion-body collapse">\n      <div class="accordion-inner">\n				<span class="locale_datum_fields_explaination"></span>\n				<ul class="datum_field_settings unstyled"></ul>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapseDatumStateSettingsRE">\n        <i class="icon-flag"></i> <strong class="locale_Datum_state_settings"></strong>\n        </a>\n    </div>\n    <div id="collapseDatumStateSettingsRE" class="accordion-body collapse">\n      <div class="accordion-inner">\n        <span class="locale_datum_states_explaination"></span>\n        <ul class="datum_state_settings unstyled"></ul>\n      </div>\n    </div>\n  </div>\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <a class="accordion-toggle" data-toggle="collapse"\n        data-parent="#accordion-read-embedded" href="#collapseLessonsSettingsRE">\n        <i class="icon-gift"></i> <strong class="">New! Add Language Lessons components to this corpus</strong>\n        </a>\n    </div>\n    <div id="collapseLessonsSettingsRE" class="accordion-body collapse">\n      <div class="accordion-inner">\n        <a href="/lessons_corpus/index.html">See prototype</a>        \n\n      </div>\n    </div>\n  </div>\n</div> \n\n<!-- Corpus comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-corpus" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_read_link = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<a href="user.html#corpus/', u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.corpusid, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.corpusid, o = typeof o === a ? o() : o), s += f(o) + '">\n<i class="icon-cloud"></i>\n', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.corpusid, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.corpusid, o = typeof o === a ? o() : 
o), s += f(o) + "</a>\n<small> ", u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + "</small>", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_summary_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- Corpus icons - Different for all Corpus Handlebars -->\n<div class="pull-right">\n  <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n    <i class="icons icon-book"></i></a>\n  <a href="#" class = "locale_Show_corpus_settings" rel="tooltip">\n    <i class="icons icon-cogs resize-full"></i></a>\n</div>\n<div class="btn-toolbar ">\n  <!-- Corpus Menu - Identical for all Corpus Handlebars -->\n  <div class="btn-toolbar">\n    <div class="btn-group">\n      <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_New_menu"></span>  <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li class="new-datum"><a href="#" class = "locale_New_Datum"></a></li>\n        <li class="new-data-list"><a href="#" class = "locale_New_Data_List"></a></li>\n        <li class="new-session"><a href="#" class = "locale_New_Session"></a></li>\n        <li class="new-corpus"><a href="#" class = "locale_New_Corpus"></a></li>\n      </ul>\n    </div>\n    <div class="btn-group">\n      <button class="btn btn-info dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_Data_menu"></span> <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li><a href="#import" class = "locale_Import_Data"></a></li>\n        <li><a href="#corpus/'
, u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '/export" class = "locale_Export_Data"></a></li>\n      </ul>\n    </div>\n    <!-- /Corpus Menu - Identical for all Corpus Handlebars -->\n  </div>\n</div>\n\n<div class="corpus-description">\n	<label class="locale_Title"></label> <i class="icon-cloud"></i> \n	<!-- <a href = "http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '" target = "_blank"><small><i class=" icon-link"></i></small></a> -->\n	<textarea class="corpus-title-input save-corpus-blur">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n	<label class="locale_Description"></label>\n	<textarea class="corpus-description-input save-corpus-blur">'
, u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n	<input type="text" value="', u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '" class=" public-or-private"\n		data-provide="typeahead" data-items="4"\n		data-source="[&quot;Public&quot;,&quot;Private&quot;]" />\n</div>\n\n\n\n\n\n\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.corpus_summary_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- Corpus icons - Different for all Corpus Handlebars -->\n<div class="pull-right">\n  <a href="#" class="locale_Edit_corpus" rel="tooltip"> \n    <i class="icons icon-edit"></i></a>\n  <a href="#" class = "locale_Show_corpus_settings" rel="tooltip">\n    <i class="icons icon-cogs resize-full"></i></a>\n</div>\n<div class="btn-toolbar ">\n  <!-- Corpus Menu - Identical for all Corpus Handlebars -->\n  <div class="btn-toolbar">\n    <div class="btn-group">\n      <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_New_menu"></span>  <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li class="new-datum"><a href="#" class = "locale_New_Datum"></a></li>\n        <li class="new-data-list"><a href="#" class = "locale_New_Data_List"></a></li>\n        <li class="new-session"><a href="#" class = "locale_New_Session"></a></li>\n        <li class="new-corpus"><a href="#" class = "locale_New_Corpus"></a></li>\n      </ul>\n    </div>\n    <div class="btn-group">\n      <button class="btn btn-info dropdown-toggle" data-toggle="dropdown">\n        <span class ="locale_Data_menu"></span> <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n        <li><a href="#import" class = "locale_Import_Data"></a></li>\n        <li><a href="#corpus/'
, u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '/export" class = "locale_Export_Data"></a></li>\n      </ul>\n    </div>\n    <!-- /Corpus Menu - Identical for all Corpus Handlebars -->\n  </div>\n</div>\n\n<div class="corpus-description">\n	<h3><i class="icon-cloud"></i> ', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "<small> ", u = n.publicCorpus, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.publicCorpus, o = typeof o === a ? o() : o), s += f(o) + '</small></h3>\n	<p>\n		<!-- <a href = "http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + "/", u = n.titleAsUrl, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.titleAsUrl, o = typeof o === a ? o() : o), s += f(o) + '" target = "_blank"><i class=" icon-link"></i></a> -->\n		'
, u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + "\n	</p>\n</div>\n\n\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="pull-right">\n  <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n      <i class="icons icon-book"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n      <i class="icons icon-resize-small"></i></a>\n</div>\n<button class="btn btn-success pull-left save-datalist locale_Save" value="Save"></button>\n<br>\n<br>\n<label class = "locale_Title"></label> <i class="icon-pushpin"></i> \n<small>'
, u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<textarea class="data-list-title">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "</textarea>\n<h4>", u = n.dateCreated, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateCreated, o = typeof o === a ? o() : o), s += f(o) + '</h4>\n<label class = "locale_Description"></label>\n<textarea class="data-list-description locale_Datalist_Description"\n>', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n\n\n<!-- Data list comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datalist" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n\n<!--DataList Menu  -->\n<div class="btn-group">\n  <a  href="#" class = "locale_Play_Audio_checked btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-bullhorn"></i></a>\n  <a  href="#" class = "locale_Remove_checked_from_datalist_tooltip btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-remove-sign"></i></a>\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_import_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || e
.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<label class = "locale_Title"></label> <i class="icon-pushpin"></i> \n<textarea class="data-list-title">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n<label class = "locale_Description"></label>\n<textarea class="data-list-description locale_Datalist_Description">\n', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n\n<!-- Data list comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datalist" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n\n<!--Import DataList Menu  -->\n<div class="btn-group">\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_read_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || e.helpers
;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="pull-right">\n  <a href="#" rel="tooltip" class="locale_Edit_Datalist">\n    <i class="icons icon-edit"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n    <i class="icons icon-resize-small"></i></a> \n</div>\n\n<h3><i class="icon-pushpin"></i> ', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "\n<small> ", u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + "</small></h3>\n<h4>", u = n.dateCreated, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateCreated, o = typeof o === a ? o() : o), s += f(o) + "</h4>\n\n", u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '\n\n<!-- Data list comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datalist" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n\n<!--DataList Menu  -->\n<div class="btn-group">\n  <a  href="#" class = "locale_Play_Audio_checked btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-bullhorn"></i></a>\n  <a  href="#" class = "locale_Remove_checked_from_datalist_tooltip btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-remove-sign"></i></a>\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_read_link = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '  <a href="#data/', u = n._id, u ? o = u.call(t, {
            
hash: {}
        }) : (o = t._id, o = typeof o === a ? o() : o), s += f(o) + '"> \n	  <i class="icon-pushpin"></i> \n	  ', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "\n  </a>\n  <small> ", u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + "</small>", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_search_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<!--  Search Data lists icons -->\n<div class="pull-right">\n  <button class="btn btn-success save-search-datalist locale_Save" value="Save"></button>\n  <a href="#" class= "locale_Hide_Datalist" rel="tooltip">\n      <i class="icons icon-minus-sign"></i>\n  </a>  \n</div>\n\n<label class="locale_Title"></label> <i class="icon-pushpin"></i> \n<small> '
, u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<textarea class="data-list-title">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n<label class="locale_Description"></label>\n<textarea class="data-list-description locale_Datalist_Description">\n', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n\n<!--Search DataList Menu  -->\n<div class="btn-group">\n  <a  href="#" class = "locale_Play_Audio_checked btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-bullhorn"></i></a>\n  <!--This cannot be included in search or import <a  href="#" class = "locale_Remove_checked_from_datalist_tooltip btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-remove-sign"></i></a> -->\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_summary_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || 
e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="pull-right">\n  <button class="btn btn-success save-datalist locale_Save" value="Save">\n  </button>\n  <a href="#" class= "locale_Hide_Datalist" rel="tooltip">\n     <i class="icons icon-minus-sign"></i></a>      \n  <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n     <i class="icons icon-book"></i></a>      \n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">\n     <i class="icons icon-resize-full"></i></a>     \n</div>\n\n<label class = "locale_Title"></label> <i class="icon-pushpin"></i> \n<small> ', u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<textarea class="data-list-title">', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n<label class = "locale_Description"></label>\n<textarea class="data-list-description locale_Datalist_Description">'
, u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n\n<!-- Data list comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datalist" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n\n<!--DataList Menu  -->\n<div class="btn-group">\n  <a  href="#" class = "locale_Play_Audio_checked btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-bullhorn"></i></a>\n  <a  href="#" class = "locale_Remove_checked_from_datalist_tooltip btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-remove-sign"></i></a>\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_summary_read_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        n = n || 
e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="pull-right">\n  <a href="#" class= "locale_Hide_Datalist" rel="tooltip">\n      <i class="icons icon-minus-sign"></i></a>      \n  <a href="#" class = "locale_Edit_Datalist" rel="tooltip">\n      <i class="icons icon-edit"></i></a>      \n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">\n      <i class="icons icon-resize-full"></i></a>\n</div>\n\n<h3><i class="icon-pushpin"></i> ', u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "<small> ", u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + "</small></h3>\n<h4>", u = n.dateCreated, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateCreated, o = typeof o === a ? o() : o), s += f(o) + "</h4>\n\n", u = n.description, u ? o = u.call(t, {
            
hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '\n\n<!-- Data list comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datalist" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n\n<!--DataList Menu  -->\n<div class="btn-group">\n  <a  href="#" class = "locale_Play_Audio_checked btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-bullhorn"></i></a>\n  <a  href="#" class = "locale_Remove_checked_from_datalist_tooltip btn btn-mini btn-primary" rel="tooltip" >\n    <i class=" icon-remove-sign"></i></a>\n  <a href="#" class= "locale_Decrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-unlock"></i></a> \n  <a href="#" class= "locale_Encrypt_checked btn btn-mini btn-primary" rel="tooltip">\n    <i class=" icon-lock"></i></a>\n  <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n    <i class=" '
, o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '"></i></a>\n  <a  href="#" class = "locale_Plain_Text_Export_Tooltip_checked btn btn-mini btn-info" rel="tooltip" >\n    <i class=" icon-paste"></i></a>\n  <a href="#" class = "locale_Export_checked_as_LaTeX btn btn-mini btn-info latex-export-datalist LaTeX" rel="tooltip">\n    <i class="">LaTeX</i></a>\n  <a href="#" class = "locale_Export_checked_as_CSV btn btn-mini btn-info CSV" rel="tooltip">\n    <i class="">CSV</i></a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.data_list_summary_read_minimized = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="pull-right">\n  <a  href="#" class= "locale_Show_Datalist" rel="tooltip" title="Show data list" >\n      <i class="icons icon-plus-sign"></i></a>\n</div>\n<h4><i class="icon-pushpin"></i> '
, u = n.title, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.title, o = typeof o === a ? o() : o), s += f(o) + "<small> ", u = n.datumCount, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumCount, o = typeof o === a ? o() : o), s += f(o) + "</small></h4>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_container_edit_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<h4 class="locale_Data_Entry_Area"></h4>\n<!-- full screen button -->\n<div class="pull-right">\n  <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n      <i class="icons icon-book"></i></a>        \n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">\n      <i class="icons icon-resize-full"></i></a>\n</div>\n\n<!-- Required so that the full screen button doesn\'t end up inside the next div -->\n<div class="clear-spacing"></div>\n\n<!-- list of datum -->\n<ul class="datum-embedded-ul unstyled"></ul>'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_container_edit_fullscreen = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<h4 class="locale_Data_Entry_Area"></h4>\n<!-- shrink button -->\n<div class="pull-right">\n  <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n      <i class="icons icon-book"></i></a>    \n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n      <i class="icons icon-resize-small"></i></a>\n</div>\n\n<!-- Required so that the full screen button doesn\'t end up inside the next div -->\n<div class="clear-spacing"></div>\n\n<!-- list of datum -->\n<ul class="datum-embedded-ul unstyled"></ul>';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_container_read_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<h4 class="locale_Data_Entry_Area"></h4>\n<div class="pull-right">\n  <a href="#" class = "locale_Edit_Datum" rel="tooltip" >\n    <i class="icons icon-edit"></i></a>     \n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">\n    <i class="icons icon-resize-full"></i></a>\n</div>\n\n<!-- Required so that the full screen button doesn\'t end up inside the next div -->\n<div class="clear-spacing"></div>\n\n<!-- list of datum -->\n<ul class="datum-embedded-ul unstyled"></ul>'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_container_read_fullscreen = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<h4 class="locale_Data_Entry_Area"></h4>\n<div class="pull-right">\n  <a href="#" class = "locale_Edit_Datum" rel="tooltip" > \n    <i class="icons icon-edit"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n    <i class="icons icon-resize-small"></i></a>\n</div>\n\n<!-- Required so that the full screen button doesn\'t end up inside the next div -->\n<div class="clear-spacing"></div>\n\n<!-- list of datum -->\n<ul class="datum-embedded-ul unstyled"></ul>';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-lock";
        }
        function h(e, t) {
            return "icon-unlock"
;
        }
        function p(e, t) {
            return "icon-eye-close";
        }
        function d(e, t) {
            return "icon-eye-open";
        }
        function v(e, t) {
            var r = "", i, s;
            return r += '\n          <option value="', s = n.state, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.state, i = typeof i === a ? i() : i), r += f(i) + '" ', s = n.selected, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.selected, i = typeof i === a ? i() : i), r += f(i) + ">", s = n.state, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.state, i = typeof i === a ? i() : i), r += f(i) + "</option>\n      ", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="pull-right">\n	<button class="btn btn-success save-datum locale_Save pull-right" value="Save"></button><br/>\n	<span class="last-modified">', u = n.dateModified
, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateModified, o = typeof o === a ? o() : o), s += f(o) + '</span><i class=" icon-save "></i><br/>\n	<span class="date-created">', u = n.dateEntered, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateEntered, o = typeof o === a ? o() : o), s += f(o) + '</span><i class=" icon-time"></i><br/>\n  \n</div>\n<!-- list for the fields -->\n<ul class="datum_fields_ul unstyled"></ul>\n<a  href="#" class= "locale_See_Fields" rel="tooltip" >\n  <i class="icons icon-list-alt pull-right"> </i></a>\n<!-- Datum Edit view specialized fields and menu area -->\n<div class="row-fluid">\n	<div class="span6">\n		<!-- Buttons for various actions -->\n	  <div class=" btn-group">\n	    <a href="#" class = "locale_Insert_New_Datum btn btn-mini btn-primary" rel="tooltip">\n	      <i class=" icon-plus"></i></a>\n	    <a  href="#" class = "locale_Duplicate btn btn-mini btn-primary" rel="tooltip">\n	      <i class=" icon-copy"></i></a>  \n	    <a  href="#" class= "locale_Encrypt btn btn-mini btn-primary" rel="tooltip">\n	      <i class=" '
, o = t.confidential, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        s += '"></i></a> \n	    <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n	      <i class=" ', o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(7, d, i),
            fn: l.program(5, p, i)
        });
        if (o || o === 0) s += o;
        s += '"></i>\n	    </a>\n	    <a  href="#" class = "locale_Plain_Text_Export_Tooltip btn btn-mini btn-info" rel="tooltip" >\n	      <i class=" icon-paste"></i></a>\n	    <a href="#" class = "locale_LaTeX  LaTeX btn btn-mini btn-info" rel="tooltip">\n	      <i class="">LaTeX</i>\n	    </a>\n	    <a href="#" class = "locale_CSV_Tooltip CSV btn btn-mini btn-info" rel="tooltip">\n	      <i class="">CSV</i>\n	    </a>\n	  </div>\n	  <br/>\n		<a href="#" class="audio_video locale_Drag_and_Drop_Audio_Tooltip" rel="tooltip"></a>\n		<span class="session-link"></span>\n	</div>\n  <div class="span3 border-left">\n		<!-- list for the tags -->\n		<ul class="datum_tags_ul unstyled"></ul>\n		<div class="controls  no-margin-left">\n			<!-- TODO go through the corpus to find tags, and put them in this autocomplete -->\n			<div class="input-append ">\n			  <input class="add_tag span6" type="text" data-provide="typeahead" data-items="4" \n	            data-source="[&quot;Passive&quot;,&quot;Nominalization&quot;]" \n	      /><button class=" btn btn-small btn-primary add_datum_tag" type="button">\n	        <i class=" icon-tag"></i>\n	        <span class="locale_Add">Add</span> \n	      </button>\n	    </div>\n		</div>\n	</div>\n  <div class="datum_state span3 border-left">\n    <span class="label label-'
, u = n.statecolor, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.statecolor, o = typeof o === a ? o() : o), s += f(o) + ' datum-state-color "><i class = " icon-flag"></i><span class="datum-state-value">', u = n.datumstate, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.datumstate, o = typeof o === a ? o() : o), s += f(o) + '</span></span><br/>\n		<!-- drop down for the states -->\n    <select class="datum_state_select span12 ">\n      ', o = t.datumStates, o = n.each.call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(9, v, i)
        });
        if (o || o === 0) s += o;
        return s += '\n    </select>\n  </div>\n</div>\n\n\n<!-- Datum comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datum" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>\n'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_field_settings_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<span class="pull-right ', u = n.label, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.label, o = typeof o === a ? o() : o), s += f(o) + '">\n\n<span class ="locale_Encrypt_if_confidential"></span>\n  <input type="checkbox" class="shouldBeEncrypted " ', u = n.shouldBeEncrypted, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.shouldBeEncrypted, o = typeof o === a ? o() : o), s += f(o) + '></input>\n</span>\n\n<input class="choose-field " ', u = n.userchooseable, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.userchooseable, o = typeof o === a ? o() : o), s += f(o) + ' value="', u = n.label, u ? o = u.call(t, {
            hash: {}
        }) : (
o = t.label, o = typeof o === a ? o() : o), s += f(o) + '" type="text"/>\n<label class = "locale_Help_Text"></label>\n<textarea class="help-text locale_Help_Text_Placeholder">', u = n.help, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.help, o = typeof o === a ? o() : o), s += f(o) + "</textarea>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_field_settings_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- this is a read-only version.  -->\n<span class="pull-right">\n\n<span class ="locale_Encrypt_if_confidential"></span>\n<input type="checkbox" class="shouldBeEncrypted" ', u = n.shouldBeEncrypted, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.shouldBeEncrypted, o = typeof o === a ? o() : o), s += f(o) + " disabled></input>\n</span>\n<h4>", u = n.label, u ? 
o = u.call(t, {
            hash: {}
        }) : (o = t.label, o = typeof o === a ? o() : o), s += f(o) + "</h4> \n<p>", u = n.help, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.help, o = typeof o === a ? o() : o), s += f(o) + "</p>\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_field_value_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            var r = "", i, s;
            return r += '\n<a  href="#" class="help-conventions" rel="popover" data-placement="bottom" data-content="', s = n.help, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.help, i = typeof i === a ? i() : i), r += f(i) + '" \n  data-original-title="Conventions/Help" tabindex="-1">\n  <i class="icon-question-sign"></i>\n</a>\n', r;
        }
        function h(e, t) {
            var r = "", i, s;
            return r += '\n<br>\n<input class="datum_field_input small-field" type="text" value="'
, s = n.mask, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.mask, i = typeof i === a ? i() : i), r += f(i) + '" />\n', r;
        }
        function p(e, t) {
            var r = "", i, s;
            return r += '\n<textarea class="datum_field_input">', s = n.mask, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.mask, i = typeof i === a ? i() : i), r += f(i) + "</textarea>\n", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<label class="datum_field_label">', u = n.label, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.label, o = typeof o === a ? o() : o), s += f(o) + "</label>\n", o = t.helpText, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        s += "\n\n", o = t.size, o = n["if"].call(t, o, {
            hash: {},
            inverse
: l.program(5, p, i),
            fn: l.program(3, h, i)
        });
        if (o || o === 0) s += o;
        return s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_field_value_read_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            var r = "", i, s;
            return r += '\n<a  href="#" class="help-conventions" rel="popover" data-placement="bottom" data-content="', s = n.help, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.help, i = typeof i === a ? i() : i), r += f(i) + '" \n  data-original-title="Conventions/Help" tabindex="-1">\n  <i class="icon-question-sign"></i>\n</a>\n', r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<h4 class="datum_field_h4">', u = n.label, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.label, o = typeof o === a ? o() : o), s += f
(o) + "</h4>\n", o = t.helpText, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += "\n<p>", u = n.mask, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.mask, o = typeof o === a ? o() : o), s += f(o) + "</p>\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_read_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            return "icon-eye-close";
        }
        function h(e, t) {
            return "icon-eye-open";
        }
        function p(e, t) {
            var r = "", i;
            r += "\n	  ", i = e.selected, i = n["if"].call(e, i, {
                hash: {},
                inverse: l.noop,
                fn: l.program(6, d, t)
            });
            if (i || i === 0) r += i;
            return r += "\n	  ", r;
        }
        function d
(e, t) {
            var r = "", i, s;
            return r += '\n	  <span class="label label-', s = n.color, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.color, i = typeof i === a ? i() : i), r += f(i) + '"><i class = " icon-flag"></i>', s = n.state, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.state, i = typeof i === a ? i() : i), r += f(i) + "</span>\n	  ", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<!-- list for the fields -->\n<ul class="datum_fields_ul unstyled"></ul>\n<div class="">\n  <i class=" icon-save "></i><span class="last-modified">', u = n.dateModified, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateModified, o = typeof o === a ? o() : o), s += f(o) + '</span><br/>\n  <i class=" icon-time"></i><span class="date-created">', u = n.dateEntered, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateEntered, o = typeof 
o === a ? o() : o), s += f(o) + '</span><br/>\n  <span class="session-link"></span>\n</div>\n<hr/>\n<!-- Datum Read only specialized fields and menu area -->\n<div class="row-fluid">\n  <div class="span5">\n    <!-- Buttons for various read only actions -->\n    <div class=" btn-group">\n      <a href="#" class = "locale_Show_confidential_items_Tooltip btn btn-mini btn-primary" rel="tooltip">\n        <i class=" ', o = t.decryptedMode, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.program(3, h, i),
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        s += '"></i>\n      </a>\n      <a  href="#" class = "locale_Plain_Text_Export_Tooltip btn btn-mini btn-info" rel="tooltip" >\n        <i class=" icon-paste"></i></a>\n      <a href="#" class = "locale_LaTeX  LaTeX btn btn-mini btn-info" rel="tooltip">\n        <i class="">LaTeX</i>\n      </a>\n      <a href="#" class = "locale_CSV_Tooltip CSV btn btn-mini btn-info" rel="tooltip">\n        <i class="">CSV</i>\n      </a>\n    </div>\n    <br/>\n    <div class="audio_video "></div>\n  </div>\n  <div class="span4 border-left">\n    <!-- list for the tags -->\n    <ul class="datum_tags_ul unstyled"></ul>\n  </div>\n  <div class="datum_state span3 border-left">\n    '
, o = t.datumStates, o = n.each.call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(5, p, i)
        });
        if (o || o === 0) s += o;
        return s += '\n  </div>\n</div>\n\n<!-- Datum comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-datum" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_read_latex = e(function(e, t, n, r, i) {
        function c(e, t) {
            var r = "", i, s;
            return r += '\n    <span class = "latex-judgement">', s = n.judgement, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.judgement, i = typeof i === a ? i() : i), r += f(i) + "</span> \n  ", r;
        }
        
function h(e, t) {
            var r = "", i, s;
            return r += '\n	  <span class="glossCouplet">\n	    ', s = n.utteranceSegment, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.utteranceSegment, i = typeof i === a ? i() : i), r += f(i) + "\n	    <br />\n	    ", s = n.glossSegment, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.glossSegment, i = typeof i === a ? i() : i), r += f(i) + "\n	  </span>\n	", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<div class="span1">\n  <input type="checkbox" class="datum-checkboxes"></input>\n</div>\n<div class="span1">\n  ', o = t.judgement, o = n["if"].call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        s += '\n</div>\n<div class="span10">\n	', o = t.couplet, o = n.each.call(t, o, {
            hash: {},
            
inverse: l.noop,
            fn: l.program(3, h, i)
        });
        if (o || o === 0) s += o;
        return s += '\n	<br />\n	<span class="datum-latex-translation">', u = n.translation, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.translation, o = typeof o === a ? o() : o), s += f(o) + "</span>\n</div>", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_state_settings_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<input class="datum_state_input" value="', u = n.state, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.state, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input>\n<select class="color_chooser">\n  <option value="success" class="locale_Green"></option>\n  <option value="warning" class="locale_Orange"></option>\n  <option value="important" class="locale_Red"></option>\n  <option value="info" class="locale_Teal"></option>\n  <option value="inverse" class="locale_Black"></option>\n  <option value="" class="locale_Default"></option>\n</select>\n<span class="label label-'
, u = n.color, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.color, o = typeof o === a ? o() : o), s += f(o) + '"><i class = " icon-flag"></i>', u = n.state, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.state, o = typeof o === a ? o() : o), s += f(o) + "</span>\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_state_settings_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<!-- this is a read-only version.  -->\n\n\n<span class="label label-', u = n.color, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.color, o = typeof o === a ? o() : o), s += f(o) + '"><i class = " icon-flag"></i>', u = n.state, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.state, o = typeof o === a ? o() : o), s += f(o) + "</span>\n\n", s;
    });
}(), function() 
{
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_tag_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<input class="datum_tag input-small span12" value="', u = n.tag, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.tag, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input>\n\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.datum_tag_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<span class="label label-info"><i class = " icon-tag"></i>', u = n.tag, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.tag, o = typeof o === a ? o() : o), s += f(o) + "</span>", s;
    });
}(), function() {
    var e = Handlebars
.template, t = Handlebars.templates = Handlebars.templates || {};
    t.paging_footer = e(function(e, t, n, r, i) {
        function c(e, t) {
            return '\n    <a href="#" class="nextinfinitepagination"><span class = "locale_More"></span></a>\r\n    ';
        }
        function h(e, t) {
            return "\r\n        (All)\r\n      ";
        }
        n = n || e.helpers;
        var s = "", o, u, a = this, f = "function", l = this.escapeExpression;
        s += '<div class="">\r\n  <span class="cell">\r\n    ', o = t.morePages, o = n["if"].call(t, o, {
            hash: {},
            inverse: a.noop,
            fn: a.program(1, c, i)
        });
        if (o || o === 0) s += o;
        s += '\r\n    <span class="cell howmanyperpagination">\r\n        <span class = "locale_Show"></span>\r\n      <a href="#" class="selected">10</a>      |\r\n      <a href="#" class="">50</a>\r\n     |\n      <a href="#" class="">100</a>\r\n       <span class = "locale_per_page"></span>\n    </span>\r\n    <span class="divider">/</span>\r\n    <span class="cell first records">\r\n      <span class="current">'
, u = n.currentPage, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.currentPage, o = typeof o === f ? o() : o), s += l(o) + '</span>\r\n\r\n <span class = "locale_of"></span>\r\n      <span class="total">', u = n.totalPages, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.totalPages, o = typeof o === f ? o() : o), s += l(o) + '</span>\r\n  <span class = "locale_pages_shown"></span>\r\n      ', o = t.allShown, o = n["if"].call(t, o, {
            hash: {},
            inverse: a.noop,
            fn: a.program(3, h, i)
        });
        if (o || o === 0) s += o;
        return s += "\r\n    </span>\r\n  </span>\r\n</div>", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.session_edit_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="btn-toolbar">\n  <div class="btn-toolbar">\n		<div class="pull-right">\n		   <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n		    <i class="icons icon-book"></i></a>\n		  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n		    <i class="icons icon-resize-small"></i></a>\n		</div>\n		<button class="btn btn-success pull-left btn-save-session locale_Save" value="Save"></button>\n  </div>\n</div>\n\n\n<h1><i class="icon-comments-alt"></i> <span class = "locale_Elicitation_Session"></span></h1>\n<ul class="session-fields-ul unstyled"></ul>\n\n\n<!-- Session comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-session" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.session_edit_import = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<i class="icon-comments-alt"></i> <strong class = "locale_Elicitation_Session"></strong>\n<br />\n<label class="locale_Goal"></label>\n<textarea class="session-goal-input">', u = n.goal, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.goal, o = typeof o === a ? o() : o), s += f(o) + '</textarea><br />\n\n<label class="locale_Consultants"></label>\n<textarea class="session-consultant-input">', u = n.consultants, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.consultants, o = typeof o === a ? o() : o), s += f(o) + '</textarea> <br />\n\n<label class = "locale_When"></label>\n<textarea class="session-elicitation-date-input">', u = n.dateElicited, u ? o = u.call(t, {
            
hash: {}
        }) : (o = t.dateElicited, o = typeof o === a ? o() : o), s += f(o) + "</textarea>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.session_edit_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n  <h1><i class="icon-comments-alt"></i> <span class = "locale_New_Session"></span><small>', u = n.pouchname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '</small></h1>\n  <span  class= "locale_New_Session_Instructions"></span>\n</div>\n<div class="modal-body">\n  <ul class="session-fields-ul unstyled"></ul>\n  <a href="#" class="btn locale_Cancel" data-dismiss="modal"></a>\n  <button class="btn btn-success pull-right btn-save-session locale_Save" value="Save"></button>  \n</div>\n', s;
    });
}(), function(
) {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.session_read_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="pull-right">\n  <a href="#" class = "locale_Edit_Session" rel="tooltip">\n      <i class="icons icon-edit"></i></a>\n  <a href="#" class= "locale_Show_in_Dashboard" rel="tooltip" >\n      <i class="icons icon-resize-small"></i></a>\n</div>\n\n<h1 ><i class="icon-comments-alt"> </i><span class = "locale_Elicitation_Session"></span></h1>\n<ul class="session-fields-ul unstyled"></ul>\n\n<!-- Session comments -->\n<ul class="comments unstyled"></ul>\n<div class="alert alert-info">\n  <textarea class="comment-new-text"></textarea>\n  <button class="btn btn-mini btn-primary add-comment-session" value="Add">\n    <i class="icon-comment"></i>\n    <span class = "locale_Add"></span> \n  </button>\n</div>';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars
.templates || {};
    t.session_read_link = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<a href="#session/', u = n._id, u ? o = u.call(t, {
            hash: {}
        }) : (o = t._id, o = typeof o === a ? o() : o), s += f(o) + '">\n<i class="icon-comments-alt"></i>\n  <span>', u = n.dateElicited, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateElicited, o = typeof o === a ? o() : o), s += f(o) + '</span> \n</a>\n--\n<span class= "locale_Consultants"></span> <span>', u = n.consultants, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.consultants, o = typeof o === a ? o() : o), s += f(o) + '</span>\n<br/>\n<span class = "locale_Goal"></span> <span>', u = n.goal, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.goal, o = typeof o === a ? o() : o), s += f(o) + "</span>\n\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars
.templates = Handlebars.templates || {};
    t.session_summary_edit_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="pull-right">\n   <a href="#" class= "locale_Show_Readonly" rel="tooltip">\n    <i class="icons icon-book"></i></a>\n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">    \n    <i class="icons icon-resize-full"></i></a>\n</div>\n  \n<i class="icon-comments-alt"></i> <strong class = "locale_Elicitation_Session"></strong>\n<br />\n<label class="locale_Goal"></label>\n<textarea class="session-goal-input">', u = n.goal, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.goal, o = typeof o === a ? o() : o), s += f(o) + '</textarea><br />\n\n<label class="locale_Consultants"></label>\n<textarea class="session-consultant-input">', u = n.consultants, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.consultants, o = typeof o === a ? 
o() : o), s += f(o) + '</textarea> <br />\n\n<label class = "locale_When"></label>\n<textarea class="session-elicitation-date-input">', u = n.dateElicited, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateElicited, o = typeof o === a ? o() : o), s += f(o) + "</textarea>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.session_summary_read_embedded = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="pull-right">\n  <a href="#" class = "locale_Edit_Session" rel="tooltip">\n    <i class="icons icon-edit"></i></a>\n  <a href="#" class = "locale_Show_fullscreen" rel="tooltip">    \n    <i class="icons icon-resize-full"></i></a>\n</div>\n\n<p>\n  <i class="icon-comments-alt"></i> <strong class = "locale_Elicitation_Session"></strong>\n  <br/>\n  <strong class = "locale_Goal"></strong>\n  <span>'
, u = n.goal, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.goal, o = typeof o === a ? o() : o), s += f(o) + '</span>\n  <br/>\n  \n  <strong class="locale_Consultants"></strong>\n  <span>', u = n.consultants, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.consultants, o = typeof o === a ? o() : o), s += f(o) + '</span>\n  <br />\n  <strong class = "locale_When"></strong>\n  <span>', u = n.dateElicited, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.dateElicited, o = typeof o === a ? o() : o), s += f(o) + "</span>\n</p>", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.export_read_modal = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="modeal-header">\n  <h1 ><span class = "locale_Export"> </span> <small id="export-type-description"></small></h1>\n</div>\n<div class="modal-body export">\n<textarea class="export-large-textarea" id="export-text-area"></textarea>  \n\n</div>\n<div class="modal-footer">\n  <a href="#" class="btn locale_Close" data-dismiss="modal"></a>\n</div>'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.hot_key_edit_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '  <div class="modal-header">\n    <h1 class = "locale_Keyboard_Shortcuts"></h1>\n  </div>\n  <div class="modal-body">\n     <table class="table">  \n        <thead>  \n          <tr>  \n            <th class = "locale_Actions"></th>  \n            <th></th>\n            <th class = "locale_Navigation"></th>  \n          </tr>  \n        </thead>  \n        <tbody>  \n          <tr>  \n            <td> <label class = "locale_Datum_Status_Checked"></label><input value ="', u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n            <td> <label class = "locale_Next_Datum"></label><input value ="'
, u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n          </tr>  \n          <tr>  \n            <td><label class = "locale_New_Datum"></label><input value ="', u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n            <td><label class = "locale_Previous_Datum"></label><input value ="', u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n          </tr>  \n          <tr>  \n            <td><label class = "locale_New_Session"></label><input value ="', u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n            <td><label class = "locale_Search"></label><input value ="'
, u = n.user, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.user, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></input></td>  \n            <td></td>  \n          </tr>  \n        </tbody>  \n      </table>  \n  </div>\n  \n  <div class="modal-footer">\n    <a href="#" class="btn locale_Close" data-dismiss="modal"> </a>\n    <a href="#" class="btn btn-success locale_Save" data-dismiss="modal"></a>\n  </div>\n\n\n\n\n\n\n\n\n\n\n\n           \n     \n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.import_edit_fullscreen = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="container-fluid well">\n	<div class="row-fluid ">\n\n		<div class="">\n			<!--Body content-->\n			<div class="well">\n				<h1>\n					<span class="locale_Import"></span> <small>', u = n.pouchname, u ? o = u.call
(t, {
            hash: {}
        }) : (o = t.pouchname, o = typeof o === a ? o() : o), s += f(o) + '</small>\n				</h1>\n				<progress class="import-progress" max="5" value="0">\n					<strong class="locale_percent_completed"></strong>\n				</progress>\n				Videos: http://www.youtube.com/watch?v=2FbfjJmqWt4&list=PL7D2CC06C80AF754C&index=2&feature=plpp_video\n				<span class="locale_Import_Instructions"></span>\n				<div>', u = n.status, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.status, o = typeof o === a ? o() : o), s += f(o) + '</div>\n			</div>\n\n		</div>\n	</div>\n	<div class="row-fluid "></div>\n</div>\n\n<div class="accordion well" id="accordion2">\n	<div class="accordion-group">\n		<div class="accordion-heading">\n			<a class="accordion-toggle" data-toggle="collapse"\n				data-parent="#accordion2" href="#collapseOne">Step 1: Raw View\n				of the Data</a>\n		</div>\n		<div id="collapseOne" class="accordion-body in collapse ">\n			<div class="accordion-inner">\n\n				<div class="well">\n					<span class="badge badge-info">1</span><span\n						class="badge badge-info">2</span>\n					<textarea\n						class="export-large-textarea  drop-zone locale_Drag_and_Drop_Placeholder">'
, u = n.rawText, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.rawText, o = typeof o === a ? o() : o), s += f(o) + '</textarea>\n\n					Click on Step 2 below.\n				</div>\n\n			</div>\n\n		</div>\n	</div>\n	<div class="accordion-group">\n		<div class="accordion-heading">\n			<a class="accordion-toggle" data-toggle="collapse"\n				data-parent="#accordion2" href="#collapseTwo">Step 2: Editable\n				Tabular View of the Data </a>\n		</div>\n		<div id="collapseTwo" class="accordion-body collapse">\n			<div class="accordion-inner ">\n\n				<button\n					class="btn btn-primary add-column  hide locale_Add_Extra_Columns"></button>\n				<div class="well container span11">\n					<span class="badge badge-info">3</span>\n					<div id="import-datum-field-labels" class="row-fluid"></div>\n				</div>\n\n				<div class="scrollable">\n					<table id="csv-table-area"\n						class="well table table-striped table-bordered table-condensed "></table>\n				</div>\n				Click on Step 3 below\n			</div>\n		</div>\n	</div>\n	<div class="accordion-group">\n		<div class="accordion-heading">\n			<a class="accordion-toggle" data-toggle="collapse"\n				data-parent="#accordion3" href="#collapseThree">Step 3:\n				Intralineaer Gloss/Quick View of the Data View of the Data </a>\n		</div>\n		<div id="collapseThree" class="accordion-body collapse">\n			<div class="accordion-inner">\n\n				<span class="badge badge-info">5</span>\n				<button\n					class="btn btn-success approve-import hide locale_Attempt_Import"></button>\n				<span class="badge badge-info">4</span><span\n					class="badge badge-info">7</span> <span class="badge badge-info">8</span>\n				<button\n					class="btn btn-success approve-save disabled locale_Save_And_Import"></button>\n\n\n				<div id="import-data-list" class="well row">\n					<div id="import-data-list-header" class=" "></div>\n					<div class=" container span12 ">\n						<ul class="unstyled zebra import-data-list-paginated-view"></ul>\n						<div class="pagination-control"></div>\n					</div>\n				</div>\n\n				<div id="import-session" class="well"></div>\n\n			</div>\n		</div>\n	</div>\n</div>\n\n'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.insert_unicode = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<span class="dropdown " id="menu', u = n.symbol, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.symbol, o = typeof o === a ? o() : o), s += f(o) + '"> \n  <a class="btn-mini btn show-unicode-details dropdown-toggle btn-info" data-toggle="dropdown" href="#menu', u = n.symbol, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.symbol, o = typeof o === a ? o() : o), s += f(o) + '"> \n    <b class="unicode-symbol infrequent-unicode-symbol" draggable="true">', u = n.symbol, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.symbol, o = typeof o === a ? o() : o), s += f(o) + '</b>\n  </a>\n	<ul class="dropdown-menu">\n		<li class = "locale_LaTeX_Code"></li>\n		<li><input class="edit-tipa-input input-small" value="'
, u = n.tipa, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.tipa, o = typeof o === a ? o() : o), s += f(o) + '" type="text"></li>\n		<li class = "locale_Unicode_Instructions"></li>\n		<li><a data-toggle="modal" href="#hotkey-settings-modal">\n		  <i class="icon-hdd"></i>\n		  <span class = "locale_Keyboard_Shortcuts"></span> </a></li>\n		<li class="remove-unicode"><a>\n		  <i class="icon-remove-sign"></i>\n		  <span class = "locale_Remove_Unicode"></span></a></li>\n	</ul>\n</span>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.insert_unicodes = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="pull-right">\n  <a href="#" class ="locale_Hide_Unicode_Palette" rel="tooltip" >\n    <i class="icons icon-minus-sign"></i></a>\n</div>\n<h3><span class = "locale_Unicode"></span>\n<span class = "locale_Drag_and_Drop">\n  </span>\n</h3>\n<div id="unicodes" class="unicode-buttons row-fluid"></div>\n<br />\n<span class="like-form-inline">\n  <input class="insert-unicode-input input-small locale_Paste_Type_Unicode_Symbol_Placeholder"  type="text"/>\n  <input class="insert-unicode-tipa-input input-small locale_TIPA_shortcut" type="text"/>\n  <a href="#" class = "locale_Add_new_symbol btn btn-primary add-unicode locale_Add" rel="tooltip">\n    </a>\n</span>'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.insert_unicodes_minimized = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="pull-right">\n  <a href="#" class="locale_Show_Unicode_Palette" rel="tooltip" >\n    <i class="icons icon-plus-sign"></i></a>\n</div>\n<h3><span class = "locale_Unicode"></span>\n<span class = "locale_Drag_and_Drop"> </span>\n</h3>';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.permissions_edit_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            var r = "", i, s;
            return r += "\n		<li>", s = n.username, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.username, i = typeof i === a ? i() : i), r += f(i) + "</li> ", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        
s += '\n<div class="span5">\n	<h4>\n		<i class="icon-group"></i> ', u = n.role, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.role, o = typeof o === a ? o() : o), s += f(o) + "s\n	</h4>\n	<ul>\n		", o = t.users, o = n.each.call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += '\n	</ul>\n</div>\n\n<div class="span6">\n	<label class="locale_Modify_Username_TODO ">Modify Username:</label> <input type="text"\n		class="  choose-add-permission-username" data-provide="typeahead"\n		data-items="4" data-source="', u = n.friends, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.friends, o = typeof o === a ? o() : o), s += f(o) + '">\n	<button class="btn btn-primary  add-user-to-permission-role"\n		value="Add">Add</button>\n	<button class="btn btn-primary  delete-user-permission-role"\n		value="Add">Delete</button>\n</div>\n\n', s;
    });
}(), function() {
    
var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.permissions_read_embedded = e(function(e, t, n, r, i) {
        function c(e, t) {
            var r = "", i, s;
            return r += "\n  <li>", s = n.username, s ? i = s.call(e, {
                hash: {}
            }) : (i = e.username, i = typeof i === a ? i() : i), r += f(i) + "</li> \n  ", r;
        }
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression, l = this;
        s += '<h4><i class="icon-group"></i> ', u = n.role, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.role, o = typeof o === a ? o() : o), s += f(o) + "s</h4>\n<ul>\n  ", o = t.users, o = n.each.call(t, o, {
            hash: {},
            inverse: l.noop,
            fn: l.program(1, c, i)
        });
        if (o || o === 0) s += o;
        return s += "\n</ul>\n", s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars
.templates || {};
    t.search_advanced_edit_embedded = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<div class="title">\n	<h1 class = "locale_Advanced_Search"></h1>\n</div>\n<div class="alert alert-info alert-block">\n	<a class="close" data-dismiss="alert" href="#">\u00d7</a> \n	<strong class="alert-heading ">How Search Works:</strong> \n	<span class="locale_advanced_search_explaination"></span>\n</div>\n\n<ul class="advanced_search_datum unstyled"></ul>\n<ul class="advanced_search_session unstyled"></ul>\n<button class="btn btn-primary btn-search-union">\n  <span class ="locale_OR"></span> \n  <img src = "images/or_venn_diagram.png">\n</button>\n<button class="btn btn-primary btn-search-intersection">\n  <span class ="locale_AND"></span>\n  <img src = "images/and_venn_diagram.png">\n</button>\n\n';
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.search_top = e(function(e, t, n, r, i) {
        n = 
n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<input class="pull-left" id="search_box" type="text" value="', u = n.searchKeywords, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.searchKeywords, o = typeof o === a ? o() : o), s += f(o) + '" />\n<div class="btn-group pull-left">\n	<a href="#" class= "locale_Search_Tooltip" rel="tooltip">\n	  <i class="icons icon-search pull-left icon-white"></i>\n	</a>\n	<button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown">\n		 <span class="caret"></span>\n	</button>\n	<ul class="dropdown-menu">\n		<a href="#" class="btn-advanced-search locale_Advanced_Search locale_Advanced_Search_Tooltip" rel="tooltip"></a>\n	</ul>\n</div>\n\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_app = e(function(e, t, n, r, i) {
        return n = n || e.helpers, '<!-- Black Navigation Bar Across the Top -->\n<div class="navbar navbar-fixed-top navbar-inner width100">\n  <div class="btn-group pull-right">\n    <ul class="nav">\n      <li>\n      <!--  <a href="#" class = "locale_Show_Dashboard" rel="tooltip" title="Show dashboard with data entry form">\n           <i class="icons icon-home icon-white"></i></a> -->\n      </li>\n      <li>\n        <!-- <div class="btn-group">\n          <button class="btn dropdown-toggle btn-inverse" data-toggle="dropdown">\n            <span class = "locale_Need_save"></span>   \n            <progress class="unsaved-changes" max="100" value="30">\n            </progress>\n            <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu unsaved-changes-status" id="unsaved-changes-status">\n            <li class="not-a locale_Recent_Changes"></li>\n          </ul>\n          <a href="#" class = "locale_Save_on_this_Computer pull-right" rel="tooltip">\n            <i class="icons icon-save save-dashboard icon-white"></i></a>\n        </div> -->\n      </li>\n      \n      <li>\n        <!-- <div class="btn-group">\n          <button class="btn dropdown-toggle btn-inverse" data-toggle="dropdown">\n            <span class = "locale_Need_sync"></span>  \n            <progress class="unsynced-changes" max="100" value="80">\n            </progress>\n            <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu unsynced-changes-status" id="unsynced-changes-status">\n            <li class="not-a locale_Differences_with_the_central_server"></li>\n          </ul>\n          <a href="#" class = "locale_Sync_and_Share pull-right" rel="tooltip">\n            <i class="icons icon-sitemap  sync-everything icon-white"></i></a>\n        </div> -->\n      </li>\n      <li>\n        <div class="btn-group">\n        <a href="#" class = "locale_View_Public_Profile_Tooltip pull-left" rel="tooltip">\n         <span id="user-quickview">\n           <i class="icons icon-user icon-white"></i>\n         </span>\n         </a>\n          <button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown"> \n             <span class="caret"></span>  \n          </button>\n          <ul class="dropdown-menu" id="authentication-embedded"></ul>\n        </div>\n      </li>\n    </ul>\n  </div>\n  <div>\n    <!-- This is a div for the top nav bar area -->\n    <span id="search-top" class="search"></span> \n  </div>\n</div>\n<!-- The rest of the page -->\n<div class="container-fluid main">\n\n  <!-- FullScreen Views -->\n  <div id="user-fullscreen" class="well "></div>\n</div>\n\n<!-- Modals are windows which pop over the active app to take focus -->\n<div id="hotkey-settings-modal" class="modal hide"></div>\n<div id="user-modal" class="modal hide"></div>\n<div id="user-preferences-modal" class="modal hide"></div>\n<div id="quick-authenticate-modal" data-backdrop="static" data-keyboard="static" class="modal hide">\n  <div class="modal-header">\n    <h4 class = "locale_We_need_to_make_sure_its_you"></h4>\n  </div>\n  <div class="modal-body">\n  <label class = "locale_Password"></label>\n      <input type="password" id="quick-authenticate-password"/>\n  </div>\n  <div class="modal-footer">\n    <button class="btn btn-success locale_Yep_its_me" id="quick-authentication-okay-btn"></button>\n  </div>\n</div>\n'
;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_edit_fullscreen = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<a href="#" class="locale_Show_Readonly" rel="tooltip"> \n   <i class="icons icon-book pull-right"> </i>\n  </a>\n<button class="btn btn-success pull-right save-user-profile locale_Save"\n    value="Save"></button>\n\n<h1>\n	<span class="locale_User_Profile"> </span> <small>', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + " 	(", u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.lastname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + ') </small>\n</h1>\n<a href = "http://www.fieldlinguist.com/'
, u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '" target="_blank"><i class=" icon-link"></i></a>\n<small>Shareable URL: http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<p class = "locale_Public_Profile_Instructions"></p>\n<hr/>\n<dl>\n    <dt class="locale_Gravatar"></dt>\n    <dd>\n      <img class="gravatar-image gravatar-large" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n    </dd>\n    <dt class="locale_Gravatar_URL"></dt>\n    <dd>\n      <input class="gravatar" type="email" value="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n    </dd>\n    <dt class="locale_Firstname"></dt>\n    <dd>\n      <input class="firstname" value="'
, u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + '" />\n    </dd>\n    <dt class="locale_Lastname"></dt>\n    <dd>\n      <input class="lastname" value="', u = n.lastname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + '" />\n    </dd>\n    <dt class="locale_Email"></dt>\n    <dd>\n      <input class="email" type="email" value="', u = n.email, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.email, o = typeof o === a ? o() : o), s += f(o) + '" />\n    </dd>\n    <dt class="locale_Research_Interests"></dt>\n    <dd>\n      <textarea class="researchInterest">', u = n.researchInterest, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.researchInterest, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n    </dd>\n    <dt class="locale_Affiliation"></dt>\n    <dd>\n      <textarea class="affiliation">', 
u = n.affiliation, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.affiliation, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n    </dd>\n    <dt class="locale_Description"></dt>\n    <dd>\n      <textarea class="description">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n    </dd>\n    <dt><i class="icon-cloud"></i> <span class="locale_Corpora"></span></dt>\n    <dd>\n      <ul class="corpuses">\n      </ul>\n    </dd>\n  </dl>\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_edit_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n	<a href="#" class="locale_Show_Readonly" rel="tooltip"> \n	 <i class="icons icon-book pull-right"> </i>\n	</a>\n  <h1>\n		<span class="locale_User_Profile"> </span> <small>'
, u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + " (", u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.lastname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + ') </small>\n	</h1>\n	<p class = "locale_Private_Profile_Instructions"></p>\n	<button class="btn btn-primary edit-public-user-profile locale_Edit_Public_User_Profile "></button>\n  \n</div>\n<div class="modal-body">\n\n	<dl>\n		<dt class="locale_Gravatar"></dt>\n		<dd>\n			<img class="gravatar-image gravatar-large" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Gravatar_URL"></dt>\n		<dd>\n			<input class="gravatar" type="email" value="', u = n.gravatar, u ? o = u.
call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Firstname"></dt>\n		<dd>\n			<input class="firstname" value="', u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Lastname"></dt>\n		<dd>\n			<input class="lastname" value="', u = n.lastname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Email"></dt>\n		<dd>\n			<input class="email" type="email" value="', u = n.email, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.email, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Research_Interests"></dt>\n		<dd>\n			<textarea class="researchInterest">', u = n.researchInterest, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.researchInterest
, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n		</dd>\n		<dt class="locale_Affiliation"></dt>\n		<dd>\n			<textarea class="affiliation">', u = n.affiliation, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.affiliation, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n		</dd>\n		<dt class="locale_Description"></dt>\n		<dd>\n			<textarea class="description">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + ' \n      </textarea>\n		</dd>\n    <dt><i class="icon-cloud"></i> <span class="locale_Corpora"></span></dt>\n		<dd>\n			<ul class="corpuses">\n			</ul>\n		</dd>\n	</dl>\n</div>\n<div class="modal-footer">\n	<a href="#" class="btn locale_Close" data-dismiss="modal"> </a>\n	<button class="btn btn-success pull-right save-user-profile locale_Save"\n		value="Save"></button>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars
.templates = Handlebars.templates || {};
    t.user_preference_edit_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n	<h1 class = "locale_User_Settings"></h1>\n</div>\n<div class="modal-body">\n  <p class="locale_user_settings_instructions">This is where you can\n		adjust settings that are mostly for you as a user, that aren\'t really\n		tied to a corpus. Your settings are backed up when you authenticate\n		with the server (this usually happens when the "I need to make sure its you" box pops up) so that you can get your preferences if you log in on\n		another device.</p>\n\n  <div class="border-bottom">\n		<h5 class = "locale_Skin"> </h5>\n		<p class="locale_skin_instructions">You can use a combinations of background colors or pictures,\n			and transparency to create the entire range between high contrast, to low contrast, low eyestrain screens\n			to make it easier on your eyes to enter data for long periods of\n			time. You can also keep the background picture on random if you feel\n			it might help you stop procrastinating and enter your data.</p>\n		<span class="user-pref-skin-filename">'
, u = n.skin, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.skin, o = typeof o === a ? o() : o), s += f(o) + '</span>\n		<div class="control-group">\n			<button class="preference btn change-skin locale_Change_Background"></button>\n			<button class="preference btn randomize-backgound locale_Background_on_Random">	</button>\n			<button class="preference btn transparent-dashboard locale_Transparent_Dashboard">		</button>\n		</div>\n	</div>\n	<div class="border-bottom">\n		<h5 class ="locale_Number_Datum"></h5>\n		<p class="locale_number_datum_instructions">You can change the number\n			of datum in the data entry area of your dashboard, if you like to\n			enter data surrounded by context (ie see the datum that you just\n			entered as you would in Word or Excel), you can set it to a high\n			number (5). This can be confusing because the datum are inserted at\n			the top, not at the bottom of the data entry area (if this annoys\n			you, let us know using the bug form, it probably woudlnt take long to make it into an option.)\n			</p>\n			<p> You can\n			also have the app show only one datum, and even make that datum full\n			screen using the arrows in its widget (if you like to enter data like\n			you would in FileMaker Pro). A pretty good middle ground is 2 datum visible. With two datum \n			you can see when you are creating minimal pairs, or creating new datum  \n			to be checked with a language consultant, based on an existing datum.</p>\n  <label class ="locale_Number_Datum" ></label>\n		<select class="num_datum_dropdown">\n			<option value="1">1</option>\n			<option value="2">2</option>\n			<option value="3" selected>3</option>\n			<option value="4">4</option>\n			<option value="5">5</option>\n		</select>\n	</div>\n	<div class="border-bottom">\n    <h5 class ="locale_Font_Size">Font Size</h5>\n		<p class="locale_font_size_instructions">It is very easy to adjust\n			the font size in LingSync, you can use the standard browser features\n			(this is one reason we wanted to make the app in a browser).</p>\n		<h5>Larger Font</h5>\n		<ul>\n			<li>Mac: \u2318+ (Command - Shift - +) </li>\n			<li>Linux/Windows: Control - Shift - + </li>\n			<li>Android: On most Androids you can double tap the screen to zoom in and out, let us know if you figure it out.</li>\n			<li>iPad/iPhone: let us know if you figure it out</li>\n		</ul>\n		<h5>Smaller Font</h5>\n    <ul>\n      <li>Mac: \u2318- (Command -) </li>\n      <li>Linux/Windows: Control -  </li>\n      <li>Android: On most Androids you can double tap the screen to zoom in and out, let us know if you figure it out.</li>\n      <li>iPad/iPhone: let us know if you figure it out</li>\n    </ul>\n	</div>\n\n	<div class="border-bottom">\n		<h5 class="locale_Full_Screen">How to go fullscreen</h5>\n		<p class="locale_full_screen_instructions">It is very easy to go\n			full screen and make LingSync look like a native desktop application,\n			(either with a toolbar) or in complete full screen presentation mode.</p>\n		<h5>Full screen</h5>\n		<ul>\n			<li>Mac: \u2318\u21e7F (Command - Shift - F)</li>\n			<li>Linux: let us know if you figure it out.</li>\n			<li>Windows: F11</li>\n			<li>Android: let us know if you figure it out.</li>\n			<li>iPad/iPhone: let us know if you figure it out</li>\n		</ul>\n		<h5>Full screen (can still see tabs)</h5>\n		<ul>\n			<li>Mac: \u2318^F (Command - Control - F)</li>\n			<li>Linux/Windows: (This how Chrome is normally)</li>\n			<li>Android: (This how Chrome is normally)</li>\n			<li>iPad/iPhone: (This how Chrome is normally)</li>\n		</ul>\n	</div>\n\n</div>\n<div class="modal-footer">\n	<a href="#" class="btn locale_Close" data-dismiss="modal"></a>\n</div>\n\n'
, s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_read_fullscreen = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '\n<a href="#" class="locale_Edit_Public_User_Profile pull-right" 	rel="tooltip"> <i\n	class="icons icon-edit edit-user-profile "></i></a>\n<h1>\n	<span class="locale_User_Profile"> </span> <small>', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + " (", u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.lastname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + ') </small>\n</h1>\n<a href = "http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            
hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '" target="_blank"><i class=" icon-link"></i></a>\n<small>Shareable URL: http://www.fieldlinguist.com/', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '</small>\n<hr/>\n<dl>\n	<dt class="locale_Gravatar"></dt>\n	<dd>\n		<img class="gravatar-image gravatar-large" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n	</dd>\n	<dt class="locale_Email"></dt>\n	<dd class="email">', u = n.email, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.email, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n	<dt class="locale_Research_Interests"></dt>\n	<dd class="researchInterest">', u = n.researchInterest, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.researchInterest, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n	<dt class="locale_Affiliation"></dt>\n	<dd class="affiliation">'
, u = n.affiliation, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.affiliation, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n	<dt class="locale_Description"></dt>\n	<dd class="description">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n  <dt><i class="icon-cloud"></i> <span class="locale_Corpora"></span></dt>\n	<dd>\n		<ul class="corpuses">\n		</ul>\n	</dd>\n</dl>\n\n\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_read_link = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<a href="#user/', u = n._id, u ? o = u.call(t, {
            hash: {}
        }) : (o = t._id, o = typeof o === a ? o() : o), s += f(o) + '" class = "locale_View_Profile_Tooltip " rel="tooltip">\n  <img class="gravatar-small" src="'
, u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" border="0" >\n</a>\n', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_read_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n	<a href="#" class="locale_Edit_User_Profile_Tooltip pull-right" rel="tooltip" >\n	 <i class="icons icon-edit edit-user-profile "></i> </a>\n <h1>\n    <span class="locale_User_Profile"> </span> <small>', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + " (", u = n.firstname, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.firstname, o = typeof o === a ? o() : o), s += f(o) + " ", u = n.lastname, u ? o = u.call(t, {
            hash
: {}
        }) : (o = t.lastname, o = typeof o === a ? o() : o), s += f(o) + ') </small>\n	</h1>\n	<p class = "locale_Private_Profile_Instructions"></p>\n	 <a href="#" class="btn btn-primary view-public-profile locale_View_Public_Profile_Tooltip " ></a>\n  \n</div>\n<div class="modal-body">\n\n	<dl>\n		<dt class="locale_Gravatar"></dt>\n		<dd>\n			<img class="gravatar-image gravatar-large" src="', u = n.gravatar, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.gravatar, o = typeof o === a ? o() : o), s += f(o) + '" />\n		</dd>\n		<dt class="locale_Email"></dt>\n		<dd class="email">', u = n.email, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.email, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n		<dt class="locale_Research_Interests"></dt>\n		<dd class="researchInterest">', u = n.researchInterest, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.researchInterest, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n		<dt class="locale_Affiliation"></dt>\n		<dd class="affiliation">'
, u = n.affiliation, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.affiliation, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n		<dt class="locale_Description"></dt>\n		<dd class="description">', u = n.description, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.description, o = typeof o === a ? o() : o), s += f(o) + '</dd>\n		<dt><i class="icon-cloud"></i> <span class="locale_Corpora"></span></dt>\n		<dd>\n			<ul class="corpuses">\n			</ul>\n		</dd>\n	</dl>\n</div>\n<div class="modal-footer">\n	 <a href="#" class="btn locale_Close" data-dismiss="modal"> </a>\n</div>', s;
    });
}(), function() {
    var e = Handlebars.template, t = Handlebars.templates = Handlebars.templates || {};
    t.user_welcome_modal = e(function(e, t, n, r, i) {
        n = n || e.helpers;
        var s = "", o, u, a = "function", f = this.escapeExpression;
        return s += '<div class="modal-header">\n  <div class="btn-group pull-right">\n    <a href="#" class="btn btn-success sync-lingllama-data locale_Close_and_login_as_LingLlama locale_Close_and_login_as_LingLlama_Tooltip" rel="tooltip"></a>\n    <a class="btn btn-success dropdown-toggle" data-toggle="dropdown" href="#"> \n      <i class="icon-user icon-white"></i> \n      <span class = "locale_Log_In"></span>\n      <span class="caret"></span> \n    </a>\n    <ul class="dropdown-menu">\n      <li class="not-a">\n        <span class = "locale_Username"></span>\n        <input class="welcomeusername" size="16" type="text" />\n      </li>\n      <li class="not-a"> \n        <span class = "locale_Password"></span>\n        <input class="welcomepassword" size="16" type="password" />\n      </li>\n      <li class="not-a"> \n        <span class = "locale_authUrl">Server:</span>\n        <input class="welcomeauthurl" size="16" type="text" />\n      </li>\n      <li class="not-a">\n        <button class="btn btn-success sync-my-data">\n          <span class = "locale_Sync_my_data_to_this_computer"></span>\n        </button>\n      </li>\n    </ul>\n  </div>\n  <div>\n    <!-- <h1 class = "locale_Welcome_to_FieldDB"></h1> -->\n    <img src="icon.png" /><br/>\n    <i class = "locale_An_offline_online_fieldlinguistics_database"></i> <span class="welcome_version_number"></span> \n  </div>\n</div>\n\n<div class="modal-body">\n  <!-- <div class = "locale_Welcome_Beta_Testers"></div> -->\n \n  <div class=" alert alert-error hide welcome-screen-alerts"></div>\n  <div class="breadcrumb create_new_user_password">\n    <h3 class = "locale_Create_a_new_user"></h3>\n    <p>\n      http://www.fieldlinguist.com/'
, u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '\n    </p>\n    <!-- <label class = "locale_What_is_your_username_going_to_be">  </label> -->\n    <span class="like-form-inline">\n      <input class="registerusername" value="', u = n.username, u ? o = u.call(t, {
            hash: {}
        }) : (o = t.username, o = typeof o === a ? o() : o), s += f(o) + '" type="text"/>\n      <button class="btn btn-primary new-user-button locale_New_User"></button>\n    </span>\n    <div class="hide confirm-password">\n      <label class = "locale_Password"></label>\n      <input class="registerpassword" type="password"/>\n      <label class = "locale_Confirm_Password"></label>\n      <input class="to-confirm-password" type="password"/>\n      <label class = "">Email:</label>\n      <input class="registeruseremail" type="email"/>\n      <br />\n      <button class="btn btn-success register-new-user locale_Sign_in_with_password">\n      </button>\n      <!-- Hiding Twitter and facebook because I dont think anyone will use them now. <button class="btn btn-success register-twitter">\n        <i class="i icon-twitter"></i> Sign in with Twitter\n      </button>\n      <button class="btn btn-success register-facebook">\n        <i class="i icon-facebook"></i> Sign in with Facebook\n      </button> -->\n    </div>\n  </div>\n  <div class="welcome_video_iframe">\n    <iframe class="welcome_video_iframe" width="420" height="315" src="https://www.youtube.com/embed/videoseries?list=PL984DA79F4B314FAA" frameborder="0" allowfullscreen></iframe>\n  </div>\n  <!-- <div class="alert alert-block">moved here so that it can be seen on smaller screens by scrolling\n    <a class="close" data-dismiss="alert" href="#">\u00d7</a>\n    <h4 class="alert-heading locale_Warning"></h4>\n   <span class = "locale_Instructions_to_show_on_dashboard"></span>  \n  </div> -->\n</div>\n'
, s;
    });
}(), fielddb.define("compiledTemplates", [ "handlebars" ], function(e) {
    return function() {
        var t, n;
        return t || e.compiledTemplates;
    };
}(this)), function() {
    var e = this, t = e.Backbone, n = Array.prototype.slice, r = Array.prototype.splice, i;
    typeof exports != "undefined" ? i = exports : i = e.Backbone = {}, i.VERSION = "0.9.2";
    var s = e._;
    !s && typeof require != "undefined" && (s = fielddb.require("underscore"));
    var o = e.jQuery || e.Zepto || e.ender;
    i.setDomLibrary = function(e) {
        o = e;
    }, i.noConflict = function() {
        return e.Backbone = t, this;
    }, i.emulateHTTP = !1, i.emulateJSON = !1;
    var u = /\s+/, a = i.Events = {
        on: function(e, t, n) {
            var r, i, s, o, a;
            if (!t) return this;
            e = e.split(u), r = this._callbacks || (this._callbacks = {});
            while (i = e.shift()) a = r[i], s = a ? a.tail : {}, s.next = o = {}, s.context = n, s.callback = 
t, r[i] = {
                tail: o,
                next: a ? a.next : s
            };
            return this;
        },
        off: function(e, t, n) {
            var r, i, o, a, f, l;
            if (!(i = this._callbacks)) return;
            if (!(e || t || n)) return delete this._callbacks, this;
            e = e ? e.split(u) : s.keys(i);
            while (r = e.shift()) {
                o = i[r], delete i[r];
                if (!o || !t && !n) continue;
                a = o.tail;
                while ((o = o.next) !== a) f = o.callback, l = o.context, (t && f !== t || n && l !== n) && this.on(r, f, l);
            }
            return this;
        },
        trigger: function(e) {
            var t, r, i, s, o, a, f;
            if (!(i = this._callbacks)) return this;
            a = i.all, e = e.split(u), f = n.call(arguments, 1);
            while (t = e.shift()) {
                if (r = i[t]) {
                    s = r.tail;
                    while ((r = r.next
) !== s) r.callback.apply(r.context || this, f);
                }
                if (r = a) {
                    s = r.tail, o = [ t ].concat(f);
                    while ((r = r.next) !== s) r.callback.apply(r.context || this, o);
                }
            }
            return this;
        }
    };
    a.bind = a.on, a.unbind = a.off;
    var f = i.Model = function(e, t) {
        var n;
        e || (e = {}), t && t.parse && (e = this.parse(e));
        if (n = C(this, "defaults")) e = s.extend({}, n, e);
        t && t.collection && (this.collection = t.collection), this.attributes = {}, this._escapedAttributes = {}, this.cid = s.uniqueId("c"), this.changed = {}, this._silent = {}, this._pending = {}, this.set(e, {
            silent: !0
        }), this.changed = {}, this._silent = {}, this._pending = {}, this._previousAttributes = s.clone(this.attributes), this.initialize.apply(this, arguments);
    };
    s.extend(f.prototype, a, {
        changed: null,
        _silent: 
null,
        _pending: null,
        idAttribute: "id",
        initialize: function() {},
        toJSON: function(e) {
            return s.clone(this.attributes);
        },
        get: function(e) {
            return this.attributes[e];
        },
        escape: function(e) {
            var t;
            if (t = this._escapedAttributes[e]) return t;
            var n = this.get(e);
            return this._escapedAttributes[e] = s.escape(n == null ? "" : "" + n);
        },
        has: function(e) {
            return this.get(e) != null;
        },
        set: function(e, t, n) {
            var r, i, o;
            s.isObject(e) || e == null ? (r = e, n = t) : (r = {}, r[e] = t), n || (n = {});
            if (!r) return this;
            r instanceof f && (r = r.attributes);
            if (n.unset) for (i in r) r[i] = void 0;
            if (!this._validate(r, n)) return !1;
            this.idAttribute in r && (this.id = r[this.idAttribute]);
            var u = n.changes = 
{}, a = this.attributes, l = this._escapedAttributes, c = this._previousAttributes || {};
            for (i in r) {
                o = r[i];
                if (!s.isEqual(a[i], o) || n.unset && s.has(a, i)) delete l[i], (n.silent ? this._silent : u)[i] = !0;
                n.unset ? delete a[i] : a[i] = o, !s.isEqual(c[i], o) || s.has(a, i) != s.has(c, i) ? (this.changed[i] = o, n.silent || (this._pending[i] = !0)) : (delete this.changed[i], delete this._pending[i]);
            }
            return n.silent || this.change(n), this;
        },
        unset: function(e, t) {
            return (t || (t = {})).unset = !0, this.set(e, null, t);
        },
        clear: function(e) {
            return (e || (e = {})).unset = !0, this.set(s.clone(this.attributes), e);
        },
        fetch: function(e) {
            e = e ? s.clone(e) : {};
            var t = this, n = e.success;
            return e.success = function(r, i, s) {
                if (!t.set(t.parse(r, s), e)) return !1
;
                n && n(t, r);
            }, e.error = i.wrapError(e.error, t, e), (this.sync || i.sync).call(this, "read", this, e);
        },
        save: function(e, t, n) {
            var r, o;
            s.isObject(e) || e == null ? (r = e, n = t) : (r = {}, r[e] = t), n = n ? s.clone(n) : {};
            if (n.wait) {
                if (!this._validate(r, n)) return !1;
                o = s.clone(this.attributes);
            }
            var u = s.extend({}, n, {
                silent: !0
            });
            if (r && !this.set(r, n.wait ? u : n)) return !1;
            var a = this, f = n.success;
            n.success = function(e, t, i) {
                var o = a.parse(e, i);
                n.wait && (delete n.wait, o = s.extend(r || {}, o));
                if (!a.set(o, n)) return !1;
                f ? f(a, e) : a.trigger("sync", a, e, n);
            }, n.error = i.wrapError(n.error, a, n);
            var l = this.isNew() ? "create" : "update", c = (this
.sync || i.sync).call(this, l, this, n);
            return n.wait && this.set(o, u), c;
        },
        destroy: function(e) {
            e = e ? s.clone(e) : {};
            var t = this, n = e.success, r = function() {
                t.trigger("destroy", t, t.collection, e);
            };
            if (this.isNew()) return r(), !1;
            e.success = function(i) {
                e.wait && r(), n ? n(t, i) : t.trigger("sync", t, i, e);
            }, e.error = i.wrapError(e.error, t, e);
            var o = (this.sync || i.sync).call(this, "delete", this, e);
            return e.wait || r(), o;
        },
        url: function() {
            var e = C(this, "urlRoot") || C(this.collection, "url") || k();
            return this.isNew() ? e : e + (e.charAt(e.length - 1) == "/" ? "" : "/") + encodeURIComponent(this.id);
        },
        parse: function(e, t) {
            return e;
        },
        clone: function() {
            return new this.constructor(this.attributes
);
        },
        isNew: function() {
            return this.id == null;
        },
        change: function(e) {
            e || (e = {});
            var t = this._changing;
            this._changing = !0;
            for (var n in this._silent) this._pending[n] = !0;
            var r = s.extend({}, e.changes, this._silent);
            this._silent = {};
            for (var n in r) this.trigger("change:" + n, this, this.get(n), e);
            if (t) return this;
            while (!s.isEmpty(this._pending)) {
                this._pending = {}, this.trigger("change", this, e);
                for (var n in this.changed) {
                    if (this._pending[n] || this._silent[n]) continue;
                    delete this.changed[n];
                }
                this._previousAttributes = s.clone(this.attributes);
            }
            return this._changing = !1, this;
        },
        hasChanged: function(e) {
            return arguments.length ? s.has(this.changed
, e) : !s.isEmpty(this.changed);
        },
        changedAttributes: function(e) {
            if (!e) return this.hasChanged() ? s.clone(this.changed) : !1;
            var t, n = !1, r = this._previousAttributes;
            for (var i in e) {
                if (s.isEqual(r[i], t = e[i])) continue;
                (n || (n = {}))[i] = t;
            }
            return n;
        },
        previous: function(e) {
            return !arguments.length || !this._previousAttributes ? null : this._previousAttributes[e];
        },
        previousAttributes: function() {
            return s.clone(this._previousAttributes);
        },
        isValid: function() {
            return !this.validate(this.attributes);
        },
        _validate: function(e, t) {
            if (t.silent || !this.validate) return !0;
            e = s.extend({}, this.attributes, e);
            var n = this.validate(e, t);
            return n ? (t && t.error ? t.error(this, n, t) : this.trigger("error"
, this, n, t), !1) : !0;
        }
    });
    var l = i.Collection = function(e, t) {
        t || (t = {}), t.model && (this.model = t.model), t.comparator && (this.comparator = t.comparator), this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, {
            silent: !0,
            parse: t.parse
        });
    };
    s.extend(l.prototype, a, {
        model: f,
        initialize: function() {},
        toJSON: function(e) {
            return this.map(function(t) {
                return t.toJSON(e);
            });
        },
        add: function(e, t) {
            var n, i, o, u, a, f, l = {}, c = {}, h = [];
            t || (t = {}), e = s.isArray(e) ? e.slice() : [ e ];
            for (n = 0, o = e.length; n < o; n++) {
                if (!(u = e[n] = this._prepareModel(e[n], t))) throw new Error("Can't add an invalid model to a collection");
                a = u.cid, f = u.id;
                if (l[a] || this._byCid[a] || f != null && (c[f] || this.
_byId[f])) {
                    h.push(n);
                    continue;
                }
                l[a] = c[f] = u;
            }
            n = h.length;
            while (n--) e.splice(h[n], 1);
            for (n = 0, o = e.length; n < o; n++) (u = e[n]).on("all", this._onModelEvent, this), this._byCid[u.cid] = u, u.id != null && (this._byId[u.id] = u);
            this.length += o, i = t.at != null ? t.at : this.models.length, r.apply(this.models, [ i, 0 ].concat(e)), this.comparator && this.sort({
                silent: !0
            });
            if (t.silent) return this;
            for (n = 0, o = this.models.length; n < o; n++) {
                if (!l[(u = this.models[n]).cid]) continue;
                t.index = n, u.trigger("add", u, this, t);
            }
            return this;
        },
        remove: function(e, t) {
            var n, r, i, o;
            t || (t = {}), e = s.isArray(e) ? e.slice() : [ e ];
            for (n = 0, r = e.length; n < r
; n++) {
                o = this.getByCid(e[n]) || this.get(e[n]);
                if (!o) continue;
                delete this._byId[o.id], delete this._byCid[o.cid], i = this.indexOf(o), this.models.splice(i, 1), this.length--, t.silent || (t.index = i, o.trigger("remove", o, this, t)), this._removeReference(o);
            }
            return this;
        },
        push: function(e, t) {
            return e = this._prepareModel(e, t), this.add(e, t), e;
        },
        pop: function(e) {
            var t = this.at(this.length - 1);
            return this.remove(t, e), t;
        },
        unshift: function(e, t) {
            return e = this._prepareModel(e, t), this.add(e, s.extend({
                at: 0
            }, t)), e;
        },
        shift: function(e) {
            var t = this.at(0);
            return this.remove(t, e), t;
        },
        get: function(e) {
            return e == null ? void 0 : this._byId[e.id != null ? e.id : e];
        },
        
getByCid: function(e) {
            return e && this._byCid[e.cid || e];
        },
        at: function(e) {
            return this.models[e];
        },
        where: function(e) {
            return s.isEmpty(e) ? [] : this.filter(function(t) {
                for (var n in e) if (e[n] !== t.get(n)) return !1;
                return !0;
            });
        },
        sort: function(e) {
            e || (e = {});
            if (!this.comparator) throw new Error("Cannot sort a set without a comparator");
            var t = s.bind(this.comparator, this);
            return this.comparator.length == 1 ? this.models = this.sortBy(t) : this.models.sort(t), e.silent || this.trigger("reset", this, e), this;
        },
        pluck: function(e) {
            return s.map(this.models, function(t) {
                return t.get(e);
            });
        },
        reset: function(e, t) {
            e || (e = []), t || (t = {});
            for (var n = 0, r = this.models.length; n < 
r; n++) this._removeReference(this.models[n]);
            return this._reset(), this.add(e, s.extend({
                silent: !0
            }, t)), t.silent || this.trigger("reset", this, t), this;
        },
        fetch: function(e) {
            e = e ? s.clone(e) : {}, e.parse === undefined && (e.parse = !0);
            var t = this, n = e.success;
            return e.success = function(r, i, s) {
                t[e.add ? "add" : "reset"](t.parse(r, s), e), n && n(t, r);
            }, e.error = i.wrapError(e.error, t, e), (this.sync || i.sync).call(this, "read", this, e);
        },
        create: function(e, t) {
            var n = this;
            t = t ? s.clone(t) : {}, e = this._prepareModel(e, t);
            if (!e) return !1;
            t.wait || n.add(e, t);
            var r = t.success;
            return t.success = function(i, s, o) {
                t.wait && n.add(i, t), r ? r(i, s) : i.trigger("sync", e, s, t);
            }, e.save(null, t), e;
        }
,
        parse: function(e, t) {
            return e;
        },
        chain: function() {
            return s(this.models).chain();
        },
        _reset: function(e) {
            this.length = 0, this.models = [], this._byId = {}, this._byCid = {};
        },
        _prepareModel: function(e, t) {
            t || (t = {});
            if (e instanceof f) e.collection || (e.collection = this); else {
                var n = e;
                t.collection = this, e = new this.model(n, t), e._validate(e.attributes, t) || (e = !1);
            }
            return e;
        },
        _removeReference: function(e) {
            this == e.collection && delete e.collection, e.off("all", this._onModelEvent, this);
        },
        _onModelEvent: function(e, t, n, r) {
            if ((e == "add" || e == "remove") && n != this) return;
            e == "destroy" && this.remove(t, r), t && e === "change:" + t.idAttribute && (delete this._byId[t.previous(t.idAttribute)], this._byId
[t.id] = t), this.trigger.apply(this, arguments);
        }
    });
    var c = [ "forEach", "each", "map", "reduce", "reduceRight", "find", "detect", "filter", "select", "reject", "every", "all", "some", "any", "include", "contains", "invoke", "max", "min", "sortBy", "sortedIndex", "toArray", "size", "first", "initial", "rest", "last", "without", "indexOf", "shuffle", "lastIndexOf", "isEmpty", "groupBy" ];
    s.each(c, function(e) {
        l.prototype[e] = function() {
            return s[e].apply(s, [ this.models ].concat(s.toArray(arguments)));
        };
    });
    var h = i.Router = function(e) {
        e || (e = {}), e.routes && (this.routes = e.routes), this._bindRoutes(), this.initialize.apply(this, arguments);
    }, p = /:\w+/g, d = /\*\w+/g, v = /[-[\]{}()+?.,\\^$|#\s]/g;
    s.extend(h.prototype, a, {
        initialize: function() {},
        route: function(e, t, n) {
            return i.history || (i.history = new m), s.isRegExp(e) || (e = this._routeToRegExp(e)), n || 
(n = this[t]), i.history.route(e, s.bind(function(r) {
                var s = this._extractParameters(e, r);
                n && n.apply(this, s), this.trigger.apply(this, [ "route:" + t ].concat(s)), i.history.trigger("route", this, t, s);
            }, this)), this;
        },
        navigate: function(e, t) {
            i.history.navigate(e, t);
        },
        _bindRoutes: function() {
            if (!this.routes) return;
            var e = [];
            for (var t in this.routes) e.unshift([ t, this.routes[t] ]);
            for (var n = 0, r = e.length; n < r; n++) this.route(e[n][0], e[n][1], this[e[n][1]]);
        },
        _routeToRegExp: function(e) {
            return e = e.replace(v, "\\$&").replace(p, "([^/]+)").replace(d, "(.*?)"), new RegExp("^" + e + "$");
        },
        _extractParameters: function(e, t) {
            return e.exec(t).slice(1);
        }
    });
    var m = i.History = function() {
        this.handlers = [], s.bindAll(this, "checkUrl"
);
    }, g = /^[#\/]/, y = /msie [\w.]+/;
    m.started = !1, s.extend(m.prototype, a, {
        interval: 50,
        getHash: function(e) {
            var t = e ? e.location : window.location, n = t.href.match(/#(.*)$/);
            return n ? n[1] : "";
        },
        getFragment: function(e, t) {
            if (e == null) if (this._hasPushState || t) {
                e = window.location.pathname;
                var n = window.location.search;
                n && (e += n);
            } else e = this.getHash();
            return e.indexOf(this.options.root) || (e = e.substr(this.options.root.length)), e.replace(g, "");
        },
        start: function(e) {
            if (m.started) throw new Error("Backbone.history has already been started");
            m.started = !0, this.options = s.extend({}, {
                root: "/"
            }, this.options, e), this._wantsHashChange = this.options.hashChange !== !1, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!
(this.options.pushState && window.history && window.history.pushState);
            var t = this.getFragment(), n = document.documentMode, r = y.exec(navigator.userAgent.toLowerCase()) && (!n || n <= 7);
            r && (this.iframe = o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow, this.navigate(t)), this._hasPushState ? o(window).bind("popstate", this.checkUrl) : this._wantsHashChange && "onhashchange" in window && !r ? o(window).bind("hashchange", this.checkUrl) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval)), this.fragment = t;
            var i = window.location, u = i.pathname == this.options.root;
            if (this._wantsHashChange && this._wantsPushState && !this._hasPushState && !u) return this.fragment = this.getFragment(null, !0), window.location.replace(this.options.root + "#" + this.fragment), !0;
            this._wantsPushState && this._hasPushState && u && i.hash && (this.fragment = 
this.getHash().replace(g, ""), window.history.replaceState({}, document.title, i.protocol + "//" + i.host + this.options.root + this.fragment));
            if (!this.options.silent) return this.loadUrl();
        },
        stop: function() {
            o(window).unbind("popstate", this.checkUrl).unbind("hashchange", this.checkUrl), clearInterval(this._checkUrlInterval), m.started = !1;
        },
        route: function(e, t) {
            this.handlers.unshift({
                route: e,
                callback: t
            });
        },
        checkUrl: function(e) {
            var t = this.getFragment();
            t == this.fragment && this.iframe && (t = this.getFragment(this.getHash(this.iframe)));
            if (t == this.fragment) return !1;
            this.iframe && this.navigate(t), this.loadUrl() || this.loadUrl(this.getHash());
        },
        loadUrl: function(e) {
            var t = this.fragment = this.getFragment(e), n = s.any(this.handlers, function(e) {
                
if (e.route.test(t)) return e.callback(t), !0;
            });
            return n;
        },
        navigate: function(e, t) {
            if (!m.started) return !1;
            if (!t || t === !0) t = {
                trigger: t
            };
            var n = (e || "").replace(g, "");
            if (this.fragment == n) return;
            this._hasPushState ? (n.indexOf(this.options.root) != 0 && (n = this.options.root + n), this.fragment = n, window.history[t.replace ? "replaceState" : "pushState"]({}, document.title, n)) : this._wantsHashChange ? (this.fragment = n, this._updateHash(window.location, n, t.replace), this.iframe && n != this.getFragment(this.getHash(this.iframe)) && (t.replace || this.iframe.document.open().close(), this._updateHash(this.iframe.location, n, t.replace))) : window.location.assign(this.options.root + e), t.trigger && this.loadUrl(e);
        },
        _updateHash: function(e, t, n) {
            n ? e.replace(e.toString().replace(/(javascript:|#).*$/
, "") + "#" + t) : e.hash = t;
        }
    });
    var b = i.View = function(e) {
        this.cid = s.uniqueId("view"), this._configure(e || {}), this._ensureElement(), this.initialize.apply(this, arguments), this.delegateEvents();
    }, w = /^(\S+)\s*(.*)$/, E = [ "model", "collection", "el", "id", "attributes", "className", "tagName" ];
    s.extend(b.prototype, a, {
        tagName: "div",
        $: function(e) {
            return this.$el.find(e);
        },
        initialize: function() {},
        render: function() {
            return this;
        },
        remove: function() {
            return this.$el.remove(), this;
        },
        make: function(e, t, n) {
            var r = document.createElement(e);
            return t && o(r).attr(t), n && o(r).html(n), r;
        },
        setElement: function(e, t) {
            return this.$el && this.undelegateEvents(), this.$el = e instanceof o ? e : o(e), this.el = this.$el[0], t !== !1 && this.delegateEvents(), this
;
        },
        delegateEvents: function(e) {
            if (!e && !(e = C(this, "events"))) return;
            this.undelegateEvents();
            for (var t in e) {
                var n = e[t];
                s.isFunction(n) || (n = this[e[t]]);
                if (!n) throw new Error('Method "' + e[t] + '" does not exist');
                var r = t.match(w), i = r[1], o = r[2];
                n = s.bind(n, this), i += ".delegateEvents" + this.cid, o === "" ? this.$el.bind(i, n) : this.$el.delegate(o, i, n);
            }
        },
        undelegateEvents: function() {
            this.$el.unbind(".delegateEvents" + this.cid);
        },
        _configure: function(e) {
            this.options && (e = s.extend({}, this.options, e));
            for (var t = 0, n = E.length; t < n; t++) {
                var r = E[t];
                e[r] && (this[r] = e[r]);
            }
            this.options = e;
        },
        _ensureElement: function() {
            if (!this
.el) {
                var e = C(this, "attributes") || {};
                this.id && (e.id = this.id), this.className && (e["class"] = this.className), this.setElement(this.make(this.tagName, e), !1);
            } else this.setElement(this.el, !1);
        }
    });
    var S = function(e, t) {
        var n = N(this, e, t);
        return n.extend = this.extend, n;
    };
    f.extend = l.extend = h.extend = b.extend = S;
    var x = {
        create: "POST",
        update: "PUT",
        "delete": "DELETE",
        read: "GET"
    };
    i.sync = function(e, t, n) {
        var r = x[e];
        n || (n = {});
        var u = {
            type: r,
            dataType: "json"
        };
        return n.url || (u.url = C(t, "url") || k()), !n.data && t && (e == "create" || e == "update") && (u.contentType = "application/json", u.data = JSON.stringify(t.toJSON())), i.emulateJSON && (u.contentType = "application/x-www-form-urlencoded", u.data = u.data ? {
            model: u.data
        
} : {}), i.emulateHTTP && (r === "PUT" || r === "DELETE") && (i.emulateJSON && (u.data._method = r), u.type = "POST", u.beforeSend = function(e) {
            e.setRequestHeader("X-HTTP-Method-Override", r);
        }), u.type !== "GET" && !i.emulateJSON && (u.processData = !1), o.ajax(s.extend(u, n));
    }, i.wrapError = function(e, t, n) {
        return function(r, i) {
            i = r === t ? i : r, e ? e(t, i, n) : t.trigger("error", t, i, n);
        };
    };
    var T = function() {}, N = function(e, t, n) {
        var r;
        return t && t.hasOwnProperty("constructor") ? r = t.constructor : r = function() {
            e.apply(this, arguments);
        }, s.extend(r, e), T.prototype = e.prototype, r.prototype = new T, t && s.extend(r.prototype, t), n && s.extend(r, n), r.prototype.constructor = r, r.__super__ = e.prototype, r;
    }, C = function(e, t) {
        return !e || !e[t] ? null : s.isFunction(e[t]) ? e[t]() : e[t];
    }, k = function() {
        throw new Error
('A "url" property or function must be specified');
    };
}.call(this), fielddb.define("backbone", [ "underscore", "jquery", "compiledTemplates" ], function(e) {
    return function() {
        var t, n;
        return t || e.Backbone;
    };
}(this));

var Utils = Utils || {};

Utils.debugMode = !1, Utils.touchUrl = "http://localhost:8888/db", Utils.pouchUrl = "idb://db", Utils.contactUs = "<a href='https://docs.google.com/spreadsheet/viewform?formkey=dGFyREp4WmhBRURYNzFkcWZMTnpkV2c6MQ' target='_blank'>Contact Us</a>", Utils.debug = function(e, t) {
    if (navigator.appName == "Microsoft Internet Explorer") return;
    this.debugMode && (console.log(e), t && console.log(t));
}, Utils.publisher = {
    subscribers: {
        any: []
    },
    subscribe: function(e, t, n) {
        e = e || "any", t = typeof t == "function" ? t : n[t], typeof this.subscribers[e] == "undefined" && (this.subscribers[e] = []), this.subscribers[e].push({
            fn: t,
            context: n || this
        
});
    },
    unsubscribe: function(e, t, n) {
        this.visitSubscribers("unsubscribe", e, t, n);
    },
    publish: function(e, t) {
        this.visitSubscribers("publish", e, t);
    },
    visitSubscribers: function(e, t, n, r) {
        var i = t || "any", s = this.subscribers[i], o, u = s ? s.length : 0;
        for (o = 0; o < u; o += 1) if (e === "publish") s[o] && s[o].fn.call(s[o].context, n); else try {
            if (s[o].context === r) {
                var a = s.splice(o, 1);
                Utils.debug("Removed subscriber from " + t, a);
            } else Utils.debug(t + " keeping subscriber " + o);
        } catch (f) {
            Utils.debug("problem visiting Subscriber " + o);
        }
    }
}, Utils.makePublisher = function(e) {
    var t;
    for (t in Utils.publisher) Utils.publisher.hasOwnProperty(t) && typeof Utils.publisher[t] == "function" && (e[t] = Utils.publisher[t]);
    e.subscribers = {
        any: []
    };
}, Utils.setCookie = function(e, t, n
) {
    var r = new Date;
    r.setDate(r.getDate() + n);
    var i = escape(t) + (n == null ? "" : "; expires=" + r.toUTCString());
    document.cookie = e + "=" + i;
}, Utils.getCookie = function(e) {
    var t, n, r, i = document.cookie.split(";");
    for (t = 0; t < i.length; t++) {
        n = i[t].substr(0, i[t].indexOf("=")), r = i[t].substr(i[t].indexOf("=") + 1), n = n.replace(/^\s+|\s+$/g, "");
        if (n == e) return unescape(r);
    }
}, Utils.androidApp = function() {
    return navigator.userAgent.indexOf("OfflineAndroidApp") > -1;
}, Utils.chromeApp = function() {
    return window.location.href.indexOf("chrome-extension") > -1;
}, Utils.onlineOnly = function() {
    return !this.androidApp() && !this.chromeApp();
}, Utils.getVersion = function(e) {
    var t = new XMLHttpRequest;
    t.open("GET", "manifest.json"), t.onload = function(n) {
        var r = JSON.parse(t.responseText);
        e(r.version);
    }, t.send(null);
}, Utils.prettyDate = function(e) {
    if (!
e) return undefined;
    e = e.replace(/"/g, "");
    var t = new Date((e || "").replace(/-/g, "/").replace(/[TZ]/g, " ")), n = JSON.stringify(new Date).replace(/"/g, ""), r = new Date((n || "").replace(/-/g, "/").replace(/[TZ]/g, " ")), i = (r.getTime() - t.getTime()) / 1e3, s = Math.floor(i / 86400);
    return isNaN(s) || s < 0 || s >= 31 ? undefined : s == 0 && (i < 60 && "just now" || i < 120 && "1 minute ago" || i < 3600 && Math.floor(i / 60) + " minutes ago" || i < 7200 && "1 hour ago" || i < 86400 && Math.floor(i / 3600) + " hours ago") || s == 1 && "Yesterday" || s < 7 && s + " days ago" || s < 31 && Math.ceil(s / 7) + " weeks ago";
}, Utils.prettyTimestamp = function(e) {
    var t = new Date(e), n = new Date, r = (n.getTime() - t.getTime()) / 1e3, i = Math.floor(r / 86400);
    if (isNaN(i) || i < 0 || i >= 31) return;
    return i == 0 && (r < 60 && "just now" || r < 120 && "1 minute ago" || r < 3600 && Math.floor(r / 60) + " minutes ago" || r < 7200 && "1 hour ago" || r < 86400 && 
Math.floor(r / 3600) + " hours ago") || i == 1 && "Yesterday" || i < 7 && i + " days ago" || i < 31 && Math.ceil(i / 7) + " weeks ago";
}, Utils.catchAndThrowAjaxError = function(e, t, n, r) {
    console.log("	Ajax error in: " + n.url + " \n" + "error:\n" + t.responseText), window.hub.publish("ajaxError", r);
}, Utils.catchAndThrowPouchError = function(e) {
    console.log("	Caught Error : ", e), e && window.hub.publish("pouchError", e);
}, Utils.testPouchChromeVersions = function(e) {
    var t = localStorage.getItem(e + "chromeCreationVersion"), n = window.navigator.appVersion.match(/Chrome\/(.*?) /)[1];
    if (!t) {
        localStorage.setItem(e + "chromeCreationVersion", n);
        return;
    }
    n != t && (n == "23.0.1271.17" ? alert("We need to upgrade your local database to work with 23.0.1271.17 version of Chrome. The app will attempt to move your local databases to a local backup, then log you out. When you log back in, the app will sync down your most recent corpora into a fresh new local database which will be compatible with 23.0.1271.17."
) : alert("Chrome changes really quickly, which is good because we get an even better offline database, but also bad because it means we need to give you special instructions.\n\nWe have discovered that Chrome version 23.0.1271.17 changes the local offline IndexedDataBase (where your corpus is stored) significantly enough that you won't be able to use your database if it was created with a previous version of Chrome. Here is the solution: before you update to Chrome 23.0.1271.17, you should sync your corpus. We have programmed the app to log you out, and do the databse upgrade for you, but you will lose some of your data if you have synced it to the team server. \n\nWe have created this pop-up to remind you to sync/backup your data to the server before you upgrade your Chrome browser."));
}, fielddb.define("libs/Utils", function() {}), fielddb.define("user/UserMask", [ "backbone", "libs/Utils" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {
            Utils
.debug("UserMask init", this.toJSON());
        },
        changePouch: function(t, n) {
            t || (t = this.get("pouchname"), t == undefined && (t = window.app.get("corpus").get("pouchname"))), this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t : Utils.pouchUrl + t)), typeof n == "function" && n();
        },
        saveAndInterConnectInApp: function(e, t) {
            Utils.debug("Saving the UserMask");
            var n = this;
            this.changePouch(null, function() {
                n.pouch(function(r, i) {
                    var s = n.toJSON();
                    if (!s._id) {
                        if (!s.id) {
                            Utils.debug("Trying to save user mask too early, before it has an _id. not saving...but pretending it worked", s), typeof e == "function" && e();
                            return;
                        }
                        s._id = s.id;
                    }
                    
i.put(s, function(r, o) {
                        r ? (Utils.debug("UserMask put error", r), r.status == "409" ? n.fetch({
                            success: function(r, o) {
                                Utils.debug("UserMask fetch revision number success, after getting a Document update conflict", o), s._rev = n.get("_rev"), Utils.debug("Usermask old version", n.toJSON()), Utils.debug("Usermask replaced with new version", s), i.put(s, function(n, r) {
                                    n ? (Utils.debug("UserMask put error, even after fetching the version number", n), typeof t == "function" && t()) : (Utils.debug("UserMask put success, after fetching its version number and overwriting it", r), typeof e == "function" && e());
                                });
                            },
                            error: function(e) {
                                Utils.debug("UserMask fetch error after trying to resolve a conflict error" + JSON.stringify(r)), typeof t == "function" && 
t();
                            }
                        }) : (Utils.debug("UserMask put error that was not a conflict" + JSON.stringify(r)), typeof t == "function" && t())) : (Utils.debug("UserMask put success", o), typeof e == "function" && e());
                    });
                });
            });
        }
    });
    return t;
}), fielddb.define("activity/Activity", [ "backbone", "user/UserMask" ], function(e, t) {
    var n = e.Model.extend({
        initialize: function() {
            Utils.debug("ACTIVITY init: "), this.get("user") || this.set("user", window.app.get("authentication").get("userPublic")), this.get("timestamp") || (this.set("timestamp", Date.now()), this.set("dateModified", JSON.stringify(new Date))), this.get("teamOrPersonal") || this.set("teamOrPersonal", "personal");
        },
        defaults: {},
        model: {
            user: t
        },
        changePouch: function(t, n) {
            if (!t) if (this.get("teamOrPersonal") == "personal") {
                
if (this.get("user").get("username") != window.app.get("authentication").get("userPublic").get("username")) {
                    alert("Bug in setting the pouch for this activity, i can only save activities from the current logged in user, not other users");
                    return;
                }
                t = window.app.get("authentication").get("userPrivate").get("activityCouchConnection").pouchname, this.set("pouchname", t);
            } else try {
                t = window.app.get("currentCorpusTeamActivityFeed").get("couchConnection").pouchname, this.set("pouchname", t);
            } catch (r) {
                alert("Bug in setting the pouch for this activity, i can only save activities for the current corpus team.");
                return;
            }
            this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t : Utils.pouchUrl + t)), typeof n == "function" && n();
        },
        saveAndInterConnectInApp: function(
e, t) {
            Utils.debug("Saving the Activity");
            var n = this;
            if (!this.isNew()) {
                Utils.debug("Activity doesnt need to be saved."), typeof e == "function" && e();
                return;
            }
            this.changePouch(null, function() {
                n.save(null, {
                    success: function(t, n) {
                        Utils.debug("Activity save success"), typeof e == "function" && e();
                    },
                    error: function(e) {
                        typeof t == "function" ? t() : alert("Activity save error" + e);
                    }
                });
            });
        }
    });
    return n;
}), fielddb.define("activity/Activities", [ "backbone", "activity/Activity" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {
            this.bind("error", function(e, t) {});
        },
        model: t
    });
    return n;
}), fielddb.define("activity/ActivityFeed"
, [ "backbone", "activity/Activity", "activity/Activities" ], function(t, n, r) {
    var i = t.Model.extend({
        initialize: function() {
            this.get("activities") || this.set("activities", new r), this.set("maxInMemoryCollectionSize", 20);
        },
        model: {
            activities: r
        },
        savedcount: 0,
        truelysaved: 0,
        savedindex: [],
        savefailedcount: 0,
        savefailedindex: [],
        nextsaveactivity: 0,
        saveAndInterConnectInApp: function(e, t) {
            if (this.lastSavedTimeStamp && Date.now() - this.lastSavedTimeStamp < 3e4) return;
            this.lastSavedTimeStamp = Date.now(), Utils.debug("Calling saveAndInterConnectInApp for " + this.get("couchConnection").pouchname), e || (e = function() {
                window.appView && window.appView.toastUser("Save all activities", "alert-success", "Saved!");
            }), Utils.debug("successcallback", e), Utils.debug("failurecallback", t);
            var n = 
this;
            window.hub.unsubscribe("savedActivityToPouch", null, n), window.hub.unsubscribe("saveActivityFailedToPouch", null, n), n.savedcount = 0, n.truelysaved = 0, n.savedindex = [], n.savefailedcount = 0, n.savefailedindex = [], n.nextsaveactivity = 0;
            for (var r = 0; r < n.get("activities").models.length; r++) n.get("activities").models[r].collection && delete n.get("activities").models[r].collection;
            window.hub.subscribe("savedActivityToPouch", function(t) {
                n.savedindex[t.d] = !0, n.savedcount++;
                if (t.d <= 0) {
                    Utils.debug("Activity feed saved."), typeof e == "function" && e();
                    var r = "alert-success";
                    if (n.savefailedcount > 0) var r = "alert-warning";
                    window.appView && window.appView.toastUser("Save activity feed completed, " + n.savefailedcount + " failures, " + n.truelysaved + " new.", r, "Activities saved:"), window.hub.unsubscribe("savedActivityToPouch"
, null, n), window.hub.unsubscribe("saveActivityFailedToPouch", null, n);
                } else {
                    var i = parseInt(t.d) - 1;
                    n.saveAnActivityAndLoop(i), Utils.debug("Save succeeded: " + t.d + " Calling saveAnActivityAndLoop for " + n.get("couchConnection").pouchname);
                }
            }, n), window.hub.subscribe("saveActivityFailedToPouch", function(t) {
                n.savefailedindex[t.d] = !1, n.savefailedcount++, window.appView, n.alerted++, n.alerted < 100 && (alert("Bug! the " + n.get("couchConnection").pouchname + " activity feed seems to be recursing. Attempting ot stop it."), window.hub.unsubscribe("savedActivityToPouch", null, n), window.hub.unsubscribe("saveActivityFailedToPouch", null, n), typeof e == "function" && e());
                if (t.d <= 0) Utils.debug("Activity feed saved."), typeof e == "function" && e(), window.appView && window.appView.toastUser("Save activity feed completed, " + n.savefailedcount + " failures, " + 
n.truelysaved + " new.", null, "Activities saved:"), window.hub.unsubscribe("savedActivityToPouch", null, n), window.hub.unsubscribe("saveActivityFailedToPouch", null, n); else {
                    var r = parseInt(t.d) - 1;
                    n.saveAnActivityAndLoop(r), Utils.debug("Save failed: " + t.d + "  Calling saveAnActivityAndLoop for " + n.get("couchConnection").pouchname);
                }
            }, n), n.get("activities").length > 0 ? n.saveAnActivityAndLoop(n.get("activities").length - 1) : (Utils.debug("Activity feed didnt need to be saved."), typeof e == "function" && e());
        },
        alerted: 0,
        saveAnActivityAndLoop: function(t) {
            var n = this.get("activities").models[t];
            if (n) Utils.debug("thatactivity " + t, n); else {
                Utils.debug("this is the model taht is missing: ", this.get("activities").models[t]), n = this.get("activities").models[t];
                if (!n) {
                    hub.publish("saveActivityFailedToPouch"
, {
                        d: t,
                        message: " activity undefined"
                    });
                    return;
                }
            }
            n.isNew() && this.truelysaved++, n.collection && (Utils.debug("This activity has a collection. removing it."), delete n.collection), n.saveAndInterConnectInApp(function() {
                hub.publish("savedActivityToPouch", {
                    d: t,
                    message: " activity " + n.id
                });
            }, function() {
                e || (e = {}), hub.publish("saveActivityFailedToPouch", {
                    d: t,
                    message: " activity " + JSON.stringify(e)
                });
            });
        },
        changePouch: function(e, n) {
            e == null || e == undefined ? e = this.get("couchConnection") : this.set("couchConnection", e), e.pouchname.indexOf("activity_feed") == -1 && (alert("this is not a well formed activity feed couch connection" + 
JSON.stringify(e)), Utils.debug("this is not a well formed activity feed couch connection" + JSON.stringify(e))), this.pouch == undefined ? (Utils.debug("Defining the activity feed's pouch.", e), this.pouch = t.sync.pouch(Utils.androidApp() ? Utils.touchUrl + e.pouchname : Utils.pouchUrl + e.pouchname)) : Utils.debug("The activity feed " + e.pouchname + " pouch was defined.", e), typeof n == "function" && n();
        },
        addActivity: function(e) {
            var t = "undefined couchconnection";
            try {
                t = this.get("couchConnection").pouchname;
            } catch (n) {
                console.warn("couchConnection was undefined on the activity feed. this is a problem");
            }
            var r = this.get("activities").length;
            Utils.debug(t + " checking activity feed size = " + r);
            if (r > this.get("maxInMemoryCollectionSize")) {
                Utils.debug("The Activities collection has grown to the maximum of " + this.
get("maxInMemoryCollectionSize") + ", removing some items ot make space and reduce memory consumption.");
                var i = this.get("activities").pop();
                i.saveAndInterConnectInApp();
            }
            e.collection && Utils.debug("This activity has a collection. removing it."), this.get("activities").unshift(e);
        },
        populate: function(e, t, r) {
            t.get("activities").each(function(e) {
                t.get("activities").remove(e), Utils.debug("Removing activity to repopulate the collection ", e);
            }), r || (r = 200);
            var i = 0;
            for (var s = e.length - 1; s >= 0; s--) {
                var o = new n((new n).parse(e[s].value));
                t.get("activities").add(o), Utils.debug("In the Activity feed populate: Adding activity to feed "), i++;
                if (i > r) return;
            }
        },
        getAllIdsByDate: function(e) {
            Utils.debug("In the activity feed getAllIdsByDate " + 
this.get("couchConnection").pouchname);
            var t = this;
            try {
                this.changePouch(null, function() {
                    Utils.debug("Changing pouch in activity feed was sucessfull."), t.pouch(function(n, r) {
                        r.query("get_ids/by_date", {
                            reduce: !1
                        }, function(n, r) {
                            !n && typeof e == "function" ? (Utils.debug("Callback with: ", r.rows), Utils.debug("Activity feed search: " + t.get("couchConnection").pouchname, r.rows), e(r.rows, t)) : (Utils.debug("There was an error querying the database.", n), Utils.debug("There was an error querying the database, this is the response.", r));
                        });
                    });
                });
            } catch (n) {
                alert("Couldnt show the most recent activity " + JSON.stringify(n));
            }
        },
        replicateActivityFeed: function(e, t, n) {
            var r = 
this;
            this.replicateToActivityFeed(e, function() {
                r.replicateFromActivityFeed(e, t, n);
            }, function() {
                alert("Replicate to activity feed failure"), typeof n == "function" && n();
            });
        },
        replicateToActivityFeed: function(e, t, r) {
            var i = this;
            Utils.debug("Calling replicateToActivityFeed for " + this.get("couchConnection").pouchname), i.saveAndInterConnectInApp(function() {
                if (e == null || e == undefined) e = i.get("couchConnection");
                e || (e = JSON.parse(JSON.stringify(window.app.get("corpus").get("couchConnection"))), e.pouchname = e.pouchname + "-activity_feed"), i.changePouch(e, function() {
                    i.pouch(function(i, s) {
                        var o = e.protocol + e.domain;
                        e.port != null && (o = o + ":" + e.port), o = o + "/" + e.pouchname, Utils.debug("This is the url using to replicate to: " + o), s
.replicate.to(o, {
                            continuous: !1
                        }, function(i, s) {
                            Utils.debug("Replicate to " + o), Utils.debug(s), Utils.debug(i);
                            if (i) typeof r == "function" ? r() : (alert("ActivityFeed replicate to error" + JSON.stringify(i)), Utils.debug("ActivityFeed replicate to error" + JSON.stringify(i))); else {
                                Utils.debug("ActivityFeed replicate to success", s);
                                var u = e.pouchname.split("-");
                                u.length == 2 ? window.app.get("currentUserActivityFeed").addActivity(new n({
                                    verb: "uploaded",
                                    verbicon: "icon-arrow-up",
                                    directobject: "your activity feed (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                                    indirectobject: "to your activity feed server"
,
                                    context: "via Offline App",
                                    teamOrPersonal: "personal"
                                })) : window.app.get("currentCorpusTeamActivityFeed").addActivity(new n({
                                    verb: "uploaded",
                                    verbicon: "icon-arrow-up",
                                    directobject: "their activity feed (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                                    indirectobject: "to the team activity feed server",
                                    context: "via Offline App",
                                    teamOrPersonal: "team"
                                })), typeof t == "function" ? t() : Utils.debug("ActivityFeed replicate to success");
                            }
                        });
                    });
                });
            }, r);
        },
        replicateFromActivityFeed: function(
e, t, r) {
            var i = this;
            if (e == null || e == undefined) e = i.get("couchConnection");
            this.changePouch(e, function() {
                i.pouch(function(t, s) {
                    var o = e.protocol + e.domain;
                    e.port != null && (o = o + ":" + e.port), o = o + "/" + e.pouchname, s.replicate.from(o, {
                        continuous: !1
                    }, function(t, s) {
                        Utils.debug("Replicate from " + o), Utils.debug(s), Utils.debug(t);
                        if (t) typeof r == "function" ? r() : (alert("ActivityFeed replicate to error" + JSON.stringify(t)), Utils.debug("ActivityFeed replicate to error" + JSON.stringify(t))); else {
                            Utils.debug("ActivityFeed replicate from success", s);
                            var u = e.pouchname.split("-");
                            u.length == 2 ? window.app.get("currentUserActivityFeed").addActivity(new n({
                                
verb: "downloaded",
                                verbicon: "icon-arrow-down",
                                directobject: "your activity feed (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                                indirectobject: "from your activity feed server",
                                context: "via Offline App",
                                teamOrPersonal: "personal"
                            })) : window.app.get("currentCorpusTeamActivityFeed").addActivity(new n({
                                verb: "downloaded",
                                verbicon: "icon-arrow-down",
                                directobject: "their activity feed (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                                indirectobject: "from the team activity feed server",
                                context: "via Offline App",
                                teamOrPersonal: "team"
                            
})), i.getAllIdsByDate(i.populate), window.hub.unsubscribe("ajaxError", null, i);
                        }
                    });
                });
            });
        }
    });
    return i;
});

var CryptoJS = CryptoJS || function(e, t) {
    var n = {}, r = n.lib = {}, i = r.Base = function() {
        function e() {}
        return {
            extend: function(t) {
                e.prototype = this;
                var n = new e;
                return t && n.mixIn(t), n.$super = this, n;
            },
            create: function() {
                var e = this.extend();
                return e.init.apply(e, arguments), e;
            },
            init: function() {},
            mixIn: function(e) {
                for (var t in e) e.hasOwnProperty(t) && (this[t] = e[t]);
                e.hasOwnProperty("toString") && (this.toString = e.toString);
            },
            clone: function() {
                return this.$super.extend(this);
            }
        
};
    }(), s = r.WordArray = i.extend({
        init: function(e, n) {
            e = this.words = e || [], this.sigBytes = n != t ? n : 4 * e.length;
        },
        toString: function(e) {
            return (e || u).stringify(this);
        },
        concat: function(e) {
            var t = this.words, n = e.words, r = this.sigBytes, e = e.sigBytes;
            this.clamp();
            if (r % 4) for (var i = 0; i < e; i++) t[r + i >>> 2] |= (n[i >>> 2] >>> 24 - 8 * (i % 4) & 255) << 24 - 8 * ((r + i) % 4); else if (65535 < n.length) for (i = 0; i < e; i += 4) t[r + i >>> 2] = n[i >>> 2]; else t.push.apply(t, n);
            return this.sigBytes += e, this;
        },
        clamp: function() {
            var t = this.words, n = this.sigBytes;
            t[n >>> 2] &= 4294967295 << 32 - 8 * (n % 4), t.length = e.ceil(n / 4);
        },
        clone: function() {
            var e = i.clone.call(this);
            return e.words = this.words.slice(0), e;
        },
        
random: function(t) {
            for (var n = [], r = 0; r < t; r += 4) n.push(4294967296 * e.random() | 0);
            return s.create(n, t);
        }
    }), o = n.enc = {}, u = o.Hex = {
        stringify: function(e) {
            for (var t = e.words, e = e.sigBytes, n = [], r = 0; r < e; r++) {
                var i = t[r >>> 2] >>> 24 - 8 * (r % 4) & 255;
                n.push((i >>> 4).toString(16)), n.push((i & 15).toString(16));
            }
            return n.join("");
        },
        parse: function(e) {
            for (var t = e.length, n = [], r = 0; r < t; r += 2) n[r >>> 3] |= parseInt(e.substr(r, 2), 16) << 24 - 4 * (r % 8);
            return s.create(n, t / 2);
        }
    }, a = o.Latin1 = {
        stringify: function(e) {
            for (var t = e.words, e = e.sigBytes, n = [], r = 0; r < e; r++) n.push(String.fromCharCode(t[r >>> 2] >>> 24 - 8 * (r % 4) & 255));
            return n.join("");
        },
        parse: function(e) {
            for (var t = 
e.length, n = [], r = 0; r < t; r++) n[r >>> 2] |= (e.charCodeAt(r) & 255) << 24 - 8 * (r % 4);
            return s.create(n, t);
        }
    }, f = o.Utf8 = {
        stringify: function(e) {
            try {
                return decodeURIComponent(escape(a.stringify(e)));
            } catch (t) {
                throw Error("Malformed UTF-8 data");
            }
        },
        parse: function(e) {
            return a.parse(unescape(encodeURIComponent(e)));
        }
    }, l = r.BufferedBlockAlgorithm = i.extend({
        reset: function() {
            this._data = s.create(), this._nDataBytes = 0;
        },
        _append: function(e) {
            "string" == typeof e && (e = f.parse(e)), this._data.concat(e), this._nDataBytes += e.sigBytes;
        },
        _process: function(t) {
            var n = this._data, r = n.words, i = n.sigBytes, o = this.blockSize, u = i / (4 * o), u = t ? e.ceil(u) : e.max((u | 0) - this._minBufferSize, 0), t = u * o, i = e.min(4 * t, 
i);
            if (t) {
                for (var a = 0; a < t; a += o) this._doProcessBlock(r, a);
                a = r.splice(0, t), n.sigBytes -= i;
            }
            return s.create(a, i);
        },
        clone: function() {
            var e = i.clone.call(this);
            return e._data = this._data.clone(), e;
        },
        _minBufferSize: 0
    });
    r.Hasher = l.extend({
        init: function() {
            this.reset();
        },
        reset: function() {
            l.reset.call(this), this._doReset();
        },
        update: function(e) {
            return this._append(e), this._process(), this;
        },
        finalize: function(e) {
            return e && this._append(e), this._doFinalize(), this._hash;
        },
        clone: function() {
            var e = l.clone.call(this);
            return e._hash = this._hash.clone(), e;
        },
        blockSize: 16,
        _createHelper: function(e) {
            return function(t, n) {
                
return e.create(n).finalize(t);
            };
        },
        _createHmacHelper: function(e) {
            return function(t, n) {
                return c.HMAC.create(e, n).finalize(t);
            };
        }
    });
    var c = n.algo = {};
    return n;
}(Math);

(function() {
    var e = CryptoJS, t = e.lib.WordArray;
    e.enc.Base64 = {
        stringify: function(e) {
            var t = e.words, n = e.sigBytes, r = this._map;
            e.clamp();
            for (var e = [], i = 0; i < n; i += 3) for (var s = (t[i >>> 2] >>> 24 - 8 * (i % 4) & 255) << 16 | (t[i + 1 >>> 2] >>> 24 - 8 * ((i + 1) % 4) & 255) << 8 | t[i + 2 >>> 2] >>> 24 - 8 * ((i + 2) % 4) & 255, o = 0; 4 > o && i + .75 * o < n; o++) e.push(r.charAt(s >>> 6 * (3 - o) & 63));
            if (t = r.charAt(64)) for (; e.length % 4; ) e.push(t);
            return e.join("");
        },
        parse: function(e) {
            var n = e.length, r = this._map, s = r.charAt(64);
            s && (s = e.indexOf(s)
, -1 != s && (n = s));
            for (var s = [], o = 0, u = 0; u < n; u++) if (u % 4) {
                var a = r.indexOf(e.charAt(u - 1)) << 2 * (u % 4), f = r.indexOf(e.charAt(u)) >>> 6 - 2 * (u % 4);
                s[o >>> 2] |= (a | f) << 24 - 8 * (o % 4), o++;
            }
            return t.create(s, o);
        },
        _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
    };
})(), function(e) {
    function t(e, t, n, r, i, s, o) {
        return e = e + (t & n | ~t & r) + i + o, (e << s | e >>> 32 - s) + t;
    }
    function n(e, t, n, r, i, s, o) {
        return e = e + (t & r | n & ~r) + i + o, (e << s | e >>> 32 - s) + t;
    }
    function r(e, t, n, r, i, s, o) {
        return e = e + (t ^ n ^ r) + i + o, (e << s | e >>> 32 - s) + t;
    }
    function i(e, t, n, r, i, s, o) {
        return e = e + (n ^ (t | ~r)) + i + o, (e << s | e >>> 32 - s) + t;
    }
    var s = CryptoJS, o = s.lib, u = o.WordArray, o = o.Hasher, a = s.algo, f = [
];
    (function() {
        for (var t = 0; 64 > t; t++) f[t] = 4294967296 * e.abs(e.sin(t + 1)) | 0;
    })(), a = a.MD5 = o.extend({
        _doReset: function() {
            this._hash = u.create([ 1732584193, 4023233417, 2562383102, 271733878 ]);
        },
        _doProcessBlock: function(e, s) {
            for (var o = 0; 16 > o; o++) {
                var u = s + o, a = e[u];
                e[u] = (a << 8 | a >>> 24) & 16711935 | (a << 24 | a >>> 8) & 4278255360;
            }
            for (var u = this._hash.words, a = u[0], c = u[1], h = u[2], d = u[3], o = 0; 64 > o; o += 4) 16 > o ? (a = t(a, c, h, d, e[s + o], 7, f[o]), d = t(d, a, c, h, e[s + o + 1], 12, f[o + 1]), h = t(h, d, a, c, e[s + o + 2], 17, f[o + 2]), c = t(c, h, d, a, e[s + o + 3], 22, f[o + 3])) : 32 > o ? (a = n(a, c, h, d, e[s + (o + 1) % 16], 5, f[o]), d = n(d, a, c, h, e[s + (o + 6) % 16], 9, f[o + 1]), h = n(h, d, a, c, e[s + (o + 11) % 16], 14, f[o + 2]), c = n(c, h, d, a, e[s + o % 16], 20, f[o + 3
])) : 48 > o ? (a = r(a, c, h, d, e[s + (3 * o + 5) % 16], 4, f[o]), d = r(d, a, c, h, e[s + (3 * o + 8) % 16], 11, f[o + 1]), h = r(h, d, a, c, e[s + (3 * o + 11) % 16], 16, f[o + 2]), c = r(c, h, d, a, e[s + (3 * o + 14) % 16], 23, f[o + 3])) : (a = i(a, c, h, d, e[s + 3 * o % 16], 6, f[o]), d = i(d, a, c, h, e[s + (3 * o + 7) % 16], 10, f[o + 1]), h = i(h, d, a, c, e[s + (3 * o + 14) % 16], 15, f[o + 2]), c = i(c, h, d, a, e[s + (3 * o + 5) % 16], 21, f[o + 3]));
            u[0] = u[0] + a | 0, u[1] = u[1] + c | 0, u[2] = u[2] + h | 0, u[3] = u[3] + d | 0;
        },
        _doFinalize: function() {
            var e = this._data, t = e.words, n = 8 * this._nDataBytes, r = 8 * e.sigBytes;
            t[r >>> 5] |= 128 << 24 - r % 32, t[(r + 64 >>> 9 << 4) + 14] = (n << 8 | n >>> 24) & 16711935 | (n << 24 | n >>> 8) & 4278255360, e.sigBytes = 4 * (t.length + 1), this._process(), e = this._hash.words;
            for (t = 0; 4 > t; t++) n = e[t], e[t] = (n << 8 | n >>> 24) & 16711935 | 
(n << 24 | n >>> 8) & 4278255360;
        }
    }), s.MD5 = o._createHelper(a), s.HmacMD5 = o._createHmacHelper(a);
}(Math), function() {
    var e = CryptoJS, t = e.lib, n = t.Base, r = t.WordArray, t = e.algo, i = t.EvpKDF = n.extend({
        cfg: n.extend({
            keySize: 4,
            hasher: t.MD5,
            iterations: 1
        }),
        init: function(e) {
            this.cfg = this.cfg.extend(e);
        },
        compute: function(e, t) {
            for (var n = this.cfg, i = n.hasher.create(), s = r.create(), o = s.words, u = n.keySize, n = n.iterations; o.length < u; ) {
                a && i.update(a);
                var a = i.update(e).finalize(t);
                i.reset();
                for (var f = 1; f < n; f++) a = i.finalize(a), i.reset();
                s.concat(a);
            }
            return s.sigBytes = 4 * u, s;
        }
    });
    e.EvpKDF = function(e, t, n) {
        return i.create(n).compute(e, t);
    };
}(), CryptoJS.lib.Cipher || 
function(e) {
    var t = CryptoJS, n = t.lib, r = n.Base, i = n.WordArray, s = n.BufferedBlockAlgorithm, o = t.enc.Base64, u = t.algo.EvpKDF, a = n.Cipher = s.extend({
        cfg: r.extend(),
        createEncryptor: function(e, t) {
            return this.create(this._ENC_XFORM_MODE, e, t);
        },
        createDecryptor: function(e, t) {
            return this.create(this._DEC_XFORM_MODE, e, t);
        },
        init: function(e, t, n) {
            this.cfg = this.cfg.extend(n), this._xformMode = e, this._key = t, this.reset();
        },
        reset: function() {
            s.reset.call(this), this._doReset();
        },
        process: function(e) {
            return this._append(e), this._process();
        },
        finalize: function(e) {
            return e && this._append(e), this._doFinalize();
        },
        keySize: 4,
        ivSize: 4,
        _ENC_XFORM_MODE: 1,
        _DEC_XFORM_MODE: 2,
        _createHelper: function() {
            return function(
e) {
                return {
                    encrypt: function(t, n, r) {
                        return ("string" == typeof n ? d : p).encrypt(e, t, n, r);
                    },
                    decrypt: function(t, n, r) {
                        return ("string" == typeof n ? d : p).decrypt(e, t, n, r);
                    }
                };
            };
        }()
    });
    n.StreamCipher = a.extend({
        _doFinalize: function() {
            return this._process(!0);
        },
        blockSize: 1
    });
    var f = t.mode = {}, l = n.BlockCipherMode = r.extend({
        createEncryptor: function(e, t) {
            return this.Encryptor.create(e, t);
        },
        createDecryptor: function(e, t) {
            return this.Decryptor.create(e, t);
        },
        init: function(e, t) {
            this._cipher = e, this._iv = t;
        }
    }), f = f.CBC = function() {
        function t(t, n, r) {
            var i = this._iv;
            i ? this._iv = 
e : i = this._prevBlock;
            for (var s = 0; s < r; s++) t[n + s] ^= i[s];
        }
        var n = l.extend();
        return n.Encryptor = n.extend({
            processBlock: function(e, n) {
                var r = this._cipher, i = r.blockSize;
                t.call(this, e, n, i), r.encryptBlock(e, n), this._prevBlock = e.slice(n, n + i);
            }
        }), n.Decryptor = n.extend({
            processBlock: function(e, n) {
                var r = this._cipher, i = r.blockSize, s = e.slice(n, n + i);
                r.decryptBlock(e, n), t.call(this, e, n, i), this._prevBlock = s;
            }
        }), n;
    }(), c = (t.pad = {}).Pkcs7 = {
        pad: function(e, t) {
            for (var n = 4 * t, n = n - e.sigBytes % n, r = n << 24 | n << 16 | n << 8 | n, s = [], o = 0; o < n; o += 4) s.push(r);
            n = i.create(s, n), e.concat(n);
        },
        unpad: function(e) {
            e.sigBytes -= e.words[e.sigBytes - 1 >>> 2] & 255;
        }
    
};
    n.BlockCipher = a.extend({
        cfg: a.cfg.extend({
            mode: f,
            padding: c
        }),
        reset: function() {
            a.reset.call(this);
            var e = this.cfg, t = e.iv, e = e.mode;
            if (this._xformMode == this._ENC_XFORM_MODE) var n = e.createEncryptor; else n = e.createDecryptor, this._minBufferSize = 1;
            this._mode = n.call(e, this, t && t.words);
        },
        _doProcessBlock: function(e, t) {
            this._mode.processBlock(e, t);
        },
        _doFinalize: function() {
            var e = this.cfg.padding;
            if (this._xformMode == this._ENC_XFORM_MODE) {
                e.pad(this._data, this.blockSize);
                var t = this._process(!0);
            } else t = this._process(!0), e.unpad(t);
            return t;
        },
        blockSize: 4
    });
    var h = n.CipherParams = r.extend({
        init: function(e) {
            this.mixIn(e);
        },
        toString: function(
e) {
            return (e || this.formatter).stringify(this);
        }
    }), f = (t.format = {}).OpenSSL = {
        stringify: function(e) {
            var t = e.ciphertext, e = e.salt;
            return (e ? i.create([ 1398893684, 1701076831 ]).concat(e).concat(t) : t).toString(o);
        },
        parse: function(e) {
            var e = o.parse(e), t = e.words;
            if (1398893684 == t[0] && 1701076831 == t[1]) {
                var n = i.create(t.slice(2, 4));
                t.splice(0, 4), e.sigBytes -= 16;
            }
            return h.create({
                ciphertext: e,
                salt: n
            });
        }
    }, p = n.SerializableCipher = r.extend({
        cfg: r.extend({
            format: f
        }),
        encrypt: function(e, t, n, r) {
            var r = this.cfg.extend(r), i = e.createEncryptor(n, r), t = i.finalize(t), i = i.cfg;
            return h.create({
                ciphertext: t,
                key: n,
                
iv: i.iv,
                algorithm: e,
                mode: i.mode,
                padding: i.padding,
                blockSize: e.blockSize,
                formatter: r.format
            });
        },
        decrypt: function(e, t, n, r) {
            return r = this.cfg.extend(r), t = this._parse(t, r.format), e.createDecryptor(n, r).finalize(t.ciphertext);
        },
        _parse: function(e, t) {
            return "string" == typeof e ? t.parse(e, this) : e;
        }
    }), t = (t.kdf = {}).OpenSSL = {
        execute: function(e, t, n, r) {
            return r || (r = i.random(8)), e = u.create({
                keySize: t + n
            }).compute(e, r), n = i.create(e.words.slice(t), 4 * n), e.sigBytes = 4 * t, h.create({
                key: e,
                iv: n,
                salt: r
            });
        }
    }, d = n.PasswordBasedCipher = p.extend({
        cfg: p.cfg.extend({
            kdf: t
        }),
        encrypt: function(e, t, n, r) {
            
return r = this.cfg.extend(r), n = r.kdf.execute(n, e.keySize, e.ivSize), r.iv = n.iv, e = p.encrypt.call(this, e, t, n.key, r), e.mixIn(n), e;
        },
        decrypt: function(e, t, n, r) {
            return r = this.cfg.extend(r), t = this._parse(t, r.format), n = r.kdf.execute(n, e.keySize, e.ivSize, t.salt), r.iv = n.iv, p.decrypt.call(this, e, t, n.key, r);
        }
    });
}(), function() {
    var e = CryptoJS, t = e.lib.BlockCipher, n = e.algo, r = [], i = [], s = [], o = [], u = [], a = [], f = [], l = [], c = [], h = [];
    (function() {
        for (var e = [], t = 0; 256 > t; t++) e[t] = 128 > t ? t << 1 : t << 1 ^ 283;
        for (var n = 0, p = 0, t = 0; 256 > t; t++) {
            var d = p ^ p << 1 ^ p << 2 ^ p << 3 ^ p << 4, d = d >>> 8 ^ d & 255 ^ 99;
            r[n] = d, i[d] = n;
            var v = e[n], g = e[v], y = e[g], b = 257 * e[d] ^ 16843008 * d;
            s[n] = b << 24 | b >>> 8, o[n] = b << 16 | b >>> 16, u[n] = b << 8 | b >>> 24, a[n] = b, b = 16843009 * 
y ^ 65537 * g ^ 257 * v ^ 16843008 * n, f[d] = b << 24 | b >>> 8, l[d] = b << 16 | b >>> 16, c[d] = b << 8 | b >>> 24, h[d] = b, n ? (n = v ^ e[e[e[y ^ v]]], p ^= e[e[p]]) : n = p = 1;
        }
    })();
    var p = [ 0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54 ], n = n.AES = t.extend({
        _doReset: function() {
            for (var e = this._key, t = e.words, n = e.sigBytes / 4, e = 4 * ((this._nRounds = n + 6) + 1), i = this._keySchedule = [], s = 0; s < e; s++) if (s < n) i[s] = t[s]; else {
                var o = i[s - 1];
                s % n ? 6 < n && 4 == s % n && (o = r[o >>> 24] << 24 | r[o >>> 16 & 255] << 16 | r[o >>> 8 & 255] << 8 | r[o & 255]) : (o = o << 8 | o >>> 24, o = r[o >>> 24] << 24 | r[o >>> 16 & 255] << 16 | r[o >>> 8 & 255] << 8 | r[o & 255], o ^= p[s / n | 0] << 24), i[s] = i[s - n] ^ o;
            }
            t = this._invKeySchedule = [];
            for (n = 0; n < e; n++) s = e - n, o = n % 4 ? i[s] : i[s - 4], t[n] = 4 > n || 4 >= s ? o : f[r[o >>> 24
]] ^ l[r[o >>> 16 & 255]] ^ c[r[o >>> 8 & 255]] ^ h[r[o & 255]];
        },
        encryptBlock: function(e, t) {
            this._doCryptBlock(e, t, this._keySchedule, s, o, u, a, r);
        },
        decryptBlock: function(e, t) {
            var n = e[t + 1];
            e[t + 1] = e[t + 3], e[t + 3] = n, this._doCryptBlock(e, t, this._invKeySchedule, f, l, c, h, i), n = e[t + 1], e[t + 1] = e[t + 3], e[t + 3] = n;
        },
        _doCryptBlock: function(e, t, n, r, i, s, o, u) {
            for (var a = this._nRounds, f = e[t] ^ n[0], l = e[t + 1] ^ n[1], c = e[t + 2] ^ n[2], h = e[t + 3] ^ n[3], p = 4, d = 1; d < a; d++) var v = r[f >>> 24] ^ i[l >>> 16 & 255] ^ s[c >>> 8 & 255] ^ o[h & 255] ^ n[p++], m = r[l >>> 24] ^ i[c >>> 16 & 255] ^ s[h >>> 8 & 255] ^ o[f & 255] ^ n[p++], g = r[c >>> 24] ^ i[h >>> 16 & 255] ^ s[f >>> 8 & 255] ^ o[l & 255] ^ n[p++], h = r[h >>> 24] ^ i[f >>> 16 & 255] ^ s[l >>> 8 & 255] ^ o[c & 255] ^ n[p++], f = v, l = m, c = g;
            v = (u[f >>> 24
] << 24 | u[l >>> 16 & 255] << 16 | u[c >>> 8 & 255] << 8 | u[h & 255]) ^ n[p++], m = (u[l >>> 24] << 24 | u[c >>> 16 & 255] << 16 | u[h >>> 8 & 255] << 8 | u[f & 255]) ^ n[p++], g = (u[c >>> 24] << 24 | u[h >>> 16 & 255] << 16 | u[f >>> 8 & 255] << 8 | u[l & 255]) ^ n[p++], h = (u[h >>> 24] << 24 | u[f >>> 16 & 255] << 16 | u[l >>> 8 & 255] << 8 | u[c & 255]) ^ n[p++], e[t] = v, e[t + 1] = m, e[t + 2] = g, e[t + 3] = h;
        },
        keySize: 8
    });
    e.AES = t._createHelper(n);
}(), fielddb.define("crypto", function(e) {
    return function() {
        var t, n;
        return t || e.CryptoJS;
    };
}(this)), fielddb.define("confidentiality_encryption/Confidential", [ "backbone", "crypto" ], function(e, t) {
    var n = e.Model.extend({
        initialize: function() {
            Utils.debug("Initializing confidentiality module"), this.get("secretkey") == "This should be a top secret pass phrase." && this.set("secretkey", this.secretKeyGenerator());
        },
        defaults
: {
            secretkey: "This should be a top secret pass phrase."
        },
        decryptedMode: !1,
        turnOnDecryptedMode: function(e) {
            this.decryptedMode = !1, typeof e == "function" && e();
        },
        turnOnDecryptedMode: function(e) {
            var t = this;
            this.decryptedMode || window.appView && window.appView.authView.showQuickAuthenticateView(function() {
                t.decryptedMode = !0, typeof e == "function" && e();
            });
        },
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        },
        encrypt: function(e) {
            var n = t.AES.encrypt(e, this.get("secretkey"));
            return "confidential:" + btoa(n);
        },
        decrypt: function(e) {
            var n = e;
            if (!!this.decryptedMode) return e = e.replace("confidential:", ""), e = atob(e), n = t.AES.decrypt(e, this.get("secretkey")).toString(t.enc.Utf8), n;
            
var r = this;
            this.turnOnDecryptedMode(function() {
                return e = e.replace("confidential:", ""), e = atob(e), n = t.AES.decrypt(e, r.get("secretkey")).toString(t.enc.Utf8), n;
            });
        },
        secretKeyGenerator: function() {
            var e = function() {
                return ((1 + Math.random()) * 65536 | 0).toString(16).substring(1);
            };
            return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e();
        }
    });
    return n;
}), fielddb.define("hotkey/HotKey", [ "backbone" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {},
        defaults: {
            firstKey: "",
            secondKey: "",
            functiontocall: function() {},
            description: ""
        },
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("user/Users", [ "backbone", "user/UserMask" 
], function(e, t) {
    var n = e.Collection.extend({
        model: t,
        add: function(e, t) {}
    });
    return n;
}), fielddb.define("permission/Permission", [ "backbone", "user/Users" ], function(e, t) {
    var n = e.Model.extend({
        intialize: function() {},
        defaults: {},
        model: {
            users: t
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return n;
}), fielddb.define("insert_unicode/InsertUnicode", [ "backbone" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {},
        defaults: {
            symbol: "",
            tipa: "",
            useCount: 0
        },
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("insert_unicode/InsertUnicodes", [ "backbone", "insert_unicode/InsertUnicode" ], function(e, t) {
    var n = e.Collection
.extend({
        initialize: function() {
            this.bind("error", function(e, t) {}), t;
        }
    });
    return n;
}), fielddb.define("user/UserPreference", [ "backbone", "insert_unicode/InsertUnicode", "insert_unicode/InsertUnicodes" ], function(e, t, n) {
    var r = e.Model.extend({
        initialize: function() {
            Utils.debug("USER PREFERENCE init"), this.get("unicodes") == undefined && this.set("unicodes", new n), this.get("unicodes").models.length == 0 && (this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0254"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u025b"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0263"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0265"
            })), this.get("unicodes").add(new t({
                tipa: "",
                
symbol: "\u0266"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u026b"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0283"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0292"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u0294"
            })), this.get("unicodes").add(new t({
                tipa: "lambda",
                symbol: "\u03bb "
            })), this.get("unicodes").add(new t({
                tipa: "alpha",
                symbol: "\u03b1 "
            })), this.get("unicodes").add(new t({
                tipa: "\beta",
                symbol: "\u03b2 "
            })), this.get("unicodes").add(new t({
                tipa: "\forall",
                symbol: "\u2200"
            })), this.get("unicodes").add(new t({
                tipa: "exists",
                
symbol: "\u2203"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u2204"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u2205"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u2208"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u2209"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u220b"
            })), this.get("unicodes").add(new t({
                tipa: "",
                symbol: "\u220c"
            })));
        },
        defaults: {
            skin: "",
            numVisibleDatum: 2,
            transparentDashboard: "false",
            alwaysRandomizeSkin: "true",
            numberOfItemsInPaginatedViews: 10
        },
        model: {
            unicodes: n
        },
        saveAndInterConnectInApp: 
function(e) {
            typeof e == "function" && e();
        }
    });
    return r;
}), fielddb.define("user/UserGeneric", [ "backbone", "activity/Activities", "hotkey/HotKey", "permission/Permission", "user/UserPreference", "user/UserMask", "libs/Utils" ], function(e, t, n, r, i, s) {
    var o = e.Model.extend({
        initialize: function() {
            Utils.debug("USERGENERIC init");
        },
        model: {
            prefs: i,
            permissions: r,
            hotkeys: n,
            publicSelf: s
        },
        addCurrentCorpusToUser: function() {
            var e = window.app.get("corpus").get("couchConnection");
            window.app.get("corpus").id != undefined ? (e.corpusid = window.app.get("corpus").id, this.get("corpuses").push(e)) : window.appView.toastUser("The corpus has no id, cant add it to the user.", "alert-danger", "Bug!");
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    
return o;
}), fielddb.define("user/User", [ "backbone", "activity/Activities", "hotkey/HotKey", "user/UserGeneric", "user/UserPreference", "libs/Utils" ], function(e, t, n, r, i) {
    var s = r.extend({
        initialize: function(e) {
            Utils.debug("USER init"), s.__super__.initialize.call(this, e), this.get("prefs") || this.set("prefs", new i), this.get("hotkeys") || this.set("hotkeys", new n), this.get("activities") || this.set("activities", new t), this.bind("change", this.checkPrefsChanged, this);
        },
        defaults: {
            username: "",
            password: "",
            email: "",
            gravatar: "./../user/user_gravatar.png",
            researchInterest: "",
            affiliation: "",
            description: "",
            subtitle: "",
            corpuses: [],
            dataLists: [],
            mostRecentIds: {},
            firstname: "",
            lastname: "",
            teams: [],
            sessionHistory: []
        },
        
subtitle: function() {
            return this.get("firstname") == undefined && this.set("firstname", ""), this.get("lastname") == undefined && this.set("lastname", ""), this.get("firstname") + " " + this.get("lastname");
        },
        checkPrefsChanged: function() {
            try {
                window.appView.userPreferenceView.model = this.get("prefs"), window.appView.userPreferenceView.render();
            } catch (e) {}
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return s;
}), fielddb.define("authentication/Authentication", [ "backbone", "confidentiality_encryption/Confidential", "user/User", "user/UserMask", "libs/Utils" ], function(e, t, n, r) {
    var i = e.Model.extend({
        initialize: function() {
            Utils.debug("AUTHENTICATION INIT"), this.bind("error", function(e, t) {
                Utils.debug("Error in Authentication  : " + t);
            }), this.get("confidential") || 
(this.set("confidential", new t), this.get("confidential").decryptedMode = !0, Utils.getCookie("token") && this.get("confidential").set("secretkey", Utils.getCookie("token")));
        },
        defaults: {
            username: localStorage.getItem("username"),
            state: "loggedOut"
        },
        model: {
            userPrivate: n,
            userPublic: r,
            confidential: t
        },
        staleAuthentication: !0,
        authenticate: function(e, t, n) {
            var r = {};
            r.username = e.get("username"), r.password = e.get("password"), this.get("userPrivate") != undefined && e.get("username") == this.get("userPrivate").get("username") && (r.syncDetails = "true", r.syncUserDetails = JSON.parse(JSON.stringify(this.get("userPrivate").toJSON())));
            var i = this, s = e.get("authUrl");
            $.ajax({
                type: "POST",
                url: s + "/login",
                data: r,
                success: function(e) {
                    
if (e.errors != null) {
                        try {
                            window.appView.toastUser(e.errors.join("<br/>") + " " + Utils.contactUs, "alert-danger", "Login errors:");
                        } catch (r) {
                            Utils.debug(r);
                        }
                        typeof n == "function" && n(e.errors.join("<br/>")), typeof t == "function" && t(null, e.errors);
                    } else e.user != null && i.saveServerResponseToUser(e, t);
                },
                error: function(e) {
                    Utils.debug("Ajax failed, user might be offline.", e), window.appView && window.appView.toastUser("There was an error in contacting the authentication server to confirm your identity. " + Utils.contactUs, "alert-danger", "Connection errors:"), typeof n == "function" && n("There was an error in contacting the authentication server to confirm your identity. Maybe you're offline?");
                },
                dataType: ""
            
});
        },
        saveServerResponseToUser: function(e, t) {
            Utils.debug("saveServerResponseToUser"), this.set("state", "loggedIn"), this.staleAuthentication = !1, e.user.publicSelf == null && (e.user.publicSelf = {}, e.user.publicSelf.username = e.user.username, e.user.publicSelf.gravatar = e.user.gravatar, e.user.publicSelf.authUrl = e.user.authUrl, e.user.publicSelf.id = e.user._id, e.user.publicSelf.pouchname = e.user.corpuses[0].pouchname), this.get("userPublic") == undefined ? this.set("userPublic", new r(e.user.publicSelf)) : this.get("userPublic").set(e.user.publicSelf), this.get("userPublic")._id = e.user._id, this.get("userPrivate") == undefined && this.set("userPrivate", new n);
            var i = this.get("userPrivate");
            i.id = e.user._id, e.user.activities && e.user.activities[0] && alert("We have made a lot of changes in the app since your user was created. Your user was created before the new Team and User activity feeds were implemented. If you want to keep this user acount and data, contact us at opensource@ilanguage.ca and we will transition your account for you. If you were just using this account for testing and you dont mind creating a  new user, you should probably sign out and make a new user so you can use the new Team and Activity feeds."
), i.set(i.parse(e.user)), window.appView && window.appView.associateCurrentUsersInternalModelsWithTheirViews(), typeof t == "function" && t("true"), Utils.setCookie("username", e.user.username, 365), Utils.setCookie("token", e.user.hash, 365), this.get("confidential").set("secretkey", e.user.hash), this.saveAndEncryptUserToLocalStorage();
        },
        loadEncryptedUser: function(e, t) {
            Utils.debug("loadEncryptedUser");
            var n = JSON.parse(this.get("confidential").decrypt(e)), r = {};
            r.user = n, this.saveServerResponseToUser(r, t);
        },
        saveAndEncryptUserToLocalStorage: function(e) {
            Utils.debug("saveAndEncryptUserToLocalStorage");
            var t = this.get("confidential").encrypt(JSON.stringify(this.get("userPrivate").toJSON()));
            localStorage.setItem("encryptedUser", t), window.appView && (window.appView.addSavedDoc(this.get("userPrivate").id), window.appView.toastUser("Sucessfully saved user details.", "alert-success"
, "Saved!")), typeof e == "function" && e();
        },
        saveAndInterConnectInApp: function(e, t) {
            localStorage.setItem("mostRecentDashboard", JSON.stringify(this.get("userPrivate").get("mostRecentIds"))), this.saveAndEncryptUserToLocalStorage(function() {
                typeof e == "function" && e();
            });
        },
        syncUserWithServer: function(e) {
            if (this.staleAuthentication) {
                var t = this;
                window.appView.authView.showQuickAuthenticateView(function() {
                    t.staleAuthentication = !1, typeof e == "function" && e();
                });
            } else typeof e == "function" && e();
        }
    });
    return i;
}), fielddb.define("comment/Comment", [ "backbone", "user/UserMask" ], function(e, t) {
    var n = e.Model.extend({
        initialize: function() {
            var e = JSON.stringify(new Date);
            this.set("timestamp", new Date(JSON.parse(e))), this.set("gravatar"
, window.appView.authView.model.get("userPublic").get("gravatar")), this.set("username", window.appView.authView.model.get("userPublic").get("username"));
        },
        defaults: {
            text: "",
            username: ""
        },
        model: {},
        remove: function() {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        },
        edit: function(e) {
            this.set("text", e);
        }
    });
    return n;
}), fielddb.define("comment/Comments", [ "backbone", "comment/Comment", "libs/Utils" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("datum/DatumField", [ "backbone" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {},
        defaults: {
            label: "",
            value: "",
            mask: "",
            encrypted: "",
            shouldBeEncrypted: "",
            help
: "Example from DataOne: Format conventions: use uppercase ,Codes for missing values: unknown"
        },
        model: {},
        validate: function(e) {},
        set: function(t, n, r) {
            var i;
            return _.isObject(t) || t == null ? (i = t, r = n) : (i = {}, i[t] = n), r = r || {}, !i.mask && this.get("mask") && (i.mask = this.get("mask")), !i.value && this.get("value") && (i.value = this.get("value")), !i.shouldBeEncrypted && this.get("shouldBeEncrypted") && (i.shouldBeEncrypted = this.get("shouldBeEncrypted")), !i.encrypted && this.get("encrypted") && (i.encrypted = this.get("encrypted")), i.mask && i.mask != "" && (i.shouldBeEncrypted != "checked" ? i.value = i.mask : i.encrypted != "checked" ? i.value = i.mask : window.app.get("corpus").get("confidential").decryptedMode ? (i.mask.indexOf("confidential:") != 0 && window.appView ? i.value = window.app.get("corpus").get("confidential").encrypt(i.mask) : i.mask.indexOf("confidential:") == 0 && window.appView && 
(i.mask = this.mask(window.app.get("corpus").get("confidential").decrypt(this.get("value"))), i.value = this.get("value")), i.value && i.value.indexOf("confidential") != 0 && window.appView ? i.value = window.app.get("corpus").get("confidential").encrypt(i.mask) : i.value && i.value.indexOf("confidential") == 0 && window.appView && (i.mask = window.app.get("corpus").get("confidential").decrypt(this.get("value")), i.value = this.get("value"))) : (this.get("encrypted") == "checked" && i.encrypted != "checked" && !window.app.get("corpus").get("confidential").decryptedMode && (i.encrypted = "checked"), i.mask && i.mask.indexOf("confidential") == 0 && window.appView ? (i.mask = this.mask(window.app.get("corpus").get("confidential").decrypt(this.get("value"))), i.value = this.get("value")) : (i.mask = this.get("mask"), i.value = this.get("value")), i.value && i.value.indexOf("confidential") != 0 && window.appView ? (i.mask = this.mask(this.get("value")), i.value = window.app.get("corpus").get
("confidential").encrypt(this.get("value"))) : (i.mask = this.get("mask"), i.value = this.get("value")))), e.Model.prototype.set.call(this, i, r);
        },
        mask: function(e) {
            return e.replace(/[A-Za-z]/g, "x");
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("datum/DatumFields", [ "backbone", "datum/DatumField", "libs/Utils" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t,
        clone: function() {
            var e = new n;
            for (var r = 0; r < this.length; r++) e.push(new t(this.models[r].toJSON()));
            return e;
        }
    });
    return n;
}), fielddb.define("datum/DatumState", [ "backbone", "user/UserMask" ], function(e, t) {
    var n = e.Model.extend({
        initialize: function() {},
        defaults: {
            color: "",
            showInSearchResults: "checked",
            
selected: ""
        },
        model: {
            consultant: t
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return n;
}), fielddb.define("datum/DatumStates", [ "backbone", "datum/DatumState" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t,
        clone: function() {
            var e = new n;
            for (var r = 0; r < this.length; r++) e.push(new t(this.models[r].toJSON()));
            return e;
        }
    });
    return n;
}), fielddb.define("audio_video/AudioVideo", [ "backbone" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {},
        defaults: {
            URL: "",
            type: "audio"
        },
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("datum/DatumTag", [ "backbone" ], function(
e) {
    var t = e.Model.extend({
        initialize: function() {},
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("datum/DatumTags", [ "backbone", "datum/DatumTag" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("user/Consultant", [ "backbone", "user/UserMask" ], function(e, t) {
    var n = t.extend({
        initialize: function(e) {
            n.__super__.initialize.call(this, e), this.set("consultantcode", ""), this.set("language", ""), this.set("dialect", "");
        },
        model: {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return n;
}), fielddb.define("user/Team", [ "backbone", "activity/Activities", "hotkey/HotKey", "user/UserGeneric", "permission/Permission", "user/UserPreference", "libs/Utils" 
], function(e, t, n, r, i, s) {
    var o = r.extend({
        initialize: function(e) {
            r.__super__.initialize.call(this, e), this.get("prefs") || this.set("prefs", new s), this.permissions || (this.permissions = new Permissions), this.get("hotkeys") || this.set("hotkeys", new n), this.get("activities") || this.set("activities", new t), this.bind("change", this.checkPrefsChanged, this);
        },
        defaults: {
            username: "",
            password: "",
            email: "",
            gravatar: "./../user/user_gravatar.png",
            researchInterest: "",
            affiliation: "",
            description: "",
            subtitle: "",
            corpuses: [],
            dataLists: [],
            mostRecentIds: {},
            firstname: "",
            lastname: "",
            teams: [],
            sessionHistory: []
        },
        subtitle: function() {
            return this.get("firstname") == undefined && this.set("firstname", ""), this
.get("lastname") == undefined && this.set("lastname", ""), this.get("firstname") + " " + this.get("lastname");
        },
        checkPrefsChanged: function() {
            try {
                window.appView.userPreferenceView.model = this.get("prefs"), window.appView.userPreferenceView.render();
            } catch (e) {}
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return o;
}), fielddb.define("datum/Session", [ "backbone", "activity/Activity", "comment/Comment", "comment/Comments", "datum/DatumField", "datum/DatumFields", "user/Consultant", "user/Team", "user/User" ], function(e, t, n, r, i, s, o, u, a) {
    var f = e.Model.extend({
        initialize: function() {
            Utils.debug("SESSION init"), this.get("comments") || this.set("comments", new r);
        },
        model: {
            sessionFields: s,
            comments: r
        },
        insertNewComment: function(e) {
            var r = new 
n({
                text: e
            });
            this.get("comments").add(r), window.appView.addUnsavedDoc(this.id);
            var i = this.get("sessionFields").where({
                label: "goal"
            })[0].get("mask");
            window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <a href='#data/" + this.id + "'><i class='icon-comments-alt'></i> " + i + "</a>",
                teamOrPersonal: "team",
                context: " via Offline App."
            })), window.app.get("currentUserActivityFeed").addActivity(new t({
                verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <a href='#data/" + this.id + "'><i class='icon-comments-alt'></i> " + 
i + "</a>",
                teamOrPersonal: "personal",
                context: " via Offline App."
            }));
        },
        changePouch: function(t, n) {
            t || (t = this.get("pouchname")), this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t : Utils.pouchUrl + t)), typeof n == "function" && n();
        },
        saveAndInterConnectInApp: function(e, n) {
            Utils.debug("Saving the Session");
            var r = this, i = !0;
            this.id ? i = !1 : this.set("dateCreated", JSON.stringify(new Date));
            if (window.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof n == "function" ? n() : alert("Session save error. I cant save this session in this corpus, it belongs to another corpus. ");
                return;
            }
            var s = this.get("_rev");
            this.set("dateModified", JSON.stringify(new Date)), this.changePouch(null, function() {
                
r.save(null, {
                    success: function(n, r) {
                        Utils.debug("Session save success");
                        var o = n.get("sessionFields").where({
                            label: "goal"
                        })[0].get("mask"), u = "#diff/oldrev/" + s + "/newrev/" + r._rev;
                        window.appView && (window.appView.toastUser("Sucessfully saved session: " + o, "alert-success", "Saved!"), window.appView.addSavedDoc(n.id));
                        var a = "updated";
                        verbicon = "icon-pencil", i && (a = "added", verbicon = "icon-plus"), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            verb: "<a href='" + u + "'>" + a + "</a> ",
                            verbicon: verbicon,
                            directobjecticon: "icon-comments-alt",
                            directobject: "<a href='#session/" + n.id + "'>" + o + "</a> ",
                            indirectobject
: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get("title") + "</a>",
                            teamOrPersonal: "team",
                            context: " via Offline App."
                        })), window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "<a href='" + u + "'>" + a + "</a> ",
                            verbicon: verbicon,
                            directobjecticon: "icon-comments-alt",
                            directobject: "<a href='#session/" + n.id + "'>" + o + "</a> ",
                            indirectobject: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get("title") + "</a>",
                            teamOrPersonal: "personal",
                            context: " via Offline App."
                        }));
                        var f = window.app.get("corpus").get("sessions").getByCid(n.cid);
                        
f == undefined ? window.app.get("corpus").get("sessions").unshift(n) : f !== n && (f = n), window.app.get("corpus").get("sessions").length == 1 && (window.app.get("authentication").get("userPrivate").get("mostRecentIds").sessionid = n.id), window.app.get("authentication").get("userPrivate").get("sessionHistory").indexOf(n.id) == -1 && window.app.get("authentication").get("userPrivate").get("sessionHistory").unshift(n.id), window.app.get("authentication").saveAndInterConnectInApp(), typeof e == "function" && e();
                    },
                    error: function(e) {
                        typeof n == "function" ? n() : (alert("Session save error" + JSON.stringfy(e)), Utils.debug("Session save error" + JSON.stringfy(e)));
                    }
                });
            });
        },
        setAsCurrentSession: function(e, t) {
            if (window.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof t == "function" ? t() : alert("This is a bug, cannot load the session you asked for, it is not in this corpus."
);
                return;
            }
            window.app.get("currentSession").id != this.id && window.app.set("currentSession", this), window.app.get("authentication").get("userPrivate").get("mostRecentIds").sessionid = this.id, window.app.get("authentication").saveAndInterConnectInApp();
            try {
                window.appView.setUpAndAssociateViewsAndModelsWithCurrentSession(function() {
                    typeof e == "function" ? e() : (window.appView.currentSessionReadView.format = "leftSide", window.appView.currentSessionReadView.render(), window.appView.toastUser("Sucessfully connected all views up to session: " + this.id, "alert-success", "Connected!"));
                });
            } catch (n) {
                typeof t == "function" ? t() : alert("This is probably a bug. There was a problem rendering the current session's views after resetting the current session.");
            }
        },
        validate: function(e) {}
    });
    return f;
}), fielddb
.define("datum/Datum", [ "backbone", "activity/Activity", "audio_video/AudioVideo", "comment/Comment", "comment/Comments", "datum/DatumField", "datum/DatumFields", "datum/DatumState", "datum/DatumStates", "datum/DatumTag", "datum/DatumTags", "datum/Session", "libs/Utils" ], function(e, t, n, r, s, o, u, a, f, l, c, h) {
    var p = e.Model.extend({
        initialize: function() {
            this.get("audioVideo") || this.set("audioVideo", new n), this.get("comments") || this.set("comments", new s), this.get("datumTags") || this.set("datumTags", new c);
        },
        model: {
            datumFields: u,
            audioVideo: n,
            session: h,
            comments: s,
            datumStates: f,
            datumTags: c
        },
        changePouch: function(t, n) {
            t || (t = this.get("pouchname"), t == undefined && (t = window.app.get("corpus").get("pouchname"))), this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t 
: Utils.pouchUrl + t)), typeof n == "function" && n();
        },
        getAllIdsByDate: function(e) {
            var t = this;
            try {
                this.changePouch(this.get("pouchname"), function() {
                    t.pouch(function(t, n) {
                        n.query("get_ids/by_date", {
                            reduce: !1
                        }, function(t, n) {
                            !t && typeof e == "function" && (Utils.debug("Callback with: ", n.rows), e(n.rows));
                        });
                    });
                });
            } catch (n) {
                appView.datumsEditView.render(), alert("Couldnt show the most recent datums " + JSON.stringify(n));
            }
        },
        searchByQueryString: function(e, t) {
            var n = this;
            try {
                window.pageTracker._trackPageview("/search_results.php?q=" + e);
            } catch (r) {
                Utils.debug("Search Analytics not working."
);
            }
            try {
                this.changePouch(this.get("pouchname"), function() {
                    n.pouch(function(r, s) {
                        s.query("get_datum_field/get_datum_fields", {
                            reduce: !1
                        }, function(r, s) {
                            var o = [];
                            if (!r) {
                                var u = n.processQueryString(e);
                                for (i in s.rows) {
                                    var a = !1;
                                    if (e.trim() == "") a = !0; else {
                                        a = n.matchesSingleCriteria(s.rows[i].key, u[0]);
                                        for (var f = 1; f < u.length; f += 2) if (u[f] == "AND") {
                                            if (!a) break;
                                            a = a && n.matchesSingleCriteria(s.rows[i].key, u[f + 1]);
                                        
} else a = a || n.matchesSingleCriteria(s.rows[i].key, u[f + 1]);
                                    }
                                    a && o.push(s.rows[i].value);
                                }
                            }
                            typeof t == "function" && t(_.unique(o));
                        });
                    });
                });
            } catch (r) {
                alert("Couldnt search the data, if you sync with the server you might get the most recent search index.");
            }
        },
        matchesSingleCriteria: function(e, t) {
            var n = t.indexOf(":"), r = t.substring(0, n), i = t.substring(n + 1);
            return e[r] && e[r].toLowerCase().indexOf(i) >= 0;
        },
        processQueryString: function(e) {
            var t = e.split(" "), n = [], r = "";
            for (i in t) {
                var s = t[i].trim();
                if (s.length <= 0) break;
                s == "AND" || s == "OR" ? (n.push
(r), n.push(s), r = "") : r ? r = r + " " + s.toLowerCase() : r = s.toLowerCase();
            }
            return n.push(r), n;
        },
        clone: function() {
            var e = new p({
                audioVideo: new n(this.get("audioVideo").toJSON(), {
                    parse: !0
                }),
                comments: new s(this.get("comments").toJSON(), {
                    parse: !0
                }),
                dateEntered: this.get("dateEntered"),
                dateModified: this.get("dateModified"),
                datumFields: new u(this.get("datumFields").toJSON(), {
                    parse: !0
                }),
                datumStates: new f(this.get("datumStates").toJSON(), {
                    parse: !0
                }),
                datumTags: new c(this.get("datumTags").toJSON(), {
                    parse: !0
                }),
                pouchname: this.get("pouchname"),
                session: this.get("session")
            
});
            return e;
        },
        laTeXiT: function(e) {
            utterance = this.get("datumFields").where({
                label: "utterance"
            })[0].get("mask"), gloss = this.get("datumFields").where({
                label: "gloss"
            })[0].get("mask"), translation = this.get("datumFields").where({
                label: "translation"
            })[0].get("mask");
            var t = "\n \\begin{exe} \n \\ex [*] \\gll " + utterance + " \\\\" + "\n	" + gloss + " \\\\" + "\n	\\glt `" + translation + "'" + "\n\\end{exe}\n\n";
            return e != null && ($("#export-type-description").html(" as LaTeX (GB4E)"), $("#export-text-area").val($("#export-text-area").val() + t)), t;
        },
        exportAsPlainText: function(e) {
            utterance = this.get("datumFields").where({
                label: "utterance"
            })[0].get("mask"), gloss = this.get("datumFields").where({
                label: "gloss"
            })[0].get("mask"), translation = 
this.get("datumFields").where({
                label: "translation"
            })[0].get("mask");
            var t = utterance + "\n" + gloss + "\n" + translation + "\n\n";
            return e != null && ($("#export-type-description").html(" as text (Word)"), $("#export-text-area").val($("#export-text-area").val() + t)), t;
        },
        exportAsCSV: function(e, t, n) {
            t == null && (t = [ "judgement", "utterance", "morphemes", "gloss", "translation" ]), judgement = this.get("datumFields").where({
                label: "judgement"
            })[0].get("mask"), morphemes = this.get("datumFields").where({
                label: "morphemes"
            })[0].get("mask"), utterance = this.get("datumFields").where({
                label: "utterance"
            })[0].get("mask"), gloss = this.get("datumFields").where({
                label: "gloss"
            })[0].get("mask"), translation = this.get("datumFields").where({
                label: "translation"
            
})[0].get("mask");
            var r = [ judgement, utterance, morphemes, gloss, translation ], i = '"' + r.join('","') + '"\n';
            if (n) {
                var s = '"' + t.join('","') + '"';
                i = s + "\n" + i;
            }
            return e != null && ($("#export-type-description").html(" as CSV (Excel, Filemaker Pro)"), $("#export-text-area").val($("#export-text-area").val() + i)), i;
        },
        encrypt: function() {
            this.set("confidential", !0), this.get("datumFields").each(function(e) {
                e.set("encrypted", "checked");
            }), this.saveAndInterConnectInApp(window.app.router.showDashboard, window.app.router.showDashboard);
        },
        decrypt: function() {
            this.set("confidential", !1), this.get("datumFields").each(function(e) {
                e.set("encrypted", "");
            });
        },
        saveAndInterConnectInApp: function(e, n) {
            Utils.debug("Saving a Datum");
            
var r = this, i = !0;
            this.id ? i = !1 : this.set("dateEntered", JSON.stringify(new Date));
            if (window.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof n == "function" ? n() : alert("Datum save error. I cant save this datum in this corpus, it belongs to another corpus. ");
                return;
            }
            this.get("datumFields").each(function(e) {
                e.set("value", e.get("mask"));
            }), this.set({
                pouchname: window.app.get("corpus").get("pouchname"),
                dateModified: JSON.stringify(new Date)
            }), this.get("session") ? Utils.debug("Not setting the session on this datum.") : (this.set("session", window.app.get("currentSession")), Util.debug("Setting the session on this datum to the current one.")), window.app.get("corpus").set("dateOfLastDatumModifiedToCheckForOldSession", JSON.stringify(new Date));
            var s = this.get("_rev");
            try {
                
var o = this.get("datumStates").models;
                for (var u in o) o[u].get("state") == undefined && this.get("datumStates").remove(o[u]);
            } catch (a) {
                Utils.debug("Removing empty states work around failed some thing was wrong.", a);
            }
            this.changePouch(null, function() {
                r.save(null, {
                    success: function(n, o) {
                        Utils.debug("Datum save success");
                        var u = n.get("datumFields").where({
                            label: "utterance"
                        })[0].get("mask"), a = "#diff/oldrev/" + s + "/newrev/" + o._rev;
                        window.appView && (window.appView.toastUser("Sucessfully saved datum: " + u, "alert-success", "Saved!"), window.appView.addSavedDoc(n.id));
                        var f = "updated";
                        verbicon = "icon-pencil", i && (f = "added", verbicon = "icon-plus"), window.app.get("currentCorpusTeamActivityFeed"
).addActivity(new t({
                            verb: "<a href='" + a + "'>" + f + "</a> ",
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.get("pouchname") + "/datum/" + n.id + "'>" + u + "</a> ",
                            directobjecticon: "icon-list",
                            indirectobject: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get("title") + "</a>",
                            teamOrPersonal: "team",
                            context: " via Offline App."
                        })), window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "<a href='" + a + "'>" + f + "</a> ",
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.get("pouchname") + "/datum/" + n.id + "'>" + u + "</a> ",
                            directobjecticon: "icon-list",
                            
indirectobject: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get("title") + "</a>",
                            teamOrPersonal: "personal",
                            context: " via Offline App."
                        }));
                        if ($("#search_box").val() != "") {
                            var l = n.get("datumFields").toJSON(), c = {};
                            for (var h in l) c[l[h].label] = l[h].mask;
                            var p = r.processQueryString($("#search_box").val()), d = r.matchesSingleCriteria(c, p[0]);
                            for (var v = 1; v < p.length; v += 2) if (p[v] == "AND") {
                                if (!d) break;
                                d = d && n.matchesSingleCriteria(c, p[v + 1]);
                            } else d = d || n.matchesSingleCriteria(c, p[v + 1]);
                            if (d) {
                                window.appView.searchEditView.searchPaginatedDataListDatumsView
.collection.remove(n), window.appView.searchEditView.searchPaginatedDataListDatumsView.collection.unshift(n);
                                var m = window.appView.searchEditView.searchDataListView.model.get("datumIds").indexOf(n.id);
                                m != -1 && window.appView.searchEditView.searchDataListView.model.get("datumIds").splice(m, 1), window.appView.searchEditView.searchDataListView.model.get("datumIds").unshift(n.id);
                            }
                        }
                        typeof e == "function" && e();
                    },
                    error: function(e) {
                        typeof n == "function" ? n() : alert("Datum save error" + e);
                    }
                });
            });
        },
        setAsCurrentDatum: function(e, t) {
            if (window.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof t == "function" ? t() : alert("This is a bug, cannot load the datum you asked for, it is not in this corpus."
);
                return;
            }
            window.appView.datumsEditView.datumsView.collection.models[0].id != this.id && window.appView.datumsEditView.datumsView.prependDatum(this), typeof e == "function" && e();
        }
    });
    return p;
}), fielddb.define("data_list/DataList", [ "backbone", "activity/Activity", "datum/Datum", "comment/Comment", "comment/Comments" ], function(e, t, n, r, i) {
    var s = e.Model.extend({
        initialize: function() {
            Utils.debug("DATALIST init"), this.get("comments") || this.set("comments", new i), this.get("dateCreated") || this.set("dateCreated", (new Date).toDateString());
        },
        defaults: {
            title: "Untitled Data List",
            description: "",
            datumIds: []
        },
        model: {
            comments: i
        },
        insertNewComment: function(e) {
            var n = new r({
                text: e
            });
            this.get("comments").add(n), window.appView
.addUnsavedDoc(this.id), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <a href='#data/" + this.id + "'><i class='icon-pushpin'></i> " + this.get("title") + "</a>",
                teamOrPersonal: "team",
                context: " via Offline App."
            })), window.app.get("currentUserActivityFeed").addActivity(new t({
                verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <a href='#data/" + this.id + "'><i class='icon-pushpin'></i> " + this.get("title") + "</a>",
                teamOrPersonal: "personal",
                context: " via Offline App."
            }));
        },
        changePouch: function(t, n) {
            
t || (t = this.get("pouchname"), t == undefined && (t = window.app.get("corpus").get("pouchname"))), this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t : Utils.pouchUrl + t)), typeof n == "function" && n();
        },
        getAllAudioAndVideoFiles: function(e, t) {
            e || (e = this.get("datumIds")), e.length == 0 && (e = this.get("datumIds"));
            var r = [];
            Utils.debug("DATA LIST datumIdsToGetAudioVideo " + JSON.stringify(e));
            for (var i in e) {
                var s = new n({
                    pouchname: app.get("corpus").get("pouchname")
                });
                s.id = e[i];
                var o = i;
                s.changePouch(window.app.get("corpus").get("pouchname"), function() {
                    s.fetch({
                        success: function(n, i) {
                            r.push(n.get("audioVideo").get("URL")), o == e.length - 1 && typeof t == "function" && t(r);
                        
}
                    });
                });
            }
        },
        applyFunctionToAllIds: function(e, t, r) {
            e || (e = this.get("datumIds")), e.length == 0 && (e = this.get("datumIds")), t || (t = "laTeXiT"), !r, Utils.debug("DATA LIST datumIdsToApplyFunction " + JSON.stringify(e));
            for (var i in e) {
                var s = new n({
                    pouchname: app.get("corpus").get("pouchname")
                });
                s.id = e[i], s.changePouch(window.app.get("corpus").get("pouchname"), function() {
                    s.fetch({
                        success: function(e, n) {
                            e[t](r);
                        }
                    });
                });
            }
        },
        saveAndInterConnectInApp: function(e, n) {
            Utils.debug("Saving the DataList");
            var r = this, i = !0;
            this.id ? i = !1 : this.set("dateCreated", JSON.stringify(new Date));
            if (window
.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof n == "function" ? n() : alert("DataList save error. I cant save this dataList in this corpus, it belongs to another corpus. ");
                return;
            }
            var s = this.get("_rev");
            this.set("dateModified", JSON.stringify(new Date)), this.changePouch(null, function() {
                r.save(null, {
                    success: function(n, r) {
                        Utils.debug("DataList save success");
                        var o = n.get("title"), u = "#diff/oldrev/" + s + "/newrev/" + r._rev;
                        window.appView && (window.appView.toastUser("Sucessfully saved data list: " + o, "alert-success", "Saved!"), window.appView.addSavedDoc(n.id));
                        var a = "updated";
                        verbicon = "icon-pencil", i && (a = "added", verbicon = "icon-plus"), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            
verb: "<a href='" + u + "'>" + a + "</a> ",
                            verbicon: verbicon,
                            directobjecticon: "icon-pushpin",
                            directobject: "<a href='#data/" + n.id + "'>" + o + "</a> ",
                            indirectobject: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get("title") + "</a>",
                            teamOrPersonal: "team",
                            context: " via Offline App."
                        })), window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "<a href='" + u + "'>" + a + "</a> ",
                            verbicon: verbicon,
                            directobjecticon: "icon-pushpin",
                            directobject: "<a href='#data/" + n.id + "'>" + o + "</a> ",
                            indirectobject: "in <a href='#corpus/" + window.app.get("corpus").id + "'>" + window.app.get("corpus").get
("title") + "</a>",
                            teamOrPersonal: "personal",
                            context: " via Offline App."
                        })), window.app.get("authentication").get("userPrivate").get("mostRecentIds").datalistid = n.id;
                        var f = window.app.get("corpus").get("dataLists").get(n.id);
                        f == undefined ? window.app.get("corpus").get("dataLists").unshift(n) : (window.app.get("corpus").get("dataLists").remove(f), window.app.get("corpus").get("dataLists").unshift(n)), window.app.get("authentication").get("userPrivate").get("dataLists").indexOf(n.id) == -1 && window.app.get("authentication").get("userPrivate").get("dataLists").unshift(n.id), typeof e == "function" && e();
                    },
                    error: function(e) {
                        typeof n == "function" ? n() : alert("DataList save error" + e);
                    }
                });
            });
        },
        setAsCurrentDataList
: function(e, t) {
            if (window.app.get("corpus").get("pouchname") != this.get("pouchname")) {
                typeof t == "function" ? t() : alert("This is a bug, cannot load the dataList you asked for, it is not in this corpus.");
                return;
            }
            window.app.get("currentDataList").id != this.id && window.app.set("currentDataList", this), window.app.get("authentication").get("userPrivate").get("mostRecentIds").datalistid = this.id, window.app.get("authentication").saveAndInterConnectInApp();
            var n = this;
            try {
                window.appView.setUpAndAssociateViewsAndModelsWithCurrentDataList(function() {
                    typeof e == "function" ? e() : (window.appView.toastUser("Sucessfully connected all views up to data list: " + n.id, "alert-success", "Connected!"), window.appView.renderEditableDataListViews("leftSide"), window.appView.renderReadonlyDataListViews("leftSide"));
                });
            } catch (
r) {
                Utils.debug(r), typeof t == "function" ? (alert("Calling the failure callback in the set as current data list." + n.id), t()) : alert("This is probably a bug. There was a problem rendering the current dataList's views after resetting the current session." + n.id);
            }
        }
    });
    return s;
}), fielddb.define("data_list/DataLists", [ "backbone", "data_list/DataList" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("user/Consultants", [ "backbone", "user/UserMask" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("lexicon/LexiconNode", [ "backbone" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {},
        defaults: {
            morpheme: "",
            allomorphs: [],
            gloss: "",
            value: 0,
            
data: []
        },
        model: {}
    });
    return t;
}), fielddb.define("lexicon/LexiconNodes", [ "backbone", "lexicon/LexiconNode" ], function(e, t) {
    var n = e.Collection.extend({
        model: t,
        defaultOptions: {
            unique: !0,
            concatSimilarNodes: !1
        },
        add: function(e, t) {
            t = t || this.defaultOptions, e = this._prepareModel(e, t);
            if (!e) return !1;
            if (t.unique) {
                var n = this.where({
                    morpheme: e.get("morpheme"),
                    gloss: e.get("gloss")
                });
                if (n.length > 0) {
                    if (t.concatSimilarNodes) {
                        var r = this.where({
                            morpheme: e.get("morpheme"),
                            gloss: e.get("gloss")
                        })[0];
                        e.set("valueLocalOld", r.get("value"));
                    }
                    Utils.debug("Updating "
, n[0].toJSON(), " to ", e.toJSON()), n[0].set(e.toJSON());
                    return;
                }
            }
            this._byId[e.id] = e, this._byCid[e.cid] = e;
            var i = t.at != null ? t.at : this.comparator ? this.sortedIndex(e, this.comparator) : this.length;
            return this.models.splice(i, 0, e), e.bind("all", this._onModelEvent), this.length++, t.index = i, t.silent || e.trigger("add", e, this, t), e;
        }
    });
    return n;
}), fielddb.define("lexicon/Lexicon", [ "backbone", "lexicon/LexiconNode", "lexicon/LexiconNodes" ], function(e, t, n) {
    var r = e.Model.extend({
        initialize: function() {},
        model: {
            lexiconNodes: n
        },
        buildLexiconFromCouch: function(e, r) {
            var i = this, s = app.get("corpus").get("couchConnection"), o = s.protocol + s.domain + ":" + s.port + "/";
            $.ajax({
                type: "GET",
                url: o + e + "/_design/lexicon/_view/create_triples?group=true"
,
                success: function(s) {
                    i.get("lexiconNodes") || i.set("lexiconNodes", new n), localStorage.setItem(e + "lexiconResults", s);
                    var o = JSON.parse(s).rows;
                    for (triple in o) i.get("lexiconNodes").add(new t({
                        morpheme: o[triple].key.morpheme,
                        allomorphs: [ o[triple].key.morpheme ],
                        gloss: o[triple].key.gloss,
                        value: o[triple].value
                    }));
                    typeof r == "function" && r();
                },
                dataType: ""
            });
        },
        buildLexiconFromLocalStorage: function(e, r) {
            var i = localStorage.getItem(e + "lexiconResults");
            if (!i) return;
            this.get("lexiconNodes") || this.set("lexiconNodes", new n);
            var s = JSON.parse(i).rows;
            for (triple in s) this.get("lexiconNodes").add(new t({
                morpheme
: s[triple].key.morpheme,
                allomorphs: [ s[triple].key.morpheme ],
                gloss: s[triple].key.gloss,
                value: s[triple].value
            }));
            typeof r == "function" && r();
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return r;
}), fielddb.define("permission/Permissions", [ "backbone", "permission/Permission" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("datum/Sessions", [ "backbone", "datum/Session" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
});

var Glosser = Glosser || {};

Glosser.currentCorpusName = "", Glosser.downloadPrecedenceRules = function(e, t) {
    var n = app.get("corpus").get("couchConnection"), r = n.protocol + n.domain + ":" + n.port + "/";
    $.ajax({
        
type: "GET",
        url: r + e + "/_design/get_precedence_rules_from_morphemes/_view/precedence_rules?group=true",
        success: function(n) {
            n = JSON.parse(n), localStorage.setItem(e + "precendenceRules", JSON.stringify(n.rows));
            var r = _.chain(n.rows).groupBy(function(e) {
                return e.key.x + "-" + e.key.y;
            }).value();
            localStorage.setItem(e + "reducedRules", JSON.stringify(r)), Glosser.currentCorpusName = e, typeof t == "function" && t();
        },
        error: function(e) {
            console.log("error getting precedence rules:", e);
        },
        dataType: ""
    });
}, Glosser.morphemefinder = function(e) {
    var t = "", n = localStorage.getItem(Glosser.currentCorpusName + "reducedRules"), r = [];
    if (n) {
        n = JSON.parse(n);
        var i = e.trim().split(/ +/);
        for (var s in i) {
            i[s] = "@" + i[s] + "@";
            var o = [];
            for (var u in n) i[s].indexOf(u
.replace(/-/, "")) >= 0 && o.push({
                r: n[u]
            });
            var a = [];
            a.push("@");
            for (var f = 0; f < 10; f++) {
                if (a[f] == undefined) break;
                for (var l in o) if (a[f] == o[l].r[0].key.x) {
                    if (a[f + 1]) {
                        a.pop();
                        break;
                    }
                    a[f + 1] = o[l].r[0].key.y;
                }
            }
            var c = [];
            if (a[a.length - 1] != "@" || a.length == 1) {
                c.push("@");
                for (var f = 0; f < 10; f++) {
                    if (c[f] == undefined) break;
                    for (var l in o) if (c[f] == o[l].r[0].key.y) {
                        if (c[f + 1]) {
                            c.pop();
                            break;
                        }
                        c[f + 1] = o[l].r[0].key.x;
                    }
                }
            }
            
var h = [];
            h = a.concat(c.reverse());
            for (var p in h) h[p] = "(" + h[p] + ")";
            var d = new RegExp(h.join("(.*)"), "");
            t = i[s].replace(d, "$1-$2-$3-$4-$5-$6-$7-$8-$9").replace(/\$[0-9]/g, "").replace(/@/g, "").replace(/--+/g, "-").replace(/^-/, "").replace(/-$/, ""), Utils.debug("Potential parse of " + i[s].replace(/@/g, "") + " is " + t), r.push(t);
        }
    }
    return r.join(" ");
}, Glosser.toastedUserToSync = !1, Glosser.toastedUserToImport = 0, Glosser.glossFinder = function(e) {
    var t = e.split(/ +/), n = [];
    if (!window.app.get("corpus")) return "";
    if (!window.app.get("corpus").lexicon.get("lexiconNodes")) {
        var r = app.get("corpus").get("dataLists").models[app.get("corpus").get("dataLists").models.length - 1].get("datumIds").length;
        return r > 30 && !Glosser.toastedUserToSync ? (Glosser.toastedUserToSync = !0, window.appView.toastUser("You probably have enough data to train an autoglosser for your corpus.\n\nIf you sync your data with the team server then editing the morphemes will automatically run the auto glosser."
, "alert-success", "Sync to train your auto-glosser:")) : (Glosser.toastedUserToImport++, Glosser.toastedUserToImport % 10 == 1 && r < 30 && window.appView.toastUser("You have roughly " + r + " datum saved in your pouch, if you have around 30 datum, then you have enough data to train an autoglosser for your corpus.", "alert-info", "")), "";
    }
    var i = window.app.get("corpus").lexicon.get("lexiconNodes");
    for (var s in t) {
        var o = t[s].split("-"), u = [];
        for (var a in o) {
            var f = _.max(i.where({
                morpheme: o[a]
            }), function(e) {
                return e.get("value");
            }), l = "?";
            f && (l = f.get("gloss")), u.push(l);
        }
        n.push(u.join("-"));
    }
    return n.join(" ");
}, Glosser.generateForceDirectedRulesJsonForD3 = function(e, t) {
    t || (t = Glosser.currentCorpusName), e || (e = localStorage.getItem(t + "precendenceRules"), e && (e = JSON.parse(e)));
    if (!e) return;
    
morphemeLinks = [], morphemes = [];
    for (var n in e) {
        var r = morphemes.indexOf(e[n].key.x);
        r < 0 && (morphemes.push(e[n].key.x), r = morphemes.length - 1);
        var i = morphemes.indexOf(e[n].key.y);
        i < 0 && (morphemes.push(e[n].key.y), i = morphemes.length - 1), e[n].key.y != "@" && morphemeLinks.push({
            source: r,
            target: i,
            value: 1
        });
    }
    var s = [];
    for (m in morphemes) s.push({
        name: morphemes[m],
        group: morphemes[m].length
    });
    var o = {};
    return o.links = morphemeLinks, o.nodes = s, Glosser.rulesGraph = o, o;
}, Glosser.saveAndInterConnectInApp = function(e) {
    typeof e == "function" && e();
}, Glosser.visualizeMorphemesAsForceDirectedGraph = function(e, t, n) {
    if (!n) throw "Must provide corpus name to be able to visualize morphemes";
    Glosser.currentCorpusName = n, e || (e = Glosser.rulesGraph, e ? e.links.length == 0 && (e = Glosser.generateForceDirectedRulesJsonForD3
()) : e = Glosser.generateForceDirectedRulesJsonForD3());
    if (!e) return;
    if (Glosser.rulesGraph.links.length == 0) return;
    json = e;
    var r = 800, i = 300, s = d3.scale.category20(), o = d3.scale.linear().range([ 0, r ]), u = d3.scale.linear().range([ 0, i - 40 ]), a = d3.layout.force().charge(-120).linkDistance(30).size([ r, i ]), f = d3.select("#corpus-precedence-rules-visualization-fullscreen").append("svg").attr("width", r).attr("title", "Morphology Visualization for " + n).attr("height", i), l = "Explore the precedence relations of morphemes in your corpus";
    e.nodes.length < 3 && (l = "Your morpheme visualizer will appear here after you have synced.");
    var c = f.append("text").attr("class", "vis-title").attr("dy", "2em").attr("dx", "2em").text(l), h = null;
    a.nodes(json.nodes).links(json.links).start();
    var p = f.selectAll("line.link").data(json.links).enter().append("line").attr("class", "link").style("stroke-width", function(e) {
        return Math
.sqrt(e.value);
    }), d = f.selectAll("circle.node").data(json.nodes).enter().append("circle").attr("class", "node").attr("r", 5).style("fill", function(e) {
        return s(e.group);
    }).on("mouseover", function(e) {
        h = d3.select("body").append("div").style("position", "absolute").style("z-index", "10").style("visibility", "visible").style("color", "#fff").text(e.name);
    }).on("mouseout", function() {
        h.style("visibility", "hidden");
    }).call(a.drag);
    d.append("title").text(function(e) {
        return e.name;
    }), a.on("tick", function() {
        p.attr("x1", function(e) {
            return e.source.x;
        }).attr("y1", function(e) {
            return e.source.y;
        }).attr("x2", function(e) {
            return e.target.x;
        }).attr("y2", function(e) {
            return e.target.y;
        }), d.attr("cx", function(e) {
            return e.x;
        }).attr("cy", function(e) {
            return e.y;
        });
    });
}, fielddb
.define("glosser/Glosser", function() {}), fielddb.define("corpus/CorpusMask", [ "backbone", "activity/Activity", "comment/Comment", "comment/Comments", "confidentiality_encryption/Confidential", "datum/DatumField", "datum/DatumFields", "datum/DatumState", "datum/DatumStates", "data_list/DataList", "data_list/DataLists", "user/Consultants", "lexicon/Lexicon", "permission/Permission", "permission/Permissions", "datum/Sessions", "user/User", "glosser/Glosser", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m) {
    var g = e.Model.extend({
        initialize: function() {
            this.set("id", "corpus"), this.get("datumStates") || this.set("datumStates", new a), this.get("datumFields") || this.set("datumFields", new o([ new s({
                label: "judgement",
                size: "3",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "Use this field to establish your team's gramaticality/acceptablity judgements (*,#,? etc)"
            
}), new s({
                label: "utterance",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "Use this as Line 1 in your examples for handouts (ie, either Orthography, or phonemic/phonetic representation)"
            }), new s({
                label: "morphemes",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "This line is used to determine the morpheme segmentation to generate glosses, it also optionally can show up in your LaTeXed examples if you choose to show morpheme segmentation in addtion ot line 1, gloss and translation."
            }), new s({
                label: "gloss",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "This line appears in the gloss line of your LaTeXed examples, we reccomend Leipzig conventions (. for fusional morphemes, - for morpehem boundaries etc) The system uses this line to partially help you in glossing. "
            
}), new s({
                label: "translation",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "Use this as your primary translation. It does not need to be English, simply a language your team is comfortable with. If your consultant often gives you multiple languages for translation you can also add addtional translations in the customized fields. For example, your Quechua informants use Spanish for translations, then you can make all Translations in Spanish, and add an additional field for English if you want to generate a handout containing the datum. "
            }) ])), this.get("sessionFields") || this.set("sessionFields", new o([ new s({
                label: "dialect",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "You can use this field to be as precise as you would like about the dialect of this session."
            }), new s({
                label: "language"
,
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This is the langauge (or language family) if you would like to use it."
            }), new s({
                label: "dateElicited",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This is the date in which the session took place."
            }), new s({
                label: "user",
                shouldBeEncrypted: "",
                userchooseable: "disabled"
            }), new s({
                label: "dateSEntered",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This is the date in which the session was entered."
            }) ])), this.get("comments") || this.set("comments", new r), this.get("dataLists") || this.set("dataLists", new l), this.get("sessions") || this.set("sessions", new v), this.permissions || (this.permissions = new d);
        },
        
defaults: {
            title: "Private Corpus",
            titleAsUrl: "PrivateCorpus",
            description: "The details of this corpus are not public.",
            couchConnection: JSON.parse(localStorage.getItem("mostRecentCouchConnection")) || Utils.defaultCouchConnection()
        },
        set: function(t, n, r) {
            var i;
            return _.isObject(t) || t == null ? (i = t, r = n) : (i = {}, i[t] = n), r = r || {}, i.title && (i.titleAsUrl = i.title.toLowerCase().replace(/[!@#$^&%*()+=-\[\]\/{}|:<>?,."'`; ]/g, "_")), e.Model.prototype.set.call(this, i, r);
        },
        model: {
            consultants: c,
            datumStates: a,
            datumFields: o,
            sessionFields: o,
            searchFields: o,
            sessions: v,
            dataLists: l,
            permissions: d,
            comments: r
        },
        lexicon: new h,
        changePouch: function(t, n) {
            t == null || t == undefined ? t = this.get("couchConnection"
) : this.set("couchConnection", t), this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t.pouchname : Utils.pouchUrl + t.pouchname)), typeof n == "function" && n();
        },
        saveAndInterConnectInApp: function(e, t) {
            Utils.debug("Saving the CorpusMask");
            var n = this;
            this.changePouch(null, function() {
                n.pouch(function(r, i) {
                    n.set("id", "corpus");
                    var s = n.toJSON();
                    s._id = "corpus", i.put(s, function(r, o) {
                        Utils.debug(o), r ? (Utils.debug("CorpusMask put error", r), r.status == "409" ? n.fetch({
                            success: function(r, o) {
                                Utils.debug("CorpusMask fetch revision number success, after getting a Document update conflict", o), s._rev = n.get("_rev"), Utils.debug("CorpusMask old version", n.toJSON()), Utils.debug("CorpusMask replaced with new version"
, s), i.put(s, function(n, r) {
                                    n ? (Utils.debug("CorpusMask put error, even after fetching the version number", n), typeof t == "function" && t()) : (Utils.debug("CorpusMask put success, after fetching its version number and overwriting it", r), typeof e == "function" && e());
                                });
                            },
                            error: function(e) {
                                Utils.debug("CorpusMask fetch error after trying to resolve a conflict error" + JSON.stringify(r)), typeof t == "function" && t();
                            }
                        }) : (Utils.debug("CorpusMask put error that was not a conflict" + JSON.stringify(r)), typeof t == "function" && t())) : typeof e == "function" ? e() : Utils.debug("CorpusMask save success", o);
                    });
                });
            });
        },
        updateToPouch: function() {
            alert("Bug: the corpusmask updatetopouch method is deprecated!"
);
            var e = this;
            this.changePouch(null, function() {
                e.pouch(function(t, n) {
                    var r = e.toJSON();
                    r._id = "corpus", n.put(r, function(e, t) {
                        Utils.debug(t);
                    });
                });
            });
        },
        buildMorphologicalAnalyzerFromTeamServer: function(e, t) {
            e || this.get("pouchname"), t || (t = null), Glosser.downloadPrecedenceRules(e, t);
        },
        buildLexiconFromTeamServer: function(e, t) {
            e || this.get("pouchname"), t || (t = null), this.lexicon.buildLexiconFromCouch(e, t);
        }
    });
    return g;
}), fielddb.define("corpus/Corpus", [ "backbone", "activity/Activity", "comment/Comment", "comment/Comments", "corpus/CorpusMask", "confidentiality_encryption/Confidential", "datum/DatumField", "datum/DatumFields", "datum/DatumState", "datum/DatumStates", "data_list/DataList", "data_list/DataLists", "user/Consultants"
, "lexicon/Lexicon", "permission/Permission", "permission/Permissions", "datum/Session", "datum/Sessions", "user/Team", "user/User", "user/Users", "user/UserMask", "glosser/Glosser", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E) {
    var S = e.Model.extend({
        initialize: function() {
            Utils.debug("CORPUS INIT"), this.get("confidential") || this.set("confidential", new s), this.get("publicSelf") || this.set("publicSelf", new i({
                couchConnection: this.get("couchConnection"),
                pouchname: this.get("pouchname")
            })), this.get("publicCorpus") || this.set("publicCorpus", "Private"), this.bind("change:publicCorpus", this.changeCorpusPublicPrivate, this), typeof this.get("datumStates") == "function" && this.set("datumStates", new f([ new a({
                state: "Checked",
                color: "success",
                selected: "selected"
            }), new a({
                state: "To be checked"
,
                color: "warning"
            }), undefined, new a({
                state: "Deleted",
                color: "important",
                showInSearchResults: ""
            }) ])), typeof this.get("datumFields") == "function" && this.set("datumFields", new u([ new o({
                label: "judgement",
                size: "3",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "Use this field to establish your team's gramaticality/acceptablity judgements (*,#,? etc)"
            }), new o({
                label: "utterance",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "Use this as Line 1 in your examples for handouts (ie, either Orthography, or phonemic/phonetic representation)"
            }), new o({
                label: "morphemes",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help
: "This line is used to determine the morpheme segmentation to generate glosses, it also optionally can show up in your LaTeXed examples if you choose to show morpheme segmentation in addtion ot line 1, gloss and translation."
            }), new o({
                label: "gloss",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "This line appears in the gloss line of your LaTeXed examples, we reccomend Leipzig conventions (. for fusional morphemes, - for morpehem boundaries etc) The system uses this line to partially help you in glossing. "
            }), new o({
                label: "translation",
                shouldBeEncrypted: "checked",
                userchooseable: "disabled",
                help: "Use this as your primary translation. It does not need to be English, simply a language your team is comfortable with. If your consultant often gives you multiple languages for translation you can also add addtional translations in the customized fields. For example, your Quechua informants use Spanish for translations, then you can make all Translations in Spanish, and add an additional field for English if you want to generate a handout containing the datum. "
            
}) ])), typeof this.get("sessionFields") == "function" && this.set("sessionFields", new u([ new o({
                label: "goal",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This describes the goals of the session."
            }), new o({
                label: "consultants",
                shouldBeEncrypted: "",
                userchooseable: "disabled"
            }), new o({
                label: "dialect",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "You can use this field to be as precise as you would like about the dialect of this session."
            }), new o({
                label: "language",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This is the langauge (or language family) if you would like to use it."
            }), new o({
                label: "dateElicited",
                shouldBeEncrypted
: "",
                userchooseable: "disabled",
                help: "This is the date in which the session took place."
            }), new o({
                label: "user",
                shouldBeEncrypted: "",
                userchooseable: "disabled"
            }), new o({
                label: "dateSEntered",
                shouldBeEncrypted: "",
                userchooseable: "disabled",
                help: "This is the date in which the session was entered."
            }) ])), this.get("comments") || this.set("comments", new r), this.get("dataLists") || this.set("dataLists", new c), this.get("sessions") || this.set("sessions", new g);
        },
        loadPermissions: function() {
            this.get("team") || window.appView && this.set("team", window.app.get("authentication").get("userPublic")), this.permissions = new v;
            var e = new w;
            this.get("team") && e.models.push(this.get("team")), this.permissions.add(new d({
                users: 
e,
                role: "admin",
                pouchname: this.get("pouchname")
            })), this.permissions.add(new d({
                users: new w,
                role: "reader",
                pouchname: this.get("pouchname")
            })), this.permissions.add(new d({
                users: new w,
                role: "writer",
                pouchname: this.get("pouchname")
            }));
        },
        defaults: {
            title: "Untitled Corpus",
            titleAsUrl: "UntitledCorpus",
            description: "This is an untitled corpus, created by default. You should change its title and description to better describe whatever database/corpus you want to build.",
            consultants: h,
            datumStates: f,
            datumFields: u,
            sessionFields: u,
            searchFields: u,
            couchConnection: JSON.parse(localStorage.getItem("mostRecentCouchConnection")) || Utils.defaultCouchConnection()
        },
        model: 
{
            confidential: s,
            consultants: h,
            datumStates: f,
            datumFields: u,
            sessionFields: u,
            searchFields: u,
            sessions: g,
            dataLists: c,
            publicSelf: i,
            comments: r,
            team: E
        },
        insertNewComment: function(e) {
            var r = new n({
                text: e
            });
            this.get("comments").add(r), window.appView.addUnsavedDoc(this.id), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <i class='icon-cloud'></i><a href='#corpus/" + this.id + "'>this corpus</a>",
                teamOrPersonal: "team",
                context: " via Offline App."
            })), window.app.get("currentUserActivityFeed").addActivity(new t({
                
verb: "commented",
                verbicon: "icon-comment",
                directobjecticon: "",
                directobject: "'" + e + "'",
                indirectobject: "on <i class='icon-cloud'></i><a href='#corpus/" + this.id + "'>" + this.get("title") + "</a>",
                teamOrPersonal: "personal",
                context: " via Offline App."
            }));
        },
        newSession: function() {
            $("#new-session-modal").modal("show");
            var e = this;
            window.app.get("currentSession").saveAndInterConnectInApp(function() {
                window.appView.sessionNewModalView.model = new m({
                    pouchname: e.get("pouchname"),
                    sessionFields: e.get("sessionFields").clone()
                }), window.appView.sessionNewModalView.model.set("comments", new r), window.appView.sessionNewModalView.render();
            });
        },
        newCorpus: function() {
            $("#new-corpus-modal").modal("show"
), this.saveAndInterConnectInApp();
            var e = JSON.parse(JSON.stringify(this.attributes));
            e._id = undefined, e._rev = undefined, e.title = this.get("title") + " copy", e.titleAsUrl = this.get("titleAsUrl") + "Copy", e.description = "Copy of: " + this.get("description"), e.pouchname = this.get("pouchname") + "copy", e.couchConnection.pouchname = this.get("pouchname") + "copy", e.dataLists = [], e.sessions = [], e.comments = [], e.publicSelfMode = {}, e.team = window.app.get("authentication").get("userPublic").toJSON(), window.appView.corpusNewModalView.model = new S, window.appView.corpusNewModalView.model.set(window.appView.corpusNewModalView.model.parse(e)), window.appView.corpusNewModalView.render();
        },
        lexicon: new p,
        changePouch: function(t, n) {
            if (t == null || t == undefined) t = this.get("couchConnection");
            this.pouch == undefined && (this.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + t.pouchname 
: Utils.pouchUrl + t.pouchname)), Utils.testPouchChromeVersions(t.pouchname), typeof n == "function" && n();
        },
        saveAndInterConnectInApp: function(e, n) {
            Utils.debug("Saving the Corpus");
            var r = this, i = !1;
            this.id ? this.get("couchConnection").corpusid = this.id : (i = !0, this.get("pouchname") || this.set("pouchname", this.get("team").get("username") + "-" + this.get("title").replace(/[^a-zA-Z0-9-._~ ]/g, "")), this.get("couchConnection") || (this.get("couchConnection").pouchname = this.get("team").get("username") + "-" + this.get("title").replace(/[^a-zA-Z0-9-._~ ]/g, "")));
            var s = this.get("_rev");
            try {
                var o = this.get("datumStates").models;
                for (var u in o) o[u].get("state") == undefined && this.get("datumStates").remove(o[u]);
            } catch (a) {
                Utils.debug("Removing empty states work around failed some thing was wrong.", a);
            }
            
this.changePouch(null, function() {
                r.save(null, {
                    success: function(n, o) {
                        Utils.debug("Corpus save success");
                        var u = n.get("title"), f = "#diff/oldrev/" + s + "/newrev/" + o._rev, l = n.get("publicSelf");
                        l.changePouch && l.changePouch(n.get("couchConnection"), function() {
                            l.saveAndInterConnectInApp();
                        }), window.appView && (window.appView.toastUser("Sucessfully saved corpus: " + u, "alert-success", "Saved!"), window.appView.addSavedDoc(n.id));
                        var c = "updated";
                        verbicon = "icon-pencil", i && (c = "added", verbicon = "icon-plus");
                        var h = n.get("team").id;
                        h ? (window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "<a href='" + f + "'>" + c + "</a> ",
                            verbmask: 
c,
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.id + "'>" + u + "</a>",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "owned by <a href='#user/" + h + "'>" + h + "</a>",
                            indirectobject: "owned by <a href='#user/" + h + "'>" + h + "</a>",
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "personal"
                        })), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            verb: "<a href='" + f + "'>" + c + "</a> ",
                            verbmask: c,
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.id + "'>" + u + "</a>",
                            directobjectmask
: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "owned by <a href='#user/" + h + "'>this team</a>",
                            indirectobject: "owned by <a href='#user/" + h + "'>this team</a>",
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "team"
                        }))) : (h = n.get("team")._id, h || n.get("team").get("username") == window.app.get("authentication").get("userPrivate").get("username") && (h = window.app.get("authentication").get("userPrivate").id), window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "<a href='" + f + "'>" + c + "</a> ",
                            verbmask: c,
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.id + "'>" + u + "</a>",
                            directobjectmask
: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "owned by <a href='#user/" + h + "'>" + h + "</a>",
                            indirectobject: "owned by <a href='#user/" + h + "'>" + h + "</a>",
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "personal"
                        })), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            verb: "<a href='" + f + "'>" + c + "</a> ",
                            verbmask: c,
                            verbicon: verbicon,
                            directobject: "<a href='#corpus/" + n.id + "'>" + u + "</a>",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "owned by <a href='#user/" + h + "'>this team</a>",
                            
indirectobject: "owned by <a href='#user/" + h + "'>this team</a>",
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "team"
                        }))), n.get("couchConnection").corpusid = n.id;
                        var p = _.pluck(window.app.get("authentication").get("userPrivate").get("corpuses"), "pouchname");
                        p.indexOf(n.get("couchConnection").pouchname) == -1 && window.app.get("authentication").get("userPrivate").get("corpuses").unshift(n.get("couchConnection"));
                        if (n.get("dataLists").length > 0) {
                            var d = n.get("dataLists").models[n.get("dataLists").length - 1];
                            d.needsSave;
                        }
                        i ? r.makeSureCorpusHasADataList(function() {
                            r.makeSureCorpusHasASession(function() {
                                r.save(null
, {
                                    success: function(e, t) {
                                        window.app.get("authentication").saveAndInterConnectInApp(function() {
                                            window.location.replace("user.html#corpus/" + e.get("couchConnection").pouchname + "/" + e.id);
                                        });
                                    },
                                    error: function(e) {
                                        alert("New Corpus save error" + e);
                                    }
                                });
                            }, function(e) {
                                alert("Failed to create a session. " + e);
                            });
                        }, function() {
                            alert("Failed to create a datalist. " + a);
                        }) : (window.app.get("authentication").saveAndInterConnectInApp(), typeof e == "function" && e());
                    
},
                    error: function(e) {
                        typeof n == "function" ? n() : alert("Corpus save error" + e);
                    }
                });
            });
        },
        makeSureCorpusHasADataList: function(t, n) {
            if (this.get("dataLists").models.length > 0 && typeof t == "function") {
                t();
                return;
            }
            var r = this, i = new l({
                pouchname: this.get("pouchname")
            });
            i.set({
                title: "Datalist instructions",
                dateCreated: (new Date).toDateString(),
                description: "This list explains what datalists are and how to make them. Data lists can be used to create handouts, prepare for sessions with consultants, export to LaTeX, or share with collaborators.",
                pouchname: this.get("pouchname")
            }), i.set("dateCreated", JSON.stringify(new Date)), i.set("dateModified", JSON.stringify(new Date
)), i.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + this.get("pouchname") : Utils.pouchUrl + this.get("pouchname")), i.save(null, {
                success: function(e, n) {
                    window.app.get("authentication").get("userPrivate").get("dataLists").unshift(e.id), r.get("dataLists").unshift(e), typeof t == "function" ? t() : Utils.debug("DataList save success" + e.id);
                },
                error: function(e) {
                    typeof n == "function" ? n() : Utils.debug("DataList save error" + e);
                }
            });
        },
        makeSureCorpusHasASession: function(t, n) {
            if (this.get("sessions").models.length > 0 && typeof t == "function") {
                t();
                return;
            }
            var r = this, i = new m({
                pouchname: this.get("pouchname"),
                sessionFields: this.get("sessionFields").clone()
            });
            i.get("sessionFields").where({
                
label: "user"
            })[0].set("mask", app.get("authentication").get("userPrivate").get("username")), i.get("sessionFields").where({
                label: "consultants"
            })[0].set("mask", "XY"), i.get("sessionFields").where({
                label: "goal"
            })[0].set("mask", "Change this session goal to the describe your first elicitiation session."), i.get("sessionFields").where({
                label: "dateSEntered"
            })[0].set("mask", new Date), i.get("sessionFields").where({
                label: "dateElicited"
            })[0].set("mask", "Change this to a time period for example: A few months ago, probably on a Monday night."), i.set("pouchname", this.get("pouchname")), i.set("dateCreated", JSON.stringify(new Date)), i.set("dateModified", JSON.stringify(new Date)), i.pouch = e.sync.pouch(Utils.androidApp() ? Utils.touchUrl + this.get("pouchname") : Utils.pouchUrl + this.get("pouchname")), i.save(null, {
                success: function(e, n
) {
                    window.app.get("authentication").get("userPrivate").get("sessionHistory").unshift(e.id), r.get("sessions").unshift(e), typeof t == "function" ? t() : Utils.debug("Session save success" + e.id);
                },
                error: function(e) {
                    typeof n == "function" ? n() : Utils.debug("Session save error" + e);
                }
            });
        },
        setAsCurrentCorpus: function(e, t) {
            window.app.get("corpus").id != this.id && window.app.set("corpus", this), window.app.get("authentication").get("userPrivate").get("mostRecentIds").corpusid = this.id, window.app.get("authentication").saveAndInterConnectInApp();
            if (!window.appView) {
                e();
                return;
            }
            try {
                window.appView.setUpAndAssociateViewsAndModelsWithCurrentCorpus(function() {
                    window.appView.activityFeedCorpusTeamView.render(), typeof e == "function" ? e() : 
window.appView.toastUser("Sucessfully connected all views up to corpus: " + this.id, "alert-success", "Connected!");
                });
            } catch (n) {
                typeof t == "function" ? t() : alert("This is probably a bug. There was a problem rendering the current corpus's views after resetting the current session.");
            }
        },
        replicateCorpus: function(e, t, n) {
            var r = this;
            this.replicateToCorpus(e, function() {
                r.replicateFromCorpus(e, t, n);
            }, function() {
                alert("Replicate to corpus failure"), typeof fromcallback == "function" && fromcallback();
            });
        },
        replicateToCorpus: function(e, n, r) {
            var i = this;
            if (e == null || e == undefined) e = i.get("couchConnection");
            this.changePouch(e, function() {
                i.pouch(function(s, o) {
                    var u = e.protocol + e.domain;
                    e
.port != null && (u = u + ":" + e.port), u = u + "/" + e.pouchname, o.replicate.to(u, {
                        continuous: !1
                    }, function(e, s) {
                        Utils.debug("Replicate to " + u), Utils.debug(s), Utils.debug(e), e ? typeof r == "function" ? r() : (alert("Corpus replicate to error" + JSON.stringify(e)), Utils.debug("Corpus replicate to error" + JSON.stringify(e))) : (Utils.debug("Corpus replicate to success", s), window.appView.allSyncedDoc(), window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            verb: "uploaded",
                            verbmask: "uploaded",
                            verbicon: "icon-arrow-up",
                            directobject: "<a href='#corpus/" + i.id + "'>" + i.get("title") + "</a> (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud"
,
                            indirectobject: "to the team server",
                            indirectobjectmask: "to its team server",
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "team"
                        })), window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "uploaded",
                            verbmask: "uploaded",
                            verbicon: "icon-arrow-up",
                            directobject: "<a href='#corpus/" + i.id + "'>" + i.get("title") + "</a> (docs read: " + s.docs_read + ", docs written: " + s.docs_written + ")",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "to the team server",
                            indirectobjectmask: "to its team server",
                            context: " via Offline App."
,
                            contextmask: "",
                            teamOrPersonal: "personal"
                        })), window.appView.activityFeedCorpusTeamView.model.replicateToActivityFeed(null, function() {
                            typeof n == "function" ? n() : Utils.debug("ActivityFeed Team replicate to success");
                        }));
                    });
                });
            });
        },
        replicateFromCorpus: function(e, n, r) {
            var i = this;
            if (e == null || e == undefined) e = i.get("couchConnection");
            this.changePouch(e, function() {
                i.pouch(function(s, o) {
                    var u = e.protocol + e.domain;
                    e.port != null && (u = u + ":" + e.port), u = u + "/" + e.pouchname, o.replicate.from(u, {
                        continuous: !1
                    }, function(s, o) {
                        Utils.debug("Replicate from " + u), Utils.debug(o), Utils.debug(
s), s ? typeof r == "function" ? r() : (alert("Corpus replicate from error" + JSON.stringify(s)), Utils.debug("Corpus replicate from error" + JSON.stringify(s))) : (Utils.debug("Corpus replicate from success", o), localStorage.setItem("mostRecentCouchConnection", JSON.stringify(e)), typeof n == "function" && n(), window.app.get("currentCorpusTeamActivityFeed") && window.app.get("currentCorpusTeamActivityFeed").addActivity(new t({
                            verb: "downloaded",
                            verbmask: "downloaded",
                            verbicon: "icon-arrow-down",
                            directobject: "<a href='#corpus/" + i.id + "'>" + i.get("title") + "</a>  (docs read: " + o.docs_read + ", docs written: " + o.docs_written + ")",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "from the team server",
                            indirectobjectmask: "from its team server"
,
                            context: " via Offline App.",
                            contextmask: "",
                            teamOrPersonal: "team"
                        })), window.app.get("currentUserActivityFeed") && window.app.get("currentUserActivityFeed").addActivity(new t({
                            verb: "downloaded",
                            verbmask: "downloaded",
                            verbicon: "icon-arrow-down",
                            directobject: "<a href='#corpus/" + i.id + "'>" + i.get("title") + "</a> (docs read: " + o.docs_read + ", docs written: " + o.docs_written + ")",
                            directobjectmask: "a corpus",
                            directobjecticon: "icon-cloud",
                            indirectobject: "from the team server",
                            indirectobjectmask: "from its team server",
                            context: " via Offline App.",
                            contextmask: "",
                            
teamOrPersonal: "personal"
                        })), i.buildMorphologicalAnalyzerFromTeamServer(i.get("pouchname")), i.buildLexiconFromTeamServer(i.get("pouchname")));
                    });
                });
            });
        },
        logUserIntoTheirCorpusServer: function(e, t, n, r, i) {
            if (e == null || e == undefined) e = this.get("couchConnection");
            var s = e.protocol + e.domain;
            e.port != null && (s = s + ":" + e.port), s += "/_session";
            var o = {};
            o.name = t, o.password = n, $.ajax({
                type: "POST",
                url: s,
                data: o,
                success: function(e) {
                    window.appView && window.appView.toastUser("I logged you into your team server automatically, your syncs will be successful.", "alert-info", "Online Mode:"), typeof r == "function" && r(e);
                },
                error: function(e) {
                    window.setTimeout(function(
) {
                        $.ajax({
                            type: "POST",
                            url: s,
                            data: o,
                            success: function(e) {
                                window.appView && window.appView.toastUser("I logged you into your team server automatically, your syncs will be successful.", "alert-info", "Online Mode:"), typeof r == "function" && r(e);
                            },
                            error: function(e) {
                                window.appView && window.appView.toastUser("I couldn't log you into your corpus. What does this mean? This means you can't upload data to train an auto-glosser or visualize your morphemes. You also can't share your data with team members. If your computer is online and you are using the Chrome Store app, then this probably the side effect of a bug that we might not know about... please report it to us :) " + Utils.contactUs + " If you're offline you can ignore this warning, and sync later when you're online. "
, "alert-danger", "Offline Mode:"), typeof i == "function" && i("I couldn't log you into your corpus."), Utils.debug(e), window.app.get("authentication").set("staleAuthentication", !0);
                            }
                        });
                    }, 5e3);
                }
            });
        },
        validate: function(e) {
            if (e.publicCorpus && e.publicCorpus != "Public" && e.publicCorpus != "Private") return "Corpus must be either Public or Private";
        },
        set: function(t, n, r) {
            var i;
            return _.isObject(t) || t == null ? (i = t, r = n) : (i = {}, i[t] = n), r = r || {}, i.title && (i.titleAsUrl = i.title.toLowerCase().replace(/[!@#$^&%*()+=-\[\]\/{}|:<>?,."'`; ]/g, "_")), e.Model.prototype.set.call(this, i, r);
        },
        buildMorphologicalAnalyzerFromTeamServer: function(e, t) {
            e || this.get("pouchname"), t || (t = null), Glosser.downloadPrecedenceRules(e, t);
        },
        buildLexiconFromTeamServer
: function(e, t) {
            e || this.get("pouchname"), t || (t = null), this.lexicon.buildLexiconFromCouch(e, t);
        },
        changeCorpusPublicPrivate: function() {}
    });
    return S;
}), fielddb.define("search/Search", [ "backbone", "libs/Utils" ], function(e) {
    var t = e.Model.extend({
        initialize: function() {
            this.on("all", function(e) {
                Utils.debug(this.get("searchKeywords") + " event: " + JSON.stringify(e));
            });
        },
        defaults: {
            searchKeywords: ""
        },
        model: {},
        saveKeyword: function() {
            this.set("searchKeywords", "hihi");
        },
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return t;
}), fielddb.define("comment/CommentReadView", [ "backbone", "handlebars", "comment/Comment" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("COMMENT init"
);
        },
        model: n,
        events: {
            "blur .comment-text": "updateComment"
        },
        template: t.templates.comment_read_embedded,
        render: function() {
            return Utils.debug("COMMENT render"), $(this.el).html(this.template(this.model.toJSON())), this;
        },
        updateComment: function() {
            this.model.set("value", this.$el.children(".comment-text").val());
        }
    });
    return r;
}), fielddb.define("datum/DatumFieldEditView", [ "backbone", "handlebars", "datum/DatumField" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("DATUM FIELD EDIT VIEW init");
        },
        model: n,
        events: {
            "blur .choose-field": "updateFieldLabel",
            "click .shouldBeEncrypted": "updateEncrypted",
            "blur .help-text": "updateHelp",
            "blur .datum_field_input": "updateFieldValue",
            "click .icon-question-sign": "showHelpConvention"
,
            "hover .icon-question-sign": "hideHelpConvention"
        },
        templateSettings: t.templates.datum_field_settings_edit_embedded,
        templateValue: t.templates.datum_field_value_edit_embedded,
        render: function() {
            Utils.debug("DATUM FIELD EDIT VIEW render");
            if (this.format == "corpus") $(this.el).html(this.templateSettings(this.model.toJSON())), $(this.el).find(".locale_Encrypt_if_confidential").html(Locale["locale_Encrypt_if_confidential"].message), $(this.el).find(".locale_Help_Text").html(Locale["locale_Help_Text"].message), $(this.el).find(".locale_Help_Text_Placeholder").attr("placeholder", Locale["locale_Help_Text_Placeholder"].message), this.$el.children(".choose-field").val(this.model.get("label")); else if (this.format == "datum") {
                var e = this.model.toJSON();
                e.helpText = !0, $(this.el).html(this.templateValue(e));
                var t = this;
                window
.setTimeout(function() {
                    $(t.el).find(".datum_field_input").autosize();
                }, 500);
            } else if (this.format == "session") {
                var e = this.model.toJSON();
                e.helpText = !1, $(this.el).html(this.templateValue(e));
            }
            return this;
        },
        updateFieldLabel: function() {
            Utils.debug("Updated label to " + this.$el.children(".choose-field").val()), this.model.set("label", this.$el.children(".choose-field").val());
        },
        updateEncrypted: function() {
            var e = this.$el.children(".shouldBeEncrypted").is(":checked");
            e ? e = "checked" : e = "", Utils.debug("Updated shouldBeEncrypted to " + e), this.model.set("shouldBeEncrypted", e);
        },
        updateHelp: function() {
            var e = this.$el.children(".help-text").val();
            Utils.debug("Updated help to " + e), this.model.set("help", e);
        },
        updateFieldValue: 
function() {
            this.model.set("mask", this.$el.children(".datum_field_input").val());
        },
        showHelpConvention: function() {
            this.$el.children(".help-conventions").popover("show");
        },
        hideHelpConvention: function() {
            this.$el.children(".help-conventions").popover("hide");
        }
    });
    return r;
}), fielddb.define("app/UpdatingCollectionView", [ "backbone" ], function(e) {
    var t = e.View.extend({
        initialize: function(e) {
            _(this).bindAll("add", "remove");
            if (!e.childViewConstructor) throw "no child view constructor provided";
            if (!e.childViewTagName) throw "no child view tag name provided";
            this._childViewConstructor = e.childViewConstructor, this._childViewTagName = e.childViewTagName, this._childViewFormat = e.childViewFormat || null, this._childViewClass = e.childViewClass || "", this._childViews = [], this.collection.each(this.add), this.collection.bind
("add", this.add), this.collection.bind("remove", this.remove);
        },
        tagName: "ul",
        add: function(e, t, n) {
            var r = new this._childViewConstructor({
                tagName: this._childViewTagName,
                className: this._childViewClass,
                model: e
            });
            this._childViewFormat && (r.format = this._childViewFormat);
            if (n == undefined || n == null) n = {}, n.index = 1;
            n.index == 0 ? (this._childViews.unshift(r), this._rendered && $(this.el).prepend(r.render().el)) : (this._childViews.push(r), this._rendered && $(this.el).append(r.render().el));
        },
        remove: function(e) {
            var t = _(this._childViews).select(function(t) {
                return t.model === e;
            })[0];
            this._childViews = _(this._childViews).without(t), this._rendered && $(t.el).remove();
        },
        render: function() {
            var e = this;
            return this
._rendered = !0, $(this.el).empty(), _(this._childViews).each(function(t) {
                $(e.el).append(t.render().el), t.delegateEvents();
            }), this;
        }
    });
    return t;
}), fielddb.define("datum/SessionEditView", [ "backbone", "handlebars", "activity/Activity", "comment/Comment", "comment/Comments", "comment/CommentReadView", "datum/DatumFieldEditView", "datum/Session", "app/UpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a) {
    var f = e.View.extend({
        initialize: function() {
            Utils.debug("SESSION EDIT VIEW init: "), this.changeViewsOfInternalModels();
            var e = this;
            this.model.bind("change:sessionFields", function() {
                e.changeViewsOfInternalModels(), e.render();
            }, this);
        },
        model: u,
        events: {
            "click .btn-save-session": "updatePouch",
            "click .add-comment-session": function(e) {
                e && (e.stopPropagation
(), e.preventDefault());
                var t = this.$el.find(".comment-new-text").val();
                this.model.insertNewComment(t), this.$el.find(".comment-new-text").val("");
            },
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeLarge",
            "click .icon-book": "showReadonly",
            "blur .session-consultant-input": "updateConsultant",
            "blur .session-elicitation-date-input": "updateElicitedDate",
            "blur .session-goal-input": "updateGoal"
        },
        updateConsultant: function() {
            this.model.get("sessionFields").where({
                label: "consultants"
            })[0].set("mask", this.$el.find(".session-consultant-input").val()), this.format != "import" && window.appView.addUnsavedDoc(this.model.id);
        },
        updateElicitedDate: function() {
            this.model.get("sessionFields").where({
                label: "dateElicited"
            })[0].set
("mask", this.$el.find(".session-elicitation-date-input").val()), this.format != "import" && window.appView.addUnsavedDoc(this.model.id);
        },
        updateGoal: function() {
            this.model.get("sessionFields").where({
                label: "goal"
            })[0].set("mask", this.$el.find(".session-goal-input").val()), this.format != "import" && window.appView.addUnsavedDoc(this.model.id);
        },
        templateSummary: t.templates.session_summary_edit_embedded,
        templateEmbedded: t.templates.session_edit_embedded,
        templateFullscreen: t.templates.session_edit_embedded,
        templateModal: t.templates.session_edit_modal,
        templateImport: t.templates.session_edit_import,
        render: function() {
            Utils.debug("SESSION EDIT render: ");
            if (this.model == undefined) return Utils.debug("SESSION is undefined, come back later."), this;
            try {
                if (this.model.get("sessionFields").where({
                    
label: "goal"
                })[0] == undefined) return Utils.debug("SESSION fields are undefined, come back later."), this;
                this.format != "modal" && (appView.currentSessionEditView.destroy_view(), appView.currentSessionReadView.destroy_view());
                if (this.format == "leftSide") {
                    Utils.debug("SESSION EDIT  LEFTSIDE render: ");
                    var e = {
                        goal: this.model.get("sessionFields").where({
                            label: "goal"
                        })[0].get("mask"),
                        consultants: this.model.get("sessionFields").where({
                            label: "consultants"
                        })[0].get("mask"),
                        dateElicited: this.model.get("sessionFields").where({
                            label: "dateElicited"
                        })[0].get("mask")
                    };
                    this.setElement("#session-quickview"), $(this.el).html
(this.templateSummary(e)), $(this.el).find(".locale_Show_Readonly").attr("title", Locale["locale_Show_Readonly"].message), $(this.el).find(".locale_Show_fullscreen").attr("title", Locale["locale_Show_fullscreen"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Goal").html(Locale["locale_Goal"].message), $(this.el).find(".locale_Consultants").html(Locale["locale_Consultants"].message), $(this.el).find(".locale_When").html(Locale["locale_When"].message);
                }
                if (this.format == "import") {
                    Utils.debug("SESSION EDIT  IMPORT render: ");
                    var e = {
                        goal: this.model.get("sessionFields").where({
                            label: "goal"
                        })[0].get("mask"),
                        consultants: this.model.get("sessionFields").where({
                            
label: "consultants"
                        })[0].get("mask"),
                        dateElicited: this.model.get("sessionFields").where({
                            label: "dateElicited"
                        })[0].get("mask")
                    };
                    this.setElement("#import-session"), $(this.el).html(this.templateImport(e)), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Goal").html(Locale["locale_Goal"].message), $(this.el).find(".locale_Consultants").html(Locale["locale_Consultants"].message), $(this.el).find(".locale_When").html(Locale["locale_When"].message);
                } else this.format == "centerWell" ? (Utils.debug("SESSION EDIT CENTERWELL render: "), this.setElement("#session-embedded"), $(this.el).html(this.templateEmbedded(this.model.toJSON())), this.sessionFieldsView.el = this.$(".session-fields-ul"), this.sessionFieldsView.render(), this
.commentReadView.el = this.$(".comments"), this.commentReadView.render(), $(this.el).find(".locale_Show_Readonly").attr("title", Locale["locale_Show_Readonly"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message)) : this.format == "fullscreen" ? (Utils.debug("SESSION EDIT FULLSCREEN render: "), this.setElement("#session-fullscreen"), this.$el.html(this.templateFullscreen(this.model.toJSON())), this.sessionFieldsView.el = this.$(".session-fields-ul"), this.sessionFieldsView.render(), this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), $(this.el).find(".locale_Show_Readonly").attr("title", chrome.i18n.getMessage("locale_Show_Readonly"
)), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message)) : this.format == "modal" && (Utils.debug("SESSION EDIT MODAL render: "), this.setElement("#new-session-modal"), this.changeViewsOfInternalModels(), this.$el.html(this.templateModal(this.model.toJSON())), this.sessionFieldsView.el = this.$(".session-fields-ul"), this.sessionFieldsView.render(), this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), $(this.el).find(".locale_New_Session").html(Locale["locale_New_Session"].message), $(this.el).find(".locale_New_Session_Instructions").html(Locale["locale_New_Session_Instructions"].message), $(this.el).find(".locale_Cancel").html(chrome
.i18n.getMessage("locale_Cancel")), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message));
            } catch (t) {
                Utils.debug("There was a problem rendering the session, probably the datumfields are still arrays and havent been restructured yet.");
            }
            return this;
        },
        changeViewsOfInternalModels: function() {
            this.sessionFieldsView = new a({
                collection: this.model.get("sessionFields"),
                childViewConstructor: o,
                childViewTagName: "li",
                childViewFormat: "session"
            }), this.commentReadView = new a({
                collection: this.model.get("comments"),
                childViewConstructor: s,
                childViewTagName: "li"
            });
        },
        updatePouch: function(e) {
            e && (e.stopPropagation(), e.preventDefault());
            var t = this;
            this.model.saveAndInterConnectInApp(function(
) {
                Utils.debug("Session format is " + t.format), t.format == "modal" ? t.model.setAsCurrentSession(function() {
                    $("#new-session-modal").modal("hide"), window.appView.currentSessionReadView.render();
                }) : (window.appView.currentSessionReadView.format = t.format, window.appView.currentSessionReadView.render());
            });
        },
        resizeSmall: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.app.router.showDashboard();
        },
        resizeLarge: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), this.format = "fullscreen", this.render(), window.app.router.showFullscreenSession();
        },
        showEditable: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), this.changeViewsOfInternalModels(), this.render();
        },
        showReadonly: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.appView.currentSessionReadView
.format = this.format, window.appView.currentSessionReadView.render();
        },
        destroy_view: function() {
            Utils.debug("DESTROYING SESSION EDIT VIEW " + this.format), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return f;
}), fielddb.define("app/AppRouter", [ "backbone", "datum/Datum", "data_list/DataList", "datum/Session", "datum/SessionEditView", "user/UserMask", "libs/Utils" ], function(e, t, n, r, i, s) {
    var o = e.Router.extend({
        initialize: function() {},
        routes: {
            "corpus/:pouchname": "showFullscreenCorpus",
            "corpus/:pouchname/datum/:id": "showEmbeddedDatum",
            "corpus/:pouchname/search": "showEmbeddedSearch",
            corpus: "showFullscreenCorpus",
            "data/:dataListid": "showFullscreenDataList",
            "session/:sessionid": "showFullscreenSession",
            "user/:userid": "showFullscreenUser",
            "import": "showImport",
            "corpus/:pouchname/export"
: "showExport",
            "diff/oldrev/:oldrevision/newrev/:newrevision": "showDiffs",
            "": "showDashboard"
        },
        showDashboard: function() {
            Utils.debug("In showDashboard: "), window.appView.renderReadonlyDashboardViews(), this.hideEverything(), $("#dashboard-view").show(), $("#datums-embedded").show(), window.location.href = "#";
        },
        showDiffs: function(e, t) {
            var n = window.app.get("corpus").get("couchConnection"), r = n.protocol + n.domain;
            n.port != null && (r = r + ":" + n.port), r = r + "/_utils/database.html?" + n.pouchname, window.appView.toastUser("We haven't implemented the 'diff' tool yet (ie, showing the changes, letting you undo changes etc). We will do it eventually, when it becomes a priority. <a target='blank'  href='https://github.com/OpenSourceFieldlinguistics/FieldDB/issues/124'>You can vote for it in our issue tracker</a>.  We use the <a target='blank' href='" + r + "'>" + "Futon User Interface</a> directly to track revisions in the data, you can too (if your a power user type)."
, "alert", "Track Changes:");
        },
        showFullscreenUser: function(e, t) {
            Utils.debug("In showFullscreenUser: " + e);
            if (e) {
                t || (t = app.get("corpus").get("pouchname"));
                if (e != window.appView.publicReadUserView.model.id) {
                    var n = new s({
                        pouchname: t
                    });
                    n.id = e, n.changePouch(t, function() {
                        n.fetch({
                            success: function(e) {
                                Utils.debug("Corpus member fetched successfully" + e), window.appView.setUpAndAssociatePublicViewsAndModelsWithCurrentUserMask(e), window.appView.publicReadUserView.render();
                            },
                            error: function(e) {
                                alert("User not found in this corpus.");
                            }
                        });
                    });
                }
            
}
            $("#public-user-page").html() == "" && window.appView.publicReadUserView.render(), this.hideEverything(), $("#public-user-page").show(), window.scrollTo(0, 0);
        },
        showFullscreenCorpus: function() {
            Utils.debug("In showFullscreenCorpus: "), $("#corpus-fullscreen").html() == "" && window.appView.renderReadonlyCorpusViews("fullscreen"), this.hideEverything(), $("#corpus-fullscreen").show(), window.scrollTo(0, 0);
        },
        showEmbeddedCorpus: function() {
            Utils.debug("In showEmbeddedCorpus: "), this.hideEverything(), $("#dashboard-view").show(), $("#corpus-embedded").show();
        },
        showEmbeddedSession: function(e, t) {
            Utils.debug("In showEmbeddedSession: " + t + " *** " + e);
            if (e) {
                t || (t = window.app.get("corpus").get("pouchname"));
                if (e != window.app.get("currentSession").id) {
                    var n = new r({
                        pouchname: t
                    
});
                    n.id = e, window.app.get("corpus").get("pouchname") != t && alert("You are opening a session which is not in this corpus. Do you want to switch to the other corpus?"), n.changePouch(t, function() {
                        n.fetch({
                            success: function(e) {
                                Utils.debug("Session fetched successfully" + e), n.setAsCurrentSession(function() {
                                    window.appView.setUpAndAssociateViewsAndModelsWithCurrentSession(function() {
                                        window.appView.renderReadonlySessionViews("centerWell");
                                    });
                                });
                            },
                            error: function(e) {
                                alert("There was an error fetching the sessions. Loading defaults..." + e);
                            }
                        });
                    });
                }
            
}
            this.hideEverything(), $("#dashboard-view").show(), $("#session-embedded").show();
        },
        showFullscreenSession: function(e, t) {
            Utils.debug("In showFullscreenSession" + t + " *** " + e);
            if (e) {
                t || (t = window.app.get("corpus").get("pouchname"));
                if (e != window.app.get("currentSession").id) {
                    var n = new r({
                        pouchname: t
                    });
                    n.id = e, window.app.get("corpus").get("pouchname") != t && alert("You are opening a session which is not in this corpus. Do you want to switch to the other corpus?"), n.changePouch(t, function() {
                        n.fetch({
                            success: function(e) {
                                Utils.debug("Session fetched successfully" + e), n.setAsCurrentSession(function() {
                                    window.appView.setUpAndAssociateViewsAndModelsWithCurrentSession(function(
) {
                                        window.appView.renderReadonlySessionViews("fullscreen");
                                    });
                                });
                            },
                            error: function(e) {
                                alert("There was an error fetching the sessions. Loading defaults..." + e);
                            }
                        });
                    });
                }
            }
            $("#session-fullscreen").html() == "" && window.appView.renderReadonlySessionViews("fullscreen"), this.hideEverything(), $("#session-fullscreen").show(), window.scrollTo(0, 0);
        },
        showFullscreenDataList: function(e, t) {
            Utils.debug("In showFullscreenDataList: " + t + " *** " + e);
            if (e && e != app.get("currentDataList").id) {
                t || (t = window.app.get("corpus").get("pouchname"));
                var r = new n({
                    pouchname: t
                
});
                r.id = e;
                if (window.app.get("corpus").get("pouchname") != t) {
                    alert("You are opening a data list which is not in this corpus. Do you want to switch to the other corpus?");
                    return;
                }
                app.get("corpus").get("dataLists").length > 0 && (e == app.get("corpus").get("dataLists").models[app.get("corpus").get("dataLists").length - 1].id ? app.get("corpus").get("dataLists").models[app.get("corpus").get("dataLists").length - 1].changePouch(null, function() {
                    app.get("corpus").get("dataLists").models[app.get("corpus").get("dataLists").length - 1].save(null, {
                        success: function(e, n) {
                            r.changePouch(t, function() {
                                r.fetch({
                                    success: function(e) {
                                        Utils.debug("Datalist fetched successfully" + e), app.get("currentDataList"
).saveAndInterConnectInApp(function() {
                                            r.setAsCurrentDataList(function() {
                                                window.appView.setUpAndAssociateViewsAndModelsWithCurrentDataList(function() {
                                                    window.appView.renderReadonlyDataListViews("fullscreen");
                                                });
                                            });
                                        });
                                    },
                                    error: function(e) {
                                        alert("There was an error fetching the data list. Loading defaults..." + e);
                                    }
                                });
                            });
                        },
                        error: function() {}
                    });
                }) : r.changePouch(t, function() {
                    r.fetch({
                        
success: function(e) {
                            Utils.debug("Datalist fetched successfully" + e), app.get("currentDataList").saveAndInterConnectInApp(function() {
                                r.setAsCurrentDataList(function() {
                                    window.appView.setUpAndAssociateViewsAndModelsWithCurrentDataList(function() {
                                        window.appView.renderReadonlyDataListViews("fullscreen");
                                    });
                                });
                            });
                        },
                        error: function(e) {
                            alert("There was an error fetching the data list. Loading defaults..." + e);
                        }
                    });
                }));
            }
            $("#data-list-fullscreen-header").html() == "" && window.appView.renderReadonlyDataListViews("fullscreen"), this.hideEverything(), $("#data-list-fullscreen").show(), window
.scrollTo(0, 0);
        },
        showMiddleDataList: function(e, t) {
            Utils.debug("In showMiddleDataList");
            if (e) {
                t || (t = window.app.get("corpus").get("pouchname"));
                var r = new n({
                    pouchname: t
                });
                r.id = e, window.app.get("corpus").get("pouchname") != t && alert("You are opening a data list which is not in this corpus. Do you want to switch to the other corpus?"), r.changePouch(t, function() {
                    r.fetch({
                        success: function(e) {
                            Utils.debug("Datalist fetched successfully" + e), r.setAsCurrentDataList(function() {
                                window.appView.setUpAndAssociateViewsAndModelsWithCurrentDataList(function() {
                                    window.appView.renderReadonlyDashboardViews();
                                });
                            });
                        },
                        
error: function(e) {
                            alert("There was an error fetching the data list. Loading defaults..." + e);
                        }
                    });
                });
            }
            this.hideEverything(), $("#dashboard-view").show(), $("#data-list-embedded").show();
        },
        showFullscreenSearch: function(e, t) {
            this.hideEverything(), window.appView.searchEditView.format = "fullscreen", window.appView.searchEditView.render(), $("#search-fullscreen").show();
        },
        showEmbeddedSearch: function(e, t) {
            this.hideEverything(), $("#dashboard-view").show(), window.appView.searchEditView.format = "centreWell", window.appView.searchEditView.render(), $("#search-embedded").show();
        },
        showEmbeddedDatum: function(e, n) {
            Utils.debug("In showEmbeddedDatum" + e + " *** " + n);
            if (n) {
                e || (e = window.app.get("corpus").get("pouchname"));
                var r = new 
t({
                    pouchname: app.get("corpus").get("pouchname")
                });
                r.id = n, r.changePouch(window.app.get("corpus").get("pouchname"), function() {
                    r.fetch({
                        success: function(e, t) {
                            window.appView.datumsEditView.prependDatum(e), window.app.router.showDashboard();
                        }
                    });
                });
            } else window.app.router.showDashboard();
        },
        showImport: function() {
            Utils.debug("In import: "), $("#import-fullscreen").html() == "" && window.appView.importView.render(), this.hideEverything(), $("#import-fullscreen").show();
        },
        showExport: function(e) {
            Utils.debug("In showExport: " + e), $("#export-modal").html() == "" && window.appView.exportView.render(), $("#export-modal").modal("show");
        },
        showEditableDatums: function(e) {
            window.appView.renderEditableDatumsViews
(e), e == "centreWell" ? (this.hideEverything(), $("#dashboard-view").show(), $("#datums-embedded").show(), window.location.href = "#") : e == "fullscreen" && (this.hideEverything(), $("#datum-container-fullscreen").show());
        },
        showReadonlyDatums: function(e) {
            window.appView.renderReadonlyDatumsViews(e), e == "centreWell" ? (this.hideEverything(), $("#dashboard-view").show(), $("#datums-embedded").show(), window.location.href = "#") : e == "fullscreen" && (this.hideEverything(), $("#datum-container-fullscreen").show());
        },
        hideEverything: function() {
            $("#dashboard-view").hide(), $("#datums-embedded").hide(), $("#data-list-fullscreen").hide(), $("#datum-container-fullscreen").hide(), $("#corpus-embedded").hide(), $("#corpus-fullscreen").hide(), $("#search-fullscreen").hide(), $("#search-embedded").hide(), $("#session-embedded").hide(), $("#session-fullscreen").hide(), $("#public-user-page").hide(), $("#user-fullscreen").hide(), $("#import-fullscreen"
).hide(), $("#data-list-embedded").hide();
        }
    });
    return o;
}), fielddb.define("app/App", [ "backbone", "activity/Activity", "activity/ActivityFeed", "authentication/Authentication", "corpus/Corpus", "data_list/DataList", "datum/DatumFields", "search/Search", "datum/Session", "app/AppRouter", "confidentiality_encryption/Confidential", "user/User", "user/UserMask", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l, c, h) {
    var p = e.Model.extend({
        initialize: function() {
            this.bind("error", function(e, t) {
                Utils.debug("Error in App: " + t);
            }), this.get("authentication") || this.set("authentication", new r), window.onbeforeunload = this.warnUserAboutSavedSyncedStateBeforeUserLeaves;
        },
        model: {
            corpus: i,
            authentication: r,
            currentSession: a,
            currentDataList: s,
            currentCorpusTeamActivityFeed: n,
            currentUserActivityFeed: n,
            
search: u
        },
        createAppBackboneObjects: function(e, t) {
            e == null && e == "";
            if (this.get("authentication").get("userPublic") == undefined) {
                var n = new h({
                    pouchname: e
                });
                this.get("authentication").set("userPublic", n);
            }
            if (this.get("authentication").get("userPrivate") == undefined) {
                var r = new c;
                this.get("authentication").set("userPrivate", r);
            }
            var o = new i({
                pouchname: e
            });
            this.set("corpus", o);
            var f = new a({
                pouchname: e,
                sessionFields: o.get("sessionFields").clone()
            });
            this.set("currentSession", f);
            var l = new s({
                pouchname: e
            });
            this.set("currentDataList", l);
            var p = new u({
                pouchname: e
            
});
            this.set("search", p), typeof t == "function" && t();
        },
        loadBackboneObjectsById: function(e, t, n) {
            if (e == null || e == undefined) e = this.get("corpus").get("couchConnection");
            var r = this, i = this.get("corpus");
            i.set({
                pouchname: e.pouchname,
                couchConnection: e
            }), i.id = t.corpusid, i.changePouch(e, function() {
                i.fetch({
                    success: function(i) {
                        Utils.debug("Corpus fetched successfully", i), window.appView.addBackboneDoc(i.id), window.appView.addPouchDoc(i.id);
                        var s = r.get("currentSession");
                        s.set({
                            pouchname: e.pouchname
                        }), s.id = t.sessionid, s.changePouch(e.pouchname, function() {
                            s.fetch({
                                success: function(i) {
                                    
Utils.debug("Session fetched successfully", i), window.appView.addBackboneDoc(i.id), window.appView.addPouchDoc(i.id);
                                    var s = r.get("currentDataList");
                                    s.set({
                                        pouchname: e.pouchname
                                    }), s.id = t.datalistid, s.changePouch(e.pouchname, function() {
                                        s.fetch({
                                            success: function(e) {
                                                Utils.debug("Data list fetched successfully", e), window.appView.addBackboneDoc(e.id), window.appView.addPouchDoc(e.id), window.appView.renderReadonlyDashboardViews(), typeof n == "function" && n();
                                            },
                                            error: function(e) {
                                                alert("There was an error fetching the data list. Loading defaults..." + e);
                                            
}
                                        });
                                    });
                                },
                                error: function(e) {
                                    alert("There was an error fetching the session. Loading defaults..." + e), s.set("sessionFields", r.get("corpus").get("sessionFields").clone());
                                }
                            });
                        });
                    },
                    error: function(e, t, n) {
                        console.log(e), console.log(t), console.log(n), alert("There was an error fetching corpus. Loading defaults..." + e), document.location.href = "user.html";
                    }
                });
            });
        },
        loadBackboneObjectsByIdAndSetAsCurrentDashboard: function(e, t, n) {
            Utils.debug("loadBackboneObjectsByIdAndSetAsCurrentDashboard");
            if (e == null || e == undefined) e = this.get("corpus").get("couchConnection"
);
            var r = new i({
                pouchname: e.pouchname,
                couchConnection: e
            });
            r.id = t.corpusid, r.changePouch(e, function() {
                r.fetch({
                    success: function(i) {
                        Utils.debug("Corpus fetched successfully in loadBackboneObjectsByIdAndSetAsCurrentDashboard", i), window.appView.addBackboneDoc(i.id), window.appView.addPouchDoc(i.id), r.setAsCurrentCorpus(function() {
                            var r = new s({
                                pouchname: e.pouchname
                            });
                            r.id = t.datalistid, r.changePouch(e.pouchname, function() {
                                r.fetch({
                                    success: function(i) {
                                        Utils.debug("Data list fetched successfully", i), window.appView.addBackboneDoc(i.id), window.appView.addPouchDoc(i.id), r.setAsCurrentDataList(function() {
                                            
var r = new a({
                                                pouchname: e.pouchname
                                            });
                                            r.id = t.sessionid, r.changePouch(e.pouchname, function() {
                                                r.fetch({
                                                    success: function(e) {
                                                        Utils.debug("Session fetched successfully", e), window.appView.addBackboneDoc(e.id), window.appView.addPouchDoc(e.id), r.setAsCurrentSession(function() {
                                                            Utils.debug("Entire dashboard fetched and loaded and linked up with views correctly."), window.appView.toastUser("Your dashboard has been loaded from where you left off last time.", "alert-success", "Dashboard loaded!"), window.app.router.showDashboard(), typeof n == "function" && n();
                                                        }, function() {
                                                            
alert("Failure to set as current session in loadBackboneObjectsByIdAndSetAsCurrentDashboard");
                                                        });
                                                    },
                                                    error: function(e) {
                                                        alert("There was an error fetching the session. Loading defaults..." + JSON.stringify(e)), r.set("sessionFields", window.app.get("corpus").get("sessionFields").clone());
                                                    }
                                                });
                                            });
                                        }, function() {
                                            alert("Failure to set as current data list in loadBackboneObjectsByIdAndSetAsCurrentDashboard");
                                        });
                                    },
                                    error: function(e) {
                                        
alert("There was an error fetching the data list. Loading defaults..." + JSON.stringify(e));
                                    }
                                });
                            });
                        }, function() {
                            alert("Failure to set as current corpus in loadBackboneObjectsByIdAndSetAsCurrentDashboard");
                        });
                    },
                    error: function(e, t, n) {
                        console.log(e), console.log(t), console.log(n), alert("There was an error fetching corpus. Loading defaults..." + JSON.stringify(t)), document.location.href = "user.html";
                    }
                });
            });
        },
        router: f,
        warnUserAboutSavedSyncedStateBeforeUserLeaves: function(e) {
            localStorage.setItem("saveStatus", "Saving in unload...");
            var t = "";
            window.appView.totalUnsaved.length >= 1 && (t = "You have unsaved changes, click cancel to save them. \n\n"
), window.appView.totalUnsaved.length >= 1 && (t += "You have unsynced changes, click cancel and then click the sync button to sync them. This is only important if you want to back up your data or if you are sharing your data with a team. \n\n");
            if (t == "") return;
            return "Either you haven't been using the app and Chrome wants some of its memory back, or you want to leave the app.\n\n" + t;
        },
        saveAndInterConnectInApp: function(e, t) {
            t || (t = function() {
                alert("There was a bug/problem in the saveAndInterConnectInApp in App.js, somewhere along the save call. The Session is saved first, if it succeeds, then the datalist, then the corpus. The failure is somewhere along there.");
            });
            var n = this;
            n.get("currentSession").saveAndInterConnectInApp(function() {
                n.get("currentDataList").saveAndInterConnectInApp(function() {
                    n.get("corpus").saveAndInterConnectInApp
(function() {
                        n.get("authentication").saveAndInterConnectInApp(function() {
                            n.get("authentication").staleAuthentication = !0, localStorage.setItem("mostRecentDashboard", JSON.stringify(window.app.get("authentication").get("userPrivate").get("mostRecentIds"))), window.appView && window.appView.toastUser("Your dashboard has been saved, you can exit the app at anytime and return to this state.", "alert-success", "Exit at anytime:"), n.get("currentCorpusTeamActivityFeed").saveAndInterConnectInApp(function() {
                                n.get("currentUserActivityFeed").saveAndInterConnectInApp(function() {
                                    Utils.debug("The activity feeds saved successfully."), typeof e == "function" && e();
                                }, t);
                            }, t);
                        }, t);
                    }, t);
                }, t);
            }, t);
        }
    });
    return p;
}), fielddb
.define("corpus/Corpuses", [ "backbone", "corpus/CorpusMask" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t,
        constructCollectionFromArray: function(e) {
            this.constructCollectionFromArrayOnServer(e);
        },
        constructCollectionFromArrayOnServer: function(e) {
            Utils.debug(e), this.reset();
            var n = this;
            for (c in e) {
                var r = e[c], i = r.protocol + r.domain;
                r.port != null && (i = i + ":" + r.port), i = i + "/" + r.pouchname + "/corpus";
                var s = new t({
                    title: "",
                    pouchname: r.pouchname
                });
                s.corpusid = r.corpusid, n.unshift(s);
            }
        },
        constructCollectionFromArrayLocally: function(e) {}
    });
    return n;
}), fielddb.define("corpus/CorpusLinkView", [ "backbone", "handlebars", "corpus/CorpusMask", "libs/Utils" ], function(
e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("CORPUS LINK init: "), this.model.bind("change:title", function() {
                this.render();
            }, this);
        },
        events: {},
        model: n,
        templateLink: t.templates.corpus_read_link,
        render: function() {
            Utils.debug("CORPUS LINK render: ");
            if (this.model == undefined) return Utils.debug("	CorpusMask model was undefined."), this;
            var e = this.model.toJSON();
            return e.corpusid = this.model.corpusid, $(this.el).html(this.templateLink(e)), this;
        }
    });
    return r;
}), fielddb.define("user/UserReadView", [ "backbone", "handlebars", "corpus/Corpus", "corpus/Corpuses", "corpus/CorpusLinkView", "user/User", "app/UpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o) {
    var u = e.View.extend({
        initialize: function() {
            Utils.debug("USER READ VIEW init: "), 
this.changeViewsOfInternalModels();
        },
        events: {
            "click .edit-user-profile": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.format == "modal" ? window.appView.modalEditUserView.render() : this.format == "public" && window.appView.publicEditUserView.render();
            },
            "click .view-public-profile": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), $("#user-modal").modal("hide"), window.app.router.showFullscreenUser(this.model.id);
            }
        },
        model: s,
        classname: "user",
        linkTemplate: t.templates.user_read_link,
        modalTemplate: t.templates.user_read_modal,
        fullscreenTemplate: t.templates.user_read_fullscreen,
        render: function() {
            if (this.model == undefined) return Utils.debug("User model was undefined"), this;
            if (this.format == "fullscreen") Utils.debug("USER READ FULLSCREEN render: "), this.setElement
($("#user-fullscreen")), $(this.el).html(this.fullscreenTemplate(this.model.toJSON())), $(this.el).find(".locale_User_Profile").html(Locale["locale_Private_Profile"].message), this.corpusesReadView.el = $(this.el).find(".corpuses"), this.corpusesReadView.render(); else if (this.format == "modal") Utils.debug("USER READ MODAL render: "), this.setElement($("#user-modal")), $(this.el).html(this.modalTemplate(this.model.toJSON())), $(this.el).find(".locale_Edit_User_Profile_Tooltip").attr("title", Locale["locale_Edit_User_Profile_Tooltip"].message), $(this.el).find(".locale_View_Public_Profile_Tooltip").html(Locale["locale_View_Public_Profile_Tooltip"].message), $(this.el).find(".locale_Private_Profile_Instructions").html(Locale["locale_Private_Profile_Instructions"].message), $(this.el).find(".locale_Close").html(Locale["locale_Close"].message), $(this.el).find(".locale_User_Profile").html(Locale["locale_Private_Profile"].message), this.corpusesReadView
.el = $(this.el).find(".corpuses"), this.corpusesReadView.render(); else if (this.format == "link") Utils.debug("USER READ LINK render: "), $(this.el).html(this.linkTemplate(this.model.toJSON())), $(this.el).find(".locale_View_Profile_Tooltip").attr("title", Locale["locale_View_Profile_Tooltip"].message); else {
                if (this.format != "public") throw "The UserReadView doesn't know what format to display, you need to tell it a format";
                Utils.debug("USER READ PUBLIC render: "), this.setElement($("#public-user-page")), $(this.el).html(this.fullscreenTemplate(this.model.toJSON())), $(this.el).find(".locale_Edit_Public_User_Profile").attr("title", Locale["locale_Edit_Public_User_Profile"].message), $(this.el).find(".locale_User_Profile").html(Locale["locale_Public_Profile"].message), this.corpusesReadView.el = $(this.el).find(".corpuses"), this.corpusesReadView.render();
            }
            return this.format != "link" && ($(this.el).
find(".locale_Gravatar").html(Locale["locale_Gravatar"].message), $(this.el).find(".locale_Email").html(Locale["locale_Email"].message), $(this.el).find(".locale_Research_Interests").html(Locale["locale_Research_Interests"].message), $(this.el).find(".locale_Affiliation").html(Locale["locale_Affiliation"].message), $(this.el).find(".locale_Description").html(Locale["locale_Description"].message), $(this.el).find(".locale_Corpora").html(Locale["locale_Corpora"].message)), this;
        },
        changeViewsOfInternalModels: function() {
            this.corpusesReadView = new o({
                collection: new r,
                childViewConstructor: i,
                childViewTagName: "li"
            }), this.corpusesReadView.collection.constructCollectionFromArray(this.model.get("corpuses"));
        }
    });
    return u;
}), fielddb.define("activity/ActivityView", [ "backbone", "handlebars", "activity/Activity", "user/UserReadView" 
], function(e, t, n, r) {
    var i = e.View.extend({
        initialize: function() {
            Utils.debug("ACTIVITY VIEW init"), this.userView = new r({
                model: this.model.get("user")
            }), this.userView.format = "link";
        },
        model: n,
        userView: r,
        classname: "activity",
        template: t.templates.activity,
        render: function() {
            var e = this.model.toJSON();
            return e.verb = e.verb.replace(/&gt;/g, ">").replace(/&lt;/g, "<"), e.directobject = e.directobject.replace(/&gt;/g, ">").replace(/&lt;/g, "<"), e.indirectobject = e.indirectobject.replace(/&gt;/g, ">").replace(/&lt;/g, "<"), e.context = e.context.replace(/&gt;/g, ">").replace(/&lt;/g, "<"), e.timestamp = Utils.prettyTimestamp(e.timestamp), $(this.el).html(this.template(e)), $(this.el).find(".activity_verb").html(e.verb), $(this.el).find(".activity_direct_object").html(e.directobject), $(this.el).find(".activity_indirect_object").html(e.indirectobject
), this.userView.setElement(this.$(".activity-feed-user-link")), this.userView.render(), this;
        }
    });
    return i;
}), fielddb.define("app/PaginatedUpdatingCollectionView", [ "backbone" ], function(e) {
    var t = e.View.extend({
        initialize: function(e) {
            Utils.debug("PAGINATED UPDATING COLLECTION INIT"), _(this).bindAll("addChildView", "removeChildView");
            if (!e.childViewConstructor) throw "no child view constructor provided";
            if (!e.childViewTagName) throw "no child view tag name provided";
            this._childViewConstructor = e.childViewConstructor, this._childViewTagName = e.childViewTagName, this._childViewFormat = e.childViewFormat || null, this._childViewClass = e.childViewClass || "", this._childViews = [], this.collection.each(this.addChildView), this.collection.bind("add", this.addChildView), this.collection.bind("unshift", this.addChildView), this.collection.bind("remove", this.removeChildView);
            try {
                
this.perPage = app.get("authentication").get("userPrivate").get("prefs").get("numberOfItemsInPaginatedViews"), this.currentVisibleEnd = this.perPage - 1;
            } catch (t) {
                Utils.debug("there was a problem getting the number of items per page for the user, using default of 12.");
            }
        },
        tagName: "ul",
        paginationControlTemplate: Handlebars.templates.paging_footer,
        events: {},
        addChildView: function(e, t, n) {
            Utils.debug("PAGINATED UPDATING COLLECTION add: ", this._childViews.length);
            if (this.collection.indexOf(e) > this.currentVisibleEnd) return;
            this.filledBasedOnModels = !0;
            var r = new this._childViewConstructor({
                tagName: this._childViewTagName,
                className: this._childViewClass,
                model: e
            });
            this._childViewFormat && (r.format = this._childViewFormat);
            if (n == undefined || n == null
) n = {}, n.index = 0;
            if (n.index == 0) {
                var i = -1;
                for (var s in this._childViews) e.cid && this._childViews[s].model.cid == e.cid && (i = s), e.id && this._childViews[s].model.id == e.id && (i = s);
                i == -1 && (this._childViews.unshift(r), this._rendered && $(this.el).prepend(r.render().el));
            } else {
                var i = -1;
                for (var s in this._childViews) e.cid && this._childViews[s].model.cid == e.cid && (i = s), e.id && this._childViews[s].model.id == e.id && (i = s);
                i == -1 && (this._childViews.push(r), this._rendered && $(this.el).append(r.render().el));
            }
            this._childViews.length > this.currentVisibleEnd + 1 && this.removeChildView(this._childViews[this.currentVisibleEnd + 1].model);
        },
        removeChildView: function(e) {
            var t = _(this._childViews).select(function(t) {
                return t.model === e;
            })[0
];
            if (!t) return;
            this._childViews = _(this._childViews).without(t), this._rendered && $(t.el).remove();
        },
        render: function() {
            Utils.debug("PAGINATED UPDATING COLLECTION render: ", this._childViews.length);
            var e = this;
            return this._rendered = !0, $(this.el).empty(), _(this._childViews).each(function(t) {
                $(e.el).append(t.render().el), t.delegateEvents();
            }), this._childViews.length != this.currentVisibleEnd + 1 && this.renderFirstPage(), this.renderUpdatedPaginationControl(), this;
        },
        renderFirstPage: function() {
            for (var e = 0; e < this.currentVisibleEnd; e++) this.collection.models[e] && this.addChildView(this.collection.models[e], this.collection, {
                index: e
            });
        },
        renderInElement: function(e) {
            this.el = e, this.render();
        },
        filledBasedOnIds: !1,
        filledBasedOnModels: !1
,
        fillWithIds: function(e, t) {
            this.filledBasedOnModels && alert("mixing a collection from id and models!");
            for (var n in e) {
                var r = new t({
                    pouchname: app.get("corpus").get("pouchname")
                });
                r.id = e[n];
                var i = this;
                r.changePouch(window.app.get("corpus").get("pouchname"), function() {
                    r.fetch({
                        success: function(e, t) {
                            i.collection.add(e), i.filledBasedOnIds = !0;
                        }
                    });
                });
            }
        },
        clearChildViews: function() {
            while (this._childViews.length > 0) {
                var e = this._childViews.pop();
                $(e.el).remove();
            }
        },
        renderUpdatedPaginationControl: function() {
            var e = this;
            this.el.parent().find(".nextinfinitepagination"
).unbind("click", function(t) {
                e.nextResultPage(t, e);
            }), this.el.parent().find(".howmanyperpagination").unbind("click", function(t) {
                e.changeCount(t, e);
            }), this.el.parent().find(".pagination-control").empty(), this.el.parent().find(".pagination-control").html(this.paginationControlTemplate(this.getPaginationInfo())), this.el.parent().find(".nextinfinitepagination").bind("click", function(t) {
                e.nextResultPage(t, e);
            }), this.el.parent().find(".howmanyperpagination").bind("click", function(t) {
                e.changeCount(t, e);
            }), this.el.parent().find(".pagination-control").find(".locale_More").html(Locale["locale_More"].message), this.el.parent().find(".pagination-control").find(".locale_Show").html(Locale["locale_Show"].message), this.el.parent().find(".pagination-control").find(".locale_per_page").html(Locale["locale_per_page"].message), this.el.parent().find
(".pagination-control").find(".locale_of").html(Locale["locale_of"].message), this.el.parent().find(".pagination-control").find(".locale_pages_shown").html(Locale["locale_pages_shown"].message);
        },
        perPage: 10,
        currentVisibleStart: 0,
        currentVisibleEnd: 9,
        getPaginationInfo: function() {
            var e = this._childViews.length > 0 ? Math.ceil(this._childViews.length / this.perPage) : 1, t = this.collection.length > 0 ? Math.ceil(this.collection.length / this.perPage) : 1;
            return {
                currentPage: e,
                totalPages: t,
                perPage: this.perPage,
                morePages: e < t,
                allShown: this.currentVisibleEnd >= this.collection.length
            };
        },
        changeCount: function(e, t) {
            e.preventDefault();
            var n = t.perPage, r = t.currentVisibleEnd;
            t.perPage = parseInt($(e.target).text());
            try {
                
app.get("authentication").get("userPrivate").get("prefs").set("numberOfItemsInPaginatedViews", t.perPage), t.currentVisibleEnd = t.perPage - 1;
            } catch (e) {
                Utils.debug("There was a problem trying to save the number of items per page to the user's preferences.", e);
            }
            t.perPage < r && (t.clearChildViews(), t.render()), t.perPage > r && t.nextResultPage(null, t);
        },
        nextResultPage: function(e, t) {
            e && e.preventDefault(), t || (t = this), t.currentVisibleEnd = t.currentVisibleEnd + t.perPage;
            for (var n = t._childViews.length; n < t.currentVisibleEnd; n++) {
                var r = t.collection.models[n];
                r && t.addChildView(r, t.collection, {
                    index: n
                });
            }
            t.renderUpdatedPaginationControl();
        },
        destroy_view: function() {
            Utils.debug("DESTROYING PAGINATEDUPDATINGCOLLECTIONVIEW  VIEW " + this.
format), this.collection.each(this.removeChildView), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return t;
}), fielddb.define("activity/ActivityFeedView", [ "backbone", "handlebars", "activity/Activity", "activity/Activities", "activity/ActivityView", "activity/ActivityFeed", "app/PaginatedUpdatingCollectionView" ], function(e, t, n, r, i, s, o) {
    var u = e.View.extend({
        initialize: function() {
            this.changeViewsOfInternalModels();
        },
        changeViewsOfInternalModels: function() {
            this.model.get("activities") ? this.activitiesView = new o({
                collection: this.model.get("activities"),
                childViewConstructor: i,
                childViewTagName: "li",
                childViewClass: "border-bottom"
            }) : alert("bug: activity feed view has no model.");
        },
        model: s,
        events: {
            "click .icon-minus-sign": function(e) {
                e && 
(e.stopPropagation(), e.preventDefault()), this.format = "minimized" + this.format, this.render();
            },
            "click .icon-plus-sign": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.format = this.format.replace("minimized", ""), this.render();
            },
            "click .icon-refresh": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this, n = this.model;
                window.appView.authView.showQuickAuthenticateView(function() {
                    Utils.debug("Called by ActivityFeedView : in the authentication sucess.");
                }, function() {
                    Utils.debug("Called by ActivityFeedView : in the authentication failure.");
                }, function() {
                    Utils.debug("Called by ActivityFeedView : in the corpus login sucess."), n.replicateActivityFeed(null, function() {
                        Utils.debug("Refreshing activity feed from the servers succeeded."
);
                    }, function() {
                        Utils.debug("Refreshing activity feed failed.");
                    });
                }, function() {
                    Utils.debug("Called by ActivityFeedView : in the corpus login failure."), Utils.debug("Logging into the corpus server failed, trying just local activites."), window.appView.toastUser("Logging into the corpus server failed, I can only load activities which you already have saved locally on this device.", "alert-info", "Showing only local activities:"), n.saveAndInterConnectInApp(function() {
                        n.getAllIdsByDate(n.populate);
                    });
                });
            }
        },
        template: t.templates.activity_feed,
        minimizedTemplate: t.templates.activity_feed_minimized,
        render: function() {
            return Utils.debug("ACTIVITY FEED VIEW render"), this.destroy_view(), this.format == "rightSideUser" ? (this.changeViewsOfInternalModels(), this.
setElement($("#activity-feed-user")), $(this.el).html(this.template(this.model.toJSON())), this.activitiesView.el = this.$(".activities-updating-collection"), this.activitiesView.render(), $(this.el).find(".locale_Refresh_Activities").attr("title", Locale["locale_Refresh_Activities"].message), $(this.el).find(".locale_Hide_Activities").attr("title", Locale["locale_Hide_Activities"].message), $(this.el).find(".locale_Activity_Feed").html(Locale["locale_Activity_Feed_Your"].message)) : this.format == "rightSideCorpusTeam" ? (this.changeViewsOfInternalModels(), this.setElement($("#activity-feed-corpus-team")), $(this.el).html(this.template(this.model.toJSON())), this.activitiesView.el = this.$(".activities-updating-collection"), this.activitiesView.render(), $(this.el).find(".locale_Refresh_Activities").attr("title", Locale["locale_Refresh_Activities"].message), $(this.el).find(".locale_Hide_Activities").attr("title", chrome.i18n.getMessage("locale_Hide_Activities"
)), $(this.el).find(".locale_Activity_Feed").html(Locale["locale_Activity_Feed_Team"].message)) : this.format == "minimizedrightSideUser" ? (this.setElement($("#activity-feed-user")), $(this.el).html(this.minimizedTemplate(this.model.toJSON())), $(this.el).find(".locale_Show_Activities").attr("title", Locale["locale_Show_Activities"].message), $(this.el).find(".locale_Activity_Feed").html(Locale["locale_Activity_Feed_Your"].message)) : this.format == "minimizedrightSideCorpusTeam" && (this.setElement($("#activity-feed-corpus-team")), $(this.el).html(this.minimizedTemplate(this.model.toJSON())), $(this.el).find(".locale_Show_Activities").attr("title", Locale["locale_Show_Activities"].message), $(this.el).find(".locale_Activity_Feed").html(Locale["locale_Activity_Feed_Team"].message)), this;
        },
        destroy_view: function() {
            Utils.debug("DESTROYING ACTIIVITYFEED VIEW " + this.format), this.format.indexOf("minimized") == -1 && 
this.activitiesView.destroy_view(), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return u;
}), fielddb.define("authentication/AuthenticationEditView", [ "backbone", "handlebars", "authentication/Authentication", "user/User", "user/UserReadView", "libs/Utils" ], function(e, t, n, r, i) {
    var s = e.View.extend({
        initialize: function() {
            Utils.debug("AUTH EDIT init: " + this.el), this.userView = new i({
                model: this.model.get("userPublic")
            }), this.userView.format = "link", this.userView.setElement($("#user-quickview")), this.model.bind("change:state", this.render, this), this.model.get("userPublic").bind("change", this.render, this);
        },
        model: n,
        userView: i,
        events: {
            "click .logout": "logout",
            "click .login": "login",
            "click #login_form": function(e) {
                e.stopPropagation();
            },
            "click .corpus-settings"
: function() {
                window.appView.toastUser("Taking you to the corpus settings screen which is where all the corpus/database details can be found.", "alert-info", "How to find the corpus settings:"), window.appView.currentCorpusReadView.format = "fullscreen", window.appView.currentCorpusReadView.render(), app.router.showFullscreenCorpus();
            },
            "keyup #quick-authenticate-password": function(e) {
                var t = e.keyCode || e.which;
                Utils.debug("This should fire when the user pushes enter but it doesnt. TODO might have to just use jquery in the render, insted of backbone which might limit it to the element..."), t == 13 && $("#quick-authenticate-password").val() != "" && $("#quick-authentication-okay-btn").click();
            }
        },
        template: t.templates.authentication_edit_embedded,
        userTemplate: t.templates.user_read_link,
        render: function() {
            return Utils.debug("AUTH EDIT render: " + 
this.el), this.model == undefined ? (Utils.debug("Auth model was undefined, come back later."), this) : (this.model.get("userPublic") != undefined && (this.model.set("gravatar", this.model.get("userPublic").get("gravatar")), this.model.set("username", this.model.get("userPublic").get("username"))), this.setElement($("#authentication-embedded")), $(this.el).html(this.template(this.model.toJSON())), this.model.get("state") == "loggedIn" ? ($("#logout").show(), $("#login").hide(), $("#login_form").hide(), this.model.get("userPublic") != undefined ? (Utils.debug("	 rendering AuthenticationEditView's UserView"), this.userView.setElement($("#user-quickview")), this.userView.render()) : $("#user-quickview").html('<i class="icons icon-user icon-white">')) : ($("#logout").hide(), $("#login").show(), $("#login_form").show(), this.model.get("userPublic") != undefined ? (Utils.debug("	 rendering AuthenticationEditView's UserView"), this.userView.setElement($("#user-quickview")), this.userView.render
()) : $("#user-quickview").html('<i class="icons icon-user icon-white">'), this.$el.children(".user").html("")), $(this.el).find(".locale_Username").html(Locale["locale_Username"].message), $(this.el).find(".locale_Password").html(Locale["locale_Password"].message), $(this.el).find(".locale_Log_Out").html(Locale["locale_Log_Out"].message), $(this.el).find(".locale_Log_In").html(Locale["locale_Log_In"].message), $(this.el).find(".locale_Private_Profile").html(Locale["locale_Private_Profile"].message), $(this.el).find(".locale_User_Settings").html(Locale["locale_User_Settings"].message), $(this.el).find(".locale_Keyboard_Shortcuts").html(Locale["locale_Keyboard_Shortcuts"].message), $(this.el).find(".locale_Corpus_Settings").html(Locale["locale_Corpus_Settings"].message), $(this.el).find(".locale_Terminal_Power_Users").html(Locale["locale_Terminal_Power_Users"].message), document.getElementById("authUrl").value = Utils
.authUrl, this);
        },
        logout: function() {
            localStorage.removeItem("username"), localStorage.removeItem("mostRecentDashboard"), localStorage.removeItem("mostRecentCouchConnection"), Utils.setCookie("username", undefined, -365), Utils.setCookie("token", undefined, -365), window.location.replace("/index.html");
        },
        login: function() {
            Utils.debug("LOGIN"), this.authenticate(document.getElementById("username").value, document.getElementById("password").value, document.getElementById("authUrl").value);
        },
        loadSample: function(e) {},
        authenticate: function(e, t, n, i, s, o, u) {
            var a = new r({
                username: e,
                password: t,
                authUrl: n
            }), f = function() {
                if (app.get("corpus").get("title").indexOf("Untitled Corpus") >= 0) if (l.model.get("userPrivate").get("mostRecentIds") == undefined) alert("Bug: User does not have most recent ids, Cant show your most recent dashbaord."
), window.app.router.showDashboard(); else {
                    var e = l.model.get("userPrivate").get("mostRecentIds");
                    window.app.loadBackboneObjectsByIdAndSetAsCurrentDashboard(couchConnection, e);
                }
                typeof u == "function" ? u() : Utils.debug("no corpusloginfailcallback was defined");
            }, l = this;
            this.model.authenticate(a, function(n) {
                if (n == null) return;
                var r = l.model.get("userPrivate").get("corpuses")[0];
                window.app.get("corpus").logUserIntoTheirCorpusServer(r, e, t, function() {
                    typeof o == "function" ? (Utils.debug("Calling corpusloginsuccesscallback"), o()) : Utils.debug("no corpusloginsuccesscallback was defined"), window.app.get("corpus").replicateFromCorpus(r, function() {
                        if (l.model.get("userPrivate").get("mostRecentIds") == undefined) alert("Bug: User does not have most recent ids, Cant show your most recent dashbaord."
), window.app.router.showDashboard(); else {
                            var e = l.model.get("userPrivate").get("mostRecentIds"), t = {};
                            t.corpusid = app.get("corpus").id, t.sessionid = app.get("currentSession").id, t.datalistid = app.get("currentDataList").id;
                            if (e.sessionid != t.sessionid || e.corpusid != t.corpusid || e.datalistid != t.datalistid) Utils.debug("Calling loadBackboneObjectsByIdAndSetAsCurrentDashboard in AuthenticationEditView"), window.app.loadBackboneObjectsByIdAndSetAsCurrentDashboard(r, e);
                        }
                    });
                }, f), l.model.set({
                    gravatar: l.model.get("userPrivate").get("gravatar"),
                    username: l.model.get("userPrivate").get("username"),
                    state: "loggedIn"
                }), typeof i == "function" && i();
            }, s);
        },
        authenticateAsPublic: function() {
            this.userView.loadPublic
(), u = this.userView.model, this.model.set({
                user: u,
                username: u.get("username"),
                state: "logggedOut"
            });
        },
        authenticatePreviousUser: function() {
            return;
        },
        showQuickAuthenticateView: function(e, t, n, r) {
            var i = this;
            this.model.get("userPrivate").get("username") == "lingllama" ? ($("#quick-authenticate-modal").modal("show"), $("#quick-authenticate-password").val("phoneme"), window.hub.subscribe("quickAuthenticationClose", function() {
                window.appView.authView.authenticate(window.app.get("authentication").get("userPrivate").get("username"), $("#quick-authenticate-password").val(), window.app.get("authentication").get("userPrivate").get("authUrl"), e, t, n, r), $("#quick-authenticate-modal").modal("hide"), $("#quick-authenticate-password").val(""), window.hub.unsubscribe("quickAuthenticationClose", null, this);
            }, i)) : ($("#quick-authenticate-modal"
).modal("show"), window.hub.subscribe("quickAuthenticationClose", function() {
                window.appView.authView.authenticate(window.app.get("authentication").get("userPrivate").get("username"), $("#quick-authenticate-password").val(), window.app.get("authentication").get("userPrivate").get("authUrl"), e, t, n, r), $("#quick-authenticate-modal").modal("hide"), $("#quick-authenticate-password").val(""), window.hub.unsubscribe("quickAuthenticationClose", null, this);
            }, i));
        }
    });
    return s;
}), fielddb.define("audio_video/AudioVideoReadView", [ "backbone", "handlebars", "audio_video/AudioVideo" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {},
        model: n,
        classname: "audio_video",
        template: t.templates.audio_video_read_embedded,
        render: function() {
            if (this.model.get("URL")) {
                var e = this.model.toJSON();
                e.audioType = "audio/" + this.model.get("filename"
).split(".").pop(), $(this.el).html(this.template(e));
            } else $(this.el).html("");
            return this;
        }
    });
    return r;
}), fielddb.define("datum/DatumFieldReadView", [ "backbone", "handlebars", "datum/DatumField" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("DATUM FIELD READ init"), this.model.bind("change", this.render, this);
        },
        model: n,
        events: {
            "click .icon-question-sign": "showHelpConvention",
            "hover .icon-question-sign": "hideHelpConvention"
        },
        templateSettings: t.templates.datum_field_settings_read_embedded,
        templateValue: t.templates.datum_field_value_read_embedded,
        render: function() {
            Utils.debug("DATUM FIELD READ VIEW render");
            if (this.format == "corpus") $(this.el).html(this.templateSettings(this.model.toJSON())), this.$el.children(".choose-field").val(this.model.get("label")
), $(this.el).find(".locale_Encrypt_if_confidential").html(Locale["locale_Encrypt_if_confidential"].message); else if (this.format == "datum") {
                var e = this.model.toJSON();
                e.helpText = !0, $(this.el).html(this.templateValue(e));
            } else if (this.format == "session") {
                var e = this.model.toJSON();
                e.helpText = !1, $(this.el).html(this.templateValue(e));
            }
            return this;
        },
        showHelpConvention: function() {
            this.$el.children(".help-conventions").popover("show");
        },
        hideHelpConvention: function() {
            this.$el.children(".help-conventions").popover("hide");
        }
    });
    return r;
}), fielddb.define("datum/DatumStateReadView", [ "backbone", "handlebars", "datum/DatumState", "libs/Utils" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("DATUM STATE READ VIEW init"), this
.format = "corpus", this.model.bind("change", this.render, this);
        },
        model: n,
        events: {
            "blur .datum_state_input": "updateState",
            "change .color_chooser": "updateColor"
        },
        templateSettings: t.templates.datum_state_settings_read_embedded,
        render: function() {
            return Utils.debug("DATUM STATE READ VIEW render"), this.format == "corpus" && ($(this.el).html(this.templateSettings(this.model.toJSON())), this.$el.children(".color_chooser").val(this.model.get("color"))), this;
        },
        updateState: function() {
            Utils.debug("Updated state to " + this.$el.children(".datum_state_input").val()), this.model.set("state", this.$el.children(".datum_state_input").val());
        },
        updateColor: function() {
            Utils.debug("Updated color to " + this.$el.children(".color_chooser").val()), this.model.set("color", this.$el.children(".color_chooser").val());
        }
    });
    return r
;
}), fielddb.define("datum/DatumTagReadView", [ "backbone", "handlebars", "datum/DatumTag", "libs/Utils" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("DATUM TAG EDIT VIEW init");
        },
        model: n,
        events: {
            "blur .datum_tag": "updateTag"
        },
        template: t.templates.datum_tag_read_embedded,
        render: function() {
            return Utils.debug("DATUM TAG EDIT VIEW render"), $(this.el).html(this.template(this.model.toJSON())), this;
        },
        updateTag: function() {
            this.model.set("tag", this.$el.children(".datum_tag").val());
        }
    });
    return r;
}), fielddb.define("datum/SessionReadView", [ "backbone", "handlebars", "comment/Comment", "comment/Comments", "comment/CommentReadView", "datum/DatumFieldReadView", "datum/Session", "app/UpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o, u) {
    var a = e.View.extend({
        initialize
: function() {
            Utils.debug("SESSION READ VIEW init: "), this.changeViewsOfInternalModels();
            var e = this;
            this.model.bind("change:sessionFields", function() {
                e.changeViewsOfInternalModels(), e.render();
            }, this);
        },
        model: o,
        events: {
            "click .add-comment-session": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this.$el.find(".comment-new-text").val();
                this.model.insertNewComment(t), this.$el.find(".comment-new-text").val("");
            },
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeLarge",
            "click .icon-edit": "showEditable"
        },
        templateSummary: t.templates.session_summary_read_embedded,
        templateEmbedded: t.templates.session_read_embedded,
        templateFullscreen: t.templates.session_read_embedded,
        templateLink: t.
templates.session_read_link,
        render: function() {
            Utils.debug("SESSION READ render: ");
            if (this.model == undefined) return Utils.debug("SESSION is undefined, come back later."), this;
            try {
                if (this.model.get("sessionFields").where({
                    label: "goal"
                })[0] == undefined) return Utils.debug("SESSION fields are undefined, come back later."), this;
                this.format != "link" && (window.appView.currentSessionEditView && appView.currentSessionEditView.destroy_view(), appView.currentSessionReadView.destroy_view());
                if (this.format == "leftSide") {
                    Utils.debug("SESSION READ LEFTSIDE render: ");
                    var e = {
                        goal: this.model.get("sessionFields").where({
                            label: "goal"
                        })[0].get("mask"),
                        consultants: this.model.get("sessionFields").where({
                            
label: "consultants"
                        })[0].get("mask"),
                        dateElicited: this.model.get("sessionFields").where({
                            label: "dateElicited"
                        })[0].get("mask")
                    };
                    this.setElement("#session-quickview"), $(this.el).html(this.templateSummary(e)), $(this.el).find(".locale_Edit_Session").attr("title", Locale["locale_Edit_Session"].message), $(this.el).find(".locale_Show_fullscreen").attr("title", Locale["locale_Show_fullscreen"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Goal").html(Locale["locale_Goal"].message), $(this.el).find(".locale_Consultants").html(Locale["locale_Consultants"].message), $(this.el).find(".locale_When").html(Locale["locale_When"].message);
                } else if (this.format == "centerWell") Utils.debug("SESSION READ CENTERWELL render: "
), this.setElement("#session-embedded"), $(this.el).html(this.templateEmbedded(this.model.toJSON())), this.sessionFieldsView.el = this.$(".session-fields-ul"), this.sessionFieldsView.render(), this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), $(this.el).find(".locale_Edit_Session").attr("title", Locale["locale_Edit_Session"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message); else if (this.format == "fullscreen") Utils.debug("SESSION READ FULLSCREEN render: "), this.setElement("#session-fullscreen"), $(this.el).html(this.templateFullscreen(this.model.toJSON())), this.sessionFieldsView.el = this.$(".session-fields-ul"), this.sessionFieldsView.render(), this.commentReadView.el = this.$(".comments"), this.commentReadView
.render(), $(this.el).find(".locale_Edit_Session").attr("title", Locale["locale_Edit_Session"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Elicitation_Session").html(Locale["locale_Elicitation_Session"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message); else {
                    if (this.format != "link") throw "You have not specified a format that the SessionReadView can understand.";
                    Utils.debug("SESSION READ LINK render: "), $(this.el).html(this.templateLink(this.model.toJSON()));
                    var e = {
                        _id: this.model.get("_id"),
                        goal: this.model.get("sessionFields").where({
                            label: "goal"
                        })[0].get("mask"),
                        consultants: this.model.get("sessionFields").where({
                            
label: "consultants"
                        })[0].get("mask"),
                        dateElicited: this.model.get("sessionFields").where({
                            label: "dateElicited"
                        })[0].get("mask")
                    };
                    $(this.el).html(this.templateLink(e)), $(this.el).find(".locale_Goal").html(Locale["locale_Goal"].message), $(this.el).find(".locale_Consultants").html(Locale["locale_Consultants"].message);
                }
            } catch (t) {
                Utils.debug("There was a problem rendering the session, probably the datumfields are still arrays and havent been restructured yet.");
            }
            return this;
        },
        changeViewsOfInternalModels: function() {
            this.sessionFieldsView = new u({
                collection: this.model.get("sessionFields"),
                childViewConstructor: s,
                childViewTagName: "li",
                childViewFormat: "session"
            
}), this.commentReadView = new u({
                collection: this.model.get("comments"),
                childViewConstructor: i,
                childViewTagName: "li"
            });
        },
        resizeSmall: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.app.router.showDashboard();
        },
        resizeLarge: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), this.format = "fullscreen", this.render(), window.app.router.showFullscreenSession();
        },
        showEditable: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.appView.currentSessionEditView && (window.appView.currentSessionEditView.format = this.format, window.appView.currentSessionEditView.render());
        },
        destroy_view: function() {
            Utils.debug("DESTROYING SESSION READ VIEW " + this.format), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return a;
}), fielddb.define
("datum/DatumReadView", [ "backbone", "handlebars", "audio_video/AudioVideoReadView", "comment/Comment", "comment/Comments", "comment/CommentReadView", "datum/Datum", "datum/DatumFieldReadView", "datum/DatumStateReadView", "datum/DatumTagReadView", "datum/SessionReadView", "app/UpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l, c) {
    var h = e.View.extend({
        initialize: function() {
            this.audioVideoView = new n({
                model: this.model.get("audioVideo")
            }), this.stateView = new a({
                model: this.model.get("state")
            }), this.stateView.format = "datum", this.commentReadView = new c({
                collection: this.model.get("comments"),
                childViewConstructor: s,
                childViewTagName: "li"
            }), this.datumTagsView = new c({
                collection: this.model.get("datumTags"),
                childViewConstructor: f,
                childViewTagName
: "li"
            }), this.datumFieldsView = new c({
                collection: this.model.get("datumFields"),
                childViewConstructor: u,
                childViewTagName: "li",
                childViewFormat: "datum"
            }), this.sessionView = new l({
                model: this.model.get("session")
            }), this.sessionView.format = "link";
        },
        model: o,
        events: {
            "click .help-conventions": function(e) {
                e && e.preventDefault();
            },
            "click .LaTeX": function() {
                this.model.laTeXiT(!0), $("#export-modal").modal("show");
            },
            "click .icon-paste": function() {
                this.model.exportAsPlainText(!0), $("#export-modal").modal("show");
            },
            "click .CSV": function() {
                this.model.exportAsCSV(!0, null, !0), $("#export-modal").modal("show");
            },
            "click .add-comment-datum": "insertNewComment"
,
            dblclick: function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this.model.clone();
                t.id = this.model.id, t.set("_id", this.model.get("_id")), t.set("_rev", this.model.get("_rev")), window.appView.datumsEditView && appView.datumsEditView.prependDatum(t);
            },
            "click .datum-checkboxes": function(e) {
                e && e.stopPropagation(), this.checked = e.target.checked;
            }
        },
        template: t.templates.datum_read_embedded,
        latexTemplate: t.templates.datum_read_latex,
        render: function() {
            Utils.debug("DATUM READ render: " + this.model.get("datumFields").models[1].get("mask")), this.collection && Utils.debug("This datum has a link to a collection. Removing the link.");
            if (this.model.get("datumFields").where({
                label: "utterance"
            })[0] == undefined) return Utils.debug("DATUM fields is undefined, come back later."
), this;
            var e = this.model.toJSON();
            e.datumStates = this.model.get("datumStates").toJSON(), e.decryptedMode = window.app.get("corpus").get("confidential").decryptedMode;
            if (this.format == "well") $(this.el).html(this.template(e)), this.audioVideoView.el = this.$(".audio_video"), this.audioVideoView.render(), this.datumTagsView.el = this.$(".datum_tags_ul"), this.datumTagsView.render(), this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), this.sessionView.el = this.$(".session-link"), this.sessionView.render(), this.datumFieldsView.el = this.$(".datum_fields_ul"), this.datumFieldsView.render(), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip"
).attr("title", Locale["locale_Plain_Text_Export_Tooltip"].message), $(this.el).find(".locale_LaTeX").attr("title", Locale["locale_LaTeX"].message), $(this.el).find(".locale_CSV_Tooltip").attr("title", Locale["locale_CSV_Tooltip"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message); else if (this.format == "latex") {
                var t = this.model.get("datumFields").where({
                    label: "judgement"
                })[0].get("mask"), n = this.model.get("datumFields").where({
                    label: "utterance"
                })[0].get("mask"), r = this.model.get("datumFields").where({
                    label: "gloss"
                })[0].get("mask"), i = this.model.get("datumFields").where({
                    label: "translation"
                })[0].get("mask"), e = {};
                try {
                    var s = n.split(" "), o = r.split(" "), u = [];
                    for (var a = 0; a < s.length
; a++) u.push({
                        utteranceSegment: s[a],
                        glossSegment: o[a]
                    });
                    i != "" && (e.translation = "'" + i + "'"), e.couplet = u, t !== "" && (e.judgement = t);
                } catch (f) {
                    alert("Bug: something is wrong with this datum: " + JSON.stringify(f)), e.translation = "bug";
                }
                try {
                    e.datumstatecolor = this.model.get("datumStates").where({
                        selected: "selected"
                    })[0].get("color");
                } catch (f) {
                    Utils.debug("problem getting color of datum state, probaly none are selected.", f);
                }
                $(this.el).html(this.latexTemplate(e)), e.datumstatecolor && $(this.el).addClass("datum-state-color-" + e.datumstatecolor);
                try {
                    this.model.get("datumStates").where({
                        selected: "selected"
                    
})[0].get("state") == "Deleted" && $(this.el).find(".datum-latex-translation").html("<del>" + i + "</del>");
                } catch (f) {
                    Utils.debug("problem getting color of datum state, probaly none are selected.", f);
                }
            }
            return this;
        },
        renderState: function() {
            this.stausview != undefined && this.stateView.render();
        },
        insertNewComment: function(e) {
            e && (e.stopPropagation(), e.preventDefault());
            var t = new r({
                text: this.$el.find(".comment-new-text").val()
            });
            this.model.get("comments").add(t), this.$el.find(".comment-new-text").val("");
        },
        encryptDatum: function() {
            this.model.encrypt(), this.render(), $(".icon-unlock").toggleClass("icon-unlock icon-lock");
        },
        decryptDatum: function() {
            this.model.decrypt(), this.render(), $(".icon-lock").toggleClass("icon-unlock icon-lock"
);
        },
        laTeXiT: function() {
            return "";
        },
        copyDatum: function() {
            var e = $(".datum_field_input").val() || [];
            return Utils.debug(e), "";
        }
    });
    return h;
}), fielddb.define("datum/Datums", [ "backbone", "datum/Datum" ], function(e, t) {
    var n = e.Collection.extend({
        initialize: function() {},
        model: t
    });
    return n;
}), fielddb.define("data_list/DataListReadView", [ "backbone", "handlebars", "comment/Comment", "comment/Comments", "comment/CommentReadView", "data_list/DataList", "datum/Datum", "datum/DatumReadView", "datum/Datums", "app/UpdatingCollectionView" ], function(e, t, n, r, i, s, o, u, a, f) {
    var l = e.View.extend({
        initialize: function(e) {
            Utils.debug("DATALIST READ VIEW init: "), this.changeViewsOfInternalModels(), this.model.bind("change:dateCreated", function() {
                this.changeViewsOfInternalModels(), this.render();
            
}, this), this.model.bind("change:datumIds", function() {
                this.render();
            }, this);
        },
        model: s,
        events: {
            "click .add-comment-datalist": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this.$el.find(".comment-new-text").val();
                this.model.insertNewComment(t), this.$el.find(".comment-new-text").val("");
            },
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeFullscreen",
            "click .icon-edit": "showEditable",
            "click .icon-minus-sign": function() {
                this.format = "minimized", this.render();
            },
            "click .icon-plus-sign": function() {
                this.format = "leftSide", this.render();
            },
            "click .latex-export-datalist": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal"
).modal("show"), $("#export-text-area").val(""), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "laTeXiT", !0), !1;
            },
            "click .icon-paste": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal").modal("show"), $("#export-text-area").val(""), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "exportAsPlainText", !0), !1;
            },
            "click .CSV": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal").modal("show"), $("#export-text-area").val(""), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "exportAsCSV", !0), !1;
            },
            "click .icon-bullhorn": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.createPlaylistAndPlayAudioVideo(this.getAllCheckedDatums()), !1;
            },
            "click .icon-remove-sign": function(e) {
                return e && (e
.stopPropagation(), e.preventDefault()), this.removeDatumFromThisList(this.getAllCheckedDatums()), !1;
            },
            "click .icon-lock": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "encrypt"), !1;
            },
            "click .icon-unlock": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "decrypt"), !1;
            },
            "click .icon-eye-open": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = app.get("corpus").get("confidential");
                t || alert("This is a bug: cannot find decryption module for your corpus.");
                var n = this;
                return t.turnOnDecryptedMode(function() {
                    n.$el.find(".icon-eye-close").toggleClass("icon-eye-close icon-eye-open");
                
}), !1;
            },
            "click .icon-eye-close": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = app.get("corpus").get("confidential");
                return t || alert("This is a bug: cannot find decryption module for your corpus."), t.turnOffDecryptedMode(), this.$el.find(".icon-eye-open").toggleClass("icon-eye-close icon-eye-open"), !1;
            }
        },
        templateFullscreen: t.templates.data_list_read_embedded,
        templateEmbedded: t.templates.data_list_read_embedded,
        templateSummary: t.templates.data_list_summary_read_embedded,
        templateLink: t.templates.data_list_read_link,
        footerTemplate: t.templates.paging_footer,
        templateMinimized: t.templates.data_list_summary_read_minimized,
        render: function() {
            this.format != "link" && (window.appView.currentReadDataListView.destroy_view(), window.appView.currentEditDataListView && window.appView.currentEditDataListView
.destroy_view());
            var e = this.model.toJSON();
            e.datumCount = this.model.get("datumIds").length, e.decryptedMode = window.app.get("corpus").get("confidential").decryptedMode, this.format == "link" ? (Utils.debug("DATALIST READ LINK render: "), $(this.el).html(this.templateLink(e))) : this.format == "leftSide" ? (Utils.debug("DATALIST READ LEFTSIDE render: "), this.setElement($("#data-list-quickview-header")), $(this.el).html(this.templateSummary(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-quickview").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Hide_Datalist").attr("title", Locale["locale_Hide_Datalist"].message), $(this.el).find(".locale_Edit_Datalist").attr("title", Locale["locale_Edit_Datalist"].message), $(this.el).find(".locale_Show_fullscreen").attr("title", Locale["locale_Show_fullscreen"].message)) : this.format == "fullscreen" ? (Utils.debug("DATALIST READ FULLSCREEN render: "
), this.setElement($("#data-list-fullscreen-header")), $(this.el).html(this.templateFullscreen(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-fullscreen").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Edit_Datalist").attr("title", Locale["locale_Edit_Datalist"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message)) : this.format == "centerWell" ? (Utils.debug("DATALIST READ CENTER render: "), this.setElement($("#data-list-embedded-header")), $(this.el).html(this.templateEmbedded(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-embedded").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Edit_Datalist").attr("title", Locale["locale_Edit_Datalist"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message)) : this.format == "minimized" && 
(Utils.debug("DATALIST READ MINIMIZED render: "), this.setElement($("#data-list-quickview-header")), $(this.el).html(this.templateMinimized(e)), $(this.el).find(".locale_Show_Datalist").attr("title", Locale["locale_Show_Datalist"].message));
            try {
                this.format && this.format.indexOf("minimized") == -1 && (this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), $(this.el).find(".locale_Play_Audio_checked").attr("title", Locale["locale_Play_Audio_checked"].message), $(this.el).find(".locale_Remove_checked_from_datalist_tooltip").attr("title", Locale["locale_Remove_checked_from_datalist_tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked").attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", Locale["locale_Encrypt_checked"].message), $(this.el).find(".locale_Decrypt_checked").attr("title", chrome.i18n
.getMessage("locale_Decrypt_checked")), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message));
            } catch (t) {
                alert("Bug, there was a problem rendering the contents of the data list format: " + this.format);
            }
            return this;
        },
        changeViewsOfInternalModels: function() {
            this.commentReadView = new f({
                collection: this.model.get("comments"),
                
childViewConstructor: i,
                childViewTagName: "li"
            });
        },
        getAllCheckedDatums: function() {
            var e = [];
            for (var t in window.appView.currentPaginatedDataListDatumsView._childViews) window.appView.currentPaginatedDataListDatumsView._childViews[t].checked == 1 && e.push(window.appView.currentPaginatedDataListDatumsView._childViews[t].model.id);
            return e;
        },
        createPlaylistAndPlayAudioVideo: function(e) {
            this.model.getAllAudioAndVideoFiles(e, function(e) {
                alert("TODO show playlist and audio player for all audio/video in datums " + JSON.stringify(e));
            });
        },
        removeDatumFromThisList: function(e) {
            if (e == this.model.get("datumIds")) return;
            try {
                this.model.set("datumIds", _.difference(this.model.get("datumIds"), [ e ])), appView.currentPaginatedDataListDatumsView.collection.remove(appView.currentPaginatedDataListDatumsView
.collection.get(e[0]));
            } catch (t) {
                Utils.debug("Attemptign to remove datum(s) from the current datalist, there was something that went wrong.", t);
            }
        },
        resizeSmall: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.app.router.showDashboard();
        },
        resizeFullscreen: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), this.format = "fullscreen", this.render(), window.app.router.showFullscreenDataList();
        },
        showEditable: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.appView.currentEditDataListView && (window.appView.currentEditDataListView.format = this.format, window.appView.currentEditDataListView.render());
        },
        destroy_view: function() {
            Utils.debug("DESTROYING DATALIST READ VIEW " + this.format), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return l
;
}), fielddb.define("lexicon/LexiconView", function() {}), fielddb.define("permission/PermissionReadView", [ "backbone", "handlebars", "permission/Permission" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("PERMISSION READ VIEW init");
        },
        model: n,
        events: {},
        template: t.templates.permissions_read_embedded,
        render: function() {
            Utils.debug("PERMISSION READ VIEW render");
            var e = this.model.toJSON();
            return e.users = this.model.get("users").toJSON(), $(this.el).html(this.template(e)), this;
        },
        updatePermission: function() {}
    });
    return r;
}), fielddb.define("corpus/CorpusReadView", [ "backbone", "handlebars", "corpus/Corpus", "comment/Comment", "comment/Comments", "comment/CommentReadView", "data_list/DataLists", "data_list/DataListReadView", "datum/DatumFieldReadView", "datum/DatumStateReadView", "lexicon/LexiconView", "permission/Permission"
, "permission/Permissions", "permission/PermissionReadView", "datum/Session", "datum/Sessions", "datum/SessionReadView", "app/UpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g) {
    var y = e.View.extend({
        initialize: function() {
            Utils.debug("CORPUS READ init: "), this.changeViewsOfInternalModels(), this.model.bind("change:title", function() {
                this.changeViewsOfInternalModels(), this.render();
            }, this);
        },
        events: {
            "click .icon-resize-small": "resizeSmall",
            "click .resize-full": "resizeFullscreen",
            "click .add-comment-corpus": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this.$el.find(".comment-new-text").val();
                this.model.insertNewComment(t), this.$el.find(".comment-new-text").val("");
            },
            "click .icon-edit": "showEditable",
            "click .new-datum"
: "newDatum",
            "click .new-data-list": "newDataList",
            "click .new-session": "newSession",
            "click .new-corpus": "newCorpus"
        },
        model: n,
        lexicon: l,
        templateFullscreen: t.templates.corpus_read_embedded,
        templateCentreWell: t.templates.corpus_read_embedded,
        templateSummary: t.templates.corpus_summary_read_embedded,
        templateLink: t.templates.corpus_read_link,
        render: function() {
            Utils.debug("CORPUS READ render: "), window.appView.currentCorpusEditView && window.appView.currentCorpusEditView.destroy_view(), window.appView.currentCorpusReadView.destroy_view();
            if (this.model == undefined) return Utils.debug("	Corpus model was undefined."), this;
            var e = this.model.toJSON();
            try {
                e.username = this.model.get("team").get("username");
            } catch (t) {
                Utils.debug("Problem getting the usrname of the corpus' team"
);
            }
            if (this.format == "leftSide") Utils.debug("CORPUS READ LEFTSIDE render: "), this.setElement($("#corpus-quickview")), $(this.el).html(this.templateSummary(e)), $(this.el).find(".locale_Show_corpus_settings").attr("title", Locale["locale_Show_corpus_settings"].message); else if (this.format == "link") Utils.debug("CORPUS READ LINK render: "), $(this.el).html(this.templateLink(e)); else if (this.format == "fullscreen") {
                Utils.debug("CORPUS READ FULLSCREEN render: "), this.setElement($("#corpus-fullscreen")), $(this.el).html(this.templateFullscreen(e)), this.commentReadView.el = this.$(".comments"), this.commentReadView.render(), this.datumFieldsView.el = this.$(".datum_field_settings"), this.datumFieldsView.render(), this.datumStatesView.el = this.$(".datum_state_settings"), this.datumStatesView.render(), this.dataListsView.el = this.$(".datalists-updating-collection"), this.dataListsView.render(), this.sessionsView.el = this.$(".sessions-updating-collection"
), this.sessionsView.render(), this.permissionsView.el = this.$(".permissions-updating-collection"), this.permissionsView.render();
                try {
                    Glosser.visualizeMorphemesAsForceDirectedGraph(null, $(this.el).find(".corpus-precedence-rules-visualization")[0], this.model.get("pouchname"));
                } catch (t) {
                    window.appView.toastUser("There was a problem loading your corpus visualization.");
                }
                $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Sessions_associated").html(Locale["locale_Sessions_associated"].message), $(this.el).find(".locale_elicitation_sessions_explaination").html(Locale["locale_elicitation_sessions_explaination"].message), $(this.el).find(".locale_Datalists_associated").html(Locale["locale_Datalists_associated"].message), $(this.el).find(".locale_datalists_explaination").html
(Locale["locale_datalists_explaination"].message), $(this.el).find(".locale_Permissions_associated").html(Locale["locale_Permissions_associated"].message), $(this.el).find(".locale_permissions_explaination").html(Locale["locale_permissions_explaination"].message), $(this.el).find(".locale_Datum_field_settings").html(Locale["locale_Datum_field_settings"].message), $(this.el).find(".locale_datum_fields_explaination").html(Locale["locale_datum_fields_explaination"].message), $(this.el).find(".locale_Datum_state_settings").html(Locale["locale_Datum_state_settings"].message), $(this.el).find(".locale_datum_states_explaination").html(Locale["locale_datum_states_explaination"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message);
            } else this.format == "centreWell" && (Utils.debug("CORPUS READ CENTER render: "), this.setElement($("#corpus-embedded")), $(this.el).html(this.templateCentreWell(e)), this
.commentReadView.el = this.$(".comments"), this.commentReadView.render(), this.datumFieldsView.el = this.$(".datum_field_settings"), this.datumFieldsView.render(), this.datumStatesView.el = this.$(".datum_state_settings"), this.datumStatesView.render(), this.dataListsView.el = this.$(".datalists-updating-collection"), this.dataListsView.render(), this.sessionsView.el = this.$(".sessions-updating-collection"), this.sessionsView.render(), this.permissionsView.el = this.$(".permissions-updating-collection"), this.permissionsView.render(), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Sessions_associated").html(Locale["locale_Sessions_associated"].message), $(this.el).find(".locale_elicitation_sessions_explaination").html(Locale["locale_elicitation_sessions_explaination"].message), $(this.el).find(".locale_Datalists_associated").html(chrome.i18n.getMessage("locale_Datalists_associated"
)), $(this.el).find(".locale_datalists_explaination").html(Locale["locale_datalists_explaination"].message), $(this.el).find(".locale_Permissions_associated").html(Locale["locale_Permissions_associated"].message), $(this.el).find(".locale_permissions_explaination").html(Locale["locale_permissions_explaination"].message), $(this.el).find(".locale_Datum_field_settings").html(Locale["locale_Datum_field_settings"].message), $(this.el).find(".locale_datum_fields_explaination").html(Locale["locale_datum_fields_explaination"].message), $(this.el).find(".locale_Datum_state_settings").html(Locale["locale_Datum_state_settings"].message), $(this.el).find(".locale_datum_states_explaination").html(Locale["locale_datum_states_explaination"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message));
            return $(this.el).find(".locale_New_menu").html(Locale["locale_New_menu"].message), $(this.el).find(".locale_New_Datum"
).html(Locale["locale_New_Datum"].message), $(this.el).find(".locale_New_Data_List").html(Locale["locale_New_Data_List"].message), $(this.el).find(".locale_New_Session").html(Locale["locale_New_Session"].message), $(this.el).find(".locale_New_Corpus").html(Locale["locale_New_Corpus"].message), $(this.el).find(".locale_Data_menu").html(Locale["locale_Data_menu"].message), $(this.el).find(".locale_Import_Data").html(Locale["locale_Import_Data"].message), $(this.el).find(".locale_Export_Data").html(Locale["locale_Export_Data"].message), $(this.el).find(".locale_Edit_corpus").attr("title", Locale["locale_Edit_corpus"].message), this;
        },
        destroy_view: function() {
            Utils.debug("DESTROYING CORPUS READ VIEW " + this.format), this.undelegateEvents(), $(this.el).removeData().unbind();
        },
        changeViewsOfInternalModels: function() {
            this.commentReadView = new g({
                collection
: this.model.get("comments"),
                childViewConstructor: s,
                childViewTagName: "li"
            }), this.dataListsView = new g({
                collection: this.model.get("dataLists"),
                childViewConstructor: u,
                childViewTagName: "li",
                childViewFormat: "link"
            }), this.datumFieldsView = new g({
                collection: this.model.get("datumFields"),
                childViewConstructor: a,
                childViewTagName: "li",
                childViewFormat: "corpus",
                childViewClass: "breadcrumb"
            }), this.datumStatesView = new g({
                collection: this.model.get("datumStates"),
                childViewConstructor: f,
                childViewTagName: "li",
                childViewFormat: "corpus"
            }), this.dataListsView = new g({
                collection: this.model.get("dataLists"),
                childViewConstructor: u,
                childViewTagName
: "li",
                childViewFormat: "link"
            }), this.model.loadPermissions(), this.permissionsView = new g({
                collection: this.model.permissions,
                childViewConstructor: p,
                childViewTagName: "li",
                childViewClass: "breadcrumb"
            }), this.sessionsView = new g({
                collection: this.model.get("sessions"),
                childViewConstructor: m,
                childViewTagName: "li",
                childViewFormat: "link"
            });
        },
        newDatum: function(e) {
            e && e.preventDefault(), appView.datumsEditView.newDatum(), app.router.showDashboard(), Utils.debug("CLICK NEW DATUM READ CORPUS VIEW.");
        },
        newDataList: function(e) {
            e && e.preventDefault(), window.appView.toastUser("Below is the Advanced Search, this is the easiest way to make a new Data List.", "alert-info", "How to make a new Data List:"), app.router.showEmbeddedSearch()
;
        },
        newSession: function(e) {
            e && e.preventDefault(), this.model.newSession();
        },
        newCorpus: function(e) {
            e && e.preventDefault(), this.model.newCorpus();
        },
        resizeSmall: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.app.router.showDashboard();
        },
        resizeFullscreen: function(e) {
            Utils.debug("CORPUS READ starts to render fullscreen. "), e && (e.stopPropagation(), e.preventDefault()), this.format = "fullscreen", this.render(), window.app.router.showFullscreenCorpus();
        },
        showEditable: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.appView.currentCorpusEditView && (window.appView.currentCorpusEditView.format = this.format, window.appView.currentCorpusEditView.render());
        }
    });
    return y;
}), fielddb.define("datum/DatumContainerReadView", [ "backbone", "handlebars", "datum/Datum", "datum/Datums"
, "datum/DatumReadView", "app/UpdatingCollectionView" ], function(e, t, n, r, i, s) {
    var o = e.View.extend({
        initialize: function() {
            this.datumsView = new s({
                collection: this.model,
                childViewConstructor: i,
                childViewTagName: "li",
                childViewClass: "well",
                childViewFormat: "well"
            }), app.get("authentication").get("userPrivate").get("prefs").bind("change:numVisibleDatum", this.updateDatums, this);
        },
        model: r,
        events: {
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeFullscreen",
            "click .icon-edit": "showEditable"
        },
        templateEmbedded: t.templates.datum_container_read_embedded,
        templateFullscreen: t.templates.datum_container_read_fullscreen,
        render: function() {
            this.format == "centreWell" ? (this.setElement($("#datums-embedded")), $(this.el).
html(this.templateEmbedded({})), this.datumsView.el = this.$(".datum-embedded-ul"), this.datumsView.render(), $(this.el).find(".locale_Show_fullscreen").attr("title", Locale["locale_Show_fullscreen"].message)) : this.format == "fullscreen" && (this.setElement($("#datum-container-fullscreen")), $(this.el).html(this.templateFullscreen({})), this.datumsView.el = this.$(".datum-embedded-ul"), this.datumsView.render(), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message)), $(this.el).find(".locale_Data_Entry_Area").html(Locale["locale_Data_Entry_Area"].message), $(this.el).find(".locale_Edit_Datum").attr("title", Locale["locale_Edit_Datum"].message);
        },
        resizeSmall: function() {
            window.app.router.showDashboard();
        },
        resizeFullscreen: function() {
            window.app.router.showReadonlyDatums("fullscreen");
        },
        showEditable: function() {
            window
.app.router.showEditableDatums(this.format);
        },
        updateDatums: function() {
            var e = app.get("authentication").get("userPrivate").get("prefs").get("numVisibleDatum"), t = this;
            (new n({
                pouchname: app.get("corpus").get("pouchname")
            })).getAllIdsByDate(function(r) {
                if (r == null || r.length <= 0) for (var i = 0; i < t.model.length; i++) t.model.pop(); else if (e > t.model.length) {
                    for (var i = t.model.length; i < e; i++) if (r[r.length - i - 1]) {
                        var s = new n;
                        s.set(s.parse(r[r.length - i - 1].value)), t.model.add(s);
                    }
                } else if (e < t.model.length) for (var i = e; i < t.model.length; i++) t.model.pop();
            });
        }
    });
    return o;
}), fielddb.define("export/Export", [ "backbone", "data_list/DataList" ], function(e, t) {
    var n = e.Model.extend({
        initialize: function() 
{},
        defaults: {
            fields: [],
            dataList: null,
            dataListName: "",
            event: null
        },
        model: {},
        validate: function(e) {},
        exportCSV: function() {},
        exportXML: function() {},
        exportLaTex: function() {},
        saveAndInterConnectInApp: function(e) {
            typeof e == "function" && e();
        }
    });
    return n;
}), fielddb.define("export/ExportReadView", [ "backbone", "handlebars", "export/Export" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {},
        model: n,
        classname: "export",
        template: t.templates.export_read_modal,
        render: function() {
            return this.setElement($("#export-modal")), $(this.el).html(this.template(this.model.toJSON())), $(this.el).find(".locale_Export").html(Locale["locale_Export"].message), $(this.el).find(".locale_Close").html(Locale["locale_Close"].message), this;
        
}
    });
    return r;
}), fielddb.define("insert_unicode/InsertUnicodeView", [ "backbone", "handlebars", "insert_unicode/InsertUnicode" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("INSERT UNICODE VIEW init");
        },
        events: {
            "click .edit-tipa-input": function(e) {
                return e.stopPropagation(), e.preventDefault(), !1;
            },
            "click .remove-unicode": "removeUnicode",
            "keyup .edit-tipa-input": function(e) {
                e.stopPropagation(), e.preventDefault(), this.model.set("tipa", $(e.target).val());
            }
        },
        model: n,
        template: t.templates.insert_unicode,
        tagName: "span",
        render: function() {
            return Utils.debug("INSERT UNICODE render"), $(this.el).html(this.template(this.model.toJSON())), $(this.el).find(".locale_LaTeX_Code").html(Locale["locale_LaTeX_Code"].message), $(this.el).find
(".locale_Unicode_Instructions").html(Locale["locale_Unicode_Instructions"].message), $(this.el).find(".locale_Keyboard_Shortcuts").html(Locale["locale_Keyboard_Shortcuts"].message), $(this.el).find(".locale_Remove_Unicode").html(Locale["locale_Remove_Unicode"].message), this;
        },
        removeUnicode: function(e) {
            e.stopPropagation(), e.preventDefault(), window.app.get("authentication").get("userPrivate").get("prefs").get("unicodes").remove(this.model);
        }
    });
    return r;
}), fielddb.define("insert_unicode/InsertUnicodesView", [ "backbone", "handlebars", "insert_unicode/InsertUnicode", "insert_unicode/InsertUnicodeView", "app/UpdatingCollectionView" ], function(e, t, n, r, i) {
    var s = e.View.extend({
        initialize: function() {
            this.changeViewsOfInternalModels();
        },
        changeViewsOfInternalModels: function() {
            this.insertUnicodesView = new i({
                collection: this.model,
                
childViewConstructor: r,
                childViewTagName: "span"
            });
        },
        events: {
            "click .add-unicode": "insertNewUnicodeSymbol",
            "keyup .insert-unicode-input": function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.insertNewUnicodeSymbol();
            },
            "keyup .insert-unicode-tipa-input": function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.insertNewUnicodeSymbol();
            },
            "click .icon-minus-sign": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.format = "minimized", this.render();
            },
            "click .icon-plus-sign": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.format = "rightSide", this.render();
            }
        },
        template: t.templates.insert_unicodes,
        minimizedTemplate: t.templates.insert_unicodes_minimized,
        
render: function() {
            return this.format == "rightSide" ? (this.setElement($("#insert-unicode")), $(this.el).html(this.template({})), this.insertUnicodesView.el = this.$("#unicodes"), this.insertUnicodesView.render(), $(this.el).find(".unicode-symbol").each(function(e, t) {
                this.addEventListener("dragstart", window.appView.insertUnicodesView.handleDragStart);
            }), $(this.el).find(".locale_Hide_Unicode_Palette").attr("title", Locale["locale_Hide_Unicode_Palette"].message), $(this.el).find(".locale_Paste_Type_Unicode_Symbol_Placeholder").attr("placeholder", Locale["locale_Paste_Type_Unicode_Symbol_Placeholder"].message), $(this.el).find(".locale_TIPA_shortcut").attr("placeholder", Locale["locale_TIPA_shortcut"].message), $(this.el).find(".locale_Add_new_symbol").attr("title", Locale["locale_Add_new_symbol"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message)) : this.format == "minimized" && 
(this.setElement($("#insert-unicode")), $(this.el).html(this.minimizedTemplate({})), $(this.el).find(".locale_Show_Unicode_Palette").attr("title", Locale["locale_Show_Unicode_Palette"].message)), $(this.el).find(".locale_Unicode").html(Locale["locale_Unicode"].message), $(this.el).find(".locale_Drag_and_Drop").html(Locale["locale_Drag_and_Drop"].message), this;
        },
        insertNewUnicodeSymbol: function(e) {
            e && (e.stopPropagation(), e.preventDefault());
            var t = new n({
                symbol: this.$el.find(".insert-unicode-input").val(),
                tipa: this.$el.find(".insert-unicode-tipa-input").val()
            });
            this.model.add(t), this.$el.find(".insert-unicode-input").val(""), this.$el.find(".insert-unicode-tipa-input").val("");
        },
        dragSrcEl: null,
        handleDragStart: function(e) {
            return this.classList.remove("infrequent-unicode-symbol"), e.dataTransfer.effectAllowed = "copy"
, window.appView.insertUnicodesView.dragSrcEl == null && (window.appView.insertUnicodesView.dragSrcEl = this, e.dataTransfer.setData("text/html", this.innerHTML)), !1;
        }
    });
    return s;
}), fielddb.define("user/UserPreferenceEditView", [ "backbone", "handlebars", "user/UserPreference", "libs/Utils" ], function(e, t, n) {
    var r = e.View.extend({
        initialize: function() {
            Utils.debug("USER PREFERENCE VIEW init"), this.model.bind("change:skin", this.renderSkin, this);
        },
        model: n,
        events: {
            "click .change-skin": "nextSkin",
            "change .num_datum_dropdown": "updateNumVisibleDatum",
            "click .randomize-backgound": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.model.get("alwaysRandomizeSkin") == "true" ? (this.model.set("alwaysRandomizeSkin", "false"), $(this.el).find(".randomize-backgound").removeClass("btn-success")) : (this.model.set("alwaysRandomizeSkin", "true"
), $(this.el).find(".randomize-backgound").addClass("btn-success"), this.randomSkin()), this.savePrefs();
            },
            "click .transparent-dashboard": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.model.get("transparentDashboard") == "true" ? (this.model.set("transparentDashboard", "false"), $(this.el).find(".transparent-dashboard").removeClass("btn-success"), this.makeDashboardOpaque()) : (this.model.set("transparentDashboard", "true"), $(this.el).find(".transparent-dashboard").addClass("btn-success"), this.makeDashboardTransparent()), this.savePrefs();
            }
        },
        template: t.templates.user_preference_edit_modal,
        render: function() {
            return Utils.debug("USERPREFERENCE render: " + this.el), this.model != undefined && (this.setElement($("#user-preferences-modal")), $(this.el).html(this.template(this.model.toJSON())), this.$el.find(".num_datum_dropdown").val(this.model.get("numVisibleDatum")), this
.model.get("alwaysRandomizeSkin") == "true" ? ($(this.el).find(".randomize-backgound").addClass("btn-success"), this.randomSkin()) : $(this.el).find(".randomize-backgound").removeClass("btn-success"), this.model.get("transparentDashboard") == "true" ? ($(this.el).find(".transparent-dashboard").addClass("btn-success"), this.makeDashboardTransparent()) : ($(this.el).find(".transparent-dashboard").removeClass("btn-success"), this.makeDashboardOpaque()), this.model.get("skin") == "" ? this.randomSkin() : this.renderSkin()), $(this.el).find(".locale_User_Settings").html(Locale["locale_User_Settings"].message), $(this.el).find(".locale_Skin").html(Locale["locale_Skin"].message), $(this.el).find(".locale_Change_Background").html(Locale["locale_Change_Background"].message), $(this.el).find(".locale_Background_on_Random").html(Locale["locale_Background_on_Random"].message), $(this.el).find(".locale_Transparent_Dashboard").html(chrome.i18n.getMessage("locale_Transparent_Dashboard"
)), $(this.el).find(".locale_Number_Datum").html(Locale["locale_Number_Datum"].message), $(this.el).find(".locale_Close").html(Locale["locale_Close"].message), this;
        },
        currentSkin: 0,
        skins: [ "images/skins/bamboo_garden.jpg", "images/skins/llama_wool.jpg", "images/skins/yellow.jpg", "images/skins/machu_picchu.jpg", "images/skins/machu_picchu2.jpg", "images/skins/white.jpg", "images/skins/prague.jpg", "images/skins/salcantay.jpg", "images/skins/stairs.jpg", "images/skins/stone_figurines.jpg", "images/skins/temple.jpg", "images/skins/weaving.jpg", "images/skins/purple.jpg", "images/skins/sunset.jpg", "images/skins/window.jpg", "images/skins/Ceske_Krumlov.jpg", "images/skins/black.jpg", "images/skins/stbasil.jpg" ],
        nextSkin: function() {
            this.currentSkin = (this.currentSkin + 1) % this.skins.length, this.model.set("skin", this.skins[this.currentSkin]), this.savePrefs();
        },
        randomSkin: function() {
            this
.currentSkin = Math.floor(Math.random() * this.skins.length), this.model.set("skin", this.skins[this.currentSkin]);
        },
        renderSkin: function() {
            document.body.style.backgroundImage.indexOf(this.model.get("skin")) == -1 && (document.body.style.backgroundImage = "url(" + this.model.get("skin") + ")"), $(this.el).find(".user-pref-skin-filename").html(this.model.get("skin"));
        },
        updateNumVisibleDatum: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), this.model.set("numVisibleDatum", this.$el.find(".num_datum_dropdown").val()), this.savePrefs();
        },
        makeDashboardTransparent: function() {
            var e = document.getElementsByTagName("head")[0];
            if (!e) return;
            var t = document.getElementsByTagName("link").item(5), n = document.createElement("link");
            n.setAttribute("rel", "stylesheet"), n.setAttribute("type", "text/css"), n.setAttribute("href", "./app/app_transparent.css"
), e.replaceChild(n, t);
        },
        makeDashboardOpaque: function() {
            var e = document.getElementsByTagName("head")[0];
            if (!e) return;
            var t = document.getElementsByTagName("link").item(5), n = document.createElement("link");
            n.setAttribute("rel", "stylesheet"), n.setAttribute("type", "text/css"), n.setAttribute("href", "./app/app_opaque.css"), e.replaceChild(n, t);
        },
        savePrefs: function() {
            Utils.debug("Saving preferences into encrypted user."), window.app.get("authentication").saveAndInterConnectInApp();
        }
    });
    return r;
}), fielddb.define("data_list/DataListEditView", [ "backbone", "handlebars", "activity/Activity", "comment/Comment", "comment/Comments", "comment/CommentReadView", "data_list/DataList", "datum/Datum", "datum/DatumReadView", "datum/Datums", "app/UpdatingCollectionView" ], function(e, t, n, r, i, s, o, u, a, f, l) {
    var c = e.View.extend({
        initialize: function(
) {
            Utils.debug("DATALIST EDIT VIEW init: " + this.el), this.changeViewsOfInternalModels(), this.model.bind("change:dateCreated", function() {
                this.changeViewsOfInternalModels(), this.render();
            }, this), this.model.bind("change:datumIds", function() {
                this.render();
            }, this);
        },
        model: o,
        datumSelected: [],
        events: {
            "click .add-comment-datalist": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = this.$el.find(".comment-new-text").val();
                this.model.insertNewComment(t), this.$el.find(".comment-new-text").val("");
            },
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeFullscreen",
            "blur .data-list-title": "updateTitle",
            "blur .data-list-description": "updateDescription",
            "click .icon-book": "showReadonly",
            "click .save-datalist"
: "updatePouch",
            "click .save-search-datalist": "saveSearchDataList",
            "click .save-import-datalist": "saveImportDataList",
            "click .icon-minus-sign": function() {
                this.format == "search" ? this.format = "search-minimized" : this.format = "minimized", this.render();
            },
            "click .icon-plus-sign": function() {
                this.format == "search-minimized" ? this.format = "search" : this.format = "leftSide", this.render();
            },
            "click .latex-export-datalist": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal").modal("show"), $("#export-text-area").val(""), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "laTeXiT", !0), !1;
            },
            "click .icon-paste": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal").modal("show"), $("#export-text-area").val(""), this.model.
applyFunctionToAllIds(this.getAllCheckedDatums(), "exportAsPlainText", !0), !1;
            },
            "click .CSV": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), $("#export-modal").modal("show"), $("#export-text-area").val(""), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "exportAsCSV", !0), !1;
            },
            "click .icon-bullhorn": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.createPlaylistAndPlayAudioVideo(this.getAllCheckedDatums()), !1;
            },
            "click .icon-remove-sign": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.removeDatumFromThisList(this.getAllCheckedDatums()), !1;
            },
            "click .icon-lock": function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "encrypt"), !1;
            },
            "click .icon-unlock"
: function(e) {
                return e && (e.stopPropagation(), e.preventDefault()), this.model.applyFunctionToAllIds(this.getAllCheckedDatums(), "decrypt"), !1;
            },
            "click .icon-eye-open": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = app.get("corpus").get("confidential");
                t || alert("This is a bug: cannot find decryption module for your corpus.");
                var n = this;
                return t.turnOnDecryptedMode(function() {
                    n.$el.find(".icon-eye-close").toggleClass("icon-eye-close icon-eye-open"), $(n.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message);
                }), !1;
            },
            "click .icon-eye-close": function(e) {
                e && (e.stopPropagation(), e.preventDefault());
                var t = app.get("corpus").get("confidential");
                
return t || alert("This is a bug: cannot find decryption module for your corpus."), t.turnOffDecryptedMode(), this.$el.find(".icon-eye-open").toggleClass("icon-eye-close icon-eye-open"), $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), !1;
            }
        },
        templateFullscreen: t.templates.data_list_edit_embedded,
        embeddedTemplate: t.templates.data_list_edit_embedded,
        templateSummary: t.templates.data_list_summary_edit_embedded,
        searchTemplate: t.templates.data_list_search_edit_embedded,
        importTemplate: t.templates.data_list_import_edit_embedded,
        templateMinimized: t.templates.data_list_summary_read_minimized,
        render: function() {
            window.appView.currentEditDataListView && appView.currentEditDataListView.destroy_view(), appView.currentReadDataListView.destroy_view();
            var e = this.model.toJSON();
            e.datumCount = 
this.model.get("datumIds").length, e.decryptedMode = window.app.get("corpus").get("confidential").decryptedMode;
            if (this.format == "leftSide") Utils.debug("DATALIST EDIT LEFTSIDE render: " + this.el), this.setElement($("#data-list-quickview-header")), $(this.el).html(this.templateSummary(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-quickview").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Hide_Datalist").attr("title", Locale["locale_Hide_Datalist"].message), $(this.el).find(".locale_Show_Readonly").attr("title", Locale["locale_Show_Readonly"].message), $(this.el).find(".locale_Show_fullscreen").attr("title", Locale["locale_Show_fullscreen"].message), $(this.el).find(".locale_Play_Audio_checked").attr("title", Locale["locale_Play_Audio_checked"].message), $(this.el).find(".locale_Remove_checked_from_datalist_tooltip"
).attr("title", Locale["locale_Remove_checked_from_datalist_tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked").attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", Locale["locale_Encrypt_checked"].message), $(this.el).find(".locale_Decrypt_checked").attr("title", Locale["locale_Decrypt_checked"].message), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message), $(this.el)
.find(".locale_Add").html(Locale["locale_Add"].message); else if (this.format == "fullscreen") Utils.debug("DATALIST EDIT FULLSCREEN render: " + this.el), this.setElement($("#data-list-fullscreen-header")), $(this.el).html(this.templateFullscreen(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-fullscreen").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Show_Readonly").attr("title", Locale["locale_Show_Readonly"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Play_Audio_checked").attr("title", Locale["locale_Play_Audio_checked"].message), $(this.el).find(".locale_Remove_checked_from_datalist_tooltip").attr("title", Locale["locale_Remove_checked_from_datalist_tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked"
).attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", Locale["locale_Encrypt_checked"].message), $(this.el).find(".locale_Decrypt_checked").attr("title", Locale["locale_Decrypt_checked"].message), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message); else if (this.format == "centreWell") Utils.debug("DATALIST EDIT CENTER render: " + 
this.el), this.setElement($("#data-list-embedded-header")), $(this.el).html(this.embeddedTemplate(e)), window.appView.currentPaginatedDataListDatumsView.renderInElement($("#data-list-embedded").find(".current-data-list-paginated-view")), $(this.el).find(".locale_Show_Readonly").attr("title", Locale["locale_Show_Readonly"].message), $(this.el).find(".locale_Show_in_Dashboard").attr("title", Locale["locale_Show_in_Dashboard"].message), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Play_Audio_checked").attr("title", Locale["locale_Play_Audio_checked"].message), $(this.el).find(".locale_Remove_checked_from_datalist_tooltip").attr("title", Locale["locale_Remove_checked_from_datalist_tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked").attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", chrome
.i18n.getMessage("locale_Encrypt_checked")), $(this.el).find(".locale_Decrypt_checked").attr("title", Locale["locale_Decrypt_checked"].message), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message); else if (this.format == "search") Utils.debug("DATALIST EDIT SEARCH render: " + this.el), this.setElement($("#search-data-list-quickview-header")), $(this.el).html(this.searchTemplate(e)), $("#search-data-list-quickview").addClass
("well"), window.appView.searchEditView.searchPaginatedDataListDatumsView.renderInElement($("#search-data-list-quickview").find(".search-data-list-paginated-view")), $(".search-data-list-paginated-view").show(), $("#search-data-list-quickview-header").parent().find(".pagination-control").show(), $(this.el).find(".locale_Save").html(Locale["locale_Save"].message), $(this.el).find(".locale_Hide_Datalist").attr("title", Locale["locale_Hide_Datalist"].message), $(this.el).find(".locale_Play_Audio_checked").attr("title", Locale["locale_Play_Audio_checked"].message), $(this.el).find(".locale_Remove_checked_from_datalist_tooltip").attr("title", Locale["locale_Remove_checked_from_datalist_tooltip"].message), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked").attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", Locale["locale_Encrypt_checked"].message), $(this.
el).find(".locale_Decrypt_checked").attr("title", Locale["locale_Decrypt_checked"].message), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Hide_confidential_items_Tooltip"].message) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message); else if (this.format == "search-minimized") {
                Utils.debug("DATALIST EDIT SEARCH render: " + this.el), this.setElement($("#search-data-list-quickview-header")), $(this.el).html(this.templateMinimized(e));
                try {
                    $(".search-data-list-paginated-view").hide(), $("#search-data-list-quickview-header").parent().
find(".pagination-control").hide();
                } catch (t) {
                    Utils.debug("There was a problem minimizing the search datums view, probably it doesnt exist yet. ", t);
                }
                $(this.el).find(".locale_Show_Datalist").attr("title", Locale["locale_Show_Datalist"].message);
            } else this.format == "import" ? (Utils.debug("DATALIST EDIT IMPORT render: " + this.el), this.setElement($("#import-data-list-header")), $(this.el).html(this.importTemplate(e)), $(this.el).find(".locale_Plain_Text_Export_Tooltip_checked").attr("title", Locale["locale_Plain_Text_Export_Tooltip_checked"].message), $(this.el).find(".locale_Encrypt_checked").attr("title", Locale["locale_Encrypt_checked"].message), $(this.el).find(".locale_Decrypt_checked").attr("title", Locale["locale_Decrypt_checked"].message), e.decryptedMode ? $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", chrome.i18n.getMessage("locale_Hide_confidential_items_Tooltip"
)) : $(this.el).find(".locale_Show_confidential_items_Tooltip").attr("title", Locale["locale_Show_confidential_items_Tooltip"].message), $(this.el).find(".locale_Export_checked_as_LaTeX").attr("title", Locale["locale_Export_checked_as_LaTeX"].message), $(this.el).find(".locale_Export_checked_as_CSV").attr("title", Locale["locale_Export_checked_as_CSV"].message), $(this.el).find(".locale_Add").html(Locale["locale_Add"].message)) : this.format == "minimized" ? (Utils.debug("DATALIST EDIT MINIMIZED render: " + this.el), this.setElement($("#data-list-quickview-header")), $(this.el).html(this.templateMinimized(e)), $(this.el).find(".locale_Show_Datalist").attr("title", Locale["locale_Show_Datalist"].message)) : Utils.debug("Bug: no format was specified for DataListEditView, nothing was rendered");
            try {
                this.format && this.format.indexOf("minimized") == -1 && (this.commentReadView.el = this.$el.find(".comments"), this.commentReadView
.render(), $(this.el).find(".locale_Title").html(Locale["locale_Title"].message), $(this.el).find(".locale_Description").html(Locale["locale_Description"].message));
            } catch (t) {
                alert("Bug, there was a problem rendering the contents of the data list format: " + this.format);
            }
            return this;
        },
        changeViewsOfInternalModels: function() {
            this.commentReadView = new l({
                collection: this.model.get("comments"),
                childViewConstructor: s,
                childViewTagName: "li"
            });
        },
        getAllCheckedDatums: function() {
            var e = [];
            for (var t in window.appView.currentPaginatedDataListDatumsView._childViews) window.appView.currentPaginatedDataListDatumsView._childViews[t].checked == 1 && e.push(window.appView.currentPaginatedDataListDatumsView._childViews[t].model.id);
            return alert("DATA LIST EDIT VIEW datumIdsChecked " + 
JSON.stringify(e)), e;
        },
        createPlaylistAndPlayAudioVideo: function(e) {
            this.model.getAllAudioAndVideoFiles(e, function(e) {
                alert("TODO show playlist and audio player for all audio/video in datums " + JSON.stringify(e));
            });
        },
        removeDatumFromThisList: function(e) {
            if (e == this.model.get("datumIds")) return;
            try {
                this.model.set("datumIds", _.difference(this.model.get("datumIds"), [ e ])), appView.currentPaginatedDataListDatumsView.collection.remove(appView.currentPaginatedDataListDatumsView.collection.get(e[0]));
            } catch (t) {
                Utils.debug("Attemptign to remove datum(s) from the current datalist, there was something that went wrong.", t);
            }
        },
        resizeSmall: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.app.router.showDashboard();
        },
        resizeFullscreen: function(e) {
            
e && (e.stopPropagation(), e.preventDefault()), this.format = "fullscreen", this.render(), window.app.router.showFullscreenDataList();
        },
        updateTitle: function() {
            this.model.set("title", this.$el.find(".data-list-title").val()), this.model.id && window.appView.addUnsavedDoc(this.model.id);
        },
        updateDescription: function() {
            this.model.set("description", this.$el.find(".data-list-description").val()), this.model.id && window.appView.addUnsavedDoc(this.model.id);
        },
        showReadonly: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), window.appView.currentReadDataListView.format = this.format, window.appView.currentReadDataListView.render();
        },
        updatePouch: function(e) {
            e && (e.stopPropagation(), e.preventDefault());
            var t = this;
            this.model.saveAndInterConnectInApp(function() {
                window.appView.currentReadDataListView.format = t.format
, window.appView.currentReadDataListView.render();
            });
        },
        saveSearchDataList: function(e) {
            e && (e.stopPropagation(), e.preventDefault());
            var t = appView.searchEditView.searchDataListView;
            t.model.saveAndInterConnectInApp(function() {
                t.format = "search-minimized", t.render(), t.model.setAsCurrentDataList(), window.app.router.showDashboard();
            });
        },
        saveImportDataList: function(e) {
            e && (e.stopPropagation(), e.preventDefault()), alert("TODO");
        },
        destroy_view: function() {
            Utils.debug("DESTROYING DATALIST EDIT VIEW " + this.format), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return c;
}), fielddb.define("search/SearchEditView", [ "backbone", "handlebars", "data_list/DataList", "data_list/DataListEditView", "datum/Datum", "datum/Datums", "datum/DatumFieldEditView", "datum/DatumReadView", "search/Search"
, "app/UpdatingCollectionView", "app/PaginatedUpdatingCollectionView", "libs/Utils" ], function(e, t, n, r, i, s, o, u, a, f, l) {
    var c = e.View.extend({
        initialize: function() {
            Utils.debug("SEARCH init: " + this.el), this.newTempDataList(), this.changeViewsOfInternalModels(), this.model.bind("change", this.render, this);
        },
        model: a,
        events: {
            "click .btn-search-union": "searchUnion",
            "click .btn-search-intersection": "searchIntersection",
            "click .icon-search": "searchTop",
            "click .icon-resize-small": "resizeSmall",
            "click .icon-resize-full": "resizeFullscreen"
        },
        embeddedTemplate: t.templates.search_advanced_edit_embedded,
        fullscreenTemplate: t.templates.search_advanced_edit_embedded,
        topTemplate: t.templates.search_top,
        render: function() {
            return Utils.debug("SEARCH render: " + this.el), this.changeViewsOfInternalModels(), 
this.format == "fullscreen" ? (this.setElement($("#search-fullscreen")), $(this.el).html(this.fullscreenTemplate(this.model.toJSON()))) : this.format == "centreWell" && (this.setElement($("#search-embedded")), $(this.el).html(this.embeddedTemplate(this.model.toJSON()))), $(this.el).find(".locale_Advanced_Search").html(Locale["locale_Advanced_Search"].message), $(this.el).find(".locale_advanced_search_explaination").html(Locale["locale_advanced_search_explaination"].message), $(this.el).find(".locale_AND").html(Locale["locale_AND"].message), $(this.el).find(".locale_OR").html(Locale["locale_OR"].message), this.advancedSearchDatumView.el = this.$(".advanced_search_datum"), this.advancedSearchDatumView.render(), this.advancedSearchSessionView.el = this.$(".advanced_search_session"), this.advancedSearchSessionView.render(), $("#search-top").html(this.topTemplate(this.model.toJSON())), $("#search-top").find(".locale_Search_Tooltip").attr("title", chrome.i18n.getMessage
("locale_Search")), $("#search-top").find(".locale_Advanced_Search").html(Locale["locale_Advanced_Search"].message), $("#search-top").find(".locale_Advanced_Search_Tooltip").attr("title", Locale["locale_Advanced_Search_Tooltip"].message), this;
        },
        newTempDataList: function(e) {
            if (this.searchPaginatedDataListDatumsView) {
                this.searchPaginatedDataListDatumsView.remove();
                var t = this.searchPaginatedDataListDatumsView.collection;
                while (t.length > 0) t.pop();
                delete this.searchPaginatedDataListDatumsView.collection, delete this.searchPaginatedDataListDatumsView;
            }
            this.searchPaginatedDataListDatumsView = new l({
                collection: new s,
                childViewConstructor: u,
                childViewTagName: "li",
                childViewFormat: "latex",
                childViewClass: "row span12"
            }), this.searchDataListView && (this
.searchDataListView.destroy_view(), delete this.searchDataListView.model), this.searchDataListView = new r({
                model: new n({
                    pouchname: window.app.get("corpus").get("pouchname"),
                    title: "Temporary Search Results",
                    description: "You can use search to create data lists for handouts."
                })
            }), this.searchDataListView.format = "search-minimized", typeof e == "function" && e();
        },
        changeViewsOfInternalModels: function() {
            this.advancedSearchDatumView = new f({
                collection: window.app.get("corpus").get("datumFields"),
                childViewConstructor: o,
                childViewTagName: "li",
                childViewFormat: "datum"
            }), this.advancedSearchSessionView = new f({
                collection: window.app.get("corpus").get("sessionFields"),
                childViewConstructor: o,
                childViewTagName: "li",
                
childViewFormat: "session"
            });
        },
        searchUnion: function() {
            Utils.debug("In searchUnion");
            var e = this.getQueryString("union");
            this.model.set("searchKeywords", e), this.search(e);
        },
        searchIntersection: function() {
            Utils.debug("In searchIntersection");
            var e = this.getQueryString("intersection");
            this.model.set("searchKeywords", e), this.search(e);
        },
        searchTop: function() {
            Utils.debug("Will search for " + $("#search_box").val()), this.model.set("searchKeywords", $("#search_box").val()), this.search($("#search_box").val());
        },
        getQueryString: function(e) {
            var t = this.advancedSearchDatumView.collection, n = this.advancedSearchSessionView.collection, r = [];
            t.each(function(e) {
                var t = e.get("mask");
                t && t != "" && r.push(e.get("label") + ":" + t);
            }), n.each
(function(e) {
                var t = e.get("mask");
                t && t != "" && r.push(e.get("label") + ":" + t);
            });
            var i = "";
            return e == "union" ? i = r.join(" OR ") : e == "intersection" && (i = r.join(" AND ")), Utils.debug("Searching for " + i), i;
        },
        search: function(e) {
            var t = this;
            (new i({
                pouchname: app.get("corpus").get("pouchname")
            })).searchByQueryString(e, function(e) {
                t.newTempDataList(function() {
                    t.searchDataListView.model.set("title", $("#search_box").val() + " search result"), t.searchDataListView.model.set("description", "This is the result of searching for : " + $("#search_box").val() + " in " + window.app.get("corpus").get("title") + " on " + JSON.stringify(new Date)), t.searchDataListView.format = "search", t.searchDataListView.render(), t.searchPaginatedDataListDatumsView.fillWithIds(e, i), t.searchDataListView.model
.set("datumIds", e), Utils.debug("Successfully got data back from search and put it into the temp search data list");
                });
            });
        },
        loadSample: function() {
            this.model.set({
                searchKeywords: "naya"
            });
        },
        resizeSmall: function(e) {
            e.stopPropagation && (e.stopPropagation(), e.preventDefault()), window.app.router.showEmbeddedSearch();
        },
        resizeFullscreen: function(e) {
            e.stopPropagation && (e.stopPropagation(), e.preventDefault()), window.app.router.showFullscreenSearch();
        },
        destroy_view: function() {
            Utils.debug("DESTROYING SEARCH EDIT VIEW "), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return c;
});

var util = util || {};

util.toArray = function(e) {
    return Array.prototype.slice.call(e || [], 0);
}, util.getDocHeight = function() {
    var e = document;
    return Math.max(Math.max
(e.body.scrollHeight, e.documentElement.scrollHeight), Math.max(e.body.offsetHeight, e.documentElement.offsetHeight), Math.max(e.body.clientHeight, e.documentElement.clientHeight));
};

var Terminal = Terminal || function(e) {
    function b(e) {
        this.value = this.value;
    }
    function w(e) {
        (e.ctrlKey || e.metaKey) && e.keyCode == 83 && (d.classList.toggle("flicker"), P("<div>Screen flicker: " + (d.classList.contains("flicker") ? "on" : "off") + "</div>"), e.preventDefault(), e.stopPropagation());
    }
    function E(e) {
        alert(e);
    }
    function S(e) {
        if (o.length) {
            if (e.keyCode == 38 || e.keyCode == 40) o[u] ? o[u] = this.value : a = this.value;
            e.keyCode == 38 ? (u--, u < 0 && (u = 0)) : e.keyCode == 40 && (u++, u > o.length && (u = o.length));
            if (e.keyCode == 38 || e.keyCode == 40) this.value = o[u] ? o[u] : a, this.value = this.value;
        }
    }
    function x(e) {
        if (!this.value && e.keyCode == 8
) {
            y.stop(), y.play();
            return;
        }
        if (e.keyCode == 9) e.preventDefault(); else if (e.keyCode == 13) {
            this.value && (o[o.length] = this.value, u = o.length);
            var i = this.parentNode.parentNode.cloneNode(!0);
            i.removeAttribute("id"), i.classList.add("line");
            var a = i.querySelector("input.cmdline");
            a.autofocus = !1, a.readOnly = !0, m.appendChild(i);
            if (this.value && this.value.trim()) {
                var d = this.value.split(" ").filter(function(e, t) {
                    return e;
                }), v = d[0].toLowerCase();
                d = d.splice(1);
            }
            switch (v) {
              case "3d":
                M(this), P("Hold on to your butts!"), D();
                break;
              case "cat":
                var g = d.join(" ");
                if (!g) {
                    P("usage: " + v + " filename");
                    break;
                
}
                A(v, g, function(e) {
                    P("<pre>" + e + "</pre>");
                });
                break;
              case "clear":
                M(this);
                return;
              case "date":
                P((new Date).toLocaleString());
                break;
              case "exit":
                h && D(), f != null && (l.stop(), clearInterval(f));
                break;
              case "help":
                P('<div class="ls-files">' + n.join("<br>") + "</div>"), P("<p>Add files by dragging them from your desktop.</p>");
                break;
              case "install":
                if (window.chrome && window.chrome.app) if (!window.chrome.app.isInstalled) try {
                    chrome.app.install();
                } catch (e) {
                    alert(e + "\nEnable is about:flags");
                } else P("This app is already installed.");
                break;
              case "ls":
                O(function(e) 
{
                    if (e.length) {
                        var t = T(e);
                        util.toArray(e).forEach(function(e, n) {
                            t.push('<span class="', e.isDirectory ? "folder" : "file", '">', e.name, "</span><br>");
                        }), t.push("</div>"), P(t.join(""));
                    }
                });
                break;
              case "pwd":
                P(s.fullPath);
                break;
              case "cd":
                var b = d.join(" ") || "/";
                s.getDirectory(b, {}, function(e) {
                    s = e, P("<div>" + e.fullPath + "</div>"), c && c.contentWindow.postMessage({
                        cmd: "cd",
                        data: b
                    }, location.origin);
                }, function(e) {
                    N(e, v, b);
                });
                break;
              case "mkdir":
                var w = !1, E = d.indexOf("-p");
                E != -1 && 
(d.splice(E, 1), w = !0);
                if (!d.length) {
                    P("usage: " + v + " [-p] directory<br>");
                    break;
                }
                d.forEach(function(e, t) {
                    if (w) {
                        var n = e.split("/");
                        if (n[0] == "." || n[0] == "") n = n.slice(1);
                        k(s, n);
                    } else s.getDirectory(e, {
                        create: !0,
                        exclusive: !0
                    }, function() {
                        c && c.contentWindow.postMessage({
                            cmd: "mkdir",
                            data: e
                        }, location.origin);
                    }, function(t) {
                        N(t, v, e);
                    });
                });
                break;
              case "cp":
              case "mv":
                var S = d[0], b = d[1];
                if (!S || !b) {
                    
P([ "usage: ", v, " source target<br>", "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", v, " source directory/" ].join(""));
                    break;
                }
                var x = function(e, t, n, r) {
                    var i = r || null;
                    e == "mv" ? t.moveTo(n, i) : t.copyTo(n, i);
                };
                b[b.length - 1] == "/" ? s.getDirectory(S, {}, function(e) {
                    var t = [ ".", "./", "..", "../", "/" ].indexOf(b) != -1 ? !1 : !0;
                    s.getDirectory(b, {
                        create: t
                    }, function(t) {
                        x(v, e, t);
                    }, C);
                }, function(e) {
                    s.getFile(S, {}, function(e) {
                        s.getDirectory(b, {}, function(t) {
                            x(v, e, t);
                        }, C);
                    }, C);
                }) : s.getFile(S, {}, function(e) {
                    e.getParent
(function(t) {
                        x(v, e, t, b);
                    }, C);
                }, C);
                break;
              case "open":
                var g = d.join(" ");
                if (!g) {
                    P("usage: " + v + " filename");
                    break;
                }
                L(v, g, function(e) {
                    var t = window.open(e.toURL(), "mywin");
                });
                break;
              case "init":
                p && p.postMessage({
                    cmd: "init",
                    type: type_,
                    size: size_
                });
                break;
              case "rm":
                var H = !1;
                [ "-r", "-f", "-rf", "-fr" ].forEach(function(e, t) {
                    var n = d.indexOf(e);
                    n != -1 && (d.splice(n, 1), H = !0);
                }), d.forEach(function(e, t) {
                    s.getFile(e, {}, function(t) {
                        
t.remove(function() {
                            c && c.contentWindow.postMessage({
                                cmd: "rm",
                                data: e
                            }, location.origin);
                        }, C);
                    }, function(t) {
                        H && t.code == FileError.TYPE_MISMATCH_ERR ? s.getDirectory(e, {}, function(e) {
                            e.removeRecursively(null, C);
                        }, C) : t.code == FileError.INVALID_STATE_ERR ? P(v + ": " + e + ": is a directory<br>") : C(t);
                    });
                });
                break;
              case "rmdir":
                d.forEach(function(e, t) {
                    s.getDirectory(e, {}, function(t) {
                        t.remove(function() {
                            c && c.contentWindow.postMessage({
                                cmd: "rm",
                                data: e
                            }, location.origin
);
                        }, function(t) {
                            t.code == FileError.INVALID_MODIFICATION_ERR ? P(v + ": " + e + ": Directory not empty<br>") : C(t);
                        });
                    }, function(t) {
                        N(t, v, e);
                    });
                });
                break;
              case "sudo":
                f != null && (l.stop(), clearInterval(f)), l ? l.play() : (l = new Sound(!0), l.load("magic_word.mp3", !1, function() {
                    l.play();
                })), f = setInterval(function() {
                    P("<div>YOU DIDN'T SAY THE MAGIC WORD!</div>");
                }, 100);
                break;
              case "theme":
                var B = d.join(" ");
                B ? r.indexOf(B) != -1 ? _(B) : P("Error - Unrecognized theme used") : P([ "usage: ", v, " " + r.join(",") ].join(""));
                break;
              case "version":
              case "ver":
                P(t);
                
break;
              case "wget":
                var j = d[0];
                if (!j) {
                    P([ "usage: ", v, " missing URL" ].join(""));
                    break;
                }
                j.search("^http://") == -1 && (j = "http://" + j);
                var F = new XMLHttpRequest;
                F.onload = function(e) {
                    this.status == 200 && this.readyState == 4 ? P("<textarea>" + this.response + "</textarea>") : P("ERROR: " + this.status + " " + this.statusText);
                }, F.onerror = function(e) {
                    P("ERROR: " + this.status + " " + this.statusText), P("Could not fetch " + j);
                }, F.open("GET", j, !0), F.send();
                break;
              case "who":
                P(document.title + " - By: Eric Bidelman &lt;ericbidelman@chromium.org&gt;");
                break;
              default:
                v && P(v + ": command not found");
            }
            this.value = "";
        
}
    }
    function T(e) {
        var t = e[0].name;
        util.toArray(e).forEach(function(e, n) {
            e.name.length > t.length && (t = e.name);
        });
        var n = e.length == 1 ? "height: " + e.length * 30 + "px;" : e.length <= 3 ? "height: " + e.length * 18 + "px;" : "", r = t.length * 16;
        return [ '<div class="ls-files" style="-webkit-column-width:', r, "px;", n, '">' ];
    }
    function N(e, t, n) {
        e.code == FileError.NOT_FOUND_ERR ? P(t + ": " + n + ": No such file or directory<br>") : e.code == FileError.INVALID_STATE_ERR ? P(t + ": " + n + ": Not a directory<br>") : e.code == FileError.INVALID_MODIFICATION_ERR ? P(t + ": " + n + ": File already exists<br>") : C(e);
    }
    function C(e) {
        var t = "";
        switch (e.code) {
          case FileError.QUOTA_EXCEEDED_ERR:
            t = "QUOTA_EXCEEDED_ERR";
            break;
          case FileError.NOT_FOUND_ERR:
            t = "NOT_FOUND_ERR";
            break;
          case FileError
.SECURITY_ERR:
            t = "SECURITY_ERR";
            break;
          case FileError.INVALID_MODIFICATION_ERR:
            t = "INVALID_MODIFICATION_ERR";
            break;
          case FileError.INVALID_STATE_ERR:
            t = "INVALID_STATE_ERR";
            break;
          default:
            t = "Unknown Error";
        }
        P("<div>Error: " + t + "</div>");
    }
    function k(e, t, n) {
        var r = n || C;
        e.getDirectory(t[0], {
            create: !0
        }, function(e) {
            t.length && k(e, t.slice(1));
        }, r);
    }
    function L(e, t, n) {
        if (!i) return;
        s.getFile(t, {}, n, function(n) {
            n.code == FileError.NOT_FOUND_ERR && P(e + ": " + t + ": No such file or directory<br>");
        });
    }
    function A(e, t, n) {
        if (!i) return;
        s.getFile(t, {}, function(e) {
            e.file(function(e) {
                var t = new FileReader;
                t.onloadend = function(e) {
                    
n(this.result);
                }, t.readAsText(e);
            }, C);
        }, function(n) {
            n.code == FileError.INVALID_STATE_ERR ? P(e + ": " + t + ": is a directory<br>") : n.code == FileError.NOT_FOUND_ERR && P(e + ": " + t + ": No such file or directory<br>");
        });
    }
    function O(e) {
        if (!i) return;
        var t = [], n = s.createReader(), r = function() {
            n.readEntries(function(n) {
                n.length ? (t = t.concat(util.toArray(n)), r()) : (t = t.sort(), e(t));
            }, C);
        };
        r();
    }
    function M(e) {
        m.innerHTML = "", e.value = "", document.documentElement.style.height = "100%", g.style.height = "100%";
    }
    function _(e) {
        var t = document.location.pathname;
        if (!e || e == "default") {
            localStorage.removeItem("theme"), document.body.className = "";
            return;
        }
        e && (document.body.classList.add(e), localStorage.theme = e);
    }
    
function D() {
        var e = document.body;
        e.classList.toggle("offscreen"), h = !h;
        if (e.classList.contains("offscreen")) {
            d.style.webkitTransform = "translateY(" + (util.getDocHeight() - 175) + "px)";
            var t = function(n) {
                var r = document.createElement("iframe");
                r.id = "fsn", r.src = "../fsn/fsn_proto.html", c = e.insertBefore(r, e.firstElementChild), r.contentWindow.onload = function() {
                    p.postMessage({
                        cmd: "read",
                        type: type_,
                        size: size_
                    });
                }, d.removeEventListener("webkitTransitionEnd", t, !1);
            };
            d.addEventListener("webkitTransitionEnd", t, !1);
        } else d.style.webkitTransform = "translateY(0)", e.removeChild(c), c = null;
    }
    function P(e) {
        m.insertAdjacentHTML("beforeEnd", e), v.scrollIntoView();
    }
    window.URL = window.URL || 
window.webkitURL, window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
    var t = "1.9.0";
    const n = [ "3d", "cat", "cd", "cp", "clear", "date", "help", "install", "ls", "mkdir", "mv", "open", "pwd", "rm", "rmdir", "theme", "version", "who", "wget" ], r = [ "default", "cream" ];
    var i = null, s = null, o = [], u = 0, a = 0, f = null, l = null, c = null, h = !1, p = new Worker("libs/terminal/worker.js");
    p.onmessage = function(e) {
        var t = e.data;
        t.entries && c.contentWindow.postMessage({
            cmd: "build",
            data: t.entries
        }, window.location.origin), t.msg && P("<div>" + t.msg + "</div>");
    }, p.onerror = function(e) {
        console.log(e);
    };
    var d = document.getElementById(e);
    d.insertAdjacentHTML("beforeEnd", [ "<output></output>", '<div id="input-line" class="input-line">', '<div class="prompt">$&gt;</div><div><input class="cmdline" autofocus /></div>', "</div>" ].join(""));
    
var v = d.querySelector("#input-line .cmdline"), m = d.querySelector("output"), g = document.querySelector(".interlace"), y = new Sound(!1);
    return y.load("libs/terminal/beep.mp3", !1), m.addEventListener("DOMSubtreeModified", function(e) {
        var t = util.getDocHeight();
        document.documentElement.style.height = t + "px", setTimeout(function() {
            v.scrollIntoView();
        }, 0);
    }, !1), m.addEventListener("click", function(e) {
        var t = e.target;
        if (t.classList.contains("file") || t.classList.contains("folder")) v.value += " " + t.textContent;
    }, !1), v.addEventListener("click", b, !1), v.addEventListener("keydown", w, !1), v.addEventListener("keyup", S, !1), v.addEventListener("keydown", x, !1), {
        initFS: function(e, n) {
            P("<div>Welcome to " + document.title + ' Power User Backend! (v<span class="fielddb-version">' + t + "</span>)</div>"), P((new Date).toLocaleString()), P("<p>You can use this terminal to modify and rename files in your LingSync's file system. To see the command list which you can run here: type 'help'</p><p> If you like to do more than rename files (ie more power user things), you can use the Chrome Browser's built in Console to run batch opperations on your data, use regular expressions and more (this is why we wrote the app in Javascript, to encourage general 'hackability' :). We will write some tutorials eventually on what is possible using the commandline (and of course, what we have blocked due to security risk to encrypted confidential data). To access the Chrome Browsers Console: <ul><li>Mac: \u2325\u2318J (Command - Option - J) to open Developer Tools and bring focus to the Console.</li><li>Linux/Windows: Control - Shift - J to open Developer Tools and bring focus to the Console.</li><li>Android: let us know if you figure it out</li><li>iPad/iPhone: let us know if you figure it out</li></ul></p>"
);
            if (!window.requestFileSystem) {
                P("<div>Sorry! The FileSystem APIs are not available in your browser.</div>");
                return;
            }
            var r = e ? window.PERSISTENT : window.TEMPORARY;
            window.requestFileSystem(r, n, function(e) {
                i = e, s = i.root, type_ = r, size_ = n, s.getDirectory("testquotaforfsfolder", {
                    create: !0
                }, function(e) {
                    e.remove(function() {});
                }, function(e) {
                    e.code == FileError.QUOTA_EXCEEDED_ERR ? (P("ERROR: Write access to the FileSystem is unavailable.<br>"), P('Type "install" or run Chrome with the --unlimited-quota-for-files flag.')) : C(e);
                });
            }, C);
        },
        output: P,
        setTheme: _,
        getCmdLine: function() {
            return v;
        },
        addDroppedFiles: function(e) {
            util.toArray(e).forEach(function(e, t) {
                
s.getFile(e.name, {
                    create: !0,
                    exclusive: !0
                }, function(t) {
                    c && c.contentWindow.postMessage({
                        cmd: "touch",
                        data: e.name
                    }, location.origin), t.createWriter(function(t) {
                        t.write(e);
                    }, C);
                }, C);
            });
        },
        toggle3DView: D,
        selectFile: E
    };
};

fielddb.define("terminal", [ "bootstrap", "jquery" ], function(e) {
    return function() {
        var t, n;
        return t || e.Terminal;
    };
}(this)), fielddb.define("app/AppViewRead", [ "backbone", "handlebars", "app/App", "app/AppRouter", "activity/ActivityFeed", "activity/ActivityFeedView", "authentication/Authentication", "authentication/AuthenticationEditView", "corpus/Corpus", "corpus/CorpusMask", "corpus/CorpusReadView", "corpus/CorpusLinkView", "data_list/DataList", "data_list/DataListReadView"
, "datum/Datum", "datum/Datums", "datum/DatumContainerReadView", "datum/DatumReadView", "datum/DatumFields", "export/Export", "export/ExportReadView", "insert_unicode/InsertUnicode", "insert_unicode/InsertUnicodes", "insert_unicode/InsertUnicodesView", "user/UserPreference", "user/UserPreferenceEditView", "app/PaginatedUpdatingCollectionView", "search/Search", "search/SearchEditView", "datum/Session", "datum/SessionReadView", "user/User", "user/UserReadView", "terminal", "libs/Utils" ], function(e, t, n, r, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _, D, P) {
    var H = e.View.extend({
        initialize: function() {
            Utils.debug("APPVIEW init: " + this.el), this.setUpAndAssociateViewsAndModelsWithCurrentUser(), this.setUpAndAssociateViewsAndModelsWithCurrentSession(), this.setUpAndAssociateViewsAndModelsWithCurrentDataList(), this.setUpAndAssociateViewsAndModelsWithCurrentCorpus(), this.term = new P("terminal"), this.term.initFS(!1, 1048576
);
        },
        setUpAndAssociateViewsAndModelsWithCurrentCorpus: function(e) {
            this.currentCorpusReadView && this.currentCorpusReadView.destroy_view(), this.currentCorpusReadView = new c({
                model: this.model.get("corpus")
            }), this.currentCorpusReadView.format = "leftSide", this.setUpAndAssociatePublicViewsAndModelsWithCurrentCorpusMask(new l(this.model.get("corpus").get("publicSelf"))), Utils.debug("Setting up the team activity feed."), this.model.get("currentCorpusTeamActivityFeed") || this.model.set("currentCorpusTeamActivityFeed", new s);
            try {
                if (this.model.get("currentCorpusTeamActivityFeed").get("couchConnection").pouchname.indexOf(this.model.get("corpus").get("couchConnection").pouchname == -1)) {
                    this.model.set("currentCorpusTeamActivityFeed", new s);
                    var t = JSON.parse(JSON.stringify(this.model.get("corpus").get("couchConnection")));
                    t.pouchname = 
this.model.get("corpus").get("couchConnection").pouchname + "-activity_feed", this.model.get("currentCorpusTeamActivityFeed").changePouch(t);
                }
            } catch (n) {
                Utils.debug("something wasnt set in the currentCorpusTeamActivityFeed or corpus, so cant make sure that their pouches are connected. overwriting the currentCorpusTeamActivityFeed's pouch to be sure it is conencted to the corpus", n), this.model.set("currentCorpusTeamActivityFeed", new s);
                var t = JSON.parse(JSON.stringify(this.model.get("corpus").get("couchConnection")));
                t.pouchname = this.model.get("corpus").get("couchConnection").pouchname + "-activity_feed", this.model.get("currentCorpusTeamActivityFeed").changePouch(t);
            }
            this.activityFeedCorpusTeamView && this.activityFeedCorpusTeamView.destroy_view(), this.activityFeedCorpusTeamView = new o({
                model: this.model.get("currentCorpusTeamActivityFeed")
            })
, this.activityFeedCorpusTeamView.format = "rightSideCorpusTeam", this.exportView = new E({
                model: new w
            }), this.searchEditView && this.searchEditView.destroy_view(), this.searchEditView = new A({
                model: this.model.get("search")
            }), this.searchEditView.format = "centreWell";
            var r = new m;
            this.datumsReadView = new g({
                model: r
            }), typeof e == "function" && e();
        },
        setUpAndAssociatePublicViewsAndModelsWithCurrentCorpusMask: function(e, t) {
            this.publicCorpusReadEmbeddedView = new h({
                model: e
            });
        },
        setUpAndAssociateViewsAndModelsWithCurrentSession: function(e) {
            this.currentSessionReadView && this.currentSessionReadView.destroy_view(), this.currentSessionReadView = new M({
                model: this.model.get("currentSession")
            }), this.currentSessionReadView.format = "leftSide", typeof 
e == "function" && e();
        },
        associateCurrentUsersInternalModelsWithTheirViews: function(e) {
            this.userPreferenceView.model = this.authView.model.get("userPrivate").get("prefs"), this.userPreferenceView.model.bind("change:skin", this.userPreferenceView.renderSkin, this.userPreferenceView), this.insertUnicodesView.model = this.authView.model.get("userPrivate").get("prefs").get("unicodes"), this.insertUnicodesView.changeViewsOfInternalModels(), this.insertUnicodesView.render(), this.modalReadUserView.changeViewsOfInternalModels(), this.modalReadUserView.render(), this.publicReadUserView.changeViewsOfInternalModels(), this.publicReadUserView.render(), typeof e == "function" && e();
        },
        setUpAndAssociateViewsAndModelsWithCurrentUser: function(e) {
            this.authView = new a({
                model: this.model.get("authentication")
            }), this.setUpAndAssociatePublicViewsAndModelsWithCurrentUserMask(this.model.get("authentication").get
("userPublic")), this.modalReadUserView = new D({
                model: this.model.get("authentication").get("userPrivate")
            }), this.modalReadUserView.format = "modal", this.modalReadUserView.changeViewsOfInternalModels(), this.userPreferenceView = new C({
                model: this.authView.model.get("userPrivate").get("prefs")
            }), Utils.debug("Setting up the user activity feed."), this.model.get("currentUserActivityFeed") || (this.model.set("currentUserActivityFeed", new s), this.model.get("currentUserActivityFeed").changePouch(window.app.get("authentication").get("userPrivate").get("activityCouchConnection"))), this.activityFeedUserView && this.activityFeedUserView.destroy_view(), this.activityFeedUserView = new o({
                model: this.model.get("currentUserActivityFeed")
            }), this.activityFeedUserView.format = "rightSideUser", this.insertUnicodesView = new T({
                model: this.authView.model.get("userPrivate").get("prefs").get("unicodes"
)
            }), this.insertUnicodesView.format = "rightSide", typeof e == "function" && e();
        },
        setUpAndAssociatePublicViewsAndModelsWithCurrentUserMask: function(e, t) {
            this.publicReadUserView = new D({
                model: e
            }), this.publicReadUserView.format = "public";
        },
        setUpAndAssociateViewsAndModelsWithCurrentDataList: function(e) {
            this.currentPaginatedDataListDatumsView && (this.currentPaginatedDataListDatumsView.remove(), this.currentPaginatedDataListDatumsView.collection.reset()), this.currentPaginatedDataListDatumsView = new k({
                collection: new m,
                childViewConstructor: y,
                childViewTagName: "li",
                childViewFormat: "latex",
                childViewClass: "row span12"
            }), this.currentPaginatedDataListDatumsView.fillWithIds(this.model.get("currentDataList").get("datumIds"), v), this.currentReadDataListView && this.currentReadDataListView
.destroy_view(), this.currentReadDataListView = new d({
                model: this.model.get("currentDataList")
            }), this.currentReadDataListView.format = "leftSide", typeof e == "function" && e();
        },
        model: n,
        events: {
            "click #quick-authentication-okay-btn": function(e) {
                window.hub.publish("quickAuthenticationClose", "no message");
            },
            "click .icon-home": function() {
                window.location.href = "#", app.router.showDashboard();
            },
            "click .save-dashboard": function() {
                window.app.saveAndInterConnectInApp();
            },
            "click .sync-everything": "replicateDatabases",
            "click .btn-advanced-search": function(e) {
                window.app.router.showEmbeddedSearch();
            },
            "click .icon-search": function(e) {
                e && (e.stopPropagation(), e.preventDefault()), this.searchEditView.searchTop();
            
},
            "keyup #search_box": function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.searchEditView.searchTop();
            }
        },
        template: t.templates.app,
        render: function() {
            return Utils.debug("APPVIEW render: " + this.el), this.model != undefined ? (Utils.debug("Destroying the appview, so we dont get double events. This is risky..."), this.currentCorpusReadView.destroy_view(), this.currentSessionReadView.destroy_view(), this.currentReadDataListView.destroy_view(), this.currentPaginatedDataListDatumsView.destroy_view(), this.searchEditView.destroy_view(), this.activityFeedUserView.destroy_view(), this.activityFeedCorpusTeamView.destroy_view(), this.destroy_view(), Utils.debug("Done Destroying the appview, so we dont get double events."), this.setElement($("#app_view")), $(this.el).html(this.template(this.model.toJSON())), this.renderReadonlyDashboardViews(), this.activityFeedUserView.render(), this.activityFeedCorpusTeamView
.render(), this.insertUnicodesView.render(), this.searchEditView.format = "centreWell", this.searchEditView.render(), Utils.getVersion(function(e) {
                window.appView.term.VERSION_ = e, $(".fielddb-version").html(e);
            }), this.exportView.render()) : alert("	App model is not defined, this is a very big bug. Refresh your browser, and let us know about this " + Utils.contactUs), this.setTotalPouchDocs(), this.setTotalBackboneDocs(), $(this.el).find(".locale_Show_Dashboard").attr("title", Locale["locale_Show_Dashboard"].message), $(this.el).find(".locale_Need_save").text(Locale["locale_Need_save"].message), $(this.el).find(".locale_Recent_Changes").text(Locale["locale_Recent_Changes"].message), $(this.el).find(".locale_Save_on_this_Computer").attr("title", Locale["locale_Save_on_this_Computer"].message), $(this.el).find(".locale_Need_sync").text(Locale["locale_Need_sync"].message), $(this.el).find(".locale_Differences_with_the_central_server"
).text(Locale["locale_Differences_with_the_central_server"].message), $(this.el).find(".locale_Sync_and_Share").attr("title", Locale["locale_Sync_and_Share"].message), $(this.el).find(".locale_View_Public_Profile_Tooltip").attr("title", Locale["locale_View_Public_Profile_Tooltip"].message), $(this.el).find(".locale_Instructions_to_show_on_dashboard").html(Locale["locale_Instructions_to_show_on_dashboard"].message), $(this.el).find(".locale_to_beta_testers").html(Locale["locale_to_beta_testers"].message), $(this.el).find(".locale_We_need_to_make_sure_its_you").html(Locale["locale_We_need_to_make_sure_its_you"].message), $(this.el).find(".locale_Password").html(Locale["locale_Password"].message), $(this.el).find(".locale_Yep_its_me").text(Locale["locale_Yep_its_me"].message), this;
        },
        renderReadonlyDashboardViews: function() {
            this.renderReadonlyCorpusViews("leftSide"), this.renderReadonlySessionViews
("leftSide"), this.renderReadonlyDataListViews("leftSide"), this.renderEditableDatumsViews("centreWell");
        },
        renderEditableCorpusViews: function(e) {},
        renderReadonlyCorpusViews: function(e) {
            this.currentCorpusReadView.format = e, this.currentCorpusReadView.render();
        },
        renderEditableSessionViews: function(e) {},
        renderReadonlySessionViews: function(e) {
            this.currentSessionReadView.format = e, this.currentSessionReadView.render();
        },
        renderEditableDatumsViews: function(e) {},
        renderReadonlyDatumsViews: function(e) {
            this.datumsReadView.format = e, this.datumsReadView.render();
        },
        renderEditableDataListViews: function(e) {},
        renderReadonlyDataListViews: function(e) {
            this.currentReadDataListView.format = e, this.currentReadDataListView.render();
        },
        renderEditableUserViews: function(e) {},
        renderReadonlyUserViews: function(
e) {
            this.publicReadUserView.render(), this.modalReadUserView.render();
        },
        renderActivityFeedViews: function() {
            this.activityFeedUserView.render(), this.activityFeedCorpusTeamView.render();
        },
        loadSample: function() {},
        replicateDatabases: function(e) {
            var t = this;
            this.model.saveAndInterConnectInApp(function() {
                t.model.get("authentication").syncUserWithServer(function() {
                    var n = t.model.get("corpus").get("couchConnection");
                    t.model.get("authentication").get("userPrivate").get("corpuses").pouchname != "default" && app.get("corpus").get("couchConnection").pouchname == "default" && (n = t.model.get("authentication").get("userPrivate").get("corpuses")[0]), t.model.get("corpus").replicateFromCorpus(n, e);
                });
            });
        },
        dragUnicodeToField: function(e) {
            Utils.debug("Recieved a drop unicode event "
), e.stopPropagation && e.stopPropagation(), e.preventDefault && e.preventDefault();
            if (window.appView.insertUnicodesView.dragSrcEl != null) return window.appView.insertUnicodesView.dragSrcEl != this && (e.target.value = e.target.value + window.appView.insertUnicodesView.dragSrcEl.innerHTML, window.appView.insertUnicodesView.dragSrcEl = null, $(this).removeClass("over")), !1;
        },
        handleDragOver: function(e) {
            return e.preventDefault && e.preventDefault(), this.className = "over", e.dataTransfer.dropEffect = "copy", !1;
        },
        totalUnsaved: [],
        totalUnsynced: [],
        totalPouchDocs: [],
        totalBackboneDocs: [],
        addUnsavedDoc: function(e) {
            if (!e) {
                alert("This is a bug: something is trying ot save an undefined item.");
                return;
            }
            this.totalUnsaved.indexOf(e) == -1 && this.totalUnsaved.push(e), $(".unsaved-changes").val(this.totalUnsaved.length)
, this.addUnsyncedDoc(e), this.addBackboneDoc(e);
        },
        addSavedDoc: function(e) {
            var t = this.totalUnsaved.indexOf(e);
            t > -1 && this.totalUnsaved.splice(t, 1), $(".unsaved-changes").val(this.totalUnsaved.length), this.addUnsyncedDoc(e), this.addBackboneDoc(e);
        },
        addUnsyncedDoc: function(e) {
            this.totalUnsynced.indexOf(e) == -1 && this.totalUnsynced.push(e), $(".unsynced-changes").val(this.totalUnsynced.length), this.addPouchDoc(e);
        },
        allSyncedDoc: function() {
            for (i in this.totalUnsynced) this.addPouchDoc(this.totalUnsynced[i]), this.addBackboneDoc(this.totalUnsynced[i]);
            this.totalUnsynced = [], $(".unsynced-changes").val(this.totalUnsynced.length);
        },
        addPouchDoc: function(e) {
            this.totalPouchDocs.indexOf(e) == -1 && this.totalPouchDocs.push(e), this.setTotalPouchDocs();
        },
        addBackboneDoc: function(e) {
            this.totalBackboneDocs
.indexOf(e) == -1 && this.totalBackboneDocs.push(e), this.setTotalBackboneDocs();
        },
        setTotalPouchDocs: function() {
            $(".unsynced-changes").attr("max", this.totalPouchDocs.length), $(".unsynced-changes").val(this.totalUnsynced.length);
        },
        setTotalBackboneDocs: function() {
            $(".unsaved-changes").attr("max", this.totalBackboneDocs.length), $(".unsaved-changes").val(this.totalUnsaved.length);
        },
        toastSavingDatumsCount: 0,
        toastUser: function(e, t, n) {
            if (e.indexOf("Automatically saving visible datum entries every 10 seconds") != -1) return;
            if (e.indexOf("Sucessfully saved") != -1) return;
            t || (t = ""), n || (n = Locale["locale_Warning"].message), $("#toast-user-area").append("<div class='alert " + t + " alert-block'>" + "<a class='close' data-dismiss='alert' href='#'>\u00d7</a>" + "<strong class='alert-heading'>" + n + "</strong> " + e + "</div>");
        },
        
destroy_view: function() {
            Utils.debug("DESTROYING APP VIEW "), this.undelegateEvents(), $(this.el).removeData().unbind();
        }
    });
    return H;
}), fielddb.define("user/UserWelcomeView", [ "backbone", "handlebars", "activity/Activity", "activity/ActivityFeed", "app/App", "authentication/Authentication", "corpus/Corpus", "data_list/DataList", "data_list/DataLists", "datum/Datum", "datum/DatumFields", "datum/Session", "datum/Sessions", "user/User", "libs/Utils" ], function(e, t, n, r, i, s, o, u, f, l, c, h, p, d) {
    var v = e.View.extend({
        initialize: function() {
            Utils.debug("USER welcome init: "), this.model = new d, this.model.set("username", "yourusernamegoeshere"), this.model.bind("change", this.render, this);
        },
        model: d,
        events: {
            "click .registerusername": function(e) {
                e.target.select();
            },
            "keyup .registerusername": function(e) {
                var t = e.keyCode || 
e.which;
                t == 13 && this.$el.find(".registerusername").val().trim() != "YourNewUserNameGoesHere" && (this.model.set("username", $(".registerusername").val().trim()), $(".confirm-password").show(), $(".registerpassword").focus());
            },
            "click .new-user-button": function() {
                this.model.set("username", $(".registerusername").val().trim()), $(".confirm-password").show(), $(".registerpassword").focus();
            },
            "click .register-new-user": "registerNewUser",
            "keyup .registeruseremail": function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.registerNewUser();
            },
            "click .register-twitter": function() {
                window.location.href = Utils.authUrl + "/auth/twitter";
            },
            "click .register-facebook": function() {
                window.location.href = Utils.authUrl + "/auth/facebook";
            },
            "click .sync-lingllama-data"
: function() {
                console.log("hiding user welcome, syncing lingllama"), this.syncUser("lingllama", "phoneme", Utils.authUrl);
            },
            "click .sync-my-data": function() {
                this.syncUser($(".welcomeusername").val().trim(), $(".welcomepassword").val().trim(), $(".welcomeauthurl").val().trim());
            },
            "click .welcomeusername": function(e) {
                return !1;
            },
            "click .welcomepassword": function(e) {
                return !1;
            },
            "keyup .welcomepassword": function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.syncUser($(".welcomeusername").val().trim(), $(".welcomepassword").val().trim(), $(".welcomeauthurl").val().trim());
            }
        },
        template: t.templates.user_welcome_modal,
        render: function() {
            Utils.debug("USER render: ");
            if (this.model != undefined) {
                this.model.set
("username", this.model.get("username").toLowerCase().replace(/[^0-9a-z]/g, "")), this.setElement($("#user-welcome-modal")), $(this.el).html(this.template(this.model.toJSON())), $(".registerusername").focus(), $(this.el).find(".locale_Close_and_login_as_LingLlama").html(Locale["locale_Close_and_login_as_LingLlama"].message), $(this.el).find(".locale_Close_and_login_as_LingLlama_Tooltip").attr("title", Locale["locale_Close_and_login_as_LingLlama_Tooltip"].message), $(this.el).find(".locale_Log_In").html(Locale["locale_Log_In"].message), $(this.el).find(".locale_Username").html(Locale["locale_Username"].message), $(this.el).find(".locale_Password").html(Locale["locale_Password"].message), $(this.el).find(".locale_Sync_my_data_to_this_computer").html(Locale["locale_Sync_my_data_to_this_computer"].message), $(this.el).find(".locale_An_offline_online_fieldlinguistics_database").html(chrome.i18n.getMessage("locale_An_offline_online_fieldlinguistics_database"
)), $(this.el).find(".locale_Create_a_new_user").html(Locale["locale_Create_a_new_user"].message), $(this.el).find(".locale_New_User").text(Locale["locale_New_User"].message), $(this.el).find(".locale_Confirm_Password").text(Locale["locale_Confirm_Password"].message), $(this.el).find(".locale_Sign_in_with_password").text(Locale["locale_Sign_in_with_password"].message);
                var e = this;
                Utils.getVersion(function(t) {
                    e.appVersion = t, $(e.el).find(".welcome_version_number").html("v" + t);
                }), $(this.el).find(".welcomeauthurl").val(Utils.authUrl);
            } else Utils.debug("User model was undefined");
            return this;
        },
        registerNewUser: function() {
            $(".register-new-user").addClass("disabled"), Utils.debug("Attempting to register a new user: ");
            var e = {};
            $(".registerusername").val($(".registerusername").val().trim().toLowerCase
().replace(/[^0-9a-z]/g, "")), e.email = $(".registeruseremail").val().trim(), e.username = $(".registerusername").val().trim().toLowerCase().replace(/[^0-9a-z]/g, ""), e.password = $(".registerpassword").val().trim(), e.authUrl = Utils.authUrl, e.appVersionWhenCreated = this.appVersion;
            var t = Utils.defaultCouchConnection();
            t.pouchname = "firstcorpus", e.corpuses = [ t ];
            var n = Utils.defaultCouchConnection();
            n.pouchname = e.username + "-activity_feed", e.activityCouchConnection = n, e.gravatar = "./../user/user_gravatar.png";
            if (e.username != "" && e.password == $(".to-confirm-password").val().trim() && e.email != "") {
                Utils.debug("User has entered an email and the passwords match. ");
                var s = new i;
                window.app = s, s.createAppBackboneObjects($(".registerusername").val().trim() + "-firstcorpus"), $(".welcome-screen-alerts").html("<p><strong>Please wait:</strong> Contacting the server to prepare your first corpus/database for you...</p> <progress max='100'> <strong>Progress: working...</strong>"
), $(".welcome-screen-alerts").addClass("alert-success"), $(".welcome-screen-alerts").show(), $(".welcome-screen-alerts").removeClass("alert-error"), $(".register-new-user").addClass("disabled"), $(".register-new-user").attr("disabed", "disabled"), $.ajax({
                    type: "POST",
                    url: Utils.authUrl + "/register",
                    data: e,
                    success: function(e) {
                        if (e.errors != null) $(".welcome-screen-alerts").html(e.errors.join("<br/>") + " " + Utils.contactUs), $(".welcome-screen-alerts").show(); else if (e.user) {
                            var t = s.get("authentication");
                            t.saveServerResponseToUser(e, function() {
                                var n = s.get("corpus");
                                n.set({
                                    title: e.user.username + "'s Corpus",
                                    dataLists: new f,
                                    sessions
: new p,
                                    team: t.get("userPublic"),
                                    couchConnection: e.user.corpuses[0],
                                    pouchname: e.user.corpuses[0].pouchname
                                }), s.set("currentCorpusTeamActivityFeed", new r);
                                var i = JSON.parse(JSON.stringify(e.user.corpuses[0]));
                                i.pouchname = e.user.corpuses[0].pouchname + "-activity_feed", s.get("currentCorpusTeamActivityFeed").changePouch(i), s.set("currentUserActivityFeed", new r), s.get("currentUserActivityFeed").changePouch(e.user.activityCouchConnection), n.saveAndInterConnectInApp();
                            });
                        }
                    },
                    dataType: ""
                });
            } else Utils.debug("User has not entered good info. "), $(".welcome-screen-alerts").html("Your passwords don't seem to match. " + Utils.contactUs), $(".welcome-screen-alerts"
).show(), $(".register-new-user").removeClass("disabled");
        },
        syncUser: function(e, t, n) {
            console.log("hiding user welcome, syncing users data");
            var r = new d({
                username: e,
                password: t,
                authUrl: n
            });
            a = new i, window.app = a, $(".welcome-screen-alerts").html("<p><strong>Please wait:</strong> Contacting the server...</p> <progress max='100'> <strong>Progress: working...</strong>"), $(".welcome-screen-alerts").addClass("alert-success"), $(".welcome-screen-alerts").show(), $(".welcome-screen-alerts").removeClass("alert-error");
            var s = a.get("authentication");
            s.authenticate(r, function(n, r) {
                n == null ? ($(".welcome-screen-alerts").html(r.join("<br/>") + " " + Utils.contactUs), $(".welcome-screen-alerts").show(), $(".welcome-screen-alerts").addClass("alert-error")) : ($(".welcome-screen-alerts").html("Attempting to sync your data to this tablet/laptop...</p> <progress max='100'> <strong>Progress: working...</strong>"
), $(".welcome-screen-alerts").addClass("alert-success"), $(".welcome-screen-alerts").removeClass("alert-error"), $(".welcome-screen-alerts").show(), a.createAppBackboneObjects(s.get("userPrivate").get("corpuses")[0].pouchname, function() {
                    var n = s.get("userPrivate").get("corpuses")[0];
                    window.app.get("corpus").logUserIntoTheirCorpusServer(n, e, t, function() {
                        window.app.get("corpus").replicateFromCorpus(n, function() {
                            document.location.href = "corpus.html";
                        });
                    }, function(e) {
                        $(".welcome-screen-alerts").html(e + " " + Utils.contactUs), $(".welcome-screen-alerts").show(), $(".welcome-screen-alerts").addClass("alert-error");
                    });
                }));
            }, function(e) {
                $(".welcome-screen-alerts").html(e + " Something went wrong, thats all we know. Please try again or report this to us if it does it again:  " + 
Utils.contactUs), $(".welcome-screen-alerts").show(), $(".welcome-screen-alerts").addClass("alert-error");
            });
        }
    });
    return v;
}), function() {
    function expandTree2(e, t, n, r) {
        t = t.slice(0), t.push(r[0]), r[1].length || e.push({
            pos: n,
            ids: t
        }), r[1].forEach(function(r) {
            expandTree2(e, t, n, r);
        });
    }
    function rootToLeaf(e) {
        var t = [];
        return e.forEach(function(e) {
            expandTree2(t, [], e.pos, e.ids);
        }), t;
    }
    function parseUri(e) {
        var t = parseUri.options, n = t.parser[t.strictMode ? "strict" : "loose"].exec(e), r = {}, i = 14;
        while (i--) r[t.key[i]] = n[i] || "";
        return r[t.q.name] = {}, r[t.key[12]].replace(t.q.parser, function(e, n, i) {
            n && (r[t.q.name][n] = i);
        }), r;
    }
    function getHost(e) {
        if (/http:/.test(e) || /https:/.test(e)) {
            var t = parseUri(e);
            
t.remote = !0, t.auth = {
                username: t.user,
                password: t.password
            };
            var n = t.path.replace(/(^\/|\/$)/g, "").split("/");
            return t.db = n.pop(), t.path = n.join("/"), t;
        }
        return {
            host: "",
            path: "/",
            db: e,
            auth: !1
        };
    }
    function genUrl(e, t) {
        if (e.remote) {
            var n = e.path ? "/" : "";
            return e.protocol + "://" + e.host + ":" + e.port + "/" + e.path + n + e.db + "/" + t;
        }
        return "/" + e.db + "/" + t;
    }
    function ajax(e, t) {
        var n = {
            success: function(e, n, r) {
                call(t, null, e, r);
            },
            error: function(e) {
                if (e) {
                    var n = {
                        status: e.status
                    };
                    try {
                        n = $.extend({}, n, JSON.parse(e.responseText));
                    
} catch (r) {}
                    call(t, n);
                } else call(t, !0);
            },
            headers: {
                Accept: "application/json"
            },
            dataType: "json",
            contentType: "application/json"
        };
        return e = $.extend({}, n, e), e.data && typeof e.data != "string" && (e.data = JSON.stringify(e.data)), e.auth && (e.beforeSend = function(t) {
            var n = btoa(e.auth.username + ":" + e.auth.password);
            t.setRequestHeader("Authorization", "Basic " + n);
        }), $.ajax(e);
    }
    (function() {
        var e = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");
        Math.uuid = function(t, n) {
            var r = e, i = [];
            n = n || r.length;
            if (t) for (var s = 0; s < t; s++) i[s] = r[0 | Math.random() * n]; else {
                var o;
                i[8] = i[13] = i[18] = i[23] = "-", i[14] = "4";
                for (var s = 0; s < 36; s++
) i[s] || (o = 0 | Math.random() * 16, i[s] = r[s == 19 ? o & 3 | 8 : o]);
            }
            return i.join("");
        }, Math.uuidFast = function() {
            var t = e, n = new Array(36), r = 0, i;
            for (var s = 0; s < 36; s++) s == 8 || s == 13 || s == 18 || s == 23 ? n[s] = "-" : s == 14 ? n[s] = "4" : (r <= 2 && (r = 33554432 + Math.random() * 16777216 | 0), i = r & 15, r >>= 4, n[s] = t[s == 19 ? i & 3 | 8 : i]);
            return n.join("");
        }, Math.uuidCompact = function() {
            return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(e) {
                var t = Math.random() * 16 | 0, n = e == "x" ? t : t & 3 | 8;
                return n.toString(16);
            }).toUpperCase();
        };
    })();
    var Crypto = {};
    (function() {
        Crypto.MD5 = function(e) {
            function t(e, t) {
                return e << t | e >>> 32 - t;
            }
            function n(e, t) {
                var n, r, i, 
s, o;
                return i = e & 2147483648, s = t & 2147483648, n = e & 1073741824, r = t & 1073741824, o = (e & 1073741823) + (t & 1073741823), n & r ? o ^ 2147483648 ^ i ^ s : n | r ? o & 1073741824 ? o ^ 3221225472 ^ i ^ s : o ^ 1073741824 ^ i ^ s : o ^ i ^ s;
            }
            function r(e, t, n) {
                return e & t | ~e & n;
            }
            function i(e, t, n) {
                return e & n | t & ~n;
            }
            function s(e, t, n) {
                return e ^ t ^ n;
            }
            function o(e, t, n) {
                return t ^ (e | ~n);
            }
            function u(e, i, s, o, u, a, f) {
                return e = n(e, n(n(r(i, s, o), u), f)), n(t(e, a), i);
            }
            function a(e, r, s, o, u, a, f) {
                return e = n(e, n(n(i(r, s, o), u), f)), n(t(e, a), r);
            }
            function f(e, r, i, o, u, a, f) {
                return e = n(e, n(n(s(r, i, o), u), f)), n(t(e, a), 
r);
            }
            function l(e, r, i, s, u, a, f) {
                return e = n(e, n(n(o(r, i, s), u), f)), n(t(e, a), r);
            }
            function c(e) {
                var t, n = e.length, r = n + 8, i = (r - r % 64) / 64, s = (i + 1) * 16, o = Array(s - 1), u = 0, a = 0;
                while (a < n) t = (a - a % 4) / 4, u = a % 4 * 8, o[t] = o[t] | e.charCodeAt(a) << u, a++;
                return t = (a - a % 4) / 4, u = a % 4 * 8, o[t] = o[t] | 128 << u, o[s - 2] = n << 3, o[s - 1] = n >>> 29, o;
            }
            function h(e) {
                var t = "", n = "", r, i;
                for (i = 0; i <= 3; i++) r = e >>> i * 8 & 255, n = "0" + r.toString(16), t += n.substr(n.length - 2, 2);
                return t;
            }
            var p = Array(), d, v, m, g, y, b, w, E, S, x = 7, T = 12, N = 17, C = 22, k = 5, L = 9, A = 14, O = 20, M = 4, _ = 11, D = 16, P = 23, H = 6, B = 10, j = 15, F = 21;
            p = c(e), b = 1732584193, w = 4023233417
, E = 2562383102, S = 271733878;
            for (d = 0; d < p.length; d += 16) v = b, m = w, g = E, y = S, b = u(b, w, E, S, p[d + 0], x, 3614090360), S = u(S, b, w, E, p[d + 1], T, 3905402710), E = u(E, S, b, w, p[d + 2], N, 606105819), w = u(w, E, S, b, p[d + 3], C, 3250441966), b = u(b, w, E, S, p[d + 4], x, 4118548399), S = u(S, b, w, E, p[d + 5], T, 1200080426), E = u(E, S, b, w, p[d + 6], N, 2821735955), w = u(w, E, S, b, p[d + 7], C, 4249261313), b = u(b, w, E, S, p[d + 8], x, 1770035416), S = u(S, b, w, E, p[d + 9], T, 2336552879), E = u(E, S, b, w, p[d + 10], N, 4294925233), w = u(w, E, S, b, p[d + 11], C, 2304563134), b = u(b, w, E, S, p[d + 12], x, 1804603682), S = u(S, b, w, E, p[d + 13], T, 4254626195), E = u(E, S, b, w, p[d + 14], N, 2792965006), w = u(w, E, S, b, p[d + 15], C, 1236535329), b = a(b, w, E, S, p[d + 1], k, 4129170786), S = a(S, b, w, E, p[d + 6], L, 3225465664), E = a(E, S, b, w, p[d + 11], A, 643717713), w = a(w, E, S, b, p[d + 0], O, 3921069994), b = a(b, 
w, E, S, p[d + 5], k, 3593408605), S = a(S, b, w, E, p[d + 10], L, 38016083), E = a(E, S, b, w, p[d + 15], A, 3634488961), w = a(w, E, S, b, p[d + 4], O, 3889429448), b = a(b, w, E, S, p[d + 9], k, 568446438), S = a(S, b, w, E, p[d + 14], L, 3275163606), E = a(E, S, b, w, p[d + 3], A, 4107603335), w = a(w, E, S, b, p[d + 8], O, 1163531501), b = a(b, w, E, S, p[d + 13], k, 2850285829), S = a(S, b, w, E, p[d + 2], L, 4243563512), E = a(E, S, b, w, p[d + 7], A, 1735328473), w = a(w, E, S, b, p[d + 12], O, 2368359562), b = f(b, w, E, S, p[d + 5], M, 4294588738), S = f(S, b, w, E, p[d + 8], _, 2272392833), E = f(E, S, b, w, p[d + 11], D, 1839030562), w = f(w, E, S, b, p[d + 14], P, 4259657740), b = f(b, w, E, S, p[d + 1], M, 2763975236), S = f(S, b, w, E, p[d + 4], _, 1272893353), E = f(E, S, b, w, p[d + 7], D, 4139469664), w = f(w, E, S, b, p[d + 10], P, 3200236656), b = f(b, w, E, S, p[d + 13], M, 681279174), S = f(S, b, w, E, p[d + 0], _, 3936430074), E = f(E, S, b, w, p[d + 3], D, 3572445317
), w = f(w, E, S, b, p[d + 6], P, 76029189), b = f(b, w, E, S, p[d + 9], M, 3654602809), S = f(S, b, w, E, p[d + 12], _, 3873151461), E = f(E, S, b, w, p[d + 15], D, 530742520), w = f(w, E, S, b, p[d + 2], P, 3299628645), b = l(b, w, E, S, p[d + 0], H, 4096336452), S = l(S, b, w, E, p[d + 7], B, 1126891415), E = l(E, S, b, w, p[d + 14], j, 2878612391), w = l(w, E, S, b, p[d + 5], F, 4237533241), b = l(b, w, E, S, p[d + 12], H, 1700485571), S = l(S, b, w, E, p[d + 3], B, 2399980690), E = l(E, S, b, w, p[d + 10], j, 4293915773), w = l(w, E, S, b, p[d + 1], F, 2240044497), b = l(b, w, E, S, p[d + 8], H, 1873313359), S = l(S, b, w, E, p[d + 15], B, 4264355552), E = l(E, S, b, w, p[d + 6], j, 2734768916), w = l(w, E, S, b, p[d + 13], F, 1309151649), b = l(b, w, E, S, p[d + 4], H, 4149444226), S = l(S, b, w, E, p[d + 11], B, 3174756917), E = l(E, S, b, w, p[d + 2], j, 718787259), w = l(w, E, S, b, p[d + 9], F, 3951481745), b = n(b, v), w = n(w, m), E = n(E, g), S = n(S, y);
            var I = 
h(b) + h(w) + h(E) + h(S);
            return I.toLowerCase();
        };
    })(), window.Pouch = function Pouch(e, t, n) {
        if (!(this instanceof Pouch)) return new Pouch(e, t, n);
        if (t instanceof Function || typeof t == "undefined") n = t, t = {};
        var r = Pouch.parseAdapter(t.name || e);
        t.name = r.name, t.adapter = t.adapter || r.adapter;
        if (!Pouch.adapters[r.adapter]) throw "Adapter is missing";
        if (!Pouch.adapters[r.adapter].valid()) throw "Invalid Adapter";
        var i = Pouch.adapters[r.adapter](t, n);
        for (var s in i) this[s] = i[s];
    }, Pouch.parseAdapter = function(e) {
        var t = e.match(/([a-z\-]*):\/\/(.*)/);
        if (t) {
            t[1] === "http" ? e = "http://" + t[2] : t[1] === "https" ? e = "https://" + t[2] : e = t[2];
            var n = t[1];
            if (!Pouch.adapters[n].valid()) throw "Invalid adapter";
            return {
                name: e,
                adapter: t[1]
            
};
        }
        for (var r in Pouch.adapters) if (Pouch.adapters[r].valid()) return {
            name: e,
            adapter: r
        };
        throw "No Valid Adapter.";
    }, Pouch.destroy = function(e, t) {
        var n = Pouch.parseAdapter(e);
        Pouch.adapters[n.adapter].destroy(n.name, t);
    }, Pouch.adapters = {}, Pouch.adapter = function(e, t) {
        Pouch.adapters[e] = t;
    }, Pouch.Errors = {
        MISSING_BULK_DOCS: {
            status: 400,
            error: "bad_request",
            reason: "Missing JSON list of 'docs'"
        },
        MISSING_DOC: {
            status: 404,
            error: "not_found",
            reason: "missing"
        },
        REV_CONFLICT: {
            status: 409,
            error: "conflict",
            reason: "Document update conflict"
        },
        INVALID_ID: {
            status: 400,
            error: "invalid_id",
            reason: "_id field must contain a string"
        },
        UNKNOWN_ERROR
: {
            status: 500,
            error: "unknown_error",
            reason: "Database encountered an unknown error"
        }
    }, function() {
        Pouch.collate = function(i, s) {
            var o = r(i), u = r(s);
            if (o - u !== 0) return o - u;
            if (i === null) return 0;
            if (typeof i == "number") return i - s;
            if (typeof i == "boolean") return i < s ? -1 : 1;
            if (typeof i == "string") return e(i, s);
            if (Array.isArray(i)) return n(i, s);
            if (typeof i == "object") return t(i, s);
        };
        var e = function(e, t) {
            return e === t ? 0 : e > t ? 1 : -1;
        }, t = function(e, t) {
            var n = Object.keys(e), r = Object.keys(t), i = Math.min(n.length, r.length);
            for (var s = 0; s < i; s++) {
                var o = Pouch.collate(n[s], r[s]);
                if (o !== 0) return o;
                o = Pouch.collate(e[n[s]], t[r[s]]);
                
if (o !== 0) return o;
            }
            return n.length === r.length ? 0 : n.length > r.length ? 1 : -1;
        }, n = function(e, t) {
            var n = Math.min(e.length, t.length);
            for (var r = 0; r < n; r++) {
                var i = Pouch.collate(e[r], t[r]);
                if (i !== 0) return i;
            }
            return e.length === t.length ? 0 : e.length > t.length ? 1 : -1;
        }, r = function(e) {
            var t = [ "boolean", "number", "string", "object" ];
            if (t.indexOf(typeof e) !== -1) return e === null ? 1 : t.indexOf(typeof e) + 2;
            if (Array.isArray(e)) return 4.5;
        };
    }.call(this), function() {
        function e(e) {
            var t = [ e.shift(), [] ], n = t;
            while (e.length) nleaf = [ e.shift(), [] ], n[1].push(nleaf), n = nleaf;
            return t;
        }
        function t(t, n) {
            var i = rootToLeaf(t).map(function(t) {
                var r = t.ids.slice(-n);
                
return {
                    pos: t.pos + (t.ids.length - r.length),
                    ids: e(r)
                };
            });
            return i.reduce(function(e, t, n, i) {
                return r(e, t, !0).tree;
            }, [ i.shift() ]);
        }
        function n(e, t) {
            var r = !1;
            for (var i = 0; i < t[1].length; i++) {
                e[1][0] || (r = "new_leaf", e[1][0] = t[1][i]);
                if (e[1][0].indexOf(t[1][i][0]) === -1) r = "new_branch", e[1].push(t[1][i]), e[1].sort(); else {
                    var s = n(e[1][0], t[1][i]);
                    r = s.conflicts || r, e[1][0] = s.tree;
                }
            }
            return {
                conflicts: r,
                tree: e
            };
        }
        function r(e, t, r) {
            var i = [], s = !1, o = !1, u, a;
            return e.length ? (e.forEach(function(e) {
                if (e.pos === t.pos && e.ids[0] === t.ids[0]) u = n(e.ids, t.ids)
, i.push({
                    pos: e.pos,
                    ids: u.tree
                }), s = s || u.conflicts, o = !0; else if (r !== !0) {
                    var a = e.pos < t.pos ? e : t, f = e.pos < t.pos ? t : e, l = f.pos - a.pos, c, h = a.ids;
                    while (l--) c = h[1], h = h[1][0];
                    h[0] !== f.ids[0] ? i.push(e) : (u = n(h, f.ids), c[0] = u.tree, i.push({
                        pos: a.pos,
                        ids: a.ids
                    }), s = s || u.conflicts, o = !0);
                } else i.push(e);
            }), o || i.push(t), i.sort(function(e, t) {
                return e.pos - t.pos;
            }), {
                tree: i,
                conflicts: s || "internal_node"
            }) : {
                tree: [ t ],
                conflicts: "new_leaf"
            };
        }
        this.Pouch.merge = function(e, n, i) {
            e = JSON.parse(JSON.stringify(e)), n = JSON.parse(JSON.stringify(n));
            
var s = r(e, n);
            return {
                tree: t(s.tree, i),
                conflicts: s.conflicts
            };
        };
    }.call(this), function() {
        function e(e, t, n, r, i) {
            fetchCheckpoint(e, t, function(s) {
                function h() {
                    u && a === 0 && (c.end_time = new Date, writeCheckpoint(e, t, f, function() {
                        call(r, null, c);
                    }));
                }
                var o = [], u = !1, a = 0, f = 0, l = n.continuous || !1, c = {
                    ok: !0,
                    start_time: new Date,
                    docs_read: 0,
                    docs_written: 0
                };
                if (i.cancelled) return;
                var p = {
                    continuous: l,
                    since: s,
                    onChange: function(n) {
                        f = n.seq, o.push(n), c.docs_read++, a++;
                        var r = {};
                        
r[n.id] = n.changes.map(function(e) {
                            return e.rev;
                        }), t.revsDiff(r, function(n, r) {
                            if (Object.keys(r).length === 0) {
                                a--, h();
                                return;
                            }
                            for (var i in r) r[i].missing.map(function(n) {
                                e.get(i, {
                                    revs: !0,
                                    rev: n,
                                    attachments: !0
                                }, function(e, n) {
                                    t.bulkDocs({
                                        docs: [ n ]
                                    }, {
                                        new_edits: !1
                                    }, function() {
                                        c.docs_written++, a--, h();
                                    });
                                
});
                            });
                        });
                    },
                    complete: function(e, t) {
                        u = !0, h();
                    }
                };
                n.filter && (p.filter = n.filter);
                var d = e.changes(p);
                n.continuous && (i.cancel = d.cancel);
            });
        }
        function t(e, t) {
            if (typeof e == "string") return new Pouch(e, t);
            t(null, e);
        }
        Pouch.replicate = function(n, r, i, s) {
            var o = function() {
                this.cancelled = !1, this.cancel = function() {
                    this.cancelled = !0;
                };
            }, u = new o;
            return t(n, function(n, o) {
                t(r, function(t, n) {
                    e(o, n, i, s, u);
                });
            }), u;
        };
    }.call(this);
    var call = function(e) {
        var t = Array.prototype.slice.call(arguments
, 1);
        typeof e == typeof Function && e.apply(this, t);
    }, parseDoc = function(e, t) {
        var n = null;
        if (t) {
            e._id || (e._id = Math.uuid());
            var r = Math.uuid(32, 16).toLowerCase(), i;
            if (e._rev) {
                var s = /^(\d+)-(.+)$/.exec(e._rev);
                if (!s) throw "invalid value for property '_rev'";
                e._rev_tree = [ {
                    pos: parseInt(s[1], 10),
                    ids: [ s[2], [ [ r, [] ] ] ]
                } ], i = parseInt(s[1], 10) + 1;
            } else e._rev_tree = [ {
                pos: 1,
                ids: [ r, [] ]
            } ], i = 1;
        } else {
            e._revisions && (e._rev_tree = [ {
                pos: e._revisions.start - e._revisions.ids.length + 1,
                ids: e._revisions.ids.reduce(function(e, t) {
                    return e === null ? [ t, [] ] : [ t, [ e ] ];
                }, null)
            } ]);
            if (!e.
_rev_tree) {
                var s = /^(\d+)-(.+)$/.exec(e._rev);
                i = parseInt(s[1], 10), r = s[2], e._rev_tree = [ {
                    pos: parseInt(s[1], 10),
                    ids: [ s[2], [] ]
                } ];
            }
        }
        return typeof e._id != "string" && (n = Pouch.Errors.INVALID_ID), e._id = decodeURIComponent(e._id), e._rev = [ i, r ].join("-"), n ? n : Object.keys(e).reduce(function(t, n) {
            return /^_/.test(n) && n !== "_attachments" ? t.metadata[n.slice(1)] = e[n] : t.data[n] = e[n], t;
        }, {
            metadata: {},
            data: {}
        });
    }, compareRevs = function(e, t) {
        return e.id !== t.id ? e.id < t.id ? -1 : 1 : e.deleted ^ t.deleted ? e.deleted ? -1 : 1 : e.rev_tree[0].pos === t.rev_tree[0].pos ? e.rev_tree[0].ids < t.rev_tree[0].ids ? -1 : 1 : e.rev_tree[0].start < t.rev_tree[0].start ? -1 : 1;
    }, expandTree = function(e, t, n) {
        e.push({
            rev: t + "-" + n[0],
            
status: "available"
        }), n[1].forEach(function(n) {
            expandTree(e, t + 1, n);
        });
    }, collectRevs = function(e) {
        var t = [];
        return expandTree(t, e.pos, e.ids), t;
    }, collectLeavesInner = function(e, t, n) {
        n[1].length || e.push({
            rev: t + "-" + n[0]
        }), n[1].forEach(function(n) {
            collectLeavesInner(e, t + 1, n);
        });
    }, collectLeaves = function(e) {
        var t = [];
        return e.forEach(function(e) {
            collectLeavesInner(t, e.pos, e.ids);
        }), t;
    }, collectConflicts = function(e) {
        var t = collectLeaves(e);
        return t.shift(), t.map(function(e) {
            return e.rev;
        });
    }, fetchCheckpoint = function(e, t, n) {
        var r = Crypto.MD5(e.id() + t.id());
        e.get("_local/" + r, function(e, t) {
            e && e.status === 404 ? n(0) : n(t.last_seq);
        });
    }, writeCheckpoint = function(e, t, n, r) {
        var i = 
{
            _id: "_local/" + Crypto.MD5(e.id() + t.id()),
            last_seq: n
        };
        e.get(i._id, function(t, n) {
            n && n._rev && (i._rev = n._rev), e.put(i, function(e, t) {
                r();
            });
        });
    }, arrayFirst = function(e, t) {
        for (var n = 0; n < e.length; n++) if (t(e[n], n) === !0) return e[n];
        return !1;
    }, localJSON = function() {
        return localStorage ? {
            set: function(e, t) {
                localStorage.setItem(e, JSON.stringify(t));
            },
            get: function(e, t) {
                try {
                    return localStorage.getItem(e) === null ? t : JSON.parse(localStorage.getItem(e) || "false");
                } catch (n) {
                    return t;
                }
            },
            remove: function(e) {
                localStorage.removeItem(e);
            }
        } : !1;
    }();
    parseUri.options = {
        strictMode: !1,
        key
: [ "source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor" ],
        q: {
            name: "queryKey",
            parser: /(?:^|&)([^&=]*)=?([^&]*)/g
        },
        parser: {
            strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
            loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        }
    };
    var HttpPouch = function(e, t) {
        var n = getHost(e.name), r = genUrl(n, ""), i = {};
        return ajax({
            auth: n.auth,
            type: "PUT",
            url: r
        }, function(e, s) {
            e && e.status === 401 ? ajax({
                auth: n.auth,
                type: "HEAD",
                url: r
            
}, function(e, n) {
                e ? call(t, e) : call(t, null, i);
            }) : !e || e.status === 412 ? call(t, null, i) : call(t, Pouch.Errors.UNKNOWN_ERROR);
        }), i.id = function() {
            return genUrl(n, "");
        }, i.info = function(e) {
            ajax({
                auth: n.auth,
                type: "GET",
                url: genUrl(n, "")
            }, e);
        }, i.get = function(e, t, r) {
            t instanceof Function && (r = t, t = {});
            var i = [];
            t.revs && i.push("revs=true"), t.revs_info && i.push("revs_info=true"), t.attachments && i.push("attachments=true"), t.rev && i.push("rev=" + t.rev), t.conflicts && i.push("conflicts=" + t.conflicts), i = i.join("&"), i = i === "" ? "" : "?" + i;
            var s = {
                auth: n.auth,
                type: "GET",
                url: genUrl(n, e + i)
            }, o = e.split("/");
            if (o.length > 1 && o[0] !== "_design" && o[0] !== "_local" || 
o.length > 2 && o[0] === "_design" && o[0] !== "_local") s.dataType = !1;
            ajax(s, function(e, t, n) {
                if (e) return call(r, Pouch.Errors.MISSING_DOC);
                call(r, null, t, n);
            });
        }, i.query = function(e, t, r) {
            t instanceof Function && (r = t, t = {});
            var i = [];
            typeof t.reduce != "undefined" && i.push("reduce=" + t.reduce), i = i.join("&"), i = i === "" ? "" : "?" + i;
            var s = e.split("/");
            ajax({
                auth: n.auth,
                type: "GET",
                url: genUrl(n, "_design/" + s[0] + "/_view/" + s[1] + i)
            }, r);
        }, i.remove = function(e, t, r) {
            t instanceof Function && (r = t, t = {}), ajax({
                auth: n.auth,
                type: "DELETE",
                url: genUrl(n, e._id) + "?rev=" + e._rev
            }, r);
        }, i.putAttachment = function(e, t, r, i, s) {
            ajax({
                
auth: n.auth,
                type: "PUT",
                url: genUrl(n, e) + "?rev=" + t,
                headers: {
                    "Content-Type": i
                },
                data: r
            }, s);
        }, i.put = function(e, t, r) {
            t instanceof Function && (r = t, t = {});
            var i = [];
            t && typeof t.new_edits != "undefined" && i.push("new_edits=" + t.new_edits), i = i.join("&"), i !== "" && (i = "?" + i), ajax({
                auth: n.auth,
                type: "PUT",
                url: genUrl(n, e._id) + i,
                data: e
            }, r);
        }, i.post = function(e, t, r) {
            t instanceof Function && (r = t, t = {}), ajax({
                auth: n.auth,
                type: "POST",
                url: genUrl(n, ""),
                data: e
            }, r);
        }, i.bulkDocs = function(e, t, r) {
            t instanceof Function && (r = t, t = {}), typeof t.new_edits != "undefined" && (e.new_edits = 
t.new_edits), ajax({
                auth: n.auth,
                type: "POST",
                url: genUrl(n, "_bulk_docs"),
                data: e
            }, r);
        }, i.allDocs = function(e, t) {
            e instanceof Function && (t = e, e = {});
            var r = [];
            e.conflicts && r.push("conflicts=true"), e.include_docs && r.push("include_docs=true"), e.startkey && r.push("startkey=" + encodeURIComponent(JSON.stringify(e.startkey))), e.endkey && r.push("endkey=" + encodeURIComponent(JSON.stringify(e.endkey))), r = r.join("&"), r !== "" && (r = "?" + r), ajax({
                auth: n.auth,
                type: "GET",
                url: genUrl(n, "_all_docs" + r)
            }, t);
        }, i.changes = function(e, t) {
            e instanceof Function && (e = {
                complete: e
            }), t && (e.complete = t), console.info(r + ": Start Changes Feed: continuous=" + e.continuous);
            var i = "?style=all_docs";
            if (
e.include_docs || e.filter && typeof e.filter == "function") i += "&include_docs=true";
            e.continuous && (i += "&feed=longpoll"), e.conflicts && (i += "&conflicts=true"), e.descending && (i += "&descending=true"), e.filter && typeof e.filter == "string" && (i += "&filter=" + e.filter);
            var s, o = function(t, r) {
                var o = {
                    auth: n.auth,
                    type: "GET",
                    url: genUrl(n, "_changes" + i + "&since=" + t)
                };
                if (e.aborted) return;
                s = ajax(o, function(e, t) {
                    r(t);
                });
            }, u = function(t) {
                t && t.results && t.results.forEach(function(t) {
                    var n = e.filter && typeof e.filter == "function";
                    if (e.aborted || n && !e.filter.apply(this, [ t.doc ])) return;
                    call(e.onChange, t);
                }), t && e.continuous ? o(t.last_seq, u) : 
call(e.complete, null, t);
            };
            return o(e.since || 0, u), {
                cancel: function() {
                    console.info(r + ": Cancel Changes Feed"), e.aborted = !0, s.abort();
                }
            };
        }, i.revsDiff = function(e, t, r) {
            t instanceof Function && (r = t, t = {}), ajax({
                auth: n.auth,
                type: "POST",
                url: genUrl(n, "_revs_diff"),
                data: e
            }, function(e, t) {
                call(r, null, t);
            });
        }, i.replicate = {}, i.replicate.from = function(e, t, n) {
            return t instanceof Function && (n = t, t = {}), Pouch.replicate(e, i, t, n);
        }, i.replicate.to = function(e, t, n) {
            return t instanceof Function && (n = t, t = {}), Pouch.replicate(i, e, t, n);
        }, i;
    };
    HttpPouch.destroy = function(e, t) {
        var n = getHost(e);
        ajax({
            auth: n.auth,
            type
: "DELETE",
            url: genUrl(n, "")
        }, t);
    }, HttpPouch.valid = function() {
        return !0;
    }, Pouch.adapter("http", HttpPouch), Pouch.adapter("https", HttpPouch), window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB, window.IDBCursor = window.IDBCursor || window.webkitIDBCursor, window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange, window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction, window.IDBDatabaseException = window.IDBDatabaseException || window.webkitIDBDatabaseException, IDBTransaction = IDBTransaction || {}, IDBTransaction.READ_WRITE = IDBTransaction.READ_WRITE || "readwrite", IDBTransaction.READ = IDBTransaction.READ || "readonly", IDBCursor = IDBCursor || {}, IDBCursor.NEXT = IDBCursor.NEXT || "next", IDBCursor.PREV = IDBCursor.PREV || "prev";
    var idbError = function(e) {
        return function(t) {
            var n = t.target.errorCode;
            call(e, {
                
status: 500,
                error: t.type,
                reason: Object.keys(IDBDatabaseException)[n - 1].toLowerCase()
            });
        };
    }, IdbPouch = function(opts, callback) {
        function sortByBulkSeq(e, t) {
            return e._bulk_seq - t._bulk_seq;
        }
        function winningRev(e, t) {
            return t[1].length ? winningRev(e + 1, t[1][0]) : e + "-" + t[0];
        }
        var POUCH_VERSION = 1, DOC_STORE = "document-store", BY_SEQ_STORE = "by-sequence", ATTACH_STORE = "attach-store", name = opts.name, req = indexedDB.open(name, POUCH_VERSION), update_seq = 0, api = {}, idb;
        console.info(name + ": Open Database"), req.onupgradeneeded = function(e) {
            var t = e.target.result;
            t.createObjectStore(DOC_STORE, {
                keyPath: "id"
            }).createIndex("seq", "seq", {
                unique: !0
            }), t.createObjectStore(BY_SEQ_STORE, {
                autoIncrement: !0
            }), t.createObjectStore
(ATTACH_STORE, {
                keyPath: "digest"
            });
        }, req.onsuccess = function(e) {
            idb = e.target.result, idb.onversionchange = function() {
                idb.close();
            };
            if (idb.setVersion && Number(idb.version) !== POUCH_VERSION) {
                var t = idb.setVersion(POUCH_VERSION);
                t.onsuccess = function(t) {
                    function n() {
                        req.onsuccess(e);
                    }
                    t.target.result.oncomplete = n, req.onupgradeneeded(e);
                };
                return;
            }
            api.changes(function(e, t) {
                t.results.length && (update_seq = t.results[t.results.length - 1].seq), call(callback, null, api);
            });
        }, req.onerror = idbError(callback), api.id = function() {
            var t = localJSON.get(name + "_id", null);
            return t === null && (t = Math.uuid(), localJSON.set(name + "_id", 
t)), t;
        }, api.bulkDocs = function(t, n, r) {
            function c(e) {
                var t = e.target.result;
                if (!t) return a.forEach(v);
                var n = a.shift();
                t.key === n.metadata.id ? d(t, t.value, n) : v(n);
            }
            function h(e) {
                var t = [];
                u.sort(sortByBulkSeq), u.forEach(function(e) {
                    delete e._bulk_seq;
                    if (e.error) {
                        t.push(e);
                        return;
                    }
                    var n = e.metadata, r = winningRev(n.rev_tree[0].pos, n.rev_tree[0].ids);
                    t.push({
                        ok: !0,
                        id: n.id,
                        rev: r
                    });
                    if (/_local/.test(n.id)) return;
                    var i = {
                        id: n.id,
                        seq: n.seq,
                        changes: collectLeaves
(n.rev_tree),
                        doc: e.data
                    };
                    i.doc._rev = r, update_seq++, IdbPouch.Changes.emitChange(name, i);
                }), call(r, null, t);
            }
            function p(e, t) {
                for (var n in e.data._attachments) if (!e.data._attachments[n].stub) {
                    var r = e.data._attachments[n].data, i = "md5-" + Crypto.MD5(r);
                    delete e.data._attachments[n].data, e.data._attachments[n].digest = i, g(i, r);
                }
                e.data._id = e.metadata.id, e.metadata.deleted && (e.data._deleted = !0);
                var s = f.objectStore(BY_SEQ_STORE).put(e.data);
                s.onsuccess = function(n) {
                    console.info(name + ": Wrote Document ", e.metadata.id), e.metadata.seq = n.target.result, delete e.metadata.rev;
                    var r = f.objectStore(DOC_STORE).put(e.metadata);
                    r.onsuccess = function() {
                        
u.push(e), call(t);
                    };
                };
            }
            function d(e, t, n) {
                var r = Pouch.merge(t.rev_tree, n.metadata.rev_tree[0], 1e3), s = t.deleted && n.metadata.deleted || !t.deleted && i && r.conflicts !== "new_leaf";
                if (s) return u.push(m(Pouch.Errors.REV_CONFLICT, n._bulk_seq)), e["continue"]();
                n.metadata.rev_tree = r.tree, p(n, function() {
                    e["continue"]();
                });
            }
            function v(e) {
                if (e.metadata.deleted) return u.push(Pouch.Errors.MISSING_DOC);
                p(e);
            }
            function m(e, t) {
                return e._bulk_seq = t, e;
            }
            function g(e, t) {
                f.objectStore(ATTACH_STORE).put({
                    digest: e,
                    body: t
                });
            }
            n instanceof Function && (r = n, n = {}), n || (n = {});
            if (!t
.docs) return call(r, Pouch.Errors.MISSING_BULK_DOCS);
            var i = "new_edits" in n ? n.new_edits : !0, s = JSON.parse(JSON.stringify(t.docs)), o = s.map(function(e, t) {
                var n = parseDoc(e, i);
                return n._bulk_seq = t, n;
            }), u = [], a = [];
            o.forEach(function(e) {
                if (e.error) return u.push(e);
                if (!a.length || e.metadata.id !== a[0].metadata.id) return a.unshift(e);
                u.push(m(Pouch.Errors.REV_CONFLICT, e._bulk_seq));
            });
            if (!a.length) return h();
            a.sort(function(e, t) {
                return Pouch.collate(e.metadata.id, t.metadata.id);
            });
            var f = idb.transaction([ DOC_STORE, BY_SEQ_STORE, ATTACH_STORE ], IDBTransaction.READ_WRITE);
            f.onerror = idbError(r), f.ontimeout = idbError(r), f.oncomplete = h;
            var l = IDBKeyRange.bound(a[0].metadata.id, a[a.length - 1].metadata.id, !1, !1);
            
f.objectStore(DOC_STORE).openCursor(l, IDBCursor.NEXT).onsuccess = c;
        }, api.get = function(t, n, r) {
            n instanceof Function && (r = n, n = {});
            var i = idb.transaction([ DOC_STORE, BY_SEQ_STORE, ATTACH_STORE ], IDBTransaction.READ);
            if (/\//.test(t) && !/^_local/.test(t) && !/^_design/.test(t)) {
                var s = t.split("/")[0], o = t.split("/")[1];
                i.objectStore(DOC_STORE).get(s).onsuccess = function(e) {
                    var t = e.target.result, n = i.objectStore(BY_SEQ_STORE);
                    n.get(t.seq).onsuccess = function(e) {
                        var t = e.target.result._attachments[o].digest;
                        i.objectStore(ATTACH_STORE).get(t).onsuccess = function(e) {
                            call(r, null, atob(e.target.result.body));
                        };
                    };
                };
                return;
            }
            i.objectStore(DOC_STORE).get(t).onsuccess = 
function(e) {
                var t = e.target.result;
                if (!e.target.result || t.deleted) return call(r, Pouch.Errors.MISSING_DOC);
                i.objectStore(BY_SEQ_STORE).get(t.seq).onsuccess = function(e) {
                    var i = e.target.result;
                    i._id = t.id, i._rev = winningRev(t.rev_tree[0].pos, t.rev_tree[0].ids);
                    if (n.revs) {
                        var s = arrayFirst(rootToLeaf(t.rev_tree), function(e) {
                            return e.ids.indexOf(i._rev.split("-")[1]) !== -1;
                        });
                        s.ids.reverse(), i._revisions = {
                            start: s.pos + s.ids.length - 1,
                            ids: s.ids
                        };
                    }
                    n.revs_info && (i._revs_info = t.rev_tree.reduce(function(e, t) {
                        return e.concat(collectRevs(t));
                    }, []));
                    if (n.conflicts
) {
                        var o = collectConflicts(t.rev_tree);
                        o.length && (i._conflicts = o);
                    }
                    if (n.attachments && i._attachments) {
                        var u = Object.keys(i._attachments), a = 0;
                        u.forEach(function(e) {
                            api.get(i._id + "/" + e, function(t, n) {
                                i._attachments[e].data = btoa(n), ++a === u.length && r(null, i);
                            });
                        });
                    } else r(null, i);
                };
            };
        }, api.put = api.post = function(t, n, r) {
            return n instanceof Function && (r = n, n = {}), api.bulkDocs({
                docs: [ t ]
            }, n, yankError(r));
        }, api.remove = function(t, n, r) {
            n instanceof Function && (r = n, n = {});
            var i = JSON.parse(JSON.stringify(t));
            return i._deleted = !0, api.bulkDocs
({
                docs: [ i ]
            }, n, yankError(r));
        }, api.allDocs = function(t, n) {
            t instanceof Function && (n = t, t = {});
            var r = "startkey" in t ? t.startkey : !1, i = "endkey" in t ? t.endkey : !1, s = "descending" in t ? t.descending : !1;
            s = s ? IDBCursor.PREV : null;
            var o = r && i ? IDBKeyRange.bound(r, i, !1, !1) : r ? IDBKeyRange.lowerBound(r, !0) : i ? IDBKeyRange.upperBound(i) : !1, u = idb.transaction([ DOC_STORE, BY_SEQ_STORE ], IDBTransaction.READ);
            o = o || null;
            var a = u.objectStore(DOC_STORE), f = s ? a.openCursor(o, s) : a.openCursor(o), l = [];
            f.onsuccess = function(e) {
                function i(e, n) {
                    if (/_local/.test(e.id)) return r["continue"]();
                    if (e.deleted !== !0) {
                        var i = {
                            id: e.id,
                            key: e.id,
                            value
: {
                                rev: winningRev(e.rev_tree[0].pos, e.rev_tree[0].ids)
                            }
                        };
                        t.include_docs && (i.doc = n, i.doc._rev = winningRev(e.rev_tree[0].pos, e.rev_tree[0].ids), t.conflicts && (i.doc._conflicts = collectConflicts(e.rev_tree))), l.push(i);
                    }
                    r["continue"]();
                }
                if (!e.target.result) return n(null, {
                    total_rows: l.length,
                    rows: l
                });
                var r = e.target.result;
                if (!t.include_docs) i(r.value); else {
                    var s = u.objectStore(BY_SEQ_STORE);
                    s.get(r.value.seq).onsuccess = function(e) {
                        i(r.value, e.target.result);
                    };
                }
            };
        }, api.info = function(t) {
            var n = 0;
            idb.transaction([ DOC_STORE ], IDBTransaction
.READ).objectStore(DOC_STORE).openCursor().onsuccess = function(e) {
                var r = e.target.result;
                if (!r) return t(null, {
                    db_name: name,
                    doc_count: n,
                    update_seq: update_seq
                });
                r.value.deleted !== !0 && n++, r["continue"]();
            };
        }, api.putAttachment = function(t, n, r, i, s) {
            var o = t.split("/")[0], u = t.split("/")[1];
            api.get(o, {
                attachments: !0
            }, function(e, t) {
                t._attachments || (t._attachments = {}), t._attachments[u] = {
                    content_type: i,
                    data: btoa(r)
                }, api.put(t, s);
            });
        }, api.revsDiff = function(t, n, r) {
            function u(e, n, u) {
                t[u].map(function(e) {
                    var t = function(t) {
                        return t.rev !== e;
                    };
                    
if (!n || n._revs_info.every(t)) o[u] || (o[u] = {
                        missing: []
                    }), o[u].missing.push(e);
                });
                if (++s === i.length) return call(r, null, o);
            }
            n instanceof Function && (r = n, n = {});
            var i = Object.keys(t), s = 0, o = {};
            i.map(function(e) {
                api.get(e, {
                    revs_info: !0
                }, function(t, n) {
                    u(t, n, e);
                });
            });
        }, api.changes = function idb_changes(opts, callback) {
            function fetchChanges() {
                txn = idb.transaction([ DOC_STORE, BY_SEQ_STORE ]);
                var e = descending ? txn.objectStore(BY_SEQ_STORE).openCursor(IDBKeyRange.lowerBound(opts.seq, !0), descending) : txn.objectStore(BY_SEQ_STORE).openCursor(IDBKeyRange.lowerBound(opts.seq, !0));
                e.onsuccess = onsuccess, e.onerror = onerror;
            }
            
function onsuccess(e) {
                if (!e.target.result) return opts.continuous && !opts.cancelled && IdbPouch.Changes.addListener(name, id, opts), results.map(function(e) {
                    if (opts.filter && !opts.filter.apply(this, [ e.doc ])) return;
                    opts.include_docs || delete e.doc, call(opts.onChange, e);
                }), call(opts.complete, null, {
                    results: results
                });
                var t = e.target.result, n = txn.objectStore(DOC_STORE);
                n.get(t.value._id).onsuccess = function(e) {
                    var n = e.target.result;
                    if (/_local/.test(n.id)) return t["continue"]();
                    var r = {
                        id: n.id,
                        seq: t.key,
                        changes: collectLeaves(n.rev_tree),
                        doc: t.value
                    };
                    r.doc._rev = winningRev(n.rev_tree[0].pos, n.rev_tree[0].ids), n.deleted && 
(r.deleted = !0), opts.conflicts && (r.doc._conflicts = collectConflicts(n.rev_tree)), results = results.filter(function(e) {
                        return e.id !== r.id;
                    }), results.push(r), t["continue"]();
                };
            }
            function onerror(e) {
                opts.continuous && IdbPouch.Changes.addListener(name, id, opts), call(opts.complete);
            }
            opts instanceof Function && (opts = {
                complete: opts
            }), callback && (opts.complete = callback), opts.seq || (opts.seq = 0), opts.since && (opts.seq = opts.since), console.info(name + ": Start Changes Feed: continuous=" + opts.continuous);
            var descending = "descending" in opts ? opts.descending : !1;
            descending = descending ? IDBCursor.PREV : null;
            var results = [], id = name + ":" + Math.uuid(), txn;
            if (opts.filter && typeof opts.filter == "string") {
                var filterName = opts.filter
.split("/");
                api.get("_design/" + filterName[0], function(err, ddoc) {
                    var filter = eval("(function() { return " + ddoc.filters[filterName[1]] + " })()");
                    opts.filter = filter, fetchChanges();
                });
            } else fetchChanges();
            if (opts.continuous) return {
                cancel: function() {
                    console.info(name + ": Cancel Changes Feed"), opts.cancelled = !0, IdbPouch.Changes.removeListener(name, id);
                }
            };
        }, api.replicate = {}, api.replicate.from = function(t, n, r) {
            return n instanceof Function && (r = n, n = {}), Pouch.replicate(t, api, n, r);
        }, api.replicate.to = function(t, n, r) {
            return n instanceof Function && (r = n, n = {}), Pouch.replicate(api, t, n, r);
        }, api.query = function(t, n, r) {
            n instanceof Function && (r = n, n = {}), r && (n.complete = r);
            if (typeof t == "string"
) {
                var i = t.split("/");
                api.get("_design/" + i[0], function(e, t) {
                    e && call(r, e), new viewQuery({
                        map: t.views[i[1]].map,
                        reduce: t.views[i[1]].reduce
                    }, idb, n);
                });
            } else new viewQuery(t, idb, n);
        };
        var yankError = function(e) {
            return function(t, n) {
                t || n[0].error ? call(e, t || n[0]) : call(e, null, n[0]);
            };
        }, viewQuery = function(e, t, n) {
            function r(e) {
                return e.reduce(function(e, t) {
                    return e + t;
                }, 0);
            }
            function p() {
                u.sort(function(e, t) {
                    return Pouch.collate(e.key, t.key);
                }), n.descending && u.reverse();
                if (n.reduce === !1) return n.complete(null, {
                    rows: u
                })
;
                var t = [];
                u.forEach(function(e) {
                    var n = t[t.length - 1] || null;
                    if (n && Pouch.collate(n.key[0][0], e.key) === 0) {
                        n.key.push([ e.key, e.id ]), n.value.push(e.value);
                        return;
                    }
                    t.push({
                        key: [ [ e.key, e.id ] ],
                        value: [ e.value ]
                    });
                }), t.forEach(function(t) {
                    t.value = e.reduce(t.key, t.value) || null, t.key = t.key[0][0];
                }), n.complete(null, {
                    rows: t
                });
            }
            function d(t, r, i) {
                a = {
                    doc: i.target.result,
                    metadata: r
                }, a.doc._rev = winningRev(a.metadata.rev_tree[0].pos, a.metadata.rev_tree[0].ids), n.complete && !a.metadata.deleted && e.map.apply(this, [ a.doc ]), t["continue"
]();
            }
            function v(e) {
                var t = e.target.result;
                if (!t) return p();
                var r = e.target.result.value, i = s.objectStore(BY_SEQ_STORE).get(r.seq);
                i.onsuccess = d.bind(this, t, r), i.onerror = idbError(n.complete);
            }
            if (!n.complete) return;
            var s = t.transaction([ DOC_STORE, BY_SEQ_STORE ], IDBTransaction.READ), o = s.objectStore(DOC_STORE), u = [], a, f = function(e, t) {
                var r = {
                    id: a._id,
                    key: e,
                    value: t
                };
                n.include_docs && (r.doc = a.doc), u.push(r);
            }, l = {
                getAllIdsByDate: function(e) {
                    e.dateModified && f(e.dateModified, e);
                },
                searchByQueryString: function(e) {
                    if (e.datumFields && e.session) {
                        var t = {};
                        
for (i = 0; i < e.datumFields.length; i++) e.datumFields[i].mask && (t[e.datumFields[i].label] = e.datumFields[i].mask);
                        if (e.session.sessionFields) for (j = 0; j < e.session.sessionFields.length; j++) e.session.sessionFields[j].mask && (t[e.session.sessionFields[j].label] = e.session.sessionFields[j].mask);
                        f(t, e._id);
                    }
                }
            };
            for (var c in l) if (e.map.toString() == l[c].toString()) {
                e.map = l[c];
                break;
            }
            if (typeof e.map != "function") for (var c in window.validCouchViews) if (e.map.toString() == window.validCouchViews[c].toString()) {
                e.map = window.validCouchViews[c];
                break;
            }
            if (e.reduce) {
                for (var c in l) if (e.reduce.toString() == l[c].toString()) {
                    e.reduce = l[c];
                    break;
                }
                
if (typeof e.reduce != "function") for (var c in window.validCouchViews) if (e.reduce.toString() == window.validCouchViews[c].toString()) {
                    e.reduce = window.validCouchViews[c];
                    break;
                }
            }
            var h = o.openCursor();
            h.onerror = idbError(n.error), h.onsuccess = v;
        };
        return api;
    };
    IdbPouch.valid = function() {
        return !!window.indexedDB;
    }, IdbPouch.destroy = function(t, n) {
        console.info(t + ": Delete Database"), IdbPouch.Changes.clearListeners(t);
        var r = indexedDB.deleteDatabase(t);
        r.onsuccess = function() {
            call(n, null);
        }, r.onerror = idbError(n);
    }, IdbPouch.Changes = function() {
        var e = {}, t = {};
        return e.addListener = function(e, n, r) {
            t[e] || (t[e] = {}), t[e][n] = r;
        }, e.removeListener = function(e, n) {
            delete t[e][n];
        }, e.clearListeners = function(
e) {
            delete t[e];
        }, e.emitChange = function(e, n) {
            if (!t[e]) return;
            for (var r in t[e]) {
                var i = t[e][r];
                if (i.filter && !i.filter.apply(this, [ n.doc ])) return;
                i.include_docs || delete n.doc, i.onChange.apply(i.onChange, [ n ]);
            }
        }, e;
    }(), Pouch.adapter("idb", IdbPouch);
}(this), fielddb.define("pouch", function(e) {
    return function() {
        var t, n;
        return t || e.Pouch;
    };
}(this)), fielddb.require([ "backbone" ], function(e) {
    e.Model.prototype.idAttribute = "_id", e.Model.prototype.parse = function(e) {
        if (e.ok === undefined) for (var t in this.model) {
            var n = this.model[t], r = e[t];
            e[t] = new n(r, {
                parse: !0
            });
        }
        return e.rev && (e._rev = e.rev, delete e.rev), e.id && (e._id = e.id, delete e.id), delete e.ok, e;
    }, e.Collection.prototype.parse = function(
e) {
        return e.rows && _.map(e.rows, function(e) {
            return e.doc || e.value;
        });
    }, e.Model.prototype.save = function() {
        var t = e.Model.prototype.save;
        return function(e, n) {
            n || (n = {});
            var r = n.success;
            n.success = function(e, t) {
                e.set({
                    _rev: t._rev
                }, {
                    silent: !0
                }), typeof r == "function" && r(e, t);
            }, t.call(this, e, n);
        };
    }(), e.Model.prototype.destroy = function() {
        var t = e.Model.prototype.destroy;
        return function(e) {
            e || (e = {}), e.headers || (e.headers = {}), e.headers["If-Match"] = this.get("_rev"), t.call(this, e);
        };
    }();
}), fielddb.define("backbone_couchdb", [ "backbone", "pouch" ], function(e) {
    return function() {
        var t, n;
        return t || e.backbone;
    };
}(this)), fielddb.require([ "backbone" ], function(
e) {
    e.sync = function() {
        function e(e, t, n, r) {
            if (t.id) return e.get(t.id, n, r);
            if (n.view) return e.query(n.view, n, r);
            e.allDocs(n, r);
        }
        var t = function(t, n, r) {
            function s(e, t) {
                e === null ? r.success(t) : r.error(e);
            }
            var i = n.pouch || n.collection && n.collection.pouch;
            r || (r = {}), r.error || (r.error = function() {}), r.success || (r.success = function() {});
            if (!i) throw "missing pouch: " + t;
            i(function(i, o, u) {
                if (i) return r.error(i);
                var a = _.extend({}, u, r);
                switch (t) {
                  case "read":
                    e(o, n, a, s);
                    break;
                  case "create":
                    o.put(n.toJSON(), a, s);
                    break;
                  case "update":
                    o.post(n.toJSON(), a, s);
                    
break;
                  case "delete":
                    o.remove(n.toJSON(), a, s);
                }
            });
        };
        return t.pouch = function(e, t) {
            var n, r, i, s = 1;
            return t || (t = {}), function o(u) {
                i ? n || r ? u(n, r, t) : _.delay(o, s *= 2) : (i = !0, new Pouch(e, function(e, i) {
                    u(n = e, r = i, t);
                }));
            };
        }, t;
    }();
}), fielddb.define("backbone_pouchdb", [ "backbone", "pouch", "backbone_couchdb" ], function(e) {
    return function() {
        var t, n;
        return t || e.backbone;
    };
}(this)), function(e) {
    var t = "hidden", n = "border-box", r = "lineHeight", i = '<textarea tabindex="-1" style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;">', s = 
[ "fontFamily", "fontSize", "fontWeight", "fontStyle", "letterSpacing", "textTransform", "wordSpacing", "textIndent" ], o = "oninput", u = "onpropertychange", a = e(i)[0];
    a.setAttribute(o, "return"), e.isFunction(a[o]) || u in a ? (e(a).css(r, "99px"), e(a).css(r) === "99px" && s.push(r), e.fn.autosize = function(r) {
        return this.each(function() {
            function g() {
                var e, n;
                p || (p = !0, l.value = a.value, l.style.overflowY = a.style.overflowY, l.style.width = f.css("width"), l.scrollTop = 0, l.scrollTop = 9e4, e = l.scrollTop, n = t, e > h ? (e = h, n = "scroll") : e < c && (e = c), a.style.overflowY = n, a.style.height = e + m + "px", setTimeout(function() {
                    p = !1;
                }, 1));
            }
            var a = this, f = e(a), l, c = f.height(), h = parseInt(f.css("maxHeight"), 10), p, d = s.length, v, m = 0;
            if (f.css("box-sizing") === n || f.css("-moz-box-sizing") === n || f.css("-webkit-box-sizing"
) === n) m = f.outerHeight() - f.height();
            if (f.data("mirror") || f.data("ismirror")) return;
            l = e(i).data("ismirror", !0).addClass(r || "autosizejs")[0], v = f.css("resize") === "none" ? "none" : "horizontal", f.data("mirror", e(l)).css({
                overflow: t,
                overflowY: t,
                wordWrap: "break-word",
                resize: v
            }), h = h && h > 0 ? h : 9e4;
            while (d--) l.style[s[d]] = f.css(s[d]);
            e("body").append(l), u in a ? o in a ? a[o] = a.onkeyup = g : a[u] = g : a[o] = g, e(window).resize(g), f.bind("autosize", g), f.text(f.text()), g();
        });
    }) : e.fn.autosize = function() {
        return this;
    };
}(jQuery), fielddb.define("autosize", [ "jquery" ], function(e) {
    return function() {
        var t, n;
        return t || e.autosize;
    };
}(this));

var x2js = new X2JS;

fielddb.define("xml2json", [ "jquery" ], function(e) {
    return function() {
        var t, n
;
        return t || e.X2JS;
    };
}(this));

var Utils = Utils || {};

Utils.websiteUrl = "https://wwwdev.fieldlinguist.com:3182", Utils.authUrl = "https://authdev.fieldlinguist.com:3183", Utils.audioUrl = "https://audiodev.fieldlinguist.com:3184", Utils.lexiconUrl = "https://lexicondev.fieldlinguist.com:3185", Utils.corpusUrl = "https://corpusdev.fieldlinguist.com:3186", Utils.activityUrl = "https://activitydev.fieldlinguist.com:3187", Utils.widgetUrl = "https://widgetdev.fieldlinguist.com:3188", Utils.chromeClientUrl = function() {
    return window.location.origin != "TODOrealunstableurlgoeshere" ? window.location.origin : "TODOrealunstableurlgoeshere";
}, Utils.defaultCouchConnection = function() {
    return {
        protocol: "https://",
        domain: "ifielddevs.iriscouch.com",
        port: "443",
        pouchname: "default"
    };
}, fielddb.define("libs/webservicesconfig_devserver", function() {}), fielddb.require.config({
    paths: {
        bootstrap: "bootstrap/js/bootstrap"
,
        "bootstrap-transition": "bootstrap/js/bootstrap-transition",
        "bootstrap-alert": "bootstrap/js/bootstrap-alert",
        "bootstrap-modal": "bootstrap/js/bootstrap-modal",
        "bootstrap-dropdown": "bootstrap/js/bootstrap-dropdown",
        "bootstrap-scrollspy": "bootstrap/js/bootstrap-scrollspy",
        "bootstrap-tab": "bootstrap/js/bootstrap-tab",
        "bootstrap-tooltip": "bootstrap/js/bootstrap-tooltip",
        "bootstrap-popover": "bootstrap/js/bootstrap-popover",
        "bootstrap-button": "bootstrap/js/bootstrap-button",
        "bootstrap-collapse": "bootstrap/js/bootstrap-collapse",
        "bootstrap-carousel": "bootstrap/js/bootstrap-carousel",
        "bootstrap-typeahead": "bootstrap/js/bootstrap-typeahead",
        crypto: "libs/Crypto_AES",
        jquery: "libs/jquery",
        autosize: "libs/jquery.autosize",
        hotkeys: "libs/jquery.hotkeys",
        compiledTemplates: "libs/compiled_handlebars",
        handlebars: "libs/handlebars.runtime"
,
        backbone: "libs/backbone",
        backbone_pouchdb: "libs/backbone-pouchdb",
        backbone_couchdb: "libs/backbone-couchdb",
        pouch: "libs/pouch.alpha",
        underscore: "libs/underscore",
        terminal: "libs/terminal/terminal",
        text: "libs/text",
        xml2json: "libs/xml2json"
    },
    shim: {
        underscore: {
            exports: "_"
        },
        jquery: {
            exports: "$"
        },
        autosize: {
            deps: [ "jquery" ],
            exports: "autosize"
        },
        xml2json: {
            deps: [ "jquery" ],
            exports: "X2JS"
        },
        bootstrap: {
            deps: [ "jquery" ],
            exports: "bootstrap"
        },
        "bootstrap-typeahead": {
            deps: [ "jquery", "bootstrap", "bootstrap-transition", "bootstrap-alert", "bootstrap-modal", "bootstrap-dropdown", "bootstrap-scrollspy", "bootstrap-tab", "bootstrap-tooltip", "bootstrap-popover", "bootstrap-button", "bootstrap-collapse"
, "bootstrap-carousel" ],
            exports: "bootstrap-typeahead"
        },
        pouch: {
            exports: "Pouch"
        },
        backbone: {
            deps: [ "underscore", "jquery", "compiledTemplates" ],
            exports: "Backbone"
        },
        backbone_pouchdb: {
            deps: [ "backbone", "pouch", "backbone_couchdb" ],
            exports: "backbone"
        },
        backbone_couchdb: {
            deps: [ "backbone", "pouch" ],
            exports: "backbone"
        },
        handlebars: {
            deps: [ "bootstrap", "jquery" ],
            exports: "Handlebars"
        },
        crypto: {
            exports: "CryptoJS"
        },
        compiledTemplates: {
            deps: [ "handlebars" ],
            exports: "compiledTemplates"
        },
        terminal: {
            deps: [ "bootstrap", "jquery" ],
            exports: "Terminal"
        }
    }
}), fielddb.require([ "app/App", "app/AppViewRead", "app/AppRouter", "corpus/Corpus"
, "data_list/DataList", "datum/Datum", "datum/Session", "user/User", "user/UserWelcomeView", "handlebars", "compiledTemplates", "backbone", "backbone_pouchdb", "autosize", "xml2json", "libs/webservicesconfig_devserver", "libs/Utils" ], function(e, t, n, r, i, s, o, u, f, l, c, h, p, d, v) {
    window.startApp = function(e, r) {
        window.app = e, window.appView = new t({
            model: e
        }), window.appView.render(), app.router = new n, h.history.start(), typeof r == "function" && (Utils.debug("Calling back the startApps callback"), r());
    }, loadFreshApp = function() {
        Utils.debug("Loading fresh app"), document.location.href = "user.html";
    }, window.hub = {}, Utils.makePublisher(window.hub);
    var m = Utils.getCookie("username");
    if (m != null && m != "") {
        var g = localStorage.getItem("mostRecentDashboard");
        g = JSON.parse(g);
        if (g == null) {
            loadFreshApp();
            return;
        }
        if (g.length < 3
) {
            loadFreshApp();
            return;
        }
        Utils.debug("Loading app from localStorage");
        var y = null, b = null;
        if (localStorage.getItem("mostRecentCouchConnection") == "undefined" || localStorage.getItem("mostRecentCouchConnection") == undefined || localStorage.getItem("mostRecentCouchConnection") == null) {
            loadFreshApp();
            return;
        }
        if (!localStorage.getItem("encryptedUser")) {
            loadFreshApp();
            return;
        }
        a = new e, window.app = a;
        var w = a.get("authentication"), E = localStorage.getItem("encryptedUser");
        w.loadEncryptedUser(E, function(e, t) {
            if (e == null) {
                alert("We couldnt log you in." + t.join("<br/>") + " " + Utils.contactUs), loadFreshApp();
                return;
            }
            a.createAppBackboneObjects(y, function() {
                window.startApp(a, function() {
                    window.app.loadBackboneObjectsByIdAndSetAsCurrentDashboard
(b, g);
                });
            });
        });
    } else loadFreshApp();
}), fielddb.define("corpus_dashboard_readonly", function() {});